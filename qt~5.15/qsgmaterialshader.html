
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>QSGMaterialShader (Class) - Qt 5.15 - W3cubDocs</title>
  
  <meta name="description" content=" The QSGMaterialShader class represents an OpenGL shader program in the renderer. More... ">
  <meta name="keywords" content="qsgmaterialshader, class, qt, qt~5.15">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/qt~5.15/qsgmaterialshader.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/qt~5.15.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/qt~5.15/" class="_nav-link" title="" style="margin-left:0;">Qt 5.15</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _qt">
				
				
<h1 class="title">QSGMaterialShader Class</h1>  <p>The QSGMaterialShader class represents an OpenGL shader program in the renderer. <a href="#details">More...</a></p>  <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> Header:</td>
<td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;QSGMaterialShader&gt;</span> </td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> qmake:</td>
<td class="memItemRight bottomAlign"> QT += quick</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> Inherited By:</td>
<td class="memItemRight bottomAlign"> <p><a href="qsgmaterialrhishader">QSGMaterialRhiShader</a> and <a class="obsolete" href="qsgsimplematerialshader">QSGSimpleMaterialShader</a></p> </td>
</tr>
</table>
<ul> <li><a href="https://doc.qt.io/qt-5.15/qsgmaterialshader-members.html">List of all members, including inherited members</a></li> </ul>  <h2 id="public-types">Public Types
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> class </td>
<td class="memItemRight bottomAlign"><b><a href="qsgmaterialshader-renderstate">RenderState</a></b></td>
</tr> </table>  <h2 id="public-functions">Public Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#QSGMaterialShader">QSGMaterialShader</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#activate">activate</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual const char *const *</td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#attributeNames">attributeNames</a></b>() const = 0</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#deactivate">deactivate</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QOpenGLShaderProgram *</td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#program">program</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#updateState">updateState</a></b>(const QSGMaterialShader::RenderState &amp;<i>state</i>, QSGMaterial *<i>newMaterial</i>, QSGMaterial *<i>oldMaterial</i>)</td>
</tr> </table>  <h2 id="protected-functions">Protected Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#compile">compile</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual const char *</td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#fragmentShader">fragmentShader</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#initialize">initialize</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#setShaderSourceFile">setShaderSourceFile</a></b>(QOpenGLShader::ShaderType <i>type</i>, const QString &amp;<i>sourceFile</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#setShaderSourceFiles">setShaderSourceFiles</a></b>(QOpenGLShader::ShaderType <i>type</i>, const QStringList &amp;<i>sourceFiles</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual const char *</td>
<td class="memItemRight bottomAlign">
<b><a href="qsgmaterialshader#vertexShader">vertexShader</a></b>() const</td>
</tr> </table>    <h2 id="details">Detailed Description
</h2> <p>The QSGMaterialShader API is relatively low-level. A more convenient API, which provides almost all the same features, is available through QSGSimpleMaterialShader.</p> <p><b>Warning:</b> This class is only functional when running with the legacy OpenGL renderer of the Qt Quick scenegraph.</p> <p>The <a href="qsgmaterial">QSGMaterial</a> and QSGMaterialShader form a tight relationship. For one scene graph (including nested graphs), there is one unique QSGMaterialShader instance which encapsulates the <a href="qopenglshaderprogram">QOpenGLShaderProgram</a> the scene graph uses to render that material, such as a shader to flat coloring of geometry. Each <a href="qsggeometrynode">QSGGeometryNode</a> can have a unique <a href="qsgmaterial">QSGMaterial</a> containing the how the shader should be configured when drawing that node, such as the actual color used to render the geometry.</p> <p>An instance of QSGMaterialShader is never created explicitly by the user, it will be created on demand by the scene graph through <a href="qsgmaterial#createShader">QSGMaterial::createShader</a>(). The scene graph will make sure that there is only one instance of each shader implementation through a scene graph.</p> <p>The source code returned from <a href="qsgmaterialshader#vertexShader">vertexShader</a>() is used to control what the material does with the vertiex data that comes in from the geometry. The source code returned from the <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>() is used to control what how the material should fill each individual pixel in the geometry. The vertex and fragment source code is queried once during initialization, changing what is returned from these functions later will not have any effect.</p> <p>The <a href="qsgmaterialshader#activate">activate</a>() function is called by the scene graph when a shader is is starting to be used. The deactivate function is called by the scene graph when the shader is no longer going to be used. While active, the scene graph may make one or more calls to <a href="qsgmaterialshader#updateState">updateState</a>() which will update the state of the shader for each individual geometry to render.</p> <p>The <a href="qsgmaterialshader#attributeNames">attributeNames</a>() returns the name of the attributes used in the <a href="qsgmaterialshader#vertexShader">vertexShader</a>(). These are used in the default implementation of <a href="qsgmaterialshader#activate">activate</a>() and <a href="qsgmaterialshader#deactivate">deactivate</a>() to decide whice vertex registers are enabled.</p> <p>The <a href="qsgmaterialshader#initialize">initialize</a>() function is called during program creation to allow subclasses to prepare for use, such as resolve uniform names in the <a href="qsgmaterialshader#vertexShader">vertexShader</a>() and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>().</p> <p>A minimal example:</p> <pre data-language="cpp">class Shader : public QSGMaterialShader
{
public:
    const char *vertexShader() const {
        return
        "attribute highp vec4 vertex;          \n"
        "uniform highp mat4 matrix;            \n"
        "void main() {                         \n"
        "    gl_Position = matrix * vertex;    \n"
        "}";
    }

    const char *fragmentShader() const {
        return
        "uniform lowp float opacity;                            \n"
        "void main() {                                          \n"
                "    gl_FragColor = vec4(1, 0, 0, 1) * opacity; \n"
        "}";
    }

    char const *const *attributeNames() const
    {
        static char const *const names[] = { "vertex", 0 };
        return names;
    }

    void initialize()
    {
        QSGMaterialShader::initialize();
        m_id_matrix = program()-&gt;uniformLocation("matrix");
        m_id_opacity = program()-&gt;uniformLocation("opacity");
    }

    void updateState(const RenderState &amp;state, QSGMaterial *newMaterial, QSGMaterial *oldMaterial)
    {
        Q_ASSERT(program()-&gt;isLinked());
        if (state.isMatrixDirty())
            program()-&gt;setUniformValue(m_id_matrix, state.combinedMatrix());
        if (state.isOpacityDirty())
            program()-&gt;setUniformValue(m_id_opacity, state.opacity());
    }

private:
    int m_id_matrix;
    int m_id_opacity;
};</pre> <p><b>Note: </b>All classes with QSG prefix should be used solely on the scene graph's rendering thread. See <a href="qtquick-visualcanvas-scenegraph#scene-graph-and-rendering">Scene Graph and Rendering</a> for more information.</p>    <h2>Member Function Documentation</h2>  <h3 class="fn" id="QSGMaterialShader">
QSGMaterialShader::<span class="name">QSGMaterialShader</span>()
</h3> <p>Creates a new QSGMaterialShader.</p>   <h3 class="fn" id="activate">
<code>[virtual] </code><span class="type">void</span> QSGMaterialShader::<span class="name">activate</span>()
</h3> <p>This function is called by the scene graph to indicate that geometry is about to be rendered using this shader.</p> <p>State that is global for all uses of the shader, independent of the geometry that is being drawn, can be setup in this function.</p>   <h3 class="fn" id="attributeNames">
<code>[pure virtual] </code>const <span class="type">char</span> *const *QSGMaterialShader::<span class="name">attributeNames</span>() const
</h3> <p>Returns a zero-terminated array describing the names of the attributes used in the vertex shader.</p> <p>This function is called when the shader is compiled to specify which attributes exist. The order of the attribute names defines the attribute register position in the vertex shader.</p>   <h3 class="fn" id="compile">
<code>[virtual protected] </code><span class="type">void</span> QSGMaterialShader::<span class="name">compile</span>()
</h3> <p>This function is called when the shader is initialized to compile the actual <a href="qopenglshaderprogram">QOpenGLShaderProgram</a>. Do not call it explicitly.</p> <p>The default implementation will extract the <a href="qsgmaterialshader#vertexShader">vertexShader</a>() and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>() and bind the names returned from <a href="qsgmaterialshader#attributeNames">attributeNames</a>() to consecutive vertex attribute registers starting at 0.</p>   <h3 class="fn" id="deactivate">
<code>[virtual] </code><span class="type">void</span> QSGMaterialShader::<span class="name">deactivate</span>()
</h3> <p>This function is called by the scene graph to indicate that geometry will no longer to be rendered using this shader.</p>   <h3 class="fn" id="fragmentShader">
<code>[virtual protected] </code>const <span class="type">char</span> *QSGMaterialShader::<span class="name">fragmentShader</span>() const
</h3> <p>Called when the shader is being initialized to get the fragment shader source code.</p> <p>The contents returned from this function should never change.</p>   <h3 class="fn" id="initialize">
<code>[virtual protected] </code><span class="type">void</span> QSGMaterialShader::<span class="name">initialize</span>()
</h3> <p>Reimplement this function to do one-time initialization when the shader program is compiled. The OpenGL shader program is compiled and linked, but not bound, when this function is called.</p>   <h3 class="fn" id="program">
<span class="type"><a href="qopenglshaderprogram">QOpenGLShaderProgram</a></span> *QSGMaterialShader::<span class="name">program</span>()
</h3> <p>Returns the shader program used by this <a href="qsgmaterialshader">QSGMaterialShader</a>.</p>   <h3 class="fn" id="setShaderSourceFile">
<code>[protected] </code><span class="type">void</span> QSGMaterialShader::<span class="name">setShaderSourceFile</span>(<span class="type"><a href="qopenglshader#ShaderTypeBit-enum">QOpenGLShader::ShaderType</a></span> <i>type</i>, const <span class="type"><a href="qstring">QString</a></span> &amp;<i>sourceFile</i>)
</h3> <p>Sets the GLSL source file for the shader stage <i>type</i> to <i>sourceFile</i>. The default implementation of the <a href="qsgmaterialshader#vertexShader">vertexShader</a>() and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>() functions will load the source files set by this function.</p> <p>This function is useful when you have a single source file for a given shader stage. If your shader consists of multiple source files then use <a href="qsgmaterialshader#setShaderSourceFiles">setShaderSourceFiles</a>()</p> <p><b>See also </b><a href="qsgmaterialshader#setShaderSourceFiles">setShaderSourceFiles</a>(), <a href="qsgmaterialshader#vertexShader">vertexShader</a>(), and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>().</p>   <h3 class="fn" id="setShaderSourceFiles">
<code>[protected] </code><span class="type">void</span> QSGMaterialShader::<span class="name">setShaderSourceFiles</span>(<span class="type"><a href="qopenglshader#ShaderTypeBit-enum">QOpenGLShader::ShaderType</a></span> <i>type</i>, const <span class="type"><a href="qstringlist">QStringList</a></span> &amp;<i>sourceFiles</i>)
</h3> <p>Sets the GLSL source files for the shader stage <i>type</i> to <i>sourceFiles</i>. The default implementation of the <a href="qsgmaterialshader#vertexShader">vertexShader</a>() and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>() functions will load the source files set by this function in the order given.</p> <p><b>See also </b><a href="qsgmaterialshader#setShaderSourceFile">setShaderSourceFile</a>(), <a href="qsgmaterialshader#vertexShader">vertexShader</a>(), and <a href="qsgmaterialshader#fragmentShader">fragmentShader</a>().</p>   <h3 class="fn" id="updateState">
<code>[virtual] </code><span class="type">void</span> QSGMaterialShader::<span class="name">updateState</span>(const <span class="type"><a href="qsgmaterialshader-renderstate">QSGMaterialShader::RenderState</a></span> &amp;<i>state</i>, <span class="type"><a href="qsgmaterial">QSGMaterial</a></span> *<i>newMaterial</i>, <span class="type"><a href="qsgmaterial">QSGMaterial</a></span> *<i>oldMaterial</i>)
</h3> <p>This function is called by the scene graph before geometry is rendered to make sure the shader is in the right state.</p> <p>The current rendering <i>state</i> is passed from the scene graph. If the state indicates that any state is dirty, the updateState implementation must update accordingly for the geometry to render correctly.</p> <p>The subclass specific state, such as the color of a flat color material, should be extracted from <i>newMaterial</i> to update the color uniforms accordingly.</p> <p>The <i>oldMaterial</i> can be used to minimze state changes when updating material states. The <i>oldMaterial</i> is 0 if this shader was just activated.</p> <p><b>See also </b><a href="qsgmaterialshader#activate">activate</a>() and <a href="qsgmaterialshader#deactivate">deactivate</a>().</p>   <h3 class="fn" id="vertexShader">
<code>[virtual protected] </code>const <span class="type">char</span> *QSGMaterialShader::<span class="name">vertexShader</span>() const
</h3> <p>Called when the shader is being initialized to get the vertex shader source code.</p> <p>The contents returned from this function should never change.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © The Qt Company Ltd<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://doc.qt.io/qt-5.15/qsgmaterialshader.html" class="_attribution-link">https://doc.qt.io/qt-5.15/qsgmaterialshader.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

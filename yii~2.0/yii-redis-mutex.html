
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>redis&#92;Mutex - Yii 2.0 - W3cubDocs</title>
  
  <meta name="description" content=" Redis Mutex implements a mutex component using redis as the storage medium. ">
  <meta name="keywords" content="class, yii, redis, mutex, yii~2.0">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~2.0/yii-redis-mutex.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/yii~2.0.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~2.0/" class="_nav-link" title="" style="margin-left:0;">Yii 2.0</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>Class yii\redis\Mutex</h1> <div class="top-nav"> <a href="index">All Classes</a> | <a href="#properties">Properties</a> | <a href="#methods">Methods</a> </div> <table> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr>
<th>Inheritance</th>
<td>
<a href="yii-redis-mutex">yii\redis\Mutex</a> » <a href="yii-mutex-mutex">yii\mutex\Mutex</a> » <a href="yii-base-component">yii\base\Component</a> » <a href="yii-base-object">yii\base\Object</a>
</td>
</tr> <tr>
<th>Implements</th>
<td><a href="yii-base-configurable">yii\base\Configurable</a></td>
</tr> <tr>
<th>Available since version</th>
<td>2.0.6</td>
</tr> <tr> <th>Source Code</th> <td><a href="https://github.com/yiisoft/yii2-redis/blob/master/Mutex.php">https://github.com/yiisoft/yii2-redis/blob/master/Mutex.php</a></td> </tr> </table>  <p><strong>Redis Mutex implements a mutex component using <a href="http://redis.io/">redis</a> as the storage medium.</strong></p> <p>Redis Mutex requires redis version 2.6.12 or higher to work properly.</p> <p>It needs to be configured with a redis <a href="yii-redis-connection">yii\redis\Connection</a> that is also configured as an application component. By default it will use the <code>redis</code> application component.</p> <p>To use redis Mutex as the application component, configure the application as follows:</p> <pre data-language="php">[
    'components' =&gt; [
        'mutex' =&gt; [
            'class' =&gt; 'yii\redis\Mutex',
            'redis' =&gt; [
                'hostname' =&gt; 'localhost',
                'port' =&gt; 6379,
                'database' =&gt; 0,
            ]
        ],
    ],
]
</pre> <p>Or if you have configured the redis <a href="yii-redis-connection">yii\redis\Connection</a> as an application component, the following is sufficient:</p> <pre data-language="php">[
    'components' =&gt; [
        'mutex' =&gt; [
            'class' =&gt; 'yii\redis\Mutex',
            // 'redis' =&gt; 'redis' // id of the connection application component
        ],
    ],
]
</pre> <p>See also:</p>
<ul>
<li><a href="yii-mutex-mutex">yii\mutex\Mutex</a></li>
<li><a href="http://redis.io/topics/distlock">http://redis.io/topics/distlock</a></li>
</ul>   <h2 id="properties">Public Properties</h2>  <table> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="$autoRelease"> <td><a href="yii-mutex-mutex#%24autoRelease-detail">$autoRelease</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether all locks acquired in this process (i.e. local locks) must be released automatically before finishing script execution.</td> <td><a href="yii-mutex-mutex">yii\mutex\Mutex</a></td> </tr> <tr id="$behaviors"> <td><a href="yii-base-component#%24behaviors-detail">$behaviors</a></td> <td>
<a href="yii-base-behavior">yii\base\Behavior</a>[]</td> <td>List of behaviors attached to this component</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="$expire"> <td><a href="yii-redis-mutex#%24expire-detail">$expire</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>The number of seconds in which the lock will be auto released.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> <tr id="$keyPrefix"> <td><a href="yii-redis-mutex#%24keyPrefix-detail">$keyPrefix</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>A string prefixed to every cache key so that it is unique.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> <tr id="$redis"> <td><a href="yii-redis-mutex#%24redis-detail">$redis</a></td> <td>
<a href="yii-redis-connection">yii\redis\Connection</a>|<a href="http://www.php.net/language.types.string">string</a>|<a href="http://www.php.net/language.types.array">array</a>
</td> <td>The Redis <a href="yii-redis-connection">yii\redis\Connection</a> object or the application component ID of the Redis <a href="yii-redis-connection">yii\redis\Connection</a>.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> </table>    <h2 id="methods">Public Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="__call()"> <td><a href="yii-base-object#__call()-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="__clone()"> <td><a href="yii-base-component#__clone()-detail">__clone()</a></td> <td>This method is called after the object is created by cloning an existing one.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="__construct()"> <td><a href="yii-base-object#__construct()-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="__get()"> <td><a href="yii-base-object#__get()-detail">__get()</a></td> <td>Returns the value of an object property.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="__isset()"> <td><a href="yii-base-object#__isset()-detail">__isset()</a></td> <td>Checks if a property is set, i.e. defined and not null.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="__set()"> <td><a href="yii-base-object#__set()-detail">__set()</a></td> <td>Sets value of an object property.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="__unset()"> <td><a href="yii-base-object#__unset()-detail">__unset()</a></td> <td>Sets an object property to null.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="acquire()"> <td><a href="yii-mutex-mutex#acquire()-detail">acquire()</a></td> <td>Acquires a lock by name.</td> <td><a href="yii-mutex-mutex">yii\mutex\Mutex</a></td> </tr> <tr id="attachBehavior()"> <td><a href="yii-base-component#attachBehavior()-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="attachBehaviors()"> <td><a href="yii-base-component#attachBehaviors()-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="behaviors()"> <td><a href="yii-base-component#behaviors()-detail">behaviors()</a></td> <td>Returns a list of behaviors that this component should behave as.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="canGetProperty()"> <td><a href="yii-base-object#canGetProperty()-detail">canGetProperty()</a></td> <td>Returns a value indicating whether a property can be read.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="canSetProperty()"> <td><a href="yii-base-object#canSetProperty()-detail">canSetProperty()</a></td> <td>Returns a value indicating whether a property can be set.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="className()"> <td><a href="yii-base-object#className()-detail">className()</a></td> <td>Returns the fully qualified name of this class.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="detachBehavior()"> <td><a href="yii-base-component#detachBehavior()-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="detachBehaviors()"> <td><a href="yii-base-component#detachBehaviors()-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="ensureBehaviors()"> <td><a href="yii-base-component#ensureBehaviors()-detail">ensureBehaviors()</a></td> <td>Makes sure that the behaviors declared in <a href="yii-base-component#behaviors()-detail">behaviors()</a> are attached to this component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="getBehavior()"> <td><a href="yii-base-component#getBehavior()-detail">getBehavior()</a></td> <td>Returns the named behavior object.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="getBehaviors()"> <td><a href="yii-base-component#getBehaviors()-detail">getBehaviors()</a></td> <td>Returns all behaviors attached to this component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="hasEventHandlers()"> <td><a href="yii-base-component#hasEventHandlers()-detail">hasEventHandlers()</a></td> <td>Returns a value indicating whether there is any handler attached to the named event.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="hasMethod()"> <td><a href="yii-base-object#hasMethod()-detail">hasMethod()</a></td> <td>Returns a value indicating whether a method is defined.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="hasProperty()"> <td><a href="yii-base-object#hasProperty()-detail">hasProperty()</a></td> <td>Returns a value indicating whether a property is defined.</td> <td><a href="yii-base-object">yii\base\Object</a></td> </tr> <tr id="init()"> <td><a href="yii-redis-mutex#init()-detail">init()</a></td> <td>Initializes the redis Mutex component.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> <tr id="off()"> <td><a href="yii-base-component#off()-detail">off()</a></td> <td>Detaches an existing event handler from this component.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="on()"> <td><a href="yii-base-component#on()-detail">on()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> <tr id="release()"> <td><a href="yii-mutex-mutex#release()-detail">release()</a></td> <td>Releases acquired lock. This method will return false in case the lock was not found.</td> <td><a href="yii-mutex-mutex">yii\mutex\Mutex</a></td> </tr> <tr id="trigger()"> <td><a href="yii-base-component#trigger()-detail">trigger()</a></td> <td>Triggers an event.</td> <td><a href="yii-base-component">yii\base\Component</a></td> </tr> </table>   <h2>Protected Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="acquireLock()"> <td><a href="yii-redis-mutex#acquireLock()-detail">acquireLock()</a></td> <td>Acquires a lock by name.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> <tr id="calculateKey()"> <td><a href="yii-redis-mutex#calculateKey()-detail">calculateKey()</a></td> <td>Generates a unique key used for storing the mutex in Redis.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> <tr id="releaseLock()"> <td><a href="yii-redis-mutex#releaseLock()-detail">releaseLock()</a></td> <td>Releases acquired lock. This method will return <code>false</code> in case the lock was not found or Redis command failed.</td> <td><a href="yii-redis-mutex">yii\redis\Mutex</a></td> </tr> </table>    <h2 id="constants">Property Details</h2>  <h3 id="$expire-detail"> $expire <span class="detail-header-tag small"> public property </span> </h3>  <p>The number of seconds in which the lock will be auto released.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <a href="yii-redis-mutex#%24expire-detail">$expire</a> = 30</pre> <h3 id="$keyPrefix-detail"> $keyPrefix <span class="detail-header-tag small"> public property </span> </h3>  <p>A string prefixed to every cache key so that it is unique. If not set, it will use a prefix generated from <span class="broken-link">\yii\redis\Application::id</span>. You may set this property to be an empty string if you don't want to use key prefix. It is recommended that you explicitly set this property to some static value if the cached data needs to be shared among multiple applications.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-redis-mutex#%24keyPrefix-detail">$keyPrefix</a> = null</pre> <h3 id="$redis-detail"> $redis <span class="detail-header-tag small"> public property </span> </h3>  <p>The Redis <a href="yii-redis-connection">yii\redis\Connection</a> object or the application component ID of the Redis <a href="yii-redis-connection">yii\redis\Connection</a>. This can also be an array that is used to create a redis <a href="yii-redis-connection">yii\redis\Connection</a> instance in case you do not want do configure redis connection as an application component. After the Mutex object is created, if you want to change this property, you should only assign it with a Redis <a href="yii-redis-connection">yii\redis\Connection</a> object.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-redis-connection">yii\redis\Connection</a>|<a href="http://www.php.net/language.types.string">string</a>|<a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-redis-mutex#%24redis-detail">$redis</a> = 'redis'</pre>  <h2>Method Details</h2> <div class="method-doc"> <h3 id="acquireLock()-detail"> acquireLock() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Acquires a lock by name.</strong></p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/language.types.boolean">boolean</a> <strong><a href="yii-redis-mutex#acquireLock()-detail">acquireLock</a></strong> ( $name, $timeout = 0 )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Of the lock to be acquired. Must be unique.</p> </td> </tr> <tr> <td>$timeout</td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>
<p>Time to wait for lock to be released. Defaults to <code>0</code> meaning that method will return false immediately in case lock was already acquired.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Lock acquiring result.</p> </td> </tr> </table>  <h3 id="calculateKey()-detail"> calculateKey() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Generates a unique key used for storing the mutex in Redis.</strong></p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-redis-mutex#calculateKey()-detail">calculateKey</a></strong> ( $name )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Mutex name.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>A safe cache key associated with the mutex name.</p> </td> </tr> </table>  <h3 id="init()-detail"> init() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Initializes the redis Mutex component.</strong></p> <p>This method will initialize the <a href="yii-redis-mutex#%24redis-detail">$redis</a> property to make sure it refers to a valid redis connection.</p>  <table> <tr><th colspan="3">public void <strong><a href="yii-redis-mutex#init()-detail">init</a></strong> ( )</th></tr> <tr> <td>throws</td> <td><a href="yii-base-invalidconfigexception">yii\base\InvalidConfigException</a></td> <td>
<p>if <a href="yii-redis-mutex#%24redis-detail">$redis</a> is invalid.</p> </td> </tr> </table>  <h3 id="releaseLock()-detail"> releaseLock() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Releases acquired lock. This method will return <code>false</code> in case the lock was not found or Redis command failed.</strong></p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/language.types.boolean">boolean</a> <strong><a href="yii-redis-mutex#releaseLock()-detail">releaseLock</a></strong> ( $name )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Of the lock to be released. This lock must already exist.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Lock release result: <code>false</code> in case named lock was not found or Redis command failed.</p> </td> </tr> </table>  </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc-2.0/yii-redis-mutex.html" class="_attribution-link">http://www.yiiframework.com/doc-2.0/yii-redis-mutex.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

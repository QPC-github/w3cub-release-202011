
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Using the Compiler - Crystal - W3cubDocs</title>
  
  <meta name="description" content=" To compile and run a program in a single shot, invoke crystal run with a single filename&#58; ">
  <meta name="keywords" content="using, compiler, crystal">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/crystal/docs/using_the_compiler.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/crystal.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/crystal/" class="_nav-link" title="" style="margin-left:0;">Crystal</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _crystal">
				
				
<h1 id="using-the-compiler">Using the compiler</h1> <h2 id="compiling-and-running-at-once">Compiling and running at once</h2> <p>To compile and run a program in a single shot, invoke <a href="#crystal-run"><code>crystal run</code></a> with a single filename:</p> <pre data-language="shell">$ echo 'puts "Hello World!"' &gt; hello_world.cr
$ crystal run hello_world.cr
Hello World!
</pre> <p>The <code>run</code> command compiles the source file <code>hello_world.cr</code> to a binary executable in a temporary location and immediately executes it.</p> <h2 id="creating-an-executable">Creating an executable</h2> <p>The <a href="#crystal-build"><code>crystal build</code></a> command builds a binary executable. The output file has the same name as the source file minus the extension <code>.cr</code>.</p> <pre data-language="shell">$ crystal build hello_world.cr
$ ./hello_world
Hello World!
</pre> <h3 id="release-builds">Release builds</h3> <p>By default, the generated executables are not fully optimized. The <code>--release</code> flag can be used to enable optimizations.</p> <pre>$ crystal build hello_world.cr --release
</pre>
<p>Compiling without release mode is much faster and the resulting binaries still offer pretty good performance.</p> <p>Building in release mode should be used for production-ready executables and when performing benchmarks. For simple development builds, there is usually no reason to do so.</p> <p>To reduce the binary size for distributable files, the <code>--no-debug</code> flag can be used. This removes debug symbols reducing file size, but obviously making debugging more difficult.</p> <h3 id="creating-a-statically-linked-executable">Creating a statically-linked executable</h3> <p>The <code>--static</code> flag can be used to build a statically-linked executable:</p> <pre>$ crystal build hello_world.cr --release --static
</pre>
<p><strong>NOTE:</strong> Building fully statical linked executables is currently only supported on Alpine Linux.</p> <p>More information about statically linking <a href="https://github.com/crystal-lang/crystal/wiki/Static-Linking" target="_blank">can be found on the wiki</a>.</p> <p>The compiler uses the <code>CRYSTAL_LIBRARY_PATH</code> environment variable as a first lookup destination for static and dynamic libraries that are to be linked. This can be used to provide static versions of libraries that are also available as dynamic libraries.</p> <h3 id="creating-a-crystal-project">Creating a Crystal project</h3> <p>The <a href="#crystal-init"><code>crystal init</code></a> command helps to initialize a Crystal project folder, setting up a basic project structure. <code>crystal init app &lt;name&gt;</code> is used for an application, <code>crystal init lib &lt;name&gt;</code> for a library.</p> <pre data-language="shell">$ crystal init app myapp
    create  myapp/.gitignore
    create  myapp/.editorconfig
    create  myapp/LICENSE
    create  myapp/README.md
    create  myapp/.travis.yml
    create  myapp/shard.yml
    create  myapp/src/myapp.cr
    create  myapp/src/myapp/version.cr
    create  myapp/spec/spec_helper.cr
    create  myapp/spec/myapp_spec.cr
Initialized empty Git repository in /home/crystal/myapp/.git/
</pre> <p>Not all of these files are required for every project, and some might need more customization, but <code>crystal init</code> creates a good default environment for developing Crystal applications and libraries.</p> <h2 id="compiler-commands">Compiler commands</h2> <ul> <li>
<a href="#crystal-init"><code>crystal init</code></a>: generate a new project</li> <li>
<a href="#crystal-build"><code>crystal build</code></a>: build an executable</li> <li>
<a href="#crystal-docs"><code>crystal docs</code></a>: generate documentation</li> <li>
<a href="#crystal-env"><code>crystal env</code></a>: print Crystal environment information</li> <li>
<a href="#crystal-eval"><code>crystal eval</code></a>: eval code from args or standard input</li> <li>
<a href="#crystal-play"><code>crystal play</code></a>: starts crystal playground server</li> <li>
<a href="#crystal-run"><code>crystal run</code></a>: build and run program</li> <li>
<a href="#crystal-spec"><code>crystal spec</code></a>: build and run specs</li> <li>
<a href="#crystal-tool"><code>crystal tool</code></a>: run a compiler tool</li> <li>
<code>crystal help</code>: show help about commands and options</li> <li>
<a href="#crystal-version"><code>crystal version</code></a>: show version</li> </ul> <p>To see the available options for a particular command, use <code>--help</code> after a command:</p> <h3 id="crystal-run"><code>crystal run</code></h3> <p>The <code>run</code> command compiles a source file to a binary executable and immediately runs it.</p> <pre>crystal [run] [&lt;options&gt;] &lt;programfile&gt; [-- &lt;argument&gt;...]
</pre>
<p>Arguments to the compiled binary can be separated with double dash <code>--</code> from the compiler arguments. The binary executable is stored in a temporary location between compiling and running.</p> <p>Example:</p> <pre data-language="shell">$ echo 'puts "Hello #{ARGV[0]?}!"' &gt; hello_world.cr
$ crystal run hello_world.cr -- Crystal
Hello Crystal!
</pre> <p><strong>Common options:</strong></p> <ul> <li>
<code>--release</code>: Compile in release mode, doing extra work to apply optimizations to the generated code.</li> <li>
<code>--progress</code>: Show progress during compilation.</li> <li>
<code>--static</code>: Link statically.</li> </ul> <p>More options are described in the integrated help: <code>crystal run --help</code> or man page <code>man crystal</code>.</p> <h3 id="crystal-build"><code>crystal build</code></h3> <p>The <code>crystal build</code> command builds a dynamically-linked binary executable.</p> <pre>crystal build [&lt;options&gt;] &lt;programfile&gt;
</pre>
<p>Unless specified, the resulting binary will have the same name as the source file minus the extension <code>.cr</code>.</p> <p>Example:</p> <pre data-language="shell">$ echo 'puts "Hello #{ARGV[0]?}!"' &gt; hello_world.cr
$ crystal build hello_world.cr
$ ./hello_world Crystal
Hello Crystal!
</pre> <p><strong>Common options:</strong></p> <ul> <li>
<code>--cross-compile</code>: Generate a .o file, and print the command to generate an executable to stdout.</li> <li>
<code>-D FLAG, --define FLAG</code>: Define a compile-time flag.</li> <li>
<code>-o &lt;output_file&gt;</code>: Define the name of the binary executable.</li> <li>
<code>--release</code>: Compile in release mode, doing extra work to apply optimizations to the generated code.</li> <li>
<code>--link-flags FLAGS</code>: Additional flags to pass to the linker.</li> <li>
<code>--lto=thin</code>: Use ThinLTO, improving performance on release builds.</li> <li>
<code>--no-debug</code>: Skip any symbolic debug info, reducing the output file size.</li> <li>
<code>--progress</code>: Show progress during compilation.</li> <li>
<code>--static</code>: Link statically.</li> <li>
<code>--verbose</code>: Display executed commands.</li> </ul> <p>More options are described in the integrated help: <code>crystal build --help</code> or man page <code>man crystal</code>.</p> <h3 id="crystal-eval"><code>crystal eval</code></h3> <p>The <code>crystal eval</code> command reads Crystal source code from command line or stdin, compiles it to a binary executable and immediately runs it.</p> <pre>crystal eval [&lt;options&gt;] [&lt;source&gt;]
</pre>
<p>If no <code>source</code> argument is provided, the Crystal source is read from standard input. The binary executable is stored in a temporary location between compiling and running.</p> <p>Example:</p> <pre data-language="shell">$ crystal eval 'puts "Hello World"'
Hello World!
$ echo 'puts "Hello World"' | crystal eval
Hello World!
</pre> <p>NOTE: When running interactively, stdin can usually be closed by typing the end of transmission character (<code>Ctrl+D</code>).</p> <p><strong>Common options:</strong></p> <ul> <li>
<code>-o &lt;output_file&gt;</code>: Define the name of the binary executable.</li> <li>
<code>--release</code>: Compile in release mode, doing extra work to apply optimizations to the generated code.</li> <li>
<code>--lto=thin</code>: Use ThinLTO, improves performance.</li> <li>
<code>--no-debug</code>: Skip any symbolic debug info, reducing the output file size.</li> <li>
<code>--progress</code>: Show progress during compilation.</li> <li>
<code>--static</code>: Link statically.</li> </ul> <p>More options are described in the integrated help: <code>crystal eval --help</code> or man page <code>man crystal</code>.</p> <h3 id="crystal-version"><code>crystal version</code></h3> <p>The <code>crystal version</code> command prints the Crystal version, LLVM version and default target triple.</p> <pre>crystal version
</pre>
<p>Example:</p> <pre data-language="shell">$ crystal version
Crystal 0.25.1 [b782738ff] (2018-06-27)

LLVM: 4.0.0
Default target: x86_64-unknown-linux-gnu
</pre> <h3 id="crystal-init"><code>crystal init</code></h3> <p>The <code>crystal init</code> command initializes a Crystal project folder.</p> <pre>crystal init (lib|app) &lt;name&gt; [&lt;dir&gt;]
</pre>
<p>The first argument is either <code>lib</code> or <code>app</code>. A <code>lib</code> is a reusable library whereas <code>app</code> describes an application not intended to be used as a dependency. A library doesn't have a <code>shard.lock</code> file in its repository and no build target in <code>shard.yml</code>, but instructions for using it as a dependency.</p> <p>Example:</p> <pre data-language="shell">$ crystal init lib my_cool_lib
    create  my_cool_lib/.gitignore
    create  my_cool_lib/.editorconfig
    create  my_cool_lib/LICENSE
    create  my_cool_lib/README.md
    create  my_cool_lib/.travis.yml
    create  my_cool_lib/shard.yml
    create  my_cool_lib/src/my_cool_lib.cr
    create  my_cool_lib/spec/spec_helper.cr
    create  my_cool_lib/spec/my_cool_lib_spec.cr
Initialized empty Git repository in ~/my_cool_lib/.git/
</pre> <h3 id="crystal-docs"><code>crystal docs</code></h3> <p>The <code>crystal docs</code> command generates API documentation from inline docstrings in Crystal files (see <a href="https://crystal-lang.org/conventions/documenting_code.html">documenting code</a>).</p> <pre data-language="bash">crystal docs [--output=&lt;output_dir&gt;] [--canonical-base-url=&lt;url&gt;] [&lt;source_file&gt;...]
</pre> <p>The command creates a static website in <code>output_dir</code> (default <code>./docs</code>), consisting of HTML files for each Crystal type, in a folder structure mirroring the Crystal namespaces. The entrypoint <code>docs/index.html</code> can be opened by any web browser. The entire API docs are also stored as a JSON document in <code>$output_dir/index.json</code>.</p> <p>By default, all Crystal files in <code>./src</code> will be appended (i.e. <code>src/**/*.cr</code>). In order to account for load-order dependencies, <code>source_file</code> can be used to specify one (or multiple) entrypoints for the docs generator.</p> <pre data-language="bash">crystal docs src/my_app.cr
</pre> <p><strong>Common options:</strong></p> <ul> <li>
<code>--project-name=NAME</code>: Set the project name. The default value is extracted from <code>shard.yml</code> if available. In case no default can be found, this option is mandatory.</li> <li>
<code>--project-version=VERSION</code>: Set the project version. The default value is extracted from current git commit or <code>shard.yml</code> if available. In case no default can be found, this option is mandatory.</li> <li>
<code>--output=DIR, -o DIR</code>: Set the output directory (default: <code>./docs</code>)</li> <li>
<code>--canonical-base-url=URL, -b URL</code>: Set the <a href="https://en.wikipedia.org/wiki/Canonical_link_element" target="_blank">canonical base url</a>
</li> </ul> <p>For the above example to output the docs at <code>public</code> with custom canonical base url, and entrypoint <code>src/my_app.cr</code>, the following arguments can be used:</p> <pre data-language="bash">crystal docs --output public --canonical-base-url http://example.com/ src/my_app.cr
</pre> <h3 id="crystal-env"><code>crystal env</code></h3> <p>The <code>crystal env</code> command prints environment variables used by Crystal.</p> <pre data-language="bash">crystal env [&lt;var&gt;...]
</pre> <p>By default, it prints information as a shell script. If one or more <code>var</code> arguments are provided, the value of each named variable is printed on its own line.</p> <p>Example:</p> <pre data-language="shell">$ crystal env
CRYSTAL_CACHE_DIR="/home/crystal/.cache/crystal"
CRYSTAL_PATH="/usr/bin/../share/crystal/src:lib"
CRYSTAL_VERSION="0.28.0"
CRYSTAL_LIBRARY_PATH="/usr/bin/../lib/crystal/lib"
$ crystal env CRYSTAL_VERSION
0.28.0
</pre> <h3 id="crystal-spec"><code>crystal spec</code></h3> <p>The <code>crystal spec</code> command compiles and runs a Crystal spec suite.</p> <pre>crystal spec [&lt;options&gt;] [&lt;file&gt;...] [-- [&lt;runner_options&gt;]]
</pre>
<p>All <code>files</code> arguments are concatenated into a single Crystal source. If an argument points to a folder, all spec files inside that folder are appended. If no <code>files</code> argument is provided, the default is <code>./spec</code>. A filename can be suffixed by <code>:</code> and a line number, providing this location to the <code>--location</code> runner option (see below).</p> <p>Run <code>crystal spec --options</code> for available options.</p> <p><strong>Runner options:</strong></p> <p><code>runner_options</code> are provided to the compiled binary executable which runs the specs. They should be separated from the other arguments by a double dash (<code>--</code>).</p> <ul> <li>
<code>--verbose</code>: Prints verbose output, including all example names.</li> <li>
<code>--profile</code>: Prints the 10 slowest specs.</li> <li>
<code>--fail-fast</code>: Abort the spec run on first failure.</li> <li>
<code>--junit_output &lt;output_dir&gt;</code>: Generates JUnit XML output.</li> </ul> <p>The following options can be combined to filter the list of specs to run.</p> <ul> <li>
<code>--example &lt;name&gt;</code>: Runs examples whose full nested names include <code>name</code>.</li> <li>
<code>--line &lt;line&gt;</code>: Runs examples whose line matches <code>line</code>.</li> <li>
<code>--location &lt;file&gt;:&lt;line&gt;</code>: Runs example(s) at <code>line</code> in <code>file</code> (multiple options allowed).</li> <li>
<code>--tag &lt;tag&gt;</code>: Runs examples with the specified tag, or excludes examples by adding <code>~</code> before the tag (multiple options allowed).<ul> <li>
<code>--tag a --tag b</code> will include specs tagged with <code>a</code> OR <code>b</code>.</li> <li>
<code>--tag ~a --tag ~b</code> will include specs not tagged with <code>a</code> AND not tagged with <code>b</code>.</li> <li>
<code>--tag a --tag ~b</code> will include specs tagged with <code>a</code>, but not tagged with <code>b</code>
</li> </ul> </li> </ul> <p>Example:</p> <pre data-language="shell">$ crystal spec
F

Failures:

  1) Myapp works
     Failure/Error: false.should eq(true)

       Expected: true
            got: false

     # spec/myapp_spec.cr:7

Finished in 880 microseconds
1 examples, 1 failures, 0 errors, 0 pending

Failed examples:

crystal spec spec/myapp_spec.cr:6 # Myapp works
</pre> <h3 id="crystal-play"><code>crystal play</code></h3> <p>The <code>crystal play</code> command starts a webserver serving an interactive Crystal playground.</p> <pre>crystal play [--port &lt;port&gt;] [--binding &lt;host&gt;] [--verbose] [file]
</pre>
<p><img src="https://crystal-lang.org/docs/crystal-play.png" alt="Screenshot of Crystal playground"></p> <h3 id="crystal-tool"><code>crystal tool</code></h3> <ul> <li>
<code>crystal tool context</code>: Show context for given location</li> <li>
<code>crystal tool expand</code>: Show macro expansion for given location</li> <li>
<a href="#crystal-tool-format"><code>crystal tool format</code></a>: Format Crystal files</li> <li>
<code>crystal tool hierarchy</code>: Show type hierarchy</li> <li>
<code>crystal tool implementations</code>: Show implementations for given call in location</li> <li>
<code>crystal tool types</code>: Show types of main variables</li> </ul> <h3 id="crystal-tool-format"><code>crystal tool format</code></h3> <p>The <code>crystal tool format</code> command applies default format to Crystal source files.</p> <pre>crystal tool format [--check] [&lt;path&gt;...]
</pre>
<p><code>path</code> can be a file or folder name and include all Crystal files in that folder tree. Omitting <code>path</code> is equal to specifying the current working directory.</p> <h2 id="environment-variables">Environment variables</h2> <p>The following environment variables are used by the Crystal compiler if set in the environment. Otherwise the compiler will populate them with default values. Their values can be inspected using <a href="#crystal-env"><code>crystal env</code></a>.</p> <ul> <li>
<code>CRYSTAL_CACHE_DIR</code>: Defines path where Crystal caches partial compilation results for faster subsequent builds. This path is also used to temporarily store executables when Crystal programs are run with <a href="#crystal-run"><code>crystal run</code></a> rather than <a href="#crystal-build"><code>crystal build</code></a>. Default value is the first directory that either exists or can be created of <code>${XDG_CACHE_HOME}/crystal</code> (if <code>XDG_CACHE_HOME</code> is defined), <code>${HOME}/.cache/crystal</code>, <code>${HOME}/.crystal</code>, <code>./.crystal</code>. If <code>CRYSTAL_CACHE_DIR</code> is set but points to a path that is not writeable, the default values are used instead.</li> <li>
<code>CRYSTAL_PATH</code>: Defines paths where Crystal searches for required files.</li> <li>
<code>CRYSTAL_VERSION</code> is only available as output of <a href="#crystal-env"><code>crystal env</code></a>. The compiler neither sets nor reads it.</li> <li>
<code>CRYSTAL_LIBRARY_PATH</code>: The compiler uses the paths in this variable as a first lookup destination for static and dynamic libraries that are to be linked. For example, if static libraries are put in <code>build/libs</code>, setting the environment variable accordingly will tell the compiler to look for libraries there.</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    To the extent possible under law, the persons who contributed to this workhave waived<br>all copyright and related or neighboring rights to this workby associating CC0 with it.<br>
    <a href="https://crystal-lang.org/docs/using_the_compiler" class="_attribution-link">https://crystal-lang.org/docs/using_the_compiler</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>ActiveRecord&#58;&#58;DatabaseConfigurations - Ruby on Rails 6.0 - W3cubDocs</title>
  
  <meta name="description" content="ActiveRecord&#58;&#58;DatabaseConfigurations returns an array of DatabaseConfig objects (either a HashConfig or UrlConfig) that are constructed from &hellip;">
  <meta name="keywords" content="class, activerecord, databaseconfigurations, ruby, on, rails, rails~6.0">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/rails~6.0/activerecord/databaseconfigurations.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/rails~6.0.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/rails~6.0/" class="_nav-link" title="" style="margin-left:0;">Ruby on Rails 6.0</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="class-ActiveRecord::DatabaseConfigurations" class="class"> class ActiveRecord::DatabaseConfigurations </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object">Object</a></dd>
</dl> <section class="description"> <p><a href="databaseconfigurations">ActiveRecord::DatabaseConfigurations</a> returns an array of DatabaseConfig objects (either a <a href="databaseconfigurations/hashconfig">HashConfig</a> or <a href="databaseconfigurations/urlconfig">UrlConfig</a>) that are constructed from the application's database configuration hash or URL string.</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-configurations"> <span class="method-name">configurations</span><span class="attribute-access-type">[R]</span> </div>  </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(configurations = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 17
def initialize(configurations = {})
  @configurations = build_configs(configurations)
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-5B-5D"> <span class="method-name">[]</span><span class="method-args">(env = ActiveRecord::ConnectionHandling::DEFAULT_ENV.call.to_s)</span> </div>  <div class="aliases"> Alias for: <a href="databaseconfigurations#method-i-default_hash">default_hash</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-blank-3F"> <span class="method-name">blank?</span><span class="method-args">()</span> </div>  <div class="aliases"> Alias for: <a href="databaseconfigurations#method-i-empty-3F">empty?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-configs_for"> <span class="method-name">configs_for</span><span class="method-args">(env_name: nil, spec_name: nil, include_replicas: false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="configs_for-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 38
def configs_for(env_name: nil, spec_name: nil, include_replicas: false)
  configs = env_with_configs(env_name)

  unless include_replicas
    configs = configs.select do |db_config|
      !db_config.replica?
    end
  end

  if spec_name
    configs.find do |db_config|
      db_config.spec_name == spec_name
    end
  else
    configs
  end
end</pre> </div> <p>Collects the configs for the environment and optionally the specification name passed in. To include replica configurations pass <code>include_replicas: true</code>.</p> <p>If a spec name is provided a single DatabaseConfig object will be returned, otherwise an array of DatabaseConfig objects will be returned that corresponds with the environment and type requested.</p> <h4 id="method-i-configs_for-label-Options">Options</h4> <ul>
<li> <p><code>env_name:</code> The environment name. Defaults to <code>nil</code> which will collect configs for all environments.</p> </li>
<li> <p><code>spec_name:</code> The specification name (i.e. primary, animals, etc.). Defaults to <code>nil</code>.</p> </li>
<li> <p><code>include_replicas:</code> Determines whether to include replicas in the returned list. Most of the time we're only iterating over the write connection (i.e. migrations don't need to run for the write and read connection). Defaults to <code>false</code>.</p> </li>
</ul>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-default_hash"> <span class="method-name">default_hash</span><span class="method-args">(env = ActiveRecord::ConnectionHandling::DEFAULT_ENV.call.to_s)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_hash-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 62
def default_hash(env = ActiveRecord::ConnectionHandling::DEFAULT_ENV.call.to_s)
  default = find_db_config(env)
  default.config if default
end</pre> </div> <p>Returns the config hash that corresponds with the environment</p> <p>If the application has multiple databases <code>default_hash</code> will return the first config hash for the environment.</p> <pre class="ruby" data-language="ruby">{ database: "my_db", adapter: "mysql2" }
</pre>  </div> <div class="aliases"> Also aliased as: <a href="databaseconfigurations#method-i-5B-5D">[]</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each"> <span class="method-name">each</span><span class="method-args">() { |env_name, config| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 96
def each
  throw_getter_deprecation(:each)
  configurations.each { |config|
    yield [config.env_name, config.config]
  }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-empty-3F"> <span class="method-name">empty?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="empty-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 91
def empty?
  configurations.empty?
end</pre> </div> <p>Checks if the application's configurations are empty.</p> <p>Aliased to blank?</p>  </div> <div class="aliases"> Also aliased as: <a href="databaseconfigurations#method-i-blank-3F">blank?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-find_db_config"> <span class="method-name">find_db_config</span><span class="method-args">(env)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_db_config-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 72
def find_db_config(env)
  configurations.find do |db_config|
    db_config.env_name == env.to_s ||
      (db_config.for_current_env? &amp;&amp; db_config.spec_name == env.to_s)
  end
end</pre> </div> <p>Returns a single DatabaseConfig object based on the requested environment.</p> <p>If the application has multiple databases <code>find_db_config</code> will return the first DatabaseConfig for the environment.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-first"> <span class="method-name">first</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="first-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 103
def first
  throw_getter_deprecation(:first)
  config = configurations.first
  [config.env_name, config.config]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_h"> <span class="method-name">to_h</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_h-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/database_configurations.rb, line 80
def to_h
  configs = configurations.reverse.inject({}) do |memo, db_config|
    memo.merge(db_config.to_legacy_hash)
  end

  Hash[configs.to_a.reverse]
end</pre> </div> <p>Returns the <a href="databaseconfigurations">DatabaseConfigurations</a> object as a <a href="../hash">Hash</a>.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    © 2004–2019 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

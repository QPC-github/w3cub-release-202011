
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>tf.nn.dynamic_rnn - TensorFlow Python - W3cubDocs</title>
  
  <meta name="description" content=" Defined in tensorflow&#47;python&#47;ops&#47;rnn.py. ">
  <meta name="keywords" content="tf, nn, dynamic, rnn, tensorflow, python, tensorflow~python">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tensorflow~python/tf/nn/dynamic_rnn.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tensorflow~python.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tensorflow~python/" class="_nav-link" title="" style="margin-left:0;">TensorFlow Python</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tensorflow">
				
				
<h1 itemprop="name" class="devsite-page-title"> tf.nn.dynamic_rnn </h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.nn.dynamic_rnn"> <meta itemprop="path" content="r1.8"> </div> <pre class="prettyprint lang-python" data-language="python">tf.nn.dynamic_rnn(
    cell,
    inputs,
    sequence_length=None,
    initial_state=None,
    dtype=None,
    parallel_iterations=None,
    swap_memory=False,
    time_major=False,
    scope=None
)
</pre> <p>Defined in <a href="https://www.github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/python/ops/rnn.py"><code>tensorflow/python/ops/rnn.py</code></a>.</p> <p>See the guide: <a href="https://www.tensorflow.org/api_guides/python/nn#Recurrent_Neural_Networks">Neural Network &gt; Recurrent Neural Networks</a></p> <p>Creates a recurrent neural network specified by RNNCell <code>cell</code>.</p> <p>Performs fully dynamic unrolling of <code>inputs</code>.</p> <p>Example:</p> <pre class="prettyprint lang-python" data-language="python"># create a BasicRNNCell
rnn_cell = tf.nn.rnn_cell.BasicRNNCell(hidden_size)

# 'outputs' is a tensor of shape [batch_size, max_time, cell_state_size]

# defining initial state
initial_state = rnn_cell.zero_state(batch_size, dtype=tf.float32)

# 'state' is a tensor of shape [batch_size, cell_state_size]
outputs, state = tf.nn.dynamic_rnn(rnn_cell, input_data,
                                   initial_state=initial_state,
                                   dtype=tf.float32)
</pre> <pre class="prettyprint lang-python" data-language="python"># create 2 LSTMCells
rnn_layers = [tf.nn.rnn_cell.LSTMCell(size) for size in [128, 256]]

# create a RNN cell composed sequentially of a number of RNNCells
multi_rnn_cell = tf.nn.rnn_cell.MultiRNNCell(rnn_layers)

# 'outputs' is a tensor of shape [batch_size, max_time, 256]
# 'state' is a N-tuple where N is the number of LSTMCells containing a
# tf.contrib.rnn.LSTMStateTuple for each cell
outputs, state = tf.nn.dynamic_rnn(cell=multi_rnn_cell,
                                   inputs=data,
                                   dtype=tf.float32)
</pre> <h4 id="args">Args:</h4> <ul> <li>
<b><code>cell</code></b>: An instance of RNNCell.</li> <li>
<b><code>inputs</code></b>: The RNN inputs. If <code>time_major == False</code> (default), this must be a <code>Tensor</code> of shape: <code>[batch_size, max_time, ...]</code>, or a nested tuple of such elements. If <code>time_major == True</code>, this must be a <code>Tensor</code> of shape: <code>[max_time, batch_size, ...]</code>, or a nested tuple of such elements. This may also be a (possibly nested) tuple of Tensors satisfying this property. The first two dimensions must match across all the inputs, but otherwise the ranks and other shape components may differ. In this case, input to <code>cell</code> at each time-step will replicate the structure of these tuples, except for the time dimension (from which the time is taken). The input to <code>cell</code> at each time step will be a <code>Tensor</code> or (possibly nested) tuple of Tensors each with dimensions <code>[batch_size, ...]</code>.</li> <li>
<b><code>sequence_length</code></b>: (optional) An int32/int64 vector sized <code>[batch_size]</code>. Used to copy-through state and zero-out outputs when past a batch element's sequence length. So it's more for correctness than performance.</li> <li>
<b><code>initial_state</code></b>: (optional) An initial state for the RNN. If <code>cell.state_size</code> is an integer, this must be a <code>Tensor</code> of appropriate type and shape <code>[batch_size, cell.state_size]</code>. If <code>cell.state_size</code> is a tuple, this should be a tuple of tensors having shapes <code>[batch_size, s] for s in cell.state_size</code>.</li> <li>
<b><code>dtype</code></b>: (optional) The data type for the initial state and expected output. Required if initial_state is not provided or RNN state has a heterogeneous dtype.</li> <li>
<b><code>parallel_iterations</code></b>: (Default: 32). The number of iterations to run in parallel. Those operations which do not have any temporal dependency and can be run in parallel, will be. This parameter trades off time for space. Values &gt;&gt; 1 use more memory but take less time, while smaller values use less memory but computations take longer.</li> <li>
<b><code>swap_memory</code></b>: Transparently swap the tensors produced in forward inference but needed for back prop from GPU to CPU. This allows training RNNs which would typically not fit on a single GPU, with very minimal (or no) performance penalty.</li> <li>
<b><code>time_major</code></b>: The shape format of the <code>inputs</code> and <code>outputs</code> Tensors. If true, these <code>Tensors</code> must be shaped <code>[max_time, batch_size, depth]</code>. If false, these <code>Tensors</code> must be shaped <code>[batch_size, max_time, depth]</code>. Using <code>time_major = True</code> is a bit more efficient because it avoids transposes at the beginning and end of the RNN calculation. However, most TensorFlow data is batch-major, so by default this function accepts input and emits output in batch-major form.</li> <li>
<b><code>scope</code></b>: VariableScope for the created subgraph; defaults to "rnn".</li> </ul> <h4 id="returns">Returns:</h4> <p>A pair (outputs, state) where:</p> <ul> <li> <p><b><code>outputs</code></b>: The RNN output <code>Tensor</code>.</p> <p>If time_major == False (default), this will be a <code>Tensor</code> shaped: <code>[batch_size, max_time, cell.output_size]</code>.</p> <p>If time_major == True, this will be a <code>Tensor</code> shaped: <code>[max_time, batch_size, cell.output_size]</code>.</p> <p>Note, if <code>cell.output_size</code> is a (possibly nested) tuple of integers or <code>TensorShape</code> objects, then <code>outputs</code> will be a tuple having the same structure as <code>cell.output_size</code>, containing Tensors having shapes corresponding to the shape data in <code>cell.output_size</code>.</p> </li> <li> <p><b><code>state</code></b>: The final state. If <code>cell.state_size</code> is an int, this will be shaped <code>[batch_size, cell.state_size]</code>. If it is a <code>TensorShape</code>, this will be shaped <code>[batch_size] + cell.state_size</code>. If it is a (possibly nested) tuple of ints or <code>TensorShape</code>, this will be a tuple having the corresponding shapes. If cells are <code>LSTMCells</code> <code>state</code> will be a tuple containing a <code>LSTMStateTuple</code> for each cell.</p> </li> </ul> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code>TypeError</code></b>: If <code>cell</code> is not an instance of RNNCell.</li> <li>
<b><code>ValueError</code></b>: If inputs is None or an empty list.</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2018 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/nn/dynamic_rnn" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/nn/dynamic_rnn</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

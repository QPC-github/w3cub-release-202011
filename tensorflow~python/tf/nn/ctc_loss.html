
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>tf.nn.ctc_loss - TensorFlow Python - W3cubDocs</title>
  
  <meta name="description" content=" Defined in tensorflow&#47;python&#47;ops&#47;ctc_ops.py. ">
  <meta name="keywords" content="tf, nn, ctc, loss, tensorflow, python, tensorflow~python">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tensorflow~python/tf/nn/ctc_loss.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tensorflow~python.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tensorflow~python/" class="_nav-link" title="" style="margin-left:0;">TensorFlow Python</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tensorflow">
				
				
<h1 itemprop="name" class="devsite-page-title"> tf.nn.ctc_loss </h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.nn.ctc_loss"> <meta itemprop="path" content="r1.8"> </div> <pre class="prettyprint lang-python" data-language="python">tf.nn.ctc_loss(
    labels,
    inputs,
    sequence_length,
    preprocess_collapse_repeated=False,
    ctc_merge_repeated=True,
    ignore_longer_outputs_than_inputs=False,
    time_major=True
)
</pre> <p>Defined in <a href="https://www.github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/python/ops/ctc_ops.py"><code>tensorflow/python/ops/ctc_ops.py</code></a>.</p> <p>See the guide: <a href="https://www.tensorflow.org/api_guides/python/nn#Connectionist_Temporal_Classification_CTC_">Neural Network &gt; Connectionist Temporal Classification (CTC)</a></p> <p>Computes the CTC (Connectionist Temporal Classification) Loss.</p> <p>This op implements the CTC loss as presented in the article:</p> <p><a href="http://www.cs.toronto.edu/~graves/icml_2006.pdf">A. Graves, S. Fernandez, F. Gomez, J. Schmidhuber. Connectionist Temporal Classification: Labeling Unsegmented Sequence Data with Recurrent Neural Networks. ICML 2006, Pittsburgh, USA, pp. 369-376.</a></p> <p>Input requirements:</p> <pre class="prettyprint" data-language="python">sequence_length(b) &lt;= time for all b

max(labels.indices(labels.indices[:, 1] == b, 2))
  &lt;= sequence_length(b) for all b.
</pre> <p>Notes:</p> <p>This class performs the softmax operation for you, so inputs should be e.g. linear projections of outputs by an LSTM.</p> <p>The <code>inputs</code> Tensor's innermost dimension size, <code>num_classes</code>, represents <code>num_labels + 1</code> classes, where num_labels is the number of true labels, and the largest value <code>(num_classes - 1)</code> is reserved for the blank label.</p> <p>For example, for a vocabulary containing 3 labels <code>[a, b, c]</code>, <code>num_classes = 4</code> and the labels indexing is <code>{a: 0, b: 1, c: 2, blank: 3}</code>.</p> <p>Regarding the arguments <code>preprocess_collapse_repeated</code> and <code>ctc_merge_repeated</code>:</p> <p>If <code>preprocess_collapse_repeated</code> is True, then a preprocessing step runs before loss calculation, wherein repeated labels passed to the loss are merged into single labels. This is useful if the training labels come from, e.g., forced alignments and therefore have unnecessary repetitions.</p> <p>If <code>ctc_merge_repeated</code> is set False, then deep within the CTC calculation, repeated non-blank labels will not be merged and are interpreted as individual labels. This is a simplified (non-standard) version of CTC.</p> <p>Here is a table of the (roughly) expected first order behavior:</p> <ul> <li>
<code>preprocess_collapse_repeated=False</code>, <code>ctc_merge_repeated=True</code>
</li> </ul> <p>Classical CTC behavior: Outputs true repeated classes with blanks in between, and can also output repeated classes with no blanks in between that need to be collapsed by the decoder.</p> <ul> <li>
<code>preprocess_collapse_repeated=True</code>, <code>ctc_merge_repeated=False</code>
</li> </ul> <p>Never learns to output repeated classes, as they are collapsed in the input labels before training.</p> <ul> <li>
<code>preprocess_collapse_repeated=False</code>, <code>ctc_merge_repeated=False</code>
</li> </ul> <p>Outputs repeated classes with blanks in between, but generally does not require the decoder to collapse/merge repeated classes.</p> <ul> <li>
<code>preprocess_collapse_repeated=True</code>, <code>ctc_merge_repeated=True</code>
</li> </ul> <p>Untested. Very likely will not learn to output repeated classes.</p> <p>The <code>ignore_longer_outputs_than_inputs</code> option allows to specify the behavior of the CTCLoss when dealing with sequences that have longer outputs than inputs. If true, the CTCLoss will simply return zero gradient for those items, otherwise an InvalidArgument error is returned, stopping training.</p> <h4 id="args">Args:</h4> <ul> <li>
<b><code>labels</code></b>: An <code>int32</code> <code>SparseTensor</code>. <code>labels.indices[i, :] == [b, t]</code> means <code>labels.values[i]</code> stores the id for (batch b, time t). <code>labels.values[i]</code> must take on values in <code>[0, num_labels)</code>. See <code>core/ops/ctc_ops.cc</code> for more details.</li> <li>
<b><code>inputs</code></b>: 3-D <code>float</code> <code>Tensor</code>. If time_major == False, this will be a <code>Tensor</code> shaped: <code>[batch_size, max_time, num_classes]</code>. If time_major == True (default), this will be a <code>Tensor</code> shaped: <code>[max_time, batch_size, num_classes]</code>. The logits.</li> <li>
<b><code>sequence_length</code></b>: 1-D <code>int32</code> vector, size <code>[batch_size]</code>. The sequence lengths.</li> <li>
<b><code>preprocess_collapse_repeated</code></b>: Boolean. Default: False. If True, repeated labels are collapsed prior to the CTC calculation.</li> <li>
<b><code>ctc_merge_repeated</code></b>: Boolean. Default: True.</li> <li>
<b><code>ignore_longer_outputs_than_inputs</code></b>: Boolean. Default: False. If True, sequences with longer outputs than inputs will be ignored.</li> <li>
<b><code>time_major</code></b>: The shape format of the <code>inputs</code> Tensors. If True, these <code>Tensors</code> must be shaped <code>[max_time, batch_size, num_classes]</code>. If False, these <code>Tensors</code> must be shaped <code>[batch_size, max_time, num_classes]</code>. Using <code>time_major = True</code> (default) is a bit more efficient because it avoids transposes at the beginning of the ctc_loss calculation. However, most TensorFlow data is batch-major, so by this function also accepts inputs in batch-major form.</li> </ul> <h4 id="returns">Returns:</h4> <p>A 1-D <code>float</code> <code>Tensor</code>, size <code>[batch]</code>, containing the negative log probabilities.</p> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code>TypeError</code></b>: if labels is not a <code>SparseTensor</code>.</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2018 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/nn/ctc_loss" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/nn/ctc_loss</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>tf.estimator.RunConfig - TensorFlow Python - W3cubDocs</title>
  
  <meta name="description" content=" Defined in tensorflow&#47;python&#47;estimator&#47;run_config.py. ">
  <meta name="keywords" content="tf, estimator, runconfig, tensorflow, python, tensorflow~python">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tensorflow~python/tf/estimator/runconfig.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tensorflow~python.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tensorflow~python/" class="_nav-link" title="" style="margin-left:0;">TensorFlow Python</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tensorflow">
				
				
<h1 itemprop="name" class="devsite-page-title"> tf.estimator.RunConfig </h1>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.estimator.RunConfig"> <meta itemprop="path" content="r1.8"> <meta itemprop="property" content="cluster_spec"> <meta itemprop="property" content="evaluation_master"> <meta itemprop="property" content="global_id_in_cluster"> <meta itemprop="property" content="is_chief"> <meta itemprop="property" content="keep_checkpoint_every_n_hours"> <meta itemprop="property" content="keep_checkpoint_max"> <meta itemprop="property" content="log_step_count_steps"> <meta itemprop="property" content="master"> <meta itemprop="property" content="model_dir"> <meta itemprop="property" content="num_ps_replicas"> <meta itemprop="property" content="num_worker_replicas"> <meta itemprop="property" content="save_checkpoints_secs"> <meta itemprop="property" content="save_checkpoints_steps"> <meta itemprop="property" content="save_summary_steps"> <meta itemprop="property" content="service"> <meta itemprop="property" content="session_config"> <meta itemprop="property" content="task_id"> <meta itemprop="property" content="task_type"> <meta itemprop="property" content="tf_random_seed"> <meta itemprop="property" content="train_distribute"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="replace"> </div> <h2 id="class_runconfig">Class <code>RunConfig</code>
</h2> <p>Defined in <a href="https://www.github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/python/estimator/run_config.py"><code>tensorflow/python/estimator/run_config.py</code></a>.</p> <p>This class specifies the configurations for an <code>Estimator</code> run.</p> <h2 id="properties">Properties</h2> <h3 id="cluster_spec"><code>cluster_spec</code></h3> <h3 id="evaluation_master"><code>evaluation_master</code></h3> <h3 id="global_id_in_cluster"><code>global_id_in_cluster</code></h3> <p>The global id in the training cluster.</p> <p>All global ids in the training cluster are assigned from an increasing sequence of consecutive integers. The first id is 0.</p> <blockquote class="note">
<strong>Note:</strong><span> Task id (the property field <code>task_id</code>) is tracking the index of the node among all nodes with the SAME task type. For example, given the cluster definition as follows:</span>
</blockquote> <pre class="prettyprint" data-language="python">cluster = {'chief': ['host0:2222'],
           'ps': ['host1:2222', 'host2:2222'],
           'worker': ['host3:2222', 'host4:2222', 'host5:2222']}
</pre> <p>Nodes with task type <code>worker</code> can have id 0, 1, 2. Nodes with task type <code>ps</code> can have id, 0, 1. So, <code>task_id</code> is not unique, but the pair (<code>task_type</code>, <code>task_id</code>) can uniquely determine a node in the cluster.</p> <p>Global id, i.e., this field, is tracking the index of the node among ALL nodes in the cluster. It is uniquely assigned. For example, for the cluster spec given above, the global ids are assigned as:</p> <pre class="prettyprint" data-language="python">task_type  | task_id  |  global_id
--------------------------------
chief      | 0        |  0
worker     | 0        |  1
worker     | 1        |  2
worker     | 2        |  3
ps         | 0        |  4
ps         | 1        |  5
</pre> <h4 id="returns">Returns:</h4> <p>An integer id.</p> <h3 id="is_chief"><code>is_chief</code></h3> <h3 id="keep_checkpoint_every_n_hours"><code>keep_checkpoint_every_n_hours</code></h3> <h3 id="keep_checkpoint_max"><code>keep_checkpoint_max</code></h3> <h3 id="log_step_count_steps"><code>log_step_count_steps</code></h3> <h3 id="master"><code>master</code></h3> <h3 id="model_dir"><code>model_dir</code></h3> <h3 id="num_ps_replicas"><code>num_ps_replicas</code></h3> <h3 id="num_worker_replicas"><code>num_worker_replicas</code></h3> <h3 id="save_checkpoints_secs"><code>save_checkpoints_secs</code></h3> <h3 id="save_checkpoints_steps"><code>save_checkpoints_steps</code></h3> <h3 id="save_summary_steps"><code>save_summary_steps</code></h3> <h3 id="service"><code>service</code></h3> <p>Returns the platform defined (in TF_CONFIG) service dict.</p> <h3 id="session_config"><code>session_config</code></h3> <h3 id="task_id"><code>task_id</code></h3> <h3 id="task_type"><code>task_type</code></h3> <h3 id="tf_random_seed"><code>tf_random_seed</code></h3> <h3 id="train_distribute"><code>train_distribute</code></h3> <p>Returns the optional <a href="../contrib/distribute/distributionstrategy"><code>tf.contrib.distribute.DistributionStrategy</code></a> object.</p> <h2 id="methods">Methods</h2> <h3 id="__init__"><code>__init__</code></h3> <pre class="prettyprint lang-python" data-language="python">__init__(
    model_dir=None,
    tf_random_seed=None,
    save_summary_steps=100,
    save_checkpoints_steps=_USE_DEFAULT,
    save_checkpoints_secs=_USE_DEFAULT,
    session_config=None,
    keep_checkpoint_max=5,
    keep_checkpoint_every_n_hours=10000,
    log_step_count_steps=100,
    train_distribute=None
)
</pre> <p>Constructs a RunConfig.</p> <p>All distributed training related properties <code>cluster_spec</code>, <code>is_chief</code>, <code>master</code> , <code>num_worker_replicas</code>, <code>num_ps_replicas</code>, <code>task_id</code>, and <code>task_type</code> are set based on the <code>TF_CONFIG</code> environment variable, if the pertinent information is present. The <code>TF_CONFIG</code> environment variable is a JSON object with attributes: <code>cluster</code> and <code>task</code>.</p> <p><code>cluster</code> is a JSON serialized version of <code>ClusterSpec</code>'s Python dict from <code>server_lib.py</code>, mapping task types (usually one of the <code>TaskType</code> enums) to a list of task addresses.</p> <p><code>task</code> has two attributes: <code>type</code> and <code>index</code>, where <code>type</code> can be any of the task types in <code>cluster</code>. <code>When</code>TF_CONFIG` contains said information, the following properties are set on this class:</p> <ul> <li>
<code>cluster_spec</code> is parsed from <code>TF_CONFIG['cluster']</code>. Defaults to {}. If present, must have one and only one node in the <code>chief</code> attribute of <code>cluster_spec</code>.</li> <li>
<code>task_type</code> is set to <code>TF_CONFIG['task']['type']</code>. Must set if <code>cluster_spec</code> is present; must be <code>worker</code> (the default value) if <code>cluster_spec</code> is not set.</li> <li>
<code>task_id</code> is set to <code>TF_CONFIG['task']['index']</code>. Must set if <code>cluster_spec</code> is present; must be 0 (the default value) if <code>cluster_spec</code> is not set.</li> <li>
<code>master</code> is determined by looking up <code>task_type</code> and <code>task_id</code> in the <code>cluster_spec</code>. Defaults to ''.</li> <li>
<code>num_ps_replicas</code> is set by counting the number of nodes listed in the <code>ps</code> attribute of <code>cluster_spec</code>. Defaults to 0.</li> <li>
<code>num_worker_replicas</code> is set by counting the number of nodes listed in the <code>worker</code> and <code>chief</code> attributes of <code>cluster_spec</code>. Defaults to 1.</li> <li>
<code>is_chief</code> is determined based on <code>task_type</code> and <code>cluster</code>.</li> </ul> <p>There is a special node with <code>task_type</code> as <code>evaluator</code>, which is not part of the (training) <code>cluster_spec</code>. It handles the distributed evaluation job.</p> <p>Example of non-chief node:</p> <pre class="prettyprint" data-language="python">cluster = {'chief': ['host0:2222'],
           'ps': ['host1:2222', 'host2:2222'],
           'worker': ['host3:2222', 'host4:2222', 'host5:2222']}
os.environ['TF_CONFIG'] = json.dumps(
    {'cluster': cluster,
     'task': {'type': 'worker', 'index': 1}})
config = RunConfig()
assert config.master == 'host4:2222'
assert config.task_id == 1
assert config.num_ps_replicas == 2
assert config.num_worker_replicas == 4
assert config.cluster_spec == server_lib.ClusterSpec(cluster)
assert config.task_type == 'worker'
assert not config.is_chief
</pre> <p>Example of chief node:</p> <pre class="prettyprint" data-language="python">cluster = {'chief': ['host0:2222'],
           'ps': ['host1:2222', 'host2:2222'],
           'worker': ['host3:2222', 'host4:2222', 'host5:2222']}
os.environ['TF_CONFIG'] = json.dumps(
    {'cluster': cluster,
     'task': {'type': 'chief', 'index': 0}})
config = RunConfig()
assert config.master == 'host0:2222'
assert config.task_id == 0
assert config.num_ps_replicas == 2
assert config.num_worker_replicas == 4
assert config.cluster_spec == server_lib.ClusterSpec(cluster)
assert config.task_type == 'chief'
assert config.is_chief
</pre> <p>Example of evaluator node (evaluator is not part of training cluster):</p> <pre class="prettyprint" data-language="python">cluster = {'chief': ['host0:2222'],
           'ps': ['host1:2222', 'host2:2222'],
           'worker': ['host3:2222', 'host4:2222', 'host5:2222']}
os.environ['TF_CONFIG'] = json.dumps(
    {'cluster': cluster,
     'task': {'type': 'evaluator', 'index': 0}})
config = RunConfig()
assert config.master == ''
assert config.evaluator_master == ''
assert config.task_id == 0
assert config.num_ps_replicas == 0
assert config.num_worker_replicas == 0
assert config.cluster_spec == {}
assert config.task_type == 'evaluator'
assert not config.is_chief
</pre> <p>N.B.: If <code>save_checkpoints_steps</code> or <code>save_checkpoints_secs</code> is set, <code>keep_checkpoint_max</code> might need to be adjusted accordingly, especially in distributed training. For example, setting <code>save_checkpoints_secs</code> as 60 without adjusting <code>keep_checkpoint_max</code> (defaults to 5) leads to situation that checkpoint would be garbage collected after 5 minutes. In distributed training, the evaluation job starts asynchronously and might fail to load or find the checkpoint due to race condition.</p> <h4 id="args">Args:</h4> <ul> <li>
<b><code>model_dir</code></b>: directory where model parameters, graph, etc are saved. If <code>PathLike</code> object, the path will be resolved. If <code>None</code>, will use a default value set by the Estimator.</li> <li>
<b><code>tf_random_seed</code></b>: Random seed for TensorFlow initializers. Setting this value allows consistency between reruns.</li> <li>
<b><code>save_summary_steps</code></b>: Save summaries every this many steps.</li> <li>
<b><code>save_checkpoints_steps</code></b>: Save checkpoints every this many steps. Can not be specified with <code>save_checkpoints_secs</code>.</li> <li>
<b><code>save_checkpoints_secs</code></b>: Save checkpoints every this many seconds. Can not be specified with <code>save_checkpoints_steps</code>. Defaults to 600 seconds if both <code>save_checkpoints_steps</code> and <code>save_checkpoints_secs</code> are not set in constructor. If both <code>save_checkpoints_steps</code> and <code>save_checkpoints_secs</code> are None, then checkpoints are disabled.</li> <li>
<b><code>session_config</code></b>: a ConfigProto used to set session parameters, or None.</li> <li>
<b><code>keep_checkpoint_max</code></b>: The maximum number of recent checkpoint files to keep. As new files are created, older files are deleted. If None or 0, all checkpoint files are kept. Defaults to 5 (that is, the 5 most recent checkpoint files are kept.)</li> <li>
<b><code>keep_checkpoint_every_n_hours</code></b>: Number of hours between each checkpoint to be saved. The default value of 10,000 hours effectively disables the feature.</li> <li>
<b><code>log_step_count_steps</code></b>: The frequency, in number of global steps, that the global step/sec and the loss will be logged during training.</li> <li>
<b><code>train_distribute</code></b>: an optional instance of <a href="../contrib/distribute/distributionstrategy"><code>tf.contrib.distribute.DistributionStrategy</code></a>. If specified, then Estimator will distribute the user's model during training, according to the policy specified by that strategy.</li> </ul> <h4 id="raises">Raises:</h4> <ul> <li>
<b><code>ValueError</code></b>: If both <code>save_checkpoints_steps</code> and <code>save_checkpoints_secs</code> are set.</li> </ul> <h3 id="replace"><code>replace</code></h3> <pre class="prettyprint lang-python" data-language="python">replace(**kwargs)
</pre> <p>Returns a new instance of <code>RunConfig</code> replacing specified properties.</p> <p>Only the properties in the following list are allowed to be replaced:</p> <ul> <li>
<code>model_dir</code>,</li> <li>
<code>tf_random_seed</code>,</li> <li>
<code>save_summary_steps</code>,</li> <li>
<code>save_checkpoints_steps</code>,</li> <li>
<code>save_checkpoints_secs</code>,</li> <li>
<code>session_config</code>,</li> <li>
<code>keep_checkpoint_max</code>,</li> <li>
<code>keep_checkpoint_every_n_hours</code>,</li> <li>
<code>log_step_count_steps</code>,</li> <li>
<code>train_distribute</code>.</li> </ul> <p>In addition, either <code>save_checkpoints_steps</code> or <code>save_checkpoints_secs</code> can be set (should not be both).</p> <h4 id="args_1">Args:</h4> <ul> <li>
<b><code>**kwargs</code></b>: keyword named properties with new values.</li> </ul> <h4 id="raises_1">Raises:</h4> <ul> <li>
<b><code>ValueError</code></b>: If any property name in <code>kwargs</code> does not exist or is not allowed to be replaced, or both <code>save_checkpoints_steps</code> and <code>save_checkpoints_secs</code> are set.</li> </ul> <h4 id="returns_1">Returns:</h4> <p>a new instance of <code>RunConfig</code>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2018 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/RunConfig" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/estimator/RunConfig</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

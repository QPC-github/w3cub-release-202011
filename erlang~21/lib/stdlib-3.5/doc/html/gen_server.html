
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Gen_server - Erlang 21 - W3cubDocs</title>
  
  <meta name="description" content=" gen_server ">
  <meta name="keywords" content="gen, server, erlang, erlang~21">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/erlang~21/lib/stdlib-3.5/doc/html/gen_server.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/erlang~21.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/erlang~21/" class="_nav-link" title="" style="margin-left:0;">Erlang 21</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _erlang">
				
				
<h1>gen_server</h1> <h2><span onmouseover="document.getElementById('ghlink-module-id227007').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-id227007').style.visibility = 'hidden';" id="module">Module</span></h2> <p class="REFBODY module-body">gen_server</p> <h2><span onmouseover="document.getElementById('ghlink-module-summary-id227011').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-id227011').style.visibility = 'hidden';" id="module-summary">Module Summary</span></h2> <p class="REFBODY module-summary-body">Generic server behavior.</p> <h2><span onmouseover="document.getElementById('ghlink-description-id227015').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-id227015').style.visibility = 'hidden';" id="description">Description</span></h2> 
<p>This behavior module provides the server of a client-server relation. A generic server process (<code class="code">gen_server</code>) implemented using this module has a standard set of interface functions and includes functionality for tracing and error reporting. It also fits into an OTP supervision tree. For more information, see section <code>gen_server Behaviour</code> in OTP Design Principles.</p> <p>A <code class="code">gen_server</code> process assumes all specific parts to be located in a callback module exporting a predefined set of functions. The relationship between the behavior functions and the callback functions is as follows:</p> <pre data-language="erlang">
gen_server module            Callback module
-----------------            ---------------
gen_server:start
gen_server:start_link -----&gt; Module:init/1

gen_server:stop       -----&gt; Module:terminate/2

gen_server:call
gen_server:multi_call -----&gt; Module:handle_call/3

gen_server:cast
gen_server:abcast     -----&gt; Module:handle_cast/2

-                     -----&gt; Module:handle_info/2

-                     -----&gt; Module:handle_continue/2

-                     -----&gt; Module:terminate/2

-                     -----&gt; Module:code_change/3</pre> <p>If a callback function fails or returns a bad value, the <code class="code">gen_server</code> process terminates.</p> <p>A <code class="code">gen_server</code> process handles system messages as described in <code><a href="sys"><span class="code">sys(3)</span></a></code>. The <code class="code">sys</code> module can be used for debugging a <code class="code">gen_server</code> process.</p> <p>Notice that a <code class="code">gen_server</code> process does not trap exit signals automatically, this must be explicitly initiated in the callback module.</p> <p>Unless otherwise stated, all functions in this module fail if the specified <code class="code">gen_server</code> process does not exist or if bad arguments are specified.</p> <p>The <code class="code">gen_server</code> process can go into hibernation (see <code><span class="code">erlang:hibernate/3</span></code>) if a callback function specifies <code class="code">'hibernate'</code> instead of a time-out value. This can be useful if the server is expected to be idle for a long time. However, use this feature with care, as hibernation implies at least two garbage collections (when hibernating and shortly after waking up) and is not something you want to do between each call to a busy server.</p> <p>If the <code class="code">gen_server</code> process needs to perform an action immediately after initialization or to break the execution of a callback into multiple steps, it can return <code class="code">{continue,Continue}</code> in place of the time-out or hibernation value, which will immediately invoke the <code class="code">handle_continue/2</code> callback.</p>  <h2><span onmouseover="document.getElementById('ghlink-exports-id227142').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-exports-id227142').style.visibility = 'hidden';" id="exports">Exports</span></h2> <div class="exports-body"> 
<div><span onmouseover="document.getElementById('ghlink-abcast-2-id227149').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-abcast-2-id227149').style.visibility = 'hidden';" id="abcast-2">abcast(Name, Request) -&gt; abcast</span></div>
<div><span onmouseover="document.getElementById('ghlink-abcast-3-id227153').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-abcast-3-id227153').style.visibility = 'hidden';" id="abcast-3">abcast(Nodes, Name, Request) -&gt; abcast</span></div>  <h2 class="func-types-title">Types</h2>      
<p>Sends an asynchronous request to the <code class="code">gen_server</code> processes locally registered as <code class="code">Name</code> at the specified nodes. The function returns immediately and ignores nodes that do not exist, or where the <code class="code">gen_server</code> <code class="code">Name</code> does not exist. The <code class="code">gen_server</code> processes call <code><a href="#Module:handle_cast-2"><span class="code">Module:handle_cast/2</span></a></code> to handle the request.</p> <p>For a description of the arguments, see <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-call-2-id227233').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-call-2-id227233').style.visibility = 'hidden';" id="call-2">call(ServerRef, Request) -&gt; Reply</span></div>
<div><span onmouseover="document.getElementById('ghlink-call-3-id227237').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-call-3-id227237').style.visibility = 'hidden';" id="call-3">call(ServerRef, Request, Timeout) -&gt; Reply</span></div>  <h2 class="func-types-title">Types</h2>         
<p>Makes a synchronous call to the <code class="code">ServerRef</code> of the <code class="code">gen_server</code> process by sending a request and waiting until a reply arrives or a time-out occurs. The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code> to handle the request.</p> <p><code class="code">ServerRef</code> can be any of the following:</p> <ul> <li>The pid</li> <li> <code class="code">Name</code>, if the <code class="code">gen_server</code> process is locally registered</li> <li> <code class="code">{Name,Node}</code>, if the <code class="code">gen_server</code> process is locally registered at another node</li> <li> <code class="code">{global,GlobalName}</code>, if the <code class="code">gen_server</code> process is globally registered</li> <li> <code class="code">{via,Module,ViaName}</code>, if the <code class="code">gen_server</code> process is registered through an alternative process registry</li> </ul> <p><code class="code">Request</code> is any term that is passed as one of the arguments to <code class="code">Module:handle_call/3</code>.</p> <p><code class="code">Timeout</code> is an integer greater than zero that specifies how many milliseconds to wait for a reply, or the atom <code class="code">infinity</code> to wait indefinitely. Defaults to 5000. If no reply is received within the specified time, the function call fails. If the caller catches the failure and continues running, and the server is just late with the reply, it can arrive at any time later into the message queue of the caller. The caller must in this case be prepared for this and discard any such garbage messages that are two element tuples with a reference as the first element.</p> <p>The return value <code class="code">Reply</code> is defined in the return value of <code class="code">Module:handle_call/3</code>.</p> <p>The call can fail for many reasons, including time-out and the called <code class="code">gen_server</code> process dying before or during the call.</p>  
<div><span onmouseover="document.getElementById('ghlink-cast-2-id227412').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-cast-2-id227412').style.visibility = 'hidden';" id="cast-2">cast(ServerRef, Request) -&gt; ok</span></div>  <h2 class="func-types-title">Types</h2>       
<p>Sends an asynchronous request to the <code class="code">ServerRef</code> of the <code class="code">gen_server</code> process and returns <code class="code">ok</code> immediately, ignoring if the destination node or <code class="code">gen_server</code> process does not exist. The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_cast-2"><span class="code">Module:handle_cast/2</span></a></code> to handle the request.</p> <p>For a description of <code class="code">ServerRef</code>, see <code><a href="#call-2"><span class="code">call/2,3</span></a></code>.</p> <p><code class="code">Request</code> is any term that is passed as one of the arguments to <code class="code">Module:handle_cast/2</code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-enter_loop-3-id227509').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-3-id227509').style.visibility = 'hidden';" id="enter_loop-3">enter_loop(Module, Options, State)</span></div>
<div><span onmouseover="document.getElementById('ghlink-enter_loop-4-id227513').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-id227513').style.visibility = 'hidden';" id="enter_loop-4">enter_loop(Module, Options, State, ServerName)</span></div>
<div><span onmouseover="document.getElementById('ghlink-enter_loop-4-id227517').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-4-id227517').style.visibility = 'hidden';" id="enter_loop-4">enter_loop(Module, Options, State, Timeout)</span></div>
<div><span onmouseover="document.getElementById('ghlink-enter_loop-5-id227521').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-enter_loop-5-id227521').style.visibility = 'hidden';" id="enter_loop-5">enter_loop(Module, Options, State, ServerName, Timeout)</span></div>  <h2 class="func-types-title">Types</h2>              
<p>Makes an existing process into a <code class="code">gen_server</code> process. Does not return, instead the calling process enters the <code class="code">gen_server</code> process receive loop and becomes a <code class="code">gen_server</code> process. The process <strong>must</strong> have been started using one of the start functions in <code><a href="proc_lib"><span class="code">proc_lib(3)</span></a></code>. The user is responsible for any initialization of the process, including registering a name for it.</p> <p>This function is useful when a more complex initialization procedure is needed than the <code class="code">gen_server</code> process behavior provides.</p> <p><code class="code">Module</code>, <code class="code">Options</code>, and <code class="code">ServerName</code> have the same meanings as when calling <code><a href="#start_link-3"><span class="code">start[_link]/3,4</span></a></code>. However, if <code class="code">ServerName</code> is specified, the process must have been registered accordingly <strong>before</strong> this function is called.</p> <p><code class="code">State</code> and <code class="code">Timeout</code> have the same meanings as in the return value of <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code>. The callback module <code class="code">Module</code> does not need to export an <code class="code">init/1</code> function.</p> <p>The function fails if the calling process was not started by a <code class="code">proc_lib</code> start function, or if it is not registered according to <code class="code">ServerName</code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-multi_call-2-id227696').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-2-id227696').style.visibility = 'hidden';" id="multi_call-2">multi_call(Name, Request) -&gt; Result</span></div>
<div><span onmouseover="document.getElementById('ghlink-multi_call-3-id227700').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-3-id227700').style.visibility = 'hidden';" id="multi_call-3">multi_call(Nodes, Name, Request) -&gt; Result</span></div>
<div><span onmouseover="document.getElementById('ghlink-multi_call-4-id227704').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-multi_call-4-id227704').style.visibility = 'hidden';" id="multi_call-4">multi_call(Nodes, Name, Request, Timeout) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>           
<p>Makes a synchronous call to all <code class="code">gen_server</code> processes locally registered as <code class="code">Name</code> at the specified nodes by first sending a request to every node and then waits for the replies. The <code class="code">gen_server</code> process calls <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code> to handle the request.</p> <p>The function returns a tuple <code class="code">{Replies,BadNodes}</code>, where <code class="code">Replies</code> is a list of <code class="code">{Node,Reply}</code> and <code class="code">BadNodes</code> is a list of node that either did not exist, or where the <code class="code">gen_server</code> <code class="code">Name</code> did not exist or did not reply.</p> <p><code class="code">Nodes</code> is a list of node names to which the request is to be sent. Default value is the list of all known nodes <code class="code">[node()|nodes()]</code>.</p> <p><code class="code">Name</code> is the locally registered name of each <code class="code">gen_server</code> process.</p> <p><code class="code">Request</code> is any term that is passed as one of the arguments to <code class="code">Module:handle_call/3</code>.</p> <p><code class="code">Timeout</code> is an integer greater than zero that specifies how many milliseconds to wait for each reply, or the atom <code class="code">infinity</code> to wait indefinitely. Defaults to <code class="code">infinity</code>. If no reply is received from a node within the specified time, the node is added to <code class="code">BadNodes</code>.</p> <p>When a reply <code class="code">Reply</code> is received from the <code class="code">gen_server</code> process at a node <code class="code">Node</code>, <code class="code">{Node,Reply}</code> is added to <code class="code">Replies</code>. <code class="code">Reply</code> is defined in the return value of <code class="code">Module:handle_call/3</code>.</p> <div class="warning"> <div class="label">Warning</div> <div class="content">

<p>If one of the nodes cannot process monitors, for example, C or Java nodes, and the <code class="code">gen_server</code> process is not started when the requests are sent, but starts within 2 seconds, this function waits the whole <code class="code">Timeout</code>, which may be infinity.</p> <p>This problem does not exist if all nodes are Erlang nodes.</p> </div> </div> <p>To prevent late answers (after the time-out) from polluting the message queue of the caller, a middleman process is used to do the calls. Late answers are then discarded when they arrive to a terminated process.</p>  
<div><span onmouseover="document.getElementById('ghlink-reply-2-id227918').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-reply-2-id227918').style.visibility = 'hidden';" id="reply-2">reply(Client, Reply) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>     
<p>This function can be used by a <code class="code">gen_server</code> process to explicitly send a reply to a client that called <code><a href="#call-2"><span class="code">call/2,3</span></a></code> or <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>, when the reply cannot be defined in the return value of <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code>.</p> <p><code class="code">Client</code> must be the <code class="code">From</code> argument provided to the callback function. <code class="code">Reply</code> is any term given back to the client as the return value of <code class="code">call/2,3</code> or <code class="code">multi_call/2,3,4</code>.</p> <p>The return value <code class="code">Result</code> is not further defined, and is always to be ignored.</p>  
<div><span onmouseover="document.getElementById('ghlink-start-3-id228012').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start-3-id228012').style.visibility = 'hidden';" id="start-3">start(Module, Args, Options) -&gt; Result</span></div>
<div><span onmouseover="document.getElementById('ghlink-start-4-id228016').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start-4-id228016').style.visibility = 'hidden';" id="start-4">start(ServerName, Module, Args, Options) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>                
<p>Creates a standalone <code class="code">gen_server</code> process, that is, a <code class="code">gen_server</code> process that is not part of a supervision tree and thus has no supervisor.</p> <p>For a description of arguments and return values, see <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-start_link-3-id228118').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-3-id228118').style.visibility = 'hidden';" id="start_link-3">start_link(Module, Args, Options) -&gt; Result</span></div>
<div><span onmouseover="document.getElementById('ghlink-start_link-4-id228122').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-start_link-4-id228122').style.visibility = 'hidden';" id="start_link-4">start_link(ServerName, Module, Args, Options) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>                
<p>Creates a <code class="code">gen_server</code> process as part of a supervision tree. This function is to be called, directly or indirectly, by the supervisor. For example, it ensures that the <code class="code">gen_server</code> process is linked to the supervisor.</p> <p>The <code class="code">gen_server</code> process calls <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> to initialize. To ensure a synchronized startup procedure, <code class="code">start_link/3,4</code> does not return until <code class="code">Module:init/1</code> has returned.</p> <ul> <li> <p>If <code class="code">ServerName={local,Name}</code>, the <code class="code">gen_server</code> process is registered locally as <code class="code">Name</code> using <code class="code">register/2</code>.</p> </li> <li> <p>If <code class="code">ServerName={global,GlobalName}</code>, the <code class="code">gen_server</code> process id registered globally as <code class="code">GlobalName</code> using <code><span class="code">global:register_name/2</span></code> If no name is provided, the <code class="code">gen_server</code> process is not registered.</p> </li> <li> <p>If <code class="code">ServerName={via,Module,ViaName}</code>, the <code class="code">gen_server</code> process registers with the registry represented by <code class="code">Module</code>. The <code class="code">Module</code> callback is to export the functions <code class="code">register_name/2</code>, <code class="code">unregister_name/1</code>, <code class="code">whereis_name/1</code>, and <code class="code">send/2</code>, which are to behave like the corresponding functions in <code><span class="code">global</span></code>. Thus, <code class="code">{via,global,GlobalName}</code> is a valid reference.</p> </li> </ul> <p><code class="code">Module</code> is the name of the callback module.</p> <p><code class="code">Args</code> is any term that is passed as the argument to <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code>.</p> <ul> <li> <p>If option <code class="code">{timeout,Time}</code> is present, the <code class="code">gen_server</code> process is allowed to spend <code class="code">Time</code> milliseconds initializing or it is terminated and the start function returns <code class="code">{error,timeout}</code>.</p> </li> <li> <p>If option <code class="code">{hibernate_after,HibernateAfterTimeout}</code> is present, the <code class="code">gen_server</code> process awaits any message for <code class="code">HibernateAfterTimeout</code> milliseconds and if no message is received, the process goes into hibernation automatically (by calling <code><a href="proc_lib#hibernate-3"><span class="code">proc_lib:hibernate/3</span></a></code>).</p> </li> <li> <p>If option <code class="code">{debug,Dbgs}</code> is present, the corresponding <code class="code">sys</code> function is called for each item in <code class="code">Dbgs</code>; see <code><a href="sys"><span class="code">sys(3)</span></a></code>.</p> </li> <li> <p>If option <code class="code">{spawn_opt,SOpts}</code> is present, <code class="code">SOpts</code> is passed as option list to the <code class="code">spawn_opt</code> BIF, which is used to spawn the <code class="code">gen_server</code> process; see <code><span class="code">spawn_opt/2</span></code>.</p> </li> </ul> <div class="note"> <div class="label">Note</div> <div class="content">

<p>Using spawn option <code class="code">monitor</code> is not allowed, it causes the function to fail with reason <code class="code">badarg</code>.</p> </div> </div> <p>If the <code class="code">gen_server</code> process is successfully created and initialized, the function returns <code class="code">{ok,Pid}</code>, where <code class="code">Pid</code> is the pid of the <code class="code">gen_server</code> process. If a process with the specified <code class="code">ServerName</code> exists already, the function returns <code class="code">{error,{already_started,Pid}}</code>, where <code class="code">Pid</code> is the pid of that process.</p> <p>If <code class="code">Module:init/1</code> fails with <code class="code">Reason</code>, the function returns <code class="code">{error,Reason}</code>. If <code class="code">Module:init/1</code> returns <code class="code">{stop,Reason}</code> or <code class="code">ignore</code>, the process is terminated and the function returns <code class="code">{error,Reason}</code> or <code class="code">ignore</code>, respectively.</p>  
<div><span onmouseover="document.getElementById('ghlink-stop-1-id228563').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-stop-1-id228563').style.visibility = 'hidden';" id="stop-1">stop(ServerRef) -&gt; ok</span></div>
<div><span onmouseover="document.getElementById('ghlink-stop-3-id228567').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-stop-3-id228567').style.visibility = 'hidden';" id="stop-3">stop(ServerRef, Reason, Timeout) -&gt; ok</span></div>  <h2 class="func-types-title">Types</h2>        
<p>Orders a generic server to exit with the specified <code class="code">Reason</code> and waits for it to terminate. The <code class="code">gen_server</code> process calls <code><a href="#Module:terminate-2"><span class="code">Module:terminate/2</span></a></code> before exiting.</p> <p>The function returns <code class="code">ok</code> if the server terminates with the expected reason. Any other reason than <code class="code">normal</code>, <code class="code">shutdown</code>, or <code class="code">{shutdown,Term}</code> causes an error report to be issued using <code><span class="code">logger(3)</span></code>. The default <code class="code">Reason</code> is <code class="code">normal</code>.</p> <p><code class="code">Timeout</code> is an integer greater than zero that specifies how many milliseconds to wait for the server to terminate, or the atom <code class="code">infinity</code> to wait indefinitely. Defaults to <code class="code">infinity</code>. If the server has not terminated within the specified time, a <code class="code">timeout</code> exception is raised.</p> <p>If the process does not exist, a <code class="code">noproc</code> exception is raised.</p>  </div> <h2><span onmouseover="document.getElementById('ghlink-callback-functions-id228689').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-callback-functions-id228689').style.visibility = 'hidden';" id="callback-functions">Callback Functions</span></h2>  <p>The following functions are to be exported from a <code class="code">gen_server</code> callback module.</p>  <h2><span onmouseover="document.getElementById('ghlink-exports-id228707').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-exports-id228707').style.visibility = 'hidden';" id="exports">Exports</span></h2> <div class="exports-body"> 
<div><span onmouseover="document.getElementById('ghlink-Module:code_change-3-id228714').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:code_change-3-id228714').style.visibility = 'hidden';" id="Module:code_change-3">Module:code_change(OldVsn, State, Extra) -&gt; {ok, NewState} | {error, Reason}</span></div>  <h2 class="func-types-title">Types</h2>       
<div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. If a release upgrade/downgrade with <code class="code">Change={advanced,Extra}</code> specified in the <code class="code">appup</code> file is made when <code class="code">code_change/3</code> isn't implemented the process will crash with an <code class="code">undef</code> exit reason.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when it is to update its internal state during a release upgrade/downgrade, that is, when the instruction <code class="code">{update,Module,Change,...}</code>, where <code class="code">Change={advanced,Extra}</code>, is specifed in the <code class="code">appup</code> file. For more information, see section <code>Release Handling Instructions</code> in OTP Design Principles.</p> <p>For an upgrade, <code class="code">OldVsn</code> is <code class="code">Vsn</code>, and for a downgrade, <code class="code">OldVsn</code> is <code class="code">{down,Vsn}</code>. <code class="code">Vsn</code> is defined by the <code class="code">vsn</code> attribute(s) of the old version of the callback module <code class="code">Module</code>. If no such attribute is defined, the version is the checksum of the Beam file.</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p><code class="code">Extra</code> is passed "as is" from the <code class="code">{advanced,Extra}</code> part of the update instruction.</p> <p>If successful, the function must return the updated internal state.</p> <p>If the function returns <code class="code">{error,Reason}</code>, the ongoing upgrade fails and rolls back to the old release.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:format_status-2-id228870').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:format_status-2-id228870').style.visibility = 'hidden';" id="Module:format_status-2">Module:format_status(Opt, [PDict, State]) -&gt; Status</span></div>  <h2 class="func-types-title">Types</h2>      
<div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation of this function that returns the callback module state.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process in the following situations:</p> <ul> <li> <p>One of <code><a href="sys#get_status-1"><span class="code">sys:get_status/1,2</span></a></code> is invoked to get the <code class="code">gen_server</code> status. <code class="code">Opt</code> is set to the atom <code class="code">normal</code>.</p> </li> <li> <p>The <code class="code">gen_server</code> process terminates abnormally and logs an error. <code class="code">Opt</code> is set to the atom <code class="code">terminate</code>.</p> </li> </ul> <p>This function is useful for changing the form and appearance of the <code class="code">gen_server</code> status for these cases. A callback module wishing to change the <code class="code">sys:get_status/1,2</code> return value, as well as how its status appears in termination error logs, exports an instance of <code class="code">format_status/2</code> that returns a term describing the current status of the <code class="code">gen_server</code> process.</p> <p><code class="code">PDict</code> is the current value of the process dictionary of the <code class="code">gen_server</code> process..</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p>The function is to return <code class="code">Status</code>, a term that changes the details of the current state and status of the <code class="code">gen_server</code> process. There are no restrictions on the form <code class="code">Status</code> can take, but for the <code class="code">sys:get_status/1,2</code> case (when <code class="code">Opt</code> is <code class="code">normal</code>), the recommended form for the <code class="code">Status</code> value is <code class="code">[{data, [{"State", Term}]}]</code>, where <code class="code">Term</code> provides relevant details of the <code class="code">gen_server</code> state. Following this recommendation is not required, but it makes the callback module status consistent with the rest of the <code class="code">sys:get_status/1,2</code> return value.</p> <p>One use for this function is to return compact alternative state representations to avoid that large state terms are printed in log files.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:handle_call-3-id229078').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_call-3-id229078').style.visibility = 'hidden';" id="Module:handle_call-3">Module:handle_call(Request, From, State) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>                 
<p>Whenever a <code class="code">gen_server</code> process receives a request sent using <code><a href="#call-2"><span class="code">call/2,3</span></a></code> or <code><a href="#multi_call-2"><span class="code">multi_call/2,3,4</span></a></code>, this function is called to handle the request.</p> <p><code class="code">Request</code> is the <code class="code">Request</code> argument provided to <code class="code">call</code> or <code class="code">multi_call</code>.</p> <p><code class="code">From</code> is a tuple <code class="code">{Pid,Tag}</code>, where <code class="code">Pid</code> is the pid of the client and <code class="code">Tag</code> is a unique tag.</p> <p><code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <ul> <li> <p>If <code class="code">{reply,Reply,NewState}</code> is returned, <code class="code">{reply,Reply,NewState,Timeout}</code> or <code class="code">{reply,Reply,NewState,hibernate}</code>, <code class="code">Reply</code> is given back to <code class="code">From</code> as the return value of <code class="code">call/2,3</code> or included in the return value of <code class="code">multi_call/2,3,4</code>. The <code class="code">gen_server</code> process then continues executing with the possibly updated internal state <code class="code">NewState</code>.</p> <p>For a description of <code class="code">Timeout</code> and <code class="code">hibernate</code>, see <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code>.</p> </li> <li> <p>If <code class="code">{noreply,NewState}</code> is returned, <code class="code">{noreply,NewState,Timeout}</code>, or <code class="code">{noreply,NewState,hibernate}</code>, the <code class="code">gen_server</code> process continues executing with <code class="code">NewState</code>. Any reply to <code class="code">From</code> must be specified explicitly using <code><a href="#reply-2"><span class="code">reply/2</span></a></code>.</p> </li> <li> <p>If <code class="code">{stop,Reason,Reply,NewState}</code> is returned, <code class="code">Reply</code> is given back to <code class="code">From</code>.</p> </li> <li> <p>If <code class="code">{stop,Reason,NewState}</code> is returned, any reply to <code class="code">From</code> must be specified explicitly using <code><a href="#reply-2"><span class="code">reply/2</span></a></code>. The <code class="code">gen_server</code> process then calls <code class="code">Module:terminate(Reason,NewState)</code> and terminates.</p> </li> </ul>  
<div><span onmouseover="document.getElementById('ghlink-Module:handle_cast-2-id229379').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_cast-2-id229379').style.visibility = 'hidden';" id="Module:handle_cast-2">Module:handle_cast(Request, State) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>            
<p>Whenever a <code class="code">gen_server</code> process receives a request sent using <code><a href="#cast-2"><span class="code">cast/2</span></a></code> or <code><a href="#abcast-2"><span class="code">abcast/2,3</span></a></code>, this function is called to handle the request.</p> <p>For a description of the arguments and possible return values, see <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:handle_continue-2-id229474').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_continue-2-id229474').style.visibility = 'hidden';" id="Module:handle_continue-2">Module:handle_continue(Continue, State) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>            
<div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need to export it only if they return <code class="code">{continue,Continue}</code> from another callback. If continue is used and the callback is not implemented, the process will exit with <code class="code">undef</code> error.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process whenever a previous callback returns <code class="code">{continue, Continue}</code>. <code class="code">handle_continue/2</code> is invoked immediately after the previous callback, which makes it useful for performing work after initialization or for splitting the work in a callback in multiple steps, updating the process state along the way.</p> <p>For a description of the other arguments and possible return values, see <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:handle_info-2-id229580').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:handle_info-2-id229580').style.visibility = 'hidden';" id="Module:handle_info-2">Module:handle_info(Info, State) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>           
<div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation of this function that logs about the unexpected <code class="code">Info</code> message, drops it and returns <code class="code">{noreply, State}</code>.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when a time-out occurs or when it receives any other message than a synchronous or asynchronous request (or a system message).</p> <p><code class="code">Info</code> is either the atom <code class="code">timeout</code>, if a time-out has occurred, or the received message.</p> <p>For a description of the other arguments and possible return values, see <code><a href="#Module:handle_call-3"><span class="code">Module:handle_call/3</span></a></code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:init-1-id229689').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:init-1-id229689').style.visibility = 'hidden';" id="Module:init-1">Module:init(Args) -&gt; Result</span></div>  <h2 class="func-types-title">Types</h2>        
<p>Whenever a <code class="code">gen_server</code> process is started using <code><a href="#start-3"><span class="code">start/3,4</span></a></code> or <code><a href="#start_link-3"><span class="code">start_link/3,4</span></a></code>, this function is called by the new process to initialize.</p> <p><code class="code">Args</code> is the <code class="code">Args</code> argument provided to the start function.</p> <p>If the initialization is successful, the function is to return <code class="code">{ok,State}</code>, <code class="code">{ok,State,Timeout}</code>, or <code class="code">{ok,State,hibernate}</code>, where <code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p>If an integer time-out value is provided, a time-out occurs unless a request or a message is received within <code class="code">Timeout</code> milliseconds. A time-out is represented by the atom <code class="code">timeout</code>, which is to be handled by the <code><a href="#Module:handle_info-2"><span class="code">Module:handle_info/2</span></a></code> callback function. The atom <code class="code">infinity</code> can be used to wait indefinitely, this is the default value.</p> <p>If <code class="code">hibernate</code> is specified instead of a time-out value, the process goes into hibernation when waiting for the next message to arrive (by calling <code><a href="proc_lib#hibernate-3"><span class="code">proc_lib:hibernate/3</span></a></code>).</p> <p>If the initialization fails, the function is to return <code class="code">{stop,Reason}</code>, where <code class="code">Reason</code> is any term, or <code class="code">ignore</code>.</p>  
<div><span onmouseover="document.getElementById('ghlink-Module:terminate-2-id229847').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-Module:terminate-2-id229847').style.visibility = 'hidden';" id="Module:terminate-2">Module:terminate(Reason, State)</span></div>  <h2 class="func-types-title">Types</h2>    
<div class="note"> <div class="label">Note</div> <div class="content">

<p>This callback is optional, so callback modules need not export it. The <code class="code">gen_server</code> module provides a default implementation without cleanup.</p> </div> </div> <p>This function is called by a <code class="code">gen_server</code> process when it is about to terminate. It is to be the opposite of <code><a href="#Module:init-1"><span class="code">Module:init/1</span></a></code> and do any necessary cleaning up. When it returns, the <code class="code">gen_server</code> process terminates with <code class="code">Reason</code>. The return value is ignored.</p> <p><code class="code">Reason</code> is a term denoting the stop reason and <code class="code">State</code> is the internal state of the <code class="code">gen_server</code> process.</p> <p><code class="code">Reason</code> depends on why the <code class="code">gen_server</code> process is terminating. If it is because another callback function has returned a stop tuple <code class="code">{stop,..}</code>, <code class="code">Reason</code> has the value specified in that tuple. If it is because of a failure, <code class="code">Reason</code> is the error reason.</p> <p>If the <code class="code">gen_server</code> process is part of a supervision tree and is ordered by its supervisor to terminate, this function is called with <code class="code">Reason=shutdown</code> if the following conditions apply:</p> <ul> <li> <p>The <code class="code">gen_server</code> process has been set to trap exit signals.</p> </li> <li> <p>The shutdown strategy as defined in the child specification of the supervisor is an integer time-out value, not <code class="code">brutal_kill</code>.</p> </li> </ul> <p>Even if the <code class="code">gen_server</code> process is <strong>not</strong> part of a supervision tree, this function is called if it receives an <code class="code">'EXIT'</code> message from its parent. <code class="code">Reason</code> is the same as in the <code class="code">'EXIT'</code> message.</p> <p>Otherwise, the <code class="code">gen_server</code> process terminates immediately.</p> <p>Notice that for any other reason than <code class="code">normal</code>, <code class="code">shutdown</code>, or <code class="code">{shutdown,Term}</code>, the <code class="code">gen_server</code> process is assumed to terminate because of an error and an error report is issued using <code><span class="code">logger(3)</span></code>.</p>  </div> <h2><span onmouseover="document.getElementById('ghlink-see-also-id230045').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-see-also-id230045').style.visibility = 'hidden';" id="see-also">See Also</span></h2>  <p><code><a href="gen_event"><span class="code">gen_event(3)</span></a></code>, <code><a href="gen_statem"><span class="code">gen_statem(3)</span></a></code>, <code><a href="proc_lib"><span class="code">proc_lib(3)</span></a></code>, <code><a href="supervisor"><span class="code">supervisor(3)</span></a></code>, <code><a href="sys"><span class="code">sys(3)</span></a></code></p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010–2017 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

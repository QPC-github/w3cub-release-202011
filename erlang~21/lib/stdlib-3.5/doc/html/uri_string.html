
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Uri_string - Erlang 21 - W3cubDocs</title>
  
  <meta name="description" content=" uri_string ">
  <meta name="keywords" content="uri, string, erlang, erlang~21">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/erlang~21/lib/stdlib-3.5/doc/html/uri_string.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/erlang~21.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/erlang~21/" class="_nav-link" title="" style="margin-left:0;">Erlang 21</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _erlang">
				
				
<h1>uri_string</h1> <h2><span onmouseover="document.getElementById('ghlink-module-id294888').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-id294888').style.visibility = 'hidden';" id="module">Module</span></h2> <p class="REFBODY module-body">uri_string</p> <h2><span onmouseover="document.getElementById('ghlink-module-summary-id294892').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-module-summary-id294892').style.visibility = 'hidden';" id="module-summary">Module Summary</span></h2> <p class="REFBODY module-summary-body">URI processing functions.</p> <h2><span onmouseover="document.getElementById('ghlink-description-id294896').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-description-id294896').style.visibility = 'hidden';" id="description">Description</span></h2> 
<p>This module contains functions for parsing and handling URIs (<code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code>) and form-urlencoded query strings (<code><a href="https://www.w3.org/TR/html52/">HTML 5.2</a></code>). </p> <p> Parsing and serializing non-UTF-8 form-urlencoded query strings are also supported (<code><a href="https://www.w3.org/TR/html50/">HTML 5.0</a></code>). </p> <p>A URI is an identifier consisting of a sequence of characters matching the syntax rule named <strong>URI</strong> in <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code>. </p> <p> The generic URI syntax consists of a hierarchical sequence of components referred to as the scheme, authority, path, query, and fragment:</p> <pre data-language="erlang">
URI         = scheme ":" hier-part [ "?" query ] [ "#" fragment ]
hier-part   = "//" authority path-abempty
               / path-absolute
               / path-rootless
               / path-empty
scheme      = ALPHA *( ALPHA / DIGIT / "+" / "-" / "." )
authority   = [ userinfo "@" ] host [ ":" port ]
userinfo    = *( unreserved / pct-encoded / sub-delims / ":" )

reserved    = gen-delims / sub-delims
gen-delims  = ":" / "/" / "?" / "#" / "[" / "]" / "@"
sub-delims  = "!" / "$" / "&amp;" / "'" / "(" / ")"
            / "*" / "+" / "," / ";" / "="

unreserved  = ALPHA / DIGIT / "-" / "." / "_" / "~"
</pre>
<br> <p>The interpretation of a URI depends only on the characters used and not on how those characters are represented in a network protocol.</p> <p>The functions implemented by this module cover the following use cases:</p> <ul> <li>Parsing URIs into its components and returing a map<br> <code><a href="#parse-1"><span class="code">parse/1</span></a></code> </li> <li>Recomposing a map of URI components into a URI string<br> <code><a href="#recompose-1"><span class="code">recompose/1</span></a></code> </li> <li>Changing inbound binary and percent-encoding of URIs<br> <code><a href="#transcode-2"><span class="code">transcode/2</span></a></code> </li> <li>Transforming URIs into a normalized form<br> <code><a href="#normalize-1"><span class="code">normalize/1</span></a></code><br> <code><a href="#normalize-2"><span class="code">normalize/2</span></a></code> </li> <li>Composing form-urlencoded query strings from a list of key-value pairs<br> <code><a href="#compose_query-1"><span class="code">compose_query/1</span></a></code><br> <code><a href="#compose_query-2"><span class="code">compose_query/2</span></a></code> </li> <li>Dissecting form-urlencoded query strings into a list of key-value pairs<br> <code><a href="#dissect_query-1"><span class="code">dissect_query/1</span></a></code> </li> </ul> <p>There are four different encodings present during the handling of URIs:</p> <ul> <li>Inbound binary encoding in binaries</li> <li>Inbound percent-encoding in lists and binaries</li> <li>Outbound binary encoding in binaries</li> <li>Outbound percent-encoding in lists and binaries</li> </ul> <p>Functions with <code class="code">uri_string()</code> argument accept lists, binaries and mixed lists (lists with binary elements) as input type. All of the functions but <code class="code">transcode/2</code> expects input as lists of unicode codepoints, UTF-8 encoded binaries and UTF-8 percent-encoded URI parts ("%C3%B6" corresponds to the unicode character "ö").</p> <p>Unless otherwise specified the return value type and encoding are the same as the input type and encoding. That is, binary input returns binary output, list input returns a list output but mixed input returns list output.</p> <p>In case of lists there is only percent-encoding. In binaries, however, both binary encoding and percent-encoding shall be considered. <code class="code">transcode/2</code> provides the means to convert between the supported encodings, it takes a <code class="code">uri_string()</code> and a list of options specifying inbound and outbound encodings.</p> <p><code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code> does not mandate any specific character encoding and it is usually defined by the protocol or surrounding text. This library takes the same assumption, binary and percent-encoding are handled as one configuration unit, they cannot be set to different values.</p>  <h2><span onmouseover="document.getElementById('ghlink-data-types-id295139').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-data-types-id295139').style.visibility = 'hidden';" id="data-types">Data Types</span></h2> <div class="data-types-body"> <div class="data-type-name" onmouseover="document.getElementById('ghlink-type-error').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-error').style.visibility = 'hidden';">  <code id="type-error">error() = {error, atom(), term()}</code><br> </div> <div class="data-type-desc">

<p>Error tuple indicating the type of error. Possible values of the second component:</p> <ul> <li><code class="code">invalid_character</code></li> <li><code class="code">invalid_encoding</code></li> <li><code class="code">invalid_input</code></li> <li><code class="code">invalid_map</code></li> <li><code class="code">invalid_percent_encoding</code></li> <li><code class="code">invalid_scheme</code></li> <li><code class="code">invalid_uri</code></li> <li><code class="code">invalid_utf8</code></li> <li><code class="code">missing_value</code></li> </ul> <p>The third component is a term providing additional information about the cause of the error.</p> </div> </div> <div class="data-types-body"> <div class="data-type-name" onmouseover="document.getElementById('ghlink-type-uri_map').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-uri_map').style.visibility = 'hidden';">  <code>uri_map() = <br id="type-uri_map">    #{fragment =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>,<br>      host =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>,<br>      path =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>,<br>      port =&gt; integer() &gt;= 0 | undefined,<br>      query =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>,<br>      scheme =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>,<br>      userinfo =&gt; <span><a href="unicode#type-chardata">unicode:chardata()</a></span>} |<br>    #{}</code><br> </div> <div class="data-type-desc">

<p>Map holding the main components of a URI.</p> </div> </div> <div class="data-types-body"> <div class="data-type-name" onmouseover="document.getElementById('ghlink-type-uri_string').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-type-uri_string').style.visibility = 'hidden';">  <code id="type-uri_string">uri_string() = iodata()</code><br> </div> <div class="data-type-desc">

<p>List of unicode codepoints, a UTF-8 encoded binary, or a mix of the two, representing an <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code> compliant URI (<strong>percent-encoded form</strong>). A URI is a sequence of characters from a very limited set: the letters of the basic Latin alphabet, digits, and a few special characters.</p> </div> </div> <h2><span onmouseover="document.getElementById('ghlink-exports-id295264').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-exports-id295264').style.visibility = 'hidden';" id="exports">Exports</span></h2> <div class="exports-body"> 
<div onmouseover="document.getElementById('ghlink-compose_query-1-id348577').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-compose_query-1-id348577').style.visibility = 'hidden';"> compose_query(QueryList) -&gt; QueryString</div> <h2 class="func-types-title">Types</h2>    
<p>Composes a form-urlencoded <code class="code">QueryString</code> based on a <code class="code">QueryList</code>, a list of non-percent-encoded key-value pairs. Form-urlencoding is defined in section 4.10.21.6 of the <code><a href="https://www.w3.org/TR/html52/">HTML 5.2</a></code> specification and in section 4.10.22.6 of the <code><a href="https://www.w3.org/TR/html50/">HTML 5.0</a></code> specification for non-UTF-8 encodings. </p> <p>See also the opposite operation <code><a href="#dissect_query-1"><span class="code">dissect_query/1</span></a></code>. </p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:compose_query([{"foo bar","1"},{"city","örebro"}]).
"foo+bar=1&amp;city=%C3%B6rebro"
2&gt; uri_string:compose_query([{&lt;&lt;"foo bar"&gt;&gt;,&lt;&lt;"1"&gt;&gt;},
2&gt; {&lt;&lt;"city"&gt;&gt;,&lt;&lt;"örebro"/utf8&gt;&gt;}]).
&lt;&lt;"foo+bar=1&amp;city=%C3%B6rebro"&gt;&gt;
	</pre>  
<div onmouseover="document.getElementById('ghlink-compose_query-2-id350431').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-compose_query-2-id350431').style.visibility = 'hidden';"> compose_query(QueryList, Options) -&gt; QueryString</div> <h2 class="func-types-title">Types</h2>     
<p>Same as <code class="code">compose_query/1</code> but with an additional <code class="code">Options</code> parameter, that controls the encoding ("charset") used by the encoding algorithm. There are two supported encodings: <code class="code">utf8</code> (or <code class="code">unicode</code>) and <code class="code">latin1</code>. </p> <p>Each character in the entry's name and value that cannot be expressed using the selected character encoding, is replaced by a string consisting of a U+0026 AMPERSAND character (&amp;), a "#" (U+0023) character, one or more ASCII digits representing the Unicode code point of the character in base ten, and finally a ";" (U+003B) character. </p> <p>Bytes that are out of the range 0x2A, 0x2D, 0x2E, 0x30 to 0x39, 0x41 to 0x5A, 0x5F, 0x61 to 0x7A, are percent-encoded (U+0025 PERCENT SIGN character (%) followed by uppercase ASCII hex digits representing the hexadecimal value of the byte). </p> <p>See also the opposite operation <code><a href="#dissect_query-1"><span class="code">dissect_query/1</span></a></code>. </p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:compose_query([{"foo bar","1"},{"city","örebro"}],
1&gt; [{encoding, latin1}]).
"foo+bar=1&amp;city=%F6rebro"
2&gt; uri_string:compose_query([{&lt;&lt;"foo bar"&gt;&gt;,&lt;&lt;"1"&gt;&gt;},
2&gt; {&lt;&lt;"city"&gt;&gt;,&lt;&lt;"東京"/utf8&gt;&gt;}], [{encoding, latin1}]).
&lt;&lt;"foo+bar=1&amp;city=%26%2326481%3B%26%2320140%3B"&gt;&gt;
	</pre>  
<div onmouseover="document.getElementById('ghlink-dissect_query-1-id350566').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-dissect_query-1-id350566').style.visibility = 'hidden';"> dissect_query(QueryString) -&gt; QueryList</div> <h2 class="func-types-title">Types</h2>    
<p>Dissects an urlencoded <code class="code">QueryString</code> and returns a <code class="code">QueryList</code>, a list of non-percent-encoded key-value pairs. Form-urlencoding is defined in section 4.10.21.6 of the <code><a href="https://www.w3.org/TR/html52/">HTML 5.2</a></code> specification and in section 4.10.22.6 of the <code><a href="https://www.w3.org/TR/html50/">HTML 5.0</a></code> specification for non-UTF-8 encodings. </p> <p>See also the opposite operation <code><a href="#compose_query-1"><span class="code">compose_query/1</span></a></code>. </p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:dissect_query("foo+bar=1&amp;city=%C3%B6rebro").
[{"foo bar","1"},{"city","örebro"}]
2&gt; uri_string:dissect_query(&lt;&lt;"foo+bar=1&amp;city=%26%2326481%3B%26%2320140%3B"&gt;&gt;).
[{&lt;&lt;"foo bar"&gt;&gt;,&lt;&lt;"1"&gt;&gt;},
 {&lt;&lt;"city"&gt;&gt;,&lt;&lt;230,157,177,228,186,172&gt;&gt;}] 
	</pre>  
<div onmouseover="document.getElementById('ghlink-normalize-1-id350615').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-normalize-1-id350615').style.visibility = 'hidden';"> normalize(URI) -&gt; NormalizedURI</div> <h2 class="func-types-title">Types</h2>    
<p>Transforms an <code class="code">URI</code> into a normalized form using Syntax-Based Normalization as defined by <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code>.</p> <p>This function implements case normalization, percent-encoding normalization, path segment normalization and scheme based normalization for HTTP(S) with basic support for FTP, SSH, SFTP and TFTP.</p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:normalize("/a/b/c/./../../g").
"/a/g"
2&gt; uri_string:normalize(&lt;&lt;"mid/content=5/../6"&gt;&gt;).
&lt;&lt;"mid/6"&gt;&gt;
3&gt; uri_string:normalize("http://localhost:80").
"https://localhost/"
4&gt; uri_string:normalize(#{scheme =&gt; "http",port =&gt; 80,path =&gt; "/a/b/c/./../../g",
4&gt; host =&gt; "localhost-örebro"}).
"http://localhost-%C3%B6rebro/a/g"
	</pre>  
<div onmouseover="document.getElementById('ghlink-normalize-2-id350761').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-normalize-2-id350761').style.visibility = 'hidden';"> normalize(URI, Options) -&gt; NormalizedURI</div> <h2 class="func-types-title">Types</h2>     
<p>Same as <code class="code">normalize/1</code> but with an additional <code class="code">Options</code> parameter, that controls if the normalized URI shall be returned as an uri_map(). There is one supported option: <code class="code">return_map</code>. </p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:normalize("/a/b/c/./../../g", [return_map]).
#{path =&gt; "/a/g"}
2&gt; uri_string:normalize(&lt;&lt;"mid/content=5/../6"&gt;&gt;, [return_map]).
#{path =&gt; &lt;&lt;"mid/6"&gt;&gt;}
3&gt; uri_string:normalize("http://localhost:80", [return_map]).
#{scheme =&gt; "http",path =&gt; "/",host =&gt; "localhost"}
4&gt; uri_string:normalize(#{scheme =&gt; "http",port =&gt; 80,path =&gt; "/a/b/c/./../../g",
4&gt; host =&gt; "localhost-örebro"}, [return_map]).
#{scheme =&gt; "http",path =&gt; "/a/g",host =&gt; "localhost-örebro"}
	</pre>  
<div onmouseover="document.getElementById('ghlink-parse-1-id350749').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-parse-1-id350749').style.visibility = 'hidden';"> parse(URIString) -&gt; URIMap</div> <h2 class="func-types-title">Types</h2>    
<p>Parses an <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code> compliant <code class="code">uri_string()</code> into a <code class="code">uri_map()</code>, that holds the parsed components of the <code class="code">URI</code>. If parsing fails, an error tuple is returned.</p> <p>See also the opposite operation <code><a href="#recompose-1"><span class="code">recompose/1</span></a></code>.</p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:parse("foo://user@example.com:8042/over/there?name=ferret#nose").
#{fragment =&gt; "nose",host =&gt; "example.com",
  path =&gt; "/over/there",port =&gt; 8042,query =&gt; "name=ferret",
  scheme =&gt; foo,userinfo =&gt; "user"}
2&gt; uri_string:parse(&lt;&lt;"foo://user@example.com:8042/over/there?name=ferret"&gt;&gt;).
#{host =&gt; &lt;&lt;"example.com"&gt;&gt;,path =&gt; &lt;&lt;"/over/there"&gt;&gt;,
  port =&gt; 8042,query =&gt; &lt;&lt;"name=ferret"&gt;&gt;,scheme =&gt; &lt;&lt;"foo"&gt;&gt;,
  userinfo =&gt; &lt;&lt;"user"&gt;&gt;}
	</pre>  
<div onmouseover="document.getElementById('ghlink-recompose-1-id351202').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-recompose-1-id351202').style.visibility = 'hidden';"> recompose(URIMap) -&gt; URIString</div> <h2 class="func-types-title">Types</h2>    
<p>Creates an <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code> compliant <code class="code">URIString</code> (percent-encoded), based on the components of <code class="code">URIMap</code>. If the <code class="code">URIMap</code> is invalid, an error tuple is returned.</p> <p>See also the opposite operation <code><a href="#parse-1"><span class="code">parse/1</span></a></code>.</p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; URIMap = #{fragment =&gt; "nose", host =&gt; "example.com", path =&gt; "/over/there",
1&gt; port =&gt; 8042, query =&gt; "name=ferret", scheme =&gt; "foo", userinfo =&gt; "user"}.
#{fragment =&gt; "top",host =&gt; "example.com",
  path =&gt; "/over/there",port =&gt; 8042,query =&gt; "?name=ferret",
  scheme =&gt; foo,userinfo =&gt; "user"}

2&gt; uri_string:recompose(URIMap).
"foo://example.com:8042/over/there?name=ferret#nose"</pre>  
<div onmouseover="document.getElementById('ghlink-transcode-2-id351365').style.visibility = 'visible';" onmouseout="document.getElementById('ghlink-transcode-2-id351365').style.visibility = 'hidden';"> transcode(URIString, Options) -&gt; Result</div> <h2 class="func-types-title">Types</h2>     
<p>Transcodes an <code><a href="https://www.ietf.org/rfc/rfc3986.txt">RFC 3986</a></code> compliant <code class="code">URIString</code>, where <code class="code">Options</code> is a list of tagged tuples, specifying the inbound (<code class="code">in_encoding</code>) and outbound (<code class="code">out_encoding</code>) encodings. <code class="code">in_encoding</code> and <code class="code">out_encoding</code> specifies both binary encoding and percent-encoding for the input and output data. Mixed encoding, where binary encoding is not the same as percent-encoding, is not supported. If an argument is invalid, an error tuple is returned.</p> <p><strong>Example:</strong></p> <pre data-language="erlang">
1&gt; uri_string:transcode(&lt;&lt;"foo%00%00%00%F6bar"/utf32&gt;&gt;,
1&gt; [{in_encoding, utf32},{out_encoding, utf8}]).
&lt;&lt;"foo%C3%B6bar"/utf8&gt;&gt;
2&gt; uri_string:transcode("foo%F6bar", [{in_encoding, latin1},
2&gt; {out_encoding, utf8}]).
"foo%C3%B6bar"
	</pre>  </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010–2017 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

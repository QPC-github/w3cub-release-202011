
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>6.13. External Blocks - Rust - W3cubDocs</title>
  
  <meta name="description" content=" Syntax ExternBlock &#58; extern Abi? { InnerAttribute&#42; ExternalItem&#42; } ">
  <meta name="keywords" content="external, blocks, rust">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/rust/reference/items/external-blocks.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/rust.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/rust/" class="_nav-link" title="" style="margin-left:0;">Rust</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rust">
				
				
<h1>External blocks</h1> <blockquote> <p><strong><sup>Syntax</sup></strong><br> <em>ExternBlock</em> :<br> <code>extern</code> <a href="functions"><em>Abi</em></a><sup>?</sup> <code>{</code><br> <a href="../attributes"><em>InnerAttribute</em></a><sup>*</sup><br> <em>ExternalItem</em><sup>*</sup><br> <code>}</code></p> <p><em>ExternalItem</em> :<br> <a href="../attributes"><em>OuterAttribute</em></a><sup>*</sup> (<br> <a href="../macros#macro-invocation"><em>MacroInvocationSemi</em></a><br> | ( <a href="../visibility-and-privacy"><em>Visibility</em></a><sup>?</sup> ( <em>ExternalStaticItem</em> | <em>ExternalFunctionItem</em> ) )<br> )</p> <p><em>ExternalStaticItem</em> :<br> <code>static</code> <code>mut</code><sup>?</sup> <a href="../identifiers">IDENTIFIER</a> <code>:</code> <a href="../types#type-expressions"><em>Type</em></a> <code>;</code></p> <p><em>ExternalFunctionItem</em> :<br> <code>fn</code> <a href="../identifiers">IDENTIFIER</a> <a href="generics"><em>Generics</em></a><sup>?</sup><br> <code>(</code> ( <em>NamedFunctionParameters</em> | <em>NamedFunctionParametersWithVariadics</em> )<sup>?</sup> <code>)</code><br> <a href="functions"><em>FunctionReturnType</em></a><sup>?</sup> <a href="generics#where-clauses"><em>WhereClause</em></a><sup>?</sup> <code>;</code></p> <p><em>NamedFunctionParameters</em> :<br> <em>NamedFunctionParam</em> ( <code>,</code> <em>NamedFunctionParam</em> )<sup>*</sup> <code>,</code><sup>?</sup></p> <p><em>NamedFunctionParam</em> :<br> <a href="../attributes"><em>OuterAttribute</em></a><sup>*</sup> ( <a href="../identifiers">IDENTIFIER</a> | <code>_</code> ) <code>:</code> <a href="../types#type-expressions"><em>Type</em></a></p> <p><em>NamedFunctionParametersWithVariadics</em> :<br> ( <em>NamedFunctionParam</em> <code>,</code> )<sup>*</sup> <em>NamedFunctionParam</em> <code>,</code> <a href="../attributes"><em>OuterAttribute</em></a><sup>*</sup> <code>...</code></p> </blockquote> <p>External blocks provide <em>declarations</em> of items that are not <em>defined</em> in the current crate and are the basis of Rust's foreign function interface. These are akin to unchecked imports.</p> <p>Two kind of item <em>declarations</em> are allowed in external blocks: <a href="functions">functions</a> and <a href="static-items">statics</a>. Calling functions or accessing statics that are declared in external blocks is only allowed in an <code>unsafe</code> context.</p> <h2>Functions</h2> <p>Functions within external blocks are declared in the same way as other Rust functions, with the exception that they may not have a body and are instead terminated by a semicolon. Patterns are not allowed in parameters, only <a href="../identifiers">IDENTIFIER</a> or <code>_</code> may be used.</p> <p>Functions within external blocks may be called by Rust code, just like functions defined in Rust. The Rust compiler automatically translates between the Rust ABI and the foreign ABI.</p> <p>A function declared in an extern block is implicitly <code>unsafe</code>. When coerced to a function pointer, a function declared in an extern block has type <code>unsafe extern "abi" for&lt;'l1, ..., 'lm&gt; fn(A1, ..., An) -&gt; R</code>, where <code>'l1</code>, ... <code>'lm</code> are its lifetime parameters, <code>A1</code>, ..., <code>An</code> are the declared types of its parameters and <code>R</code> is the declared return type.</p> <h2>Statics</h2> <p>Statics within external blocks are declared in the same way as <a href="static-items">statics</a> outside of external blocks, except that they do not have an expression initializing their value. It is <code>unsafe</code> to access a static item declared in an extern block, whether or not it's mutable, because there is nothing guaranteeing that the bit pattern at the static's memory is valid for the type it is declared with, since some arbitrary (e.g. C) code is in charge of initializing the static.</p> <p>Extern statics can be either immutable or mutable just like <a href="static-items">statics</a> outside of external blocks. An immutable static <em>must</em> be initialized before any Rust code is executed. It is not enough for the static to be initialized before Rust code reads from it.</p> <h2>ABI</h2> <p>By default external blocks assume that the library they are calling uses the standard C ABI on the specific platform. Other ABIs may be specified using an <code>abi</code> string, as shown here:</p> <pre data-language="rust">
#![allow(unused)]
fn main() {
// Interface to the Windows API
extern "stdcall" { }
}
</pre> <p>There are three ABI strings which are cross-platform, and which all compilers are guaranteed to support:</p> <ul> <li>
<code>extern "Rust"</code> -- The default ABI when you write a normal <code>fn foo()</code> in any Rust code.</li> <li>
<code>extern "C"</code> -- This is the same as <code>extern fn foo()</code>; whatever the default your C compiler supports.</li> <li>
<code>extern "system"</code> -- Usually the same as <code>extern "C"</code>, except on Win32, in which case it's <code>"stdcall"</code>, or what you should use to link to the Windows API itself</li> </ul> <p>There are also some platform-specific ABI strings:</p> <ul> <li>
<code>extern "cdecl"</code> -- The default for x86_32 C code.</li> <li>
<code>extern "stdcall"</code> -- The default for the Win32 API on x86_32.</li> <li>
<code>extern "win64"</code> -- The default for C code on x86_64 Windows.</li> <li>
<code>extern "sysv64"</code> -- The default for C code on non-Windows x86_64.</li> <li>
<code>extern "aapcs"</code> -- The default for ARM.</li> <li>
<code>extern "fastcall"</code> -- The <code>fastcall</code> ABI -- corresponds to MSVC's <code>__fastcall</code> and GCC and clang's <code>__attribute__((fastcall))</code>
</li> <li>
<code>extern "vectorcall"</code> -- The <code>vectorcall</code> ABI -- corresponds to MSVC's <code>__vectorcall</code> and clang's <code>__attribute__((vectorcall))</code>
</li> </ul> <h2>Variadic functions</h2> <p>Functions within external blocks may be variadic by specifying <code>...</code> after one or more named arguments in the argument list:</p> <pre data-language="rust">
#![allow(unused)]
fn main() {
extern {
    fn foo(x: i32, ...);
}
}
</pre> <h2>Attributes on extern blocks</h2> <p>The following <a href="../attributes">attributes</a> control the behavior of external blocks.</p> <h3>The <code id="the-link-attribute">link</code> attribute</h3> <p>The <em><code>link</code> attribute</em> specifies the name of a native library that the compiler should link with for the items within an <code>extern</code> block. It uses the <a href="../attributes#meta-item-attribute-syntax"><em>MetaListNameValueStr</em></a> syntax to specify its inputs. The <code>name</code> key is the name of the native library to link. The <code>kind</code> key is an optional value which specifies the kind of library with the following possible values:</p> <ul> <li>
<code>dylib</code> — Indicates a dynamic library. This is the default if <code>kind</code> is not specified.</li> <li>
<code>static</code> — Indicates a static library.</li> <li>
<code>framework</code> — Indicates a macOS framework. This is only valid for macOS targets.</li> </ul> <p>The <code>name</code> key must be included if <code>kind</code> is specified.</p> <p>The <code>wasm_import_module</code> key may be used to specify the <a href="https://webassembly.github.io/spec/core/syntax/modules.html">WebAssembly module</a> name for the items within an <code>extern</code> block when importing symbols from the host environment. The default module name is <code>env</code> if <code>wasm_import_module</code> is not specified.</p>  <pre data-language="rust">#[link(name = "crypto")]
extern {
    // …
}

#[link(name = "CoreFoundation", kind = "framework")]
extern {
    // …
}

#[link(wasm_import_module = "foo")]
extern {
    // …
}
</pre> <p>It is valid to add the <code>link</code> attribute on an empty extern block. You can use this to satisfy the linking requirements of extern blocks elsewhere in your code (including upstream crates) instead of adding the attribute to each extern block.</p> <h3>The <code id="the-link_name-attribute">link_name</code> attribute</h3> <p>The <code>link_name</code> attribute may be specified on declarations inside an <code>extern</code> block to indicate the symbol to import for the given function or static. It uses the <a href="../attributes#meta-item-attribute-syntax"><em>MetaNameValueStr</em></a> syntax to specify the name of the symbol.</p> <pre data-language="rust">
#![allow(unused)]
fn main() {
extern {
    #[link_name = "actual_symbol_name"]
    fn name_in_rust();
}
}
</pre> <h3>Attributes on function parameters</h3> <p>Attributes on extern function parameters follow the same rules and restrictions as <a href="functions#attributes-on-function-parameters">regular function parameters</a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010 The Rust Project Developers<br>Licensed under the Apache License, Version 2.0 or the MIT license, at your option.<br>
    <a href="https://doc.rust-lang.org/reference/items/external-blocks.html" class="_attribution-link">https://doc.rust-lang.org/reference/items/external-blocks.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

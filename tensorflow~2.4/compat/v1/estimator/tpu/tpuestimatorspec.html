
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>tf.compat.v1.estimator.tpu.TPUEstimatorSpec - TensorFlow 2.4 - W3cubDocs</title>
  
  <meta name="description" content=" Ops and objects returned from a model_fn and passed to TPUEstimator. ">
  <meta name="keywords" content="tf, compat, estimator, tpu, tpuestimatorspec, tensorflow, tensorflow~2.4">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tensorflow~2.4/compat/v1/estimator/tpu/tpuestimatorspec.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-9352e6910fe51dd10a2c4166dc5a7847892ebc84c0bb52d7e40dcdccbf262592790483d09e6dbfd62c689609a706227727ca9acb967a718e944c111f43ca96a0.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tensorflow~2.4.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tensorflow~2.4/" class="_nav-link" title="" style="margin-left:0;">TensorFlow 2.4</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tensorflow">
				
				
<h1 class="devsite-page-title">tf.compat.v1.estimator.tpu.TPUEstimatorSpec</h1>       <p>Ops and objects returned from a <code translate="no" dir="ltr">model_fn</code> and passed to <code translate="no" dir="ltr">TPUEstimator</code>.</p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.compat.v1.estimator.tpu.TPUEstimatorSpec(
    mode, predictions=None, loss=None, train_op=None, eval_metrics=None,
    export_outputs=None, scaffold_fn=None, host_call=None, training_hooks=None,
    evaluation_hooks=None, prediction_hooks=None
)
</pre>  <p>See <code translate="no" dir="ltr">EstimatorSpec</code> for <code translate="no" dir="ltr">mode</code>, <code translate="no" dir="ltr">predictions</code>, <code translate="no" dir="ltr">loss</code>, <code translate="no" dir="ltr">train_op</code>, and <code translate="no" dir="ltr">export_outputs</code>.</p> <p>For evaluation, <code translate="no" dir="ltr">eval_metrics</code>is a tuple of <code translate="no" dir="ltr">metric_fn</code> and <code translate="no" dir="ltr">tensors</code>, where <code translate="no" dir="ltr">metric_fn</code> runs on CPU to generate metrics and <code translate="no" dir="ltr">tensors</code> represents the <code translate="no" dir="ltr">Tensor</code>s transferred from TPU system to CPU host and passed to <code translate="no" dir="ltr">metric_fn</code>. To be precise, TPU evaluation expects a slightly different signature from the <a href="../../../../estimator/estimator"><code translate="no" dir="ltr">tf.estimator.Estimator</code></a>. While <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/EstimatorSpec#eval_metric_ops"><code translate="no" dir="ltr">EstimatorSpec.eval_metric_ops</code></a> expects a dict, <code translate="no" dir="ltr">TPUEstimatorSpec.eval_metrics</code> is a tuple of <code translate="no" dir="ltr">metric_fn</code> and <code translate="no" dir="ltr">tensors</code>. The <code translate="no" dir="ltr">tensors</code> could be a list of <code translate="no" dir="ltr">Tensor</code>s or dict of names to <code translate="no" dir="ltr">Tensor</code>s. The <code translate="no" dir="ltr">tensors</code> usually specify the model logits, which are transferred back from TPU system to CPU host. All tensors must have be batch-major, i.e., the batch size is the first dimension. Once all tensors are available at CPU host from all shards, they are concatenated (on CPU) and passed as positional arguments to the <code translate="no" dir="ltr">metric_fn</code> if <code translate="no" dir="ltr">tensors</code> is list or keyword arguments if <code translate="no" dir="ltr">tensors</code> is a dict. <code translate="no" dir="ltr">metric_fn</code> takes the <code translate="no" dir="ltr">tensors</code> and returns a dict from metric string name to the result of calling a metric function, namely a <code translate="no" dir="ltr">(metric_tensor, update_op)</code> tuple. See <code translate="no" dir="ltr">TPUEstimator</code> for MNIST example how to specify the <code translate="no" dir="ltr">eval_metrics</code>.</p> <p><code translate="no" dir="ltr">scaffold_fn</code> is a function running on CPU to generate the <code translate="no" dir="ltr">Scaffold</code>. This function should not capture any Tensors in <code translate="no" dir="ltr">model_fn</code>.</p> <p><code translate="no" dir="ltr">host_call</code> is a tuple of a <code translate="no" dir="ltr">function</code> and a list or dictionary of <code translate="no" dir="ltr">tensors</code> to pass to that function and returns a list of Tensors. <code translate="no" dir="ltr">host_call</code> currently works for train() and evaluate(). The Tensors returned by the function is executed on the CPU on every step, so there is communication overhead when sending tensors from TPU to CPU. To reduce the overhead, try reducing the size of the tensors. The <code translate="no" dir="ltr">tensors</code> are concatenated along their major (batch) dimension, and so must be &gt;= rank 1. The <code translate="no" dir="ltr">host_call</code> is useful for writing summaries with <code translate="no" dir="ltr">tf.contrib.summary.create_file_writer</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">mode</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">predictions</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">loss</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">train_op</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">eval_metrics</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">export_outputs</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">scaffold_fn</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">host_call</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">training_hooks</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">evaluation_hooks</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">prediction_hooks</code> </td> <td> 
</td> </tr> </table> <h2 id="methods" data-text="Methods">Methods</h2> <h3 id="as_estimator_spec" data-text="as_estimator_spec"><code translate="no" dir="ltr">as_estimator_spec</code></h3> <p><a target="_blank" href="https://github.com/tensorflow/estimator/tree/master/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py#L383-L410">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
as_estimator_spec()
</pre> <p>Creates an equivalent <code translate="no" dir="ltr">EstimatorSpec</code> used by CPU train/eval.</p>  <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0"> </devsite-page-rating><div class="_attribution">
  <p class="_attribution-p">
    Â© 2020 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.4/api_docs/python/tf/compat/v1/estimator/tpu/TPUEstimatorSpec" class="_attribution-link">https://www.tensorflow.org/versions/r2.4/api_docs/python/tf/compat/v1/estimator/tpu/TPUEstimatorSpec</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Command Line Interface - Flask 0.12 - W3cubDocs</title>
  
  <meta name="description" content=" New in version 0.11. ">
  <meta name="keywords" content="command, line, interface, flask, flask~0.12">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/flask~0.12/cli/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/flask~0.12.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/flask~0.12/" class="_nav-link" title="" style="margin-left:0;">Flask 0.12</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="cli">Command Line Interface</h1> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 0.11.</span></p> </div> </details><p>One of the nice new features in Flask 0.11 is the built-in integration of the <a class="reference external" href="http://click.pocoo.org/">click</a> command line interface. This enables a wide range of new features for the Flask ecosystem and your own applications.</p>  <h2 id="basic-usage">Basic Usage</h2> <p>After installation of Flask you will now find a <strong class="command">flask</strong> script installed into your virtualenv. If you don’t want to install Flask or you have a special use-case you can also use <code>python -m flask</code> to accomplish exactly the same.</p> <p>The way this script works is by providing access to all the commands on your Flask application’s <a class="reference internal" href="../api/index#flask.Flask.cli" title="flask.Flask.cli"><code>Flask.cli</code></a> instance as well as some built-in commands that are always there. Flask extensions can also register more commands there if they desire so.</p> <p>For the <strong class="command">flask</strong> script to work, an application needs to be discovered. This is achieved by exporting the <code>FLASK_APP</code> environment variable. It can be either set to an import path or to a filename of a Python module that contains a Flask application.</p> <p>In that imported file the name of the app needs to be called <code>app</code> or optionally be specified after a colon. For instance <code>mymodule:application</code> would tell it to use the <code>application</code> object in the <code>mymodule.py</code> file.</p> <p>Given a <code>hello.py</code> file with the application in it named <code>app</code> this is how it can be run.</p> <p>Environment variables (On Windows use <code>set</code> instead of <code>export</code>):</p> <pre data-language="python">export FLASK_APP=hello
flask run
</pre> <p>Or with a filename:</p> <pre data-language="python">export FLASK_APP=/path/to/hello.py
flask run
</pre>   <h2 id="virtualenv-integration">Virtualenv Integration</h2> <p>If you are constantly working with a virtualenv you can also put the <code>export FLASK_APP</code> into your <code>activate</code> script by adding it to the bottom of the file. That way every time you activate your virtualenv you automatically also activate the correct application name.</p>   <h2 id="debug-flag">Debug Flag</h2> <p>The <strong class="command">flask</strong> script can also be instructed to enable the debug mode of the application automatically by exporting <code>FLASK_DEBUG</code>. If set to <code>1</code> debug is enabled or <code>0</code> disables it:</p> <pre data-language="python">export FLASK_DEBUG=1
</pre>   <h2 id="running-a-shell">Running a Shell</h2> <p>To run an interactive Python shell you can use the <code>shell</code> command:</p> <pre data-language="python">flask shell
</pre> <p>This will start up an interactive Python shell, setup the correct application context and setup the local variables in the shell. This is done by invoking the <a class="reference internal" href="../api/index#flask.Flask.make_shell_context" title="flask.Flask.make_shell_context"><code>Flask.make_shell_context()</code></a> method of the application. By default you have access to your <code>app</code> and <a class="reference internal" href="../api/index#flask.g" title="flask.g"><code>g</code></a>.</p>   <h2 id="custom-commands">Custom Commands</h2> <p>If you want to add more commands to the shell script you can do this easily. Flask uses <a class="reference external" href="http://click.pocoo.org/">click</a> for the command interface which makes creating custom commands very easy. For instance if you want a shell command to initialize the database you can do this:</p> <pre data-language="python">import click
from flask import Flask

app = Flask(__name__)

@app.cli.command()
def initdb():
    """Initialize the database."""
    click.echo('Init the db')
</pre> <p>The command will then show up on the command line:</p> <pre data-language="python">$ flask initdb
Init the db
</pre>   <h2 id="application-context">Application Context</h2> <p>Most commands operate on the application so it makes a lot of sense if they have the application context setup. Because of this, if you register a callback on <code>app.cli</code> with the <a class="reference internal" href="../api/index#flask.cli.AppGroup.command" title="flask.cli.AppGroup.command"><code>command()</code></a> the callback will automatically be wrapped through <a class="reference internal" href="../api/index#flask.cli.with_appcontext" title="flask.cli.with_appcontext"><code>cli.with_appcontext()</code></a> which informs the cli system to ensure that an application context is set up. This behavior is not available if a command is added later with <code>add_command()</code> or through other means.</p> <p>It can also be disabled by passing <code>with_appcontext=False</code> to the decorator:</p> <pre data-language="python">@app.cli.command(with_appcontext=False)
def example():
    pass
</pre>   <h2 id="factory-functions">Factory Functions</h2> <p>In case you are using factory functions to create your application (see <a class="reference internal" href="../patterns/appfactories/index#app-factories"><span class="std std-ref">Application Factories</span></a>) you will discover that the <strong class="command">flask</strong> command cannot work with them directly. Flask won’t be able to figure out how to instantiate your application properly by itself. Because of this reason the recommendation is to create a separate file that instantiates applications. This is not the only way to make this work. Another is the <a class="reference internal" href="#custom-scripts"><span class="std std-ref">Custom Scripts</span></a> support.</p> <p>For instance if you have a factory function that creates an application from a filename you could make a separate file that creates such an application from an environment variable.</p> <p>This could be a file named <code>autoapp.py</code> with these contents:</p> <pre data-language="python">import os
from yourapplication import create_app
app = create_app(os.environ['YOURAPPLICATION_CONFIG'])
</pre> <p>Once this has happened you can make the <strong class="command">flask</strong> command automatically pick it up:</p> <pre data-language="python">export YOURAPPLICATION_CONFIG=/path/to/config.cfg
export FLASK_APP=/path/to/autoapp.py
</pre> <p>From this point onwards <strong class="command">flask</strong> will find your application.</p>   <h2 id="id1">Custom Scripts</h2> <p id="custom-scripts">While the most common way is to use the <strong class="command">flask</strong> command, you can also make your own “driver scripts”. Since Flask uses click for the scripts there is no reason you cannot hook these scripts into any click application. There is one big caveat and that is, that commands registered to <a class="reference internal" href="../api/index#flask.Flask.cli" title="flask.Flask.cli"><code>Flask.cli</code></a> will expect to be (indirectly at least) launched from a <a class="reference internal" href="../api/index#flask.cli.FlaskGroup" title="flask.cli.FlaskGroup"><code>flask.cli.FlaskGroup</code></a> click group. This is necessary so that the commands know which Flask application they have to work with.</p> <p>To understand why you might want custom scripts you need to understand how click finds and executes the Flask application. If you use the <strong class="command">flask</strong> script you specify the application to work with on the command line or environment variable as an import name. This is simple but it has some limitations. Primarily it does not work with application factory functions (see <a class="reference internal" href="../patterns/appfactories/index#app-factories"><span class="std std-ref">Application Factories</span></a>).</p> <p>With a custom script you don’t have this problem as you can fully customize how the application will be created. This is very useful if you write reusable applications that you want to ship to users and they should be presented with a custom management script.</p> <p>To explain all of this, here is an example <code>manage.py</code> script that manages a hypothetical wiki application. We will go through the details afterwards:</p> <pre data-language="python">import os
import click
from flask.cli import FlaskGroup

def create_wiki_app(info):
    from yourwiki import create_app
    return create_app(
        config=os.environ.get('WIKI_CONFIG', 'wikiconfig.py'))

@click.group(cls=FlaskGroup, create_app=create_wiki_app)
def cli():
    """This is a management script for the wiki application."""

if __name__ == '__main__':
    cli()
</pre> <p>That’s a lot of code for not much, so let’s go through all parts step by step.</p> <ol class="arabic"> <li>First we import the <code>click</code> library as well as the click extensions from the <code>flask.cli</code> package. Primarily we are here interested in the <a class="reference internal" href="../api/index#flask.cli.FlaskGroup" title="flask.cli.FlaskGroup"><code>FlaskGroup</code></a> click group.</li> <li>The next thing we do is defining a function that is invoked with the script info object (<a class="reference internal" href="../api/index#flask.cli.ScriptInfo" title="flask.cli.ScriptInfo"><code>ScriptInfo</code></a>) from Flask and its purpose is to fully import and create the application. This can either directly import an application object or create it (see <a class="reference internal" href="../patterns/appfactories/index#app-factories"><span class="std std-ref">Application Factories</span></a>). In this case we load the config from an environment variable.</li> <li>
<p>Next step is to create a <code>FlaskGroup</code>. In this case we just make an empty function with a help doc string that just does nothing and then pass the <code>create_wiki_app</code> function as a factory function.</p> <p>Whenever click now needs to operate on a Flask application it will call that function with the script info and ask for it to be created.</p> </li> <li>All is rounded up by invoking the script.</li> </ol>   <h2 id="cli-plugins">CLI Plugins</h2> <p>Flask extensions can always patch the <a class="reference internal" href="../api/index#flask.Flask.cli" title="flask.Flask.cli"><code>Flask.cli</code></a> instance with more commands if they want. However there is a second way to add CLI plugins to Flask which is through <code>setuptools</code>. If you make a Python package that should export a Flask command line plugin you can ship a <code>setup.py</code> file that declares an entrypoint that points to a click command:</p> <p>Example <code>setup.py</code>:</p> <pre data-language="python">from setuptools import setup

setup(
    name='flask-my-extension',
    ...
    entry_points='''
        [flask.commands]
        my-command=mypackage.commands:cli
    ''',
)
</pre> <p>Inside <code>mypackage/commands.py</code> you can then export a Click object:</p> <pre data-language="python">import click

@click.command()
def cli():
    """This is an example command."""
</pre> <p>Once that package is installed in the same virtualenv as Flask itself you can run <code>flask my-command</code> to invoke your command. This is useful to provide extra functionality that Flask itself cannot ship.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2007–2020 Pallets<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://flask.palletsprojects.com/en/0.12.x/cli/" class="_attribution-link">https://flask.palletsprojects.com/en/0.12.x/cli/</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>JavaScript Modules - Kotlin - W3cubDocs</title>
  
  <meta name="description" content="You can compile your Kotlin projects to JavaScript modules for various popular module systems. We currently support the following configurations for &hellip;">
  <meta name="keywords" content="javascript, modules, kotlin">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/kotlin/docs/reference/js-modules.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/kotlin.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/kotlin/" class="_nav-link" title="" style="margin-left:0;">Kotlin</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _kotlin">
				
				
<h1 class="typo-header typo-h1" id="javascript-modules">JavaScript Modules</h1> <p class="typo-para">You can compile your Kotlin projects to JavaScript modules for various popular module systems. We currently support the following configurations for JavaScript modules:</p> <ul class="typo-list typo-list_type_simple"> <li class="typo-list__item">
<a class="typo-link" href="https://github.com/umdjs/umd">Unified Module Definitions (UMD)</a>, which is compatible with both <em>AMD</em> and <em>CommonJS</em>. UMD modules are also able to be executed without being imported or when no module system is present. This is the default option for the <code>browser</code> and <code>nodejs</code> targets.</li> <li class="typo-list__item">
<a class="typo-link" href="https://github.com/amdjs/amdjs-api/wiki/AMD">Asynchronous Module Definitions (AMD)</a>, which is in particular used by the <a class="typo-link" href="https://requirejs.org/">RequireJS</a> library.</li> <li class="typo-list__item">
<a class="typo-link" href="http://wiki.commonjs.org/wiki/Modules/1.1">CommonJS</a>, widely used by Node.js/npm (<code>require</code> function and <code>module.exports</code> object)</li> <li class="typo-list__item">Plain. Don't compile for any module system. You can access a module by its name in the global scope.</li> </ul> <h2 class="typo-header typo-h2" id="targeting-the-browser">Targeting the browser</h2> <p class="typo-para">If you're targeting the browser and want to use a different module system than UMD, you can specify the desired module type in the <code>webpackTask</code> configuration block. For example, to switch to CommonJS, use:</p> <div class="sample" mode="groovy"> <pre data-language="groovy">
kotlin {
    js {
        browser {
            webpackTask {
                output.libraryTarget = "commonjs2"
            }
        }
        binaries.executable()
    }
}

</pre> </div> <p class="typo-para">Webpack provides two different "flavors" of CommonJS, <code>commonjs</code> and <code>commonjs2</code>, which affect the way your declarations are made available. While in most cases, you probably want <code>commonjs2</code>, which adds the <code>module.exports</code> syntax to the generated library, you can also opt for the "pure" <code>commonjs</code> option, which implements the CommonJS specification exactly. To learn more about the difference between <code>commonjs</code> and <code>commonjs2</code>, check <a class="typo-link" href="https://github.com/webpack/webpack/issues/1114">here</a>.</p> <h2 class="typo-header typo-h2" id="creating-javascript-libraries-and-nodejs-files">Creating JavaScript libraries and Node.js files</h2> <p class="typo-para">If you are creating a library that will be consumed from JavaScript or a Node.js file, and want to use a different module system, the instructions are slightly different.</p> <h3 class="typo-header typo-h3" id="choosing-the-target-module-system">Choosing the target module system</h3> <p class="typo-para">To select module kind, set the <code>moduleKind</code> compiler option in the Gradle build script.</p> <div class="multi-language-sample" data-lang="groovy"> <div class="sample" mode="groovy"> <pre data-language="groovy">compileKotlinJs.kotlinOptions.moduleKind = "commonjs"

</pre> </div> </div> <div class="multi-language-sample" data-lang="kotlin"> <div class="sample" mode="kotlin"> <pre data-language="kotlin">tasks.withType(KotlinJsCompile::class.java).named("compileKotlinJs") {
    kotlinOptions.moduleKind = "commonjs"
}
</pre> </div> </div> <p class="typo-para">Available values are: <code>umd</code> (default), <code>commonjs</code>, <code>amd</code>, <code>plain</code>.</p> <blockquote class="note typo-quote"> <p class="typo-para">This is different from adjusting <code>webpackTask.output.libraryTarget</code>. The library target changes the output <em>generated by webpack</em> (after your code has already been compiled). <code>kotlinOptions.moduleKind</code> changes the output generated <em>by the Kotlin compiler</em>.</p> </blockquote> <p class="typo-para">In the Kotlin Gradle DSL, there is also a shortcut for setting the CommonJS module kind:</p> <div class="sample" mode="kotlin"> <pre data-language="kotlin">kotlin {
    js {
         useCommonJs()
         // . . .
    }
}
</pre> </div> <h2 class="typo-header typo-h2" id="jsmodule-annotation">
<code>@JsModule</code> annotation</h2> <p class="typo-para">To tell Kotlin that an <code>external</code> class, package, function or property is a JavaScript module, you can use <code>@JsModule</code> annotation. Consider you have the following CommonJS module called "hello":</p> <div class="sample" mode="java"> <pre data-language="javascript">module.exports.sayHello = function(name) { alert("Hello, " + name); }
</pre> </div> <p class="typo-para">You should declare it like this in Kotlin:</p> <div class="sample"> <pre data-language="kotlin">@JsModule("hello")
external fun sayHello(name: String)
</pre> </div> <h3 class="typo-header typo-h3" id="applying-jsmodule-to-packages">Applying <code>@JsModule</code> to packages</h3> <p class="typo-para">Some JavaScript libraries export packages (namespaces) instead of functions and classes. In terms of JavaScript, it's an <em>object</em> that has <em>members</em> that are classes, functions and properties. Importing these packages as Kotlin objects often looks unnatural. The compiler can map imported JavaScript packages to Kotlin packages, using the following notation:</p> <div class="sample"> <pre data-language="kotlin">@file:JsModule("extModule")
package ext.jspackage.name

external fun foo()

external class C
</pre> </div> <p class="typo-para">where the corresponding JavaScript module is declared like this:</p> <div class="sample" mode="js"> <pre data-language="javascript">module.exports = {
    foo:  { /* some code here */ },
    C:  { /* some code here */ }
}
</pre> </div> <blockquote class="typo-quote"> <p class="typo-para">files marked with <code>@file:JsModule</code> annotation can't declare non-external members. The example below produces compile-time error:</p> </blockquote> <div class="sample"> <pre data-language="kotlin">@file:JsModule("extModule")
package ext.jspackage.name

external fun foo()

fun bar() = "!" + foo() + "!" // error here
</pre> </div> <h3 class="typo-header typo-h3" id="importing-deeper-package-hierarchies">Importing deeper package hierarchies</h3> <p class="typo-para">In the previous example the JavaScript module exports a single package. However, some JavaScript libraries export multiple packages from within a module. This case is also supported by Kotlin, though you have to declare a new <code>.kt</code> file for each package you import.</p> <p class="typo-para">For example, let's make our example a bit more complicated:</p> <div class="sample" mode="js"> <pre data-language="javascript">module.exports = {
    mylib: {
        pkg1: {
            foo: function() { /* some code here */ },
            bar: function() { /* some code here */ }
        },
        pkg2: {
            baz: function() { /* some code here */ }
        }
    }
}
</pre> </div> <p class="typo-para">To import this module in Kotlin, you have to write two Kotlin source files:</p> <div class="sample"> <pre data-language="kotlin">@file:JsModule("extModule")
@file:JsQualifier("mylib.pkg1")
package extlib.pkg1

external fun foo()

external fun bar()
</pre> </div> <p class="typo-para">and</p> <div class="sample"> <pre data-language="kotlin">@file:JsModule("extModule")
@file:JsQualifier("mylib.pkg2")
package extlib.pkg2

external fun baz()
</pre> </div> <h3 class="typo-header typo-h3" id="jsnonmodule-annotation">
<code>@JsNonModule</code> annotation</h3> <p class="typo-para">When a declaration is marked as <code>@JsModule</code>, you can't use it from Kotlin code when you don't compile it to a JavaScript module. Usually, developers distribute their libraries both as JavaScript modules and downloadable <code>.js</code> files that you can copy to your project's static resources and include via a <code>&lt;script&gt;</code> tag. To tell Kotlin that it's okay to use a <code>@JsModule</code> declaration from a non-module environment, add the <code>@JsNonModule</code> annotation. For example, consider the following JavaScript code:</p> <div class="sample" mode="js"> <pre data-language="javascript">function topLevelSayHello(name) { alert("Hello, " + name); }
if (module &amp;&amp; module.exports) {
    module.exports = topLevelSayHello;
}
</pre> </div> <p class="typo-para">You could describe it from Kotlin as follows:</p> <div class="sample"> <pre data-language="kotlin">@JsModule("hello")
@JsNonModule
@JsName("topLevelSayHello")
external fun sayHello(name: String)
</pre> </div> <h3 class="typo-header typo-h3" id="module-system-used-by-the-kotlin-standard-library">Module system used by the Kotlin Standard Library</h3> <p class="typo-para">Kotlin is distributed with the Kotlin/JS standard library as a single file, which is itself compiled as an UMD module, so you can use it with any module system described above. While for most use cases of Kotlin/JS, it is recommended to use a Gradle dependency on <code>kotlin-stdlib-js</code>, it is also available on NPM as the <a class="typo-link" href="https://www.npmjs.com/package/kotlin"><code>kotlin</code></a> package.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010–2020 JetBrains s.r.o. and Kotlin Programming Language contributors<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://kotlinlang.org/docs/reference/js-modules.html" class="_attribution-link">https://kotlinlang.org/docs/reference/js-modules.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>TensorFlow Version Compatibility - TensorFlow Guide - W3cubDocs</title>
  
  <meta name="description" content="This document is for users who need backwards compatibility across different versions of TensorFlow (either for code or data), and for developers &hellip;">
  <meta name="keywords" content="tensorflow, version, compatibility, guide, tensorflow~guide">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tensorflow~guide/programmers_guide/version_compat.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tensorflow~guide.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tensorflow~guide/" class="_nav-link" title="" style="margin-left:0;">TensorFlow Guide</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tensorflow">
				
				
<h1 itemprop="name" class="devsite-page-title"> TensorFlow Version Compatibility </h1>     <p>This document is for users who need backwards compatibility across different versions of TensorFlow (either for code or data), and for developers who want to modify TensorFlow while preserving compatibility.</p> <h2 id="semantic_versioning_20">Semantic Versioning 2.0</h2> <p>TensorFlow follows Semantic Versioning 2.0 (<a href="http://semver.org">semver</a>) for its public API. Each release version of TensorFlow has the form <code>MAJOR.MINOR.PATCH</code>. For example, TensorFlow version 1.2.3 has <code>MAJOR</code> version 1, <code>MINOR</code> version 2, and <code>PATCH</code> version 3. Changes to each number have the following meaning:</p> <ul> <li> <p><strong>MAJOR</strong>: Potentially backwards incompatible changes. Code and data that worked with a previous major release will not necessarily work with the new release. However, in some cases existing TensorFlow graphs and checkpoints may be migratable to the newer release; see <a href="#compatibility_of_graphs_and_checkpoints">Compatibility of graphs and checkpoints</a> for details on data compatibility.</p> </li> <li> <p><strong>MINOR</strong>: Backwards compatible features, speed improvements, etc. Code and data that worked with a previous minor release <em>and</em> which depends only on the public API will continue to work unchanged. For details on what is and is not the public API, see <a href="#what_is_covered">What is covered</a>.</p> </li> <li> <p><strong>PATCH</strong>: Backwards compatible bug fixes.</p> </li> </ul> <p>For example, release 1.0.0 introduced backwards <em>incompatible</em> changes from release 0.12.1. However, release 1.1.1 was backwards <em>compatible</em> with release 1.0.0.</p> <h2 id="what_is_covered">What is covered</h2> <p>Only the public APIs of TensorFlow are backwards compatible across minor and patch versions. The public APIs consist of</p> <ul> <li>All the documented <a href="https://www.tensorflow.org/api_docs/python">Python</a> functions and classes in the <br> <code>tensorflow</code> module and its submodules, except for<ul> <li>functions and classes in <a href="https://www.tensorflow.org/api_docs/python/tf/contrib"><code>tf.contrib</code></a>
</li> <li>functions and classes whose names start with <code>_</code> (as these are private) Note that the code in the <code>examples/</code> and <code>tools/</code> directories is not reachable through the <code>tensorflow</code> Python module and is thus not covered by the compatibility guarantee.</li> </ul> </li> </ul> <p>If a symbol is available through the <code>tensorflow</code> Python module or its submodules, but is not documented, then it is <strong>not</strong> considered part of the public API.</p> <ul> <li> <p>The <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.h">C API</a>.</p> </li> <li> <p>The following protocol buffer files:</p> <ul> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/attr_value.proto"><code>attr_value</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/protobuf/config.proto"><code>config</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/util/event.proto"><code>event</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/graph.proto"><code>graph</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/op_def.proto"><code>op_def</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/reader_base.proto"><code>reader_base</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/summary.proto"><code>summary</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor.proto"><code>tensor</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/tensor_shape.proto"><code>tensor_shape</code></a></li> <li><a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/types.proto"><code>types</code></a></li> </ul> </li> </ul>  <h2 id="what_is_not_covered">What is <em>not</em> covered</h2> <p>Some API functions are explicitly marked as "experimental" and can change in backward incompatible ways between minor releases. These include:</p> <ul> <li> <p><strong>Experimental APIs</strong>: The <a href="https://www.tensorflow.org/api_docs/python/tf/contrib"><code>tf.contrib</code></a> module and its submodules in Python and any functions in the C API or fields in protocol buffers that are explicitly commented as being experimental. In particular, any field in a protocol buffer which is called "experimental" and all its fields and submessages can change at any time.</p> </li> <li> <p><strong>Other languages</strong>: TensorFlow APIs in languages other than Python and C, such as:</p> </li> <li> <p><a href="https://www.tensorflow.org/api_guides/cc/guide">C++</a> (exposed through header files in <a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/cc"><code>tensorflow/cc</code></a>).</p> </li> <li>
<a href="https://www.tensorflow.org/api_docs/java/reference/org/tensorflow/package-summary">Java</a>,</li> <li> <p><a href="https://godoc.org/github.com/tensorflow/tensorflow/tensorflow/go">Go</a></p> </li> <li> <p><strong>Details of composite ops:</strong> Many public functions in Python expand to several primitive ops in the graph, and these details will be part of any graphs saved to disk as <code>GraphDef</code>s. These details may change for minor releases. In particular, regressions tests that check for exact matching between graphs are likely to break across minor releases, even though the behavior of the graph should be unchanged and existing checkpoints will still work.</p> </li> <li> <p><strong>Floating point numerical details:</strong> The specific floating point values computed by ops may change at any time. Users should rely only on approximate accuracy and numerical stability, not on the specific bits computed. Changes to numerical formulas in minor and patch releases should result in comparable or improved accuracy, with the caveat that in machine learning improved accuracy of specific formulas may result in decreased accuracy for the overall system.</p> </li> <li> <p><strong>Random numbers:</strong> The specific random numbers computed by the <a href="https://www.tensorflow.org/api_guides/python/constant_op#Random_Tensors">random ops</a> may change at any time. Users should rely only on approximately correct distributions and statistical strength, not the specific bits computed. However, we will make changes to random bits rarely (or perhaps never) for patch releases. We will, of course, document all such changes.</p> </li> <li> <p><strong>Version skew in distributed Tensorflow:</strong> Running two different versions of TensorFlow in a single cluster is unsupported. There are no guarantees about backwards compatibility of the wire protocol.</p> </li> <li> <p><strong>Bugs:</strong> We reserve the right to make backwards incompatible behavior (though not API) changes if the current implementation is clearly broken, that is, if it contradicts the documentation or if a well-known and well-defined intended behavior is not properly implemented due to a bug. For example, if an optimizer claims to implement a well-known optimization algorithm but does not match that algorithm due to a bug, then we will fix the optimizer. Our fix may break code relying on the wrong behavior for convergence. We will note such changes in the release notes.</p> </li> <li> <p><strong>Error messages:</strong> We reserve the right to change the text of error messages. In addition, the type of an error may change unless the type is specified in the documentation. For example, a function documented to raise an <code>InvalidArgument</code> exception will continue to raise <code>InvalidArgument</code>, but the human-readable message contents can change.</p> </li> </ul> <h2 id="compatibility_of_graphs_and_checkpoints">Compatibility of graphs and checkpoints</h2> <p>You'll sometimes need to preserve graphs and checkpoints. Graphs describe the data flow of ops to be run during training and inference, and checkpoints contain the saved tensor values of variables in a graph.</p> <p>Many TensorFlow users save graphs and trained models to disk for later evaluation or additional training, but end up running their saved graphs or models on a later release. In compliance with semver, any graph or checkpoint written out with one version of TensorFlow can be loaded and evaluated with a later version of TensorFlow with the same major release. However, we will endeavor to preserve backwards compatibility even across major releases when possible, so that the serialized files are usable over long periods of time.</p> <p>Graphs are serialized via the <code>GraphDef</code> protocol buffer. To facilitate (rare) backwards incompatible changes to graphs, each <code>GraphDef</code> has a version number separate from the TensorFlow version. For example, <code>GraphDef</code> version 17 deprecated the <code>inv</code> op in favor of <code>reciprocal</code>. The semantics are:</p> <ul> <li> <p>Each version of TensorFlow supports an interval of <code>GraphDef</code> versions. This interval will be constant across patch releases, and will only grow across minor releases. Dropping support for a <code>GraphDef</code> version will only occur for a major release of TensorFlow.</p> </li> <li> <p>Newly created graphs are assigned the latest <code>GraphDef</code> version number.</p> </li> <li> <p>If a given version of TensorFlow supports the <code>GraphDef</code> version of a graph, it will load and evaluate with the same behavior as the TensorFlow version used to generate it (except for floating point numerical details and random numbers), regardless of the major version of TensorFlow. In particular, all checkpoint files will be compatible.</p> </li> <li> <p>If the <code>GraphDef</code> <em>upper</em> bound is increased to X in a (minor) release, there will be at least six months before the <em>lower</em> bound is increased to X. For example (we're using hypothetical version numbers here):</p> <ul> <li>TensorFlow 1.2 might support <code>GraphDef</code> versions 4 to 7.</li> <li>TensorFlow 1.3 could add <code>GraphDef</code> version 8 and support versions 4 to 8.</li> <li>At least six months later, TensorFlow 2.0.0 could drop support for versions 4 to 7, leaving version 8 only.</li> </ul> </li> </ul> <p>Finally, when support for a <code>GraphDef</code> version is dropped, we will attempt to provide tools for automatically converting graphs to a newer supported <code>GraphDef</code> version.</p> <h2 id="graph_and_checkpoint_compatibility_when_extending_tensorflow">Graph and checkpoint compatibility when extending TensorFlow</h2> <p>This section is relevant only when making incompatible changes to the <code>GraphDef</code> format, such as when adding ops, removing ops, or changing the functionality of existing ops. The previous section should suffice for most users.</p> <h3 id="backward_and_partial_forward_compatibility">Backward and partial forward compatibility</h3> <p>Our versioning scheme has three requirements:</p> <ul> <li>
<strong>Backward compatibility</strong> to support loading graphs and checkpoints created with older versions of TensorFlow.</li> <li>
<strong>Forward compatibility</strong> to support scenarios where the producer of a graph or checkpoint is upgraded to a newer version of TensorFlow before the consumer.</li> <li>Enable evolving TensorFlow in incompatible ways. For example, removing ops, adding attributes, and removing attributes.</li> </ul> <p>Note that while the <code>GraphDef</code> version mechanism is separate from the TensorFlow version, backwards incompatible changes to the <code>GraphDef</code> format are still restricted by Semantic Versioning. This means functionality can only be removed or changed between <code>MAJOR</code> versions of TensorFlow (such as <code>1.7</code> to <code>2.0</code>). Additionally, forward compatibility is enforced within Patch releases (<code>1.x.1</code> to <code>1.x.2</code> for example).</p> <p>To achieve backward and forward compatibility and to know when to enforce changes in formats, graphs and checkpoints have metadata that describes when they were produced. The sections below detail the TensorFlow implementation and guidelines for evolving <code>GraphDef</code> versions.</p> <h3 id="independent_data_version_schemes">Independent data version schemes</h3> <p>There are different data versions for graphs and checkpoints. The two data formats evolve at different rates from each other and also at different rates from TensorFlow. Both versioning systems are defined in <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/public/version.h"><code>core/public/version.h</code></a>. Whenever a new version is added, a note is added to the header detailing what changed and the date.</p> <h3 id="data_producers_and_consumers">Data, producers, and consumers</h3> <p>We distinguish between the following kinds of data version information: <em> <strong>producers</strong>: binaries that produce data. Producers have a version (<code>producer</code>) and a minimum consumer version that they are compatible with (<code>min_consumer</code>). </em> <strong>consumers</strong>: binaries that consume data. Consumers have a version (<code>consumer</code>) and a minimum producer version that they are compatible with (<code>min_producer</code>).</p> <p>Each piece of versioned data has a <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/framework/versions.proto"><code>VersionDef versions</code></a> field which records the <code>producer</code> that made the data, the <code>min_consumer</code> that it is compatible with, and a list of <code>bad_consumers</code> versions that are disallowed.</p> <p>By default, when a producer makes some data, the data inherits the producer's <code>producer</code> and <code>min_consumer</code> versions. <code>bad_consumers</code> can be set if specific consumer versions are known to contain bugs and must be avoided. A consumer can accept a piece of data if the following are all true:</p> <ul> <li>
<code>consumer</code> &gt;= data's <code>min_consumer</code>
</li> <li>data's <code>producer</code> &gt;= consumer's <code>min_producer</code>
</li> <li>
<code>consumer</code> not in data's <code>bad_consumers</code>
</li> </ul> <p>Since both producers and consumers come from the same TensorFlow code base, <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/public/version.h"><code>core/public/version.h</code></a> contains a main data version which is treated as either <code>producer</code> or <code>consumer</code> depending on context and both <code>min_consumer</code> and <code>min_producer</code> (needed by producers and consumers, respectively). Specifically,</p> <ul> <li>For <code>GraphDef</code> versions, we have <code>TF_GRAPH_DEF_VERSION</code>, <code>TF_GRAPH_DEF_VERSION_MIN_CONSUMER</code>, and <code>TF_GRAPH_DEF_VERSION_MIN_PRODUCER</code>.</li> <li>For checkpoint versions, we have <code>TF_CHECKPOINT_VERSION</code>, <code>TF_CHECKPOINT_VERSION_MIN_CONSUMER</code>, and <code>TF_CHECKPOINT_VERSION_MIN_PRODUCER</code>.</li> </ul> <h3 id="add_a_new_attribute_with_default_to_an_existing_op">Add a new attribute with default to an existing op</h3> <p>Following the guidance below gives you forward compatibility only if the set of ops has not changed:</p> <ol> <li>If forward compatibility is desired, set <code>strip_default_attrs</code> to <code>True</code> while exporting the model using either the <a href="https://www.tensorflow.org/api_docs/python/tf/saved_model/builder/SavedModelBuilder#add_meta_graph_and_variables"><code>add_meta_graph_and_variables</code></a> and <a href="https://www.tensorflow.org/api_docs/python/tf/saved_model/builder/SavedModelBuilder#add_meta_graph"><code>add_meta_graph</code></a> methods of the <code>SavedModelBuilder</code> class, or <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/BaselineClassifier#export_savedmodel"><code>Estimator.export_savedmodel</code></a>
</li> <li>This strips off the default valued attributes at the time of producing/exporting the models. This makes sure that the exported <a href="https://www.tensorflow.org/api_docs/python/tf/MetaGraphDef"><code>tf.MetaGraphDef</code></a> does not contain the new op-attribute when the default value is used.</li> <li>Having this control could allow out-of-date consumers (for example, serving binaries that lag behind training binaries) to continue loading the models and prevent interruptions in model serving.</li> </ol> <h3 id="evolving_graphdef_versions">Evolving GraphDef versions</h3> <p>This section explains how to use this versioning mechanism to make different types of changes to the <code>GraphDef</code> format.</p> <h4 id="add_an_op">Add an op</h4> <p>Add the new op to both consumers and producers at the same time, and do not change any <code>GraphDef</code> versions. This type of change is automatically backward compatible, and does not impact forward compatibility plan since existing producer scripts will not suddenly use the new functionality.</p> <h4 id="add_an_op_and_switch_existing_python_wrappers_to_use_it">Add an op and switch existing Python wrappers to use it</h4> <ol> <li>Implement new consumer functionality and increment the <code>GraphDef</code> version.</li> <li>If it is possible to make the wrappers use the new functionality only in cases that did not work before, the wrappers can be updated now.</li> <li>Change Python wrappers to use the new functionality. Do not increment <code>min_consumer</code>, since models that do not use this op should not break.</li> </ol> <h4 id="remove_or_restrict_an_ops_functionality">Remove or restrict an op's functionality</h4> <ol> <li>Fix all producer scripts (not TensorFlow itself) to not use the banned op or functionality.</li> <li>Increment the <code>GraphDef</code> version and implement new consumer functionality that bans the removed op or functionality for GraphDefs at the new version and above. If possible, make TensorFlow stop producing <code>GraphDefs</code> with the banned functionality. To do so, add the <a href="https://github.com/tensorflow/tensorflow/blob/b289bc7a50fc0254970c60aaeba01c33de61a728/tensorflow/core/ops/array_ops.cc#L1009"><code>REGISTER_OP(...).Deprecated(deprecated_at_version, message)</code></a>.</li> <li>Wait for a major release for backward compatibility purposes.</li> <li>Increase <code>min_producer</code> to the GraphDef version from (2) and remove the functionality entirely.</li> </ol> <h4 id="change_an_ops_functionality">Change an op's functionality</h4> <ol> <li>Add a new similar op named <code>SomethingV2</code> or similar and go through the process of adding it and switching existing Python wrappers to use it, which may take three weeks if forward compatibility is desired.</li> <li>Remove the old op (Can only take place with a major version change due to backward compatibility).</li> <li>Increase <code>min_consumer</code> to rule out consumers with the old op, add back the old op as an alias for <code>SomethingV2</code>, and go through the process to switch existing Python wrappers to use it.</li> <li>Go through the process to remove <code>SomethingV2</code>.</li> </ol> <h4 id="ban_a_single_unsafe_consumer_version">Ban a single unsafe consumer version</h4> <ol> <li>Bump the <code>GraphDef</code> version and add the bad version to <code>bad_consumers</code> for all new GraphDefs. If possible, add to <code>bad_consumers</code> only for GraphDefs which contain a certain op or similar.</li> <li>If existing consumers have the bad version, push them out as soon as possible.</li> </ol>
<div class="_attribution">
  <p class="_attribution-p">
    © 2018 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 3.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/programmers_guide/version_compat" class="_attribution-link">https://www.tensorflow.org/programmers_guide/version_compat</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

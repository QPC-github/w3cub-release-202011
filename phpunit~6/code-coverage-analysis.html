
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Code Coverage Analysis - PHPUnit 6 - W3cubDocs</title>
  
  <meta name="description" content="In computer science, code coverage is a measure used to describe the degree to which the source code of a program is tested by a particular test &hellip;">
  <meta name="keywords" content="code, coverage, analysis, phpunit, phpunit~6">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/phpunit~6/code-coverage-analysis.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/phpunit~6.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/phpunit~6/" class="_nav-link" title="" style="margin-left:0;">PHPUnit 6</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _phpunit">
				
				
<h1 class="title" id="code-coverage-analysis">Code Coverage Analysis</h1>
<div class="blockquote"><table class="blockquote" summary="Block quote">
<tr>
<td width="10%"> </td>
<td width="80%"><p> In computer science, code coverage is a measure used to describe the degree to which the source code of a program is tested by a particular test suite. A program with high code coverage has been more thoroughly tested and has a lower chance of containing software bugs than a program with low code coverage. </p></td>
<td width="10%"> </td>
</tr>
<tr>
<td width="10%"> </td>
<td colspan="2" align="right">--<span class="attribution">Wikipedia</span>
</td>
</tr>
</table></div>
<p id="idp771616">   In this chapter you will learn all about PHPUnit's code coverage functionality that provides an insight into what parts of the production code are executed when the tests are run. It makes use of the <a class="ulink" href="https://github.com/sebastianbergmann/php-code-coverage" target="_top">PHP_CodeCoverage</a> component, which in turn leverages the code coverage functionality provided by the <a class="ulink" href="http://xdebug.org/" target="_top">Xdebug</a> extension for PHP. </p>
<div class="alert alert-info"><p> Xdebug is not distributed as part of PHPUnit. If you receive a notice while running tests that the Xdebug extension is not loaded, it means that Xdebug is either not installed or not configured properly. Before you can use the code coverage analysis features in PHPUnit, you should read <a class="ulink" href="http://xdebug.org/docs/install" target="_top">the Xdebug installation guide</a>. </p></div>
<p> PHPUnit can generate an HTML-based code coverage report as well as XML-based logfiles with code coverage information in various formats (Clover, Crap4J, PHPUnit). Code coverage information can also be reported as text (and printed to STDOUT) and exported as PHP code for further processing. </p>
<p> Please refer to <a class="xref" href="textui" title="Chapter 3. The Command-Line Test Runner">Chapter 3</a> for a list of commandline switches that control code coverage functionality as well as <a class="xref" href="appendixes.configuration#appendixes.configuration.logging" title="Logging">the section called “Logging”</a> for the relevant configuration settings. </p>
<h2 class="title" id="code-coverage-analysis.metrics">Software Metrics for Code Coverage</h2>
<p> Various software metrics exist to measure code coverage: </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">Line Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Line Coverage</em></span> software metric measures whether each executable line was executed. </p></dd>
<dt><span class="term">Function and Method Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Function and Method Coverage</em></span> software metric measures whether each function or method has been invoked. PHP_CodeCoverage only considers a function or method as covered when all of its executable lines are covered. </p></dd>
<dt><span class="term">Class and Trait Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Class and Trait Coverage</em></span> software metric measures whether each method of a class or trait is covered. PHP_CodeCoverage only considers a class or trait as covered when all of its methods are covered. </p></dd>
<dt><span class="term">Opcode Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Opcode Coverage</em></span> software metric measures whether each opcode of a function or method has been executed while running the test suite. A line of code usually compiles into more than one opcode. Line Coverage regards a line of code as covered as soon as one of its opcodes is executed. </p></dd>
<dt><span class="term">Branch Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Branch Coverage</em></span> software metric measures whether the boolean expression of each control structure evaluated to both <code class="literal">true</code> and <code class="literal">false</code> while running the test suite. </p></dd>
<dt><span class="term">Path Coverage</span></dt>
<dd><p> The <span class="emphasis"><em>Path Coverage</em></span> software metric measures whether each of the possible execution paths in a function or method has been followed while running the test suite. An execution path is a unique sequence of branches from the entry of the function or method to its exit. </p></dd>
<dt><span class="term">Change Risk Anti-Patterns (CRAP) Index</span></dt>
<dd><p> The <span class="emphasis"><em>Change Risk Anti-Patterns (CRAP) Index</em></span> is calculated based on the cyclomatic complexity and code coverage of a unit of code. Code that is not too complex and has an adequate test coverage will have a low CRAP index. The CRAP index can be lowered by writing tests and by refactoring the code to lower its complexity. </p></dd>
</dl></div>
<div class="alert alert-info"><p> The <span class="emphasis"><em>Opcode Coverage</em></span>, <span class="emphasis"><em>Branch Coverage</em></span>, and <span class="emphasis"><em>Path Coverage</em></span> software metrics are not yet supported by PHP_CodeCoverage. </p></div>
<h2 class="title" id="code-coverage-analysis.whitelisting-files">Whitelisting Files</h2>
<p id="idp1164560">  It is mandatory to configure a <span class="emphasis"><em>whitelist</em></span> for telling PHPUnit which sourcecode files to include in the code coverage report. This can either be done using the <code class="literal">--whitelist</code> commandline option or via the configuration file (see <a class="xref" href="appendixes.configuration#appendixes.configuration.whitelisting-files" title="Whitelisting Files for Code Coverage">the section called “Whitelisting Files for Code Coverage”</a>). </p>
<p> Optionally, all whitelisted files can be added to the code coverage report by setting <code class="literal">addUncoveredFilesFromWhitelist="true"</code> in your PHPUnit configuration (see <a class="xref" href="appendixes.configuration#appendixes.configuration.whitelisting-files" title="Whitelisting Files for Code Coverage">the section called “Whitelisting Files for Code Coverage”</a>). This allows the inclusion of files that are not tested yet at all. If you want to get information about which lines of such an uncovered file are executable, for instance, you also need to set <code class="literal">processUncoveredFilesFromWhitelist="true"</code> in your PHPUnit configuration (see <a class="xref" href="appendixes.configuration#appendixes.configuration.whitelisting-files" title="Whitelisting Files for Code Coverage">the section called “Whitelisting Files for Code Coverage”</a>). </p>
<div class="alert alert-info"><p> Please note that the loading of sourcecode files that is performed when <code class="literal">processUncoveredFilesFromWhitelist="true"</code> is set can cause problems when a sourcecode file contains code outside the scope of a class or function, for instance. </p></div>
<h2 class="title" id="code-coverage-analysis.ignoring-code-blocks">Ignoring Code Blocks</h2>
<p id="idp836112">     Sometimes you have blocks of code that you cannot test and that you may want to ignore during code coverage analysis. PHPUnit lets you do this using the <code class="literal">@codeCoverageIgnore</code>, <code class="literal">@codeCoverageIgnoreStart</code> and <code class="literal">@codeCoverageIgnoreEnd</code> annotations as shown in <a class="xref" href="code-coverage-analysis#code-coverage-analysis.ignoring-code-blocks.examples.Sample.php" title="Example 11.1: Using the @codeCoverageIgnore, @codeCoverageIgnoreStart and @codeCoverageIgnoreEnd annotations">Example 11.1</a>. </p>
<div class="example" id="code-coverage-analysis.ignoring-code-blocks.examples.Sample.php">
<p class="title"><strong>Example 11.1: Using the <code class="literal">@codeCoverageIgnore</code>, <code class="literal">@codeCoverageIgnoreStart</code> and <code class="literal">@codeCoverageIgnoreEnd</code> annotations</strong></p>
<div class="example-contents"><pre class="programlisting" data-language="php">&lt;?php
use PHPUnit\Framework\TestCase;

/**
 * @codeCoverageIgnore
 */
class Foo
{
    public function bar()
    {
    }
}

class Bar
{
    /**
     * @codeCoverageIgnore
     */
    public function foo()
    {
    }
}

if (false) {
    // @codeCoverageIgnoreStart
    print '*';
    // @codeCoverageIgnoreEnd
}

exit; // @codeCoverageIgnore
?&gt;</pre></div>
</div>
<p> The ignored lines of code (marked as ignored using the annotations) are counted as executed (if they are executable) and will not be highlighted. </p>
<h2 class="title" id="code-coverage-analysis.specifying-covered-methods">Specifying Covered Methods</h2>
<p id="idp845024">   The <code class="literal">@covers</code> annotation (see <a class="xref" href="appendixes.annotations#appendixes.annotations.covers.tables.annotations" title="Table B.1. Annotations for specifying which methods are covered by a test">Table B.1</a>) can be used in the test code to specify which method(s) a test method wants to test. If provided, only the code coverage information for the specified method(s) will be considered. <a class="xref" href="code-coverage-analysis#code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php" title="Example 11.2: Tests that specify which method they want to cover">Example 11.2</a> shows an example. </p>
<div class="example" id="code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php">
<p class="title"><strong>Example 11.2: Tests that specify which method they want to cover</strong></p>
<div class="example-contents"><pre class="programlisting" data-language="php">&lt;?php
use PHPUnit\Framework\TestCase;

class BankAccountTest extends TestCase
{
    protected $ba;

    protected function setUp()
    {
        $this-&gt;ba = new BankAccount;
    }

    /**
     * @covers BankAccount::getBalance
     */
    public function testBalanceIsInitiallyZero()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }

    /**
     * @covers BankAccount::withdrawMoney
     */
    public function testBalanceCannotBecomeNegative()
    {
        try {
            $this-&gt;ba-&gt;withdrawMoney(1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }

    /**
     * @covers BankAccount::depositMoney
     */
    public function testBalanceCannotBecomeNegative2()
    {
        try {
            $this-&gt;ba-&gt;depositMoney(-1);
        }

        catch (BankAccountException $e) {
            $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());

            return;
        }

        $this-&gt;fail();
    }

    /**
     * @covers BankAccount::getBalance
     * @covers BankAccount::depositMoney
     * @covers BankAccount::withdrawMoney
     */
    public function testDepositWithdrawMoney()
    {
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;depositMoney(1);
        $this-&gt;assertEquals(1, $this-&gt;ba-&gt;getBalance());
        $this-&gt;ba-&gt;withdrawMoney(1);
        $this-&gt;assertEquals(0, $this-&gt;ba-&gt;getBalance());
    }
}
?&gt;</pre></div>
</div>
<p id="idp851600">   It is also possible to specify that a test should not cover <span class="emphasis"><em>any</em></span> method by using the <code class="literal">@coversNothing</code> annotation (see <a class="xref" href="appendixes.annotations#appendixes.annotations.coversNothing" title="@coversNothing">the section called “@coversNothing”</a>). This can be helpful when writing integration tests to make sure you only generate code coverage with unit tests. </p>
<div class="example" id="code-coverage-analysis.specifying-covered-methods.examples.GuestbookIntegrationTest.php">
<p class="title"><strong>Example 11.3: A test that specifies that no method should be covered</strong></p>
<div class="example-contents"><pre class="programlisting" data-language="php">&lt;?php
use PHPUnit\Framework\TestCase;

class GuestbookIntegrationTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @coversNothing
     */
    public function testAddEntry()
    {
        $guestbook = new Guestbook();
        $guestbook-&gt;addEntry("suzy", "Hello world!");

        $queryTable = $this-&gt;getConnection()-&gt;createQueryTable(
            'guestbook', 'SELECT * FROM guestbook'
        );

        $expectedTable = $this-&gt;createFlatXmlDataSet("expectedBook.xml")
                              -&gt;getTable("guestbook");

        $this-&gt;assertTablesEqual($expectedTable, $queryTable);
    }
}
?&gt;
      </pre></div>
</div>
<h2 class="title" id="code-coverage-analysis.edge-cases">Edge Cases</h2>
<p> This section shows noteworthy edge cases that lead to confusing code coverage information. </p>
<div class="example" id="code-coverage-analysis.edge-cases.examples.Sample.php">
<p class="title"><strong>Example 11.4: </strong></p>
<div class="example-contents"><pre class="programlisting" data-language="php">&lt;?php
use PHPUnit\Framework\TestCase;

// Because it is "line based" and not statement base coverage
// one line will always have one coverage status
if (false) this_function_call_shows_up_as_covered();

// Due to how code coverage works internally these two lines are special.
// This line will show up as non executable
if (false)
    // This line will show up as covered because it is actually the 
    // coverage of the if statement in the line above that gets shown here!
    will_also_show_up_as_covered();

// To avoid this it is necessary that braces are used
if (false) {
    this_call_will_never_show_up_as_covered();
}
?&gt;</pre></div>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2017 Sebastian Bergmann<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>
    <a href="https://phpunit.de/manual/6.5/en/code-coverage-analysis.html" class="_attribution-link">https://phpunit.de/manual/6.5/en/code-coverage-analysis.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

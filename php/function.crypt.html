
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Crypt - PHP - W3cubDocs</title>
  
  <meta name="description" content=" (PHP 4, PHP 5, PHP 7) ">
  <meta name="keywords" content="crypt, php">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/php/function.crypt.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/php.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/php/" class="_nav-link" title="" style="margin-left:0;">PHP</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _php">
				
				
<div class="refnamediv"> <h1 class="refname">crypt</h1> <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p>
<p class="refpurpose"><span class="refname">crypt</span> — <span class="dc-title">One-way string hashing</span></p> </div> <div class="refsect1 description" id="refsect1-function.crypt-description"> <h3 class="title">Description</h3> <pre class="methodsynopsis dc-description" data-language="php">string crypt ( string $str [, string $salt ] )</pre> <p class="para rdfs-comment"> <span class="function"><strong>crypt()</strong></span> will return a hashed string using the standard Unix <abbr class="abbrev">DES</abbr>-based algorithm or alternative algorithms that may be available on the system. </p> <p class="para"> The <code class="parameter">salt</code> parameter is optional. However, <span class="function"><strong>crypt()</strong></span> creates a weak hash without the <code class="parameter">salt</code>. PHP 5.6 or later raise an E_NOTICE error without it. Make sure to specify a strong enough salt for better security. </p> <p class="para"> <span class="function"><a href="function.password-hash" class="function">password_hash()</a></span> uses a strong hash, generates a strong salt, and applies proper rounds automatically. <span class="function"><a href="function.password-hash" class="function">password_hash()</a></span> is a simple <span class="function"><strong>crypt()</strong></span> wrapper and compatible with existing password hashes. Use of <span class="function"><a href="function.password-hash" class="function">password_hash()</a></span> is encouraged. </p> <p class="para"> Some operating systems support more than one type of hash. In fact, sometimes the standard DES-based algorithm is replaced by an MD5-based algorithm. The hash type is triggered by the salt argument. Prior to 5.3, PHP would determine the available algorithms at install-time based on the system's crypt(). If no salt is provided, PHP will auto-generate either a standard two character (DES) salt, or a twelve character (MD5), depending on the availability of MD5 crypt(). PHP sets a constant named <strong><code>CRYPT_SALT_LENGTH</code></strong> which indicates the longest valid salt allowed by the available hashes. </p> <p class="para"> The standard DES-based <span class="function"><strong>crypt()</strong></span> returns the salt as the first two characters of the output. It also only uses the first eight characters of <code class="parameter">str</code>, so longer strings that start with the same eight characters will generate the same result (when the same salt is used). </p> <p class="simpara"> On systems where the crypt() function supports multiple hash types, the following constants are set to 0 or 1 depending on whether the given type is available: </p> <ul class="itemizedlist"> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_STD_DES</code></strong> - Standard DES-based hash with a two character salt from the alphabet "./0-9A-Za-z". Using invalid characters in the salt will cause crypt() to fail. </span> </li> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_EXT_DES</code></strong> - Extended DES-based hash. The "salt" is a 9-character string consisting of an underscore followed by 4 bytes of iteration count and 4 bytes of salt. These are encoded as printable characters, 6 bits per character, least significant character first. The values 0 to 63 are encoded as "./0-9A-Za-z". Using invalid characters in the salt will cause crypt() to fail. </span> </li> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_MD5</code></strong> - MD5 hashing with a twelve character salt starting with $1$ </span> </li> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_BLOWFISH</code></strong> - Blowfish hashing with a salt as follows: "$2a$", "$2x$" or "$2y$", a two digit cost parameter, "$", and 22 characters from the alphabet "./0-9A-Za-z". Using characters outside of this range in the salt will cause crypt() to return a zero-length string. The two digit cost parameter is the base-2 logarithm of the iteration count for the underlying Blowfish-based hashing algorithmeter and must be in range 04-31, values outside this range will cause crypt() to fail. Versions of PHP before 5.3.7 only support "$2a$" as the salt prefix: PHP 5.3.7 introduced the new prefixes to fix a security weakness in the Blowfish implementation. Please refer to <a href="http://www.php.net/security/crypt_blowfish.php" class="link external">» this document</a> for full details of the security fix, but to summarise, developers targeting only PHP 5.3.7 and later should use "$2y$" in preference to "$2a$". </span> </li> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_SHA256</code></strong> - SHA-256 hash with a sixteen character salt prefixed with $5$. If the salt string starts with 'rounds=&lt;N&gt;$', the numeric value of N is used to indicate how many times the hashing loop should be executed, much like the cost parameter on Blowfish. The default number of rounds is 5000, there is a minimum of 1000 and a maximum of 999,999,999. Any selection of N outside this range will be truncated to the nearest limit. </span> </li> <li class="listitem"> <span class="simpara"> <strong><code>CRYPT_SHA512</code></strong> - SHA-512 hash with a sixteen character salt prefixed with $6$. If the salt string starts with 'rounds=&lt;N&gt;$', the numeric value of N is used to indicate how many times the hashing loop should be executed, much like the cost parameter on Blowfish. The default number of rounds is 5000, there is a minimum of 1000 and a maximum of 999,999,999. Any selection of N outside this range will be truncated to the nearest limit. </span> </li> </ul> <blockquote class="note">
<p><strong class="note">Note</strong>: </p>
<p class="para"> As of PHP 5.3.0, PHP contains its own implementation and will use that if the system lacks of support for one or more of the algorithms. </p> </blockquote> </div> <div class="refsect1 parameters" id="refsect1-function.crypt-parameters"> <h3 class="title">Parameters</h3> 
<dl> <dt> <code class="parameter">str</code>
</dt> <dd> <p class="para"> The string to be hashed. </p> <div class="caution">
<strong class="caution">Caution</strong> <p class="para"> Using the <strong><code>CRYPT_BLOWFISH</code></strong> algorithm, will result in the <code class="parameter">str</code> parameter being truncated to a maximum length of 72 characters. </p> </div> </dd> <dt> <code class="parameter">salt</code>
</dt> <dd> <p class="para"> An optional salt string to base the hashing on. If not provided, the behaviour is defined by the algorithm implementation and can lead to unexpected results. </p> </dd> </dl> </div> <div class="refsect1 returnvalues" id="refsect1-function.crypt-returnvalues"> <h3 class="title">Return Values</h3> <p class="para"> Returns the hashed string or a string that is shorter than 13 characters and is guaranteed to differ from the salt on failure. </p> <div class="warning">
<strong class="warning">Warning</strong> <p class="simpara"> When validating passwords, a string comparison function that isn't vulnerable to timing attacks should be used to compare the output of <span class="function"><strong>crypt()</strong></span> to the previously known hash. PHP 5.6 onwards provides <span class="function"><a href="function.hash-equals" class="function">hash_equals()</a></span> for this purpose. </p> </div> </div> <div class="refsect1 changelog" id="refsect1-function.crypt-changelog"> <h3 class="title">Changelog</h3> 
<table class="doctable informaltable"> <thead> <tr> <th>Version</th> <th>Description</th> </tr> </thead> <tbody class="tbody"> <tr> <td>5.6.5</td> <td> When the failure string "*0" is given as the <code class="parameter">salt</code>, "*1" will now be returned for consistency with other crypt implementations. Prior to this version, PHP 5.6 would incorrectly return a DES hash. </td> </tr> <tr> <td>5.6.0</td> <td> Raise E_NOTICE security warning if <code class="parameter">salt</code> is omitted. </td> </tr> <tr> <td>5.5.21</td> <td> When the failure string "*0" is given as the <code class="parameter">salt</code>, "*1" will now be returned for consistency with other crypt implementations. Prior to this version, PHP 5.5 (and earlier branches) would incorrectly return a DES hash. </td> </tr> <tr> <td>5.3.7</td> <td> Added <em>$2x$</em> and <em>$2y$</em> Blowfish modes to deal with potential high-bit attacks. </td> </tr> <tr> <td>5.3.2</td> <td> Added SHA-256 and SHA-512 crypt based on Ulrich Drepper's <a href="http://people.redhat.com/drepper/SHA-crypt.txt" class="link external">» implementation</a>. </td> </tr> <tr> <td>5.3.2</td> <td> Fixed Blowfish behaviour on invalid rounds to return "failure" string ("*0" or "*1"), instead of falling back to DES. </td> </tr> <tr> <td>5.3.0</td> <td> PHP now contains its own implementation for the MD5 crypt, Standard DES, Extended DES and the Blowfish algorithms and will use that if the system lacks of support for one or more of the algorithms. </td> </tr> </tbody> </table> </div> <div class="refsect1 examples" id="refsect1-function.crypt-examples"> <h3 class="title">Examples</h3> 
<div class="example" id="example-6028"> <p><strong>Example #1 <span class="function"><strong>crypt()</strong></span> examples</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
$hashed_password = crypt('mypassword'); // let the salt be automatically generated

/* You should pass the entire results of crypt() as the salt for comparing a
   password, to avoid problems when different hashing algorithms are used. (As
   it says above, standard DES-based password hashing uses a 2-character salt,
   but MD5-based hashing uses 12.) */
if (hash_equals($hashed_password, crypt($user_input, $hashed_password))) {
   echo "Password verified!";
}
?&gt;</pre> </div> </div> 
<div class="example" id="example-6029"> <p><strong>Example #2 Using <span class="function"><strong>crypt()</strong></span> with htpasswd</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
// Set the password
$password = 'mypassword';

// Get the hash, letting the salt be automatically generated
$hash = crypt($password);
?&gt;</pre> </div> </div> 
<div class="example" id="example-6030"> <p><strong>Example #3 Using <span class="function"><strong>crypt()</strong></span> with different hash types</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
/* These salts are examples only, and should not be used verbatim in your code.
   You should generate a distinct, correctly-formatted salt for each password.
*/
if (CRYPT_STD_DES == 1) {
    echo 'Standard DES: ' . crypt('rasmuslerdorf', 'rl') . "\n";
}

if (CRYPT_EXT_DES == 1) {
    echo 'Extended DES: ' . crypt('rasmuslerdorf', '_J9..rasm') . "\n";
}

if (CRYPT_MD5 == 1) {
    echo 'MD5:          ' . crypt('rasmuslerdorf', '$1$rasmusle$') . "\n";
}

if (CRYPT_BLOWFISH == 1) {
    echo 'Blowfish:     ' . crypt('rasmuslerdorf', '$2a$07$usesomesillystringforsalt$') . "\n";
}

if (CRYPT_SHA256 == 1) {
    echo 'SHA-256:      ' . crypt('rasmuslerdorf', '$5$rounds=5000$usesomesillystringforsalt$') . "\n";
}

if (CRYPT_SHA512 == 1) {
    echo 'SHA-512:      ' . crypt('rasmuslerdorf', '$6$rounds=5000$usesomesillystringforsalt$') . "\n";
}
?&gt;</pre> </div> <div class="example-contents"><p>The above example will output something similar to:</p></div> <div class="example-contents screen"> <div class="cdata"><pre>
Standard DES: rl.3StKT.4T8M
Extended DES: _J9..rasmBYk8r9AiWNc
MD5:          $1$rasmusle$rISCgZzpwk3UhDidwXvin0
Blowfish:     $2a$07$usesomesillystringfore2uDLvp1Ii2e./U9C8sBjqp8I90dH6hi
SHA-256:      $5$rounds=5000$usesomesillystri$KqJWpanXZHKq2BOB43TSaYhEWsQ1Lr5QNyPCDH/Tp.6
SHA-512:      $6$rounds=5000$usesomesillystri$D4IrlXatmP7rx3P3InaxBeoomnAihCKRVQP22JZ6EY47Wc6BkroIuUUBOov1i.S5KPgErtP/EN5mcO.ChWQW21
</pre></div> </div> </div> </div> <div class="refsect1 notes" id="refsect1-function.crypt-notes"> <h3 class="title">Notes</h3> <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara"> There is no decrypt function, since <span class="function"><strong>crypt()</strong></span> uses a one-way algorithm. </span> </p></blockquote> </div> <div class="refsect1 seealso" id="refsect1-function.crypt-seealso"> <h3 class="title">See Also</h3> 
<ul class="simplelist"> <li class="member"><span class="function"><a href="function.hash-equals" class="function" rel="rdfs-seeAlso">hash_equals()</a> - Timing attack safe string comparison</span></li> <li class="member"><span class="function"><a href="function.password-hash" class="function" rel="rdfs-seeAlso">password_hash()</a> - Creates a password hash</span></li> <li class="member"><span class="function"><a href="function.md5" class="function" rel="rdfs-seeAlso">md5()</a> - Calculate the md5 hash of a string</span></li> <li class="member">The <a href="https://secure.php.net/manual/en/ref.mcrypt.php" class="link">Mcrypt</a> extension</li> <li class="member">The Unix man page for your crypt function for more information</li> </ul> </div> <div class="manualnavbar" style="text-align: center;"> <div class="prev" style="text-align: left; float: left;"><a href="function.crc32">← crc32</a></div> <div class="next" style="text-align: right; float: right;"><a href="function.echo">echo →</a></div>   </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 1997–2018 The PHP Documentation Group<br>Licensed under the Creative Commons Attribution License v3.0 or later.<br>
    <a href="https://secure.php.net/manual/en/function.crypt.php" class="_attribution-link">https://secure.php.net/manual/en/function.crypt.php</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Reline&#58;&#58;Core - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content="Keystrokes of GNU Readline will timeout it with the specification of “keyseq-timeout” when waiting for the 2nd character after the 1st one. If the &hellip;">
  <meta name="keywords" content="class, reline, core, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/reline/core.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/ruby~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="class-Reline::Core" class="class"> class Reline::Core </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object">Object</a></dd>
</dl>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="ATTR_READER_NAMES">ATTR_READER_NAMES </dt>

</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-ambiguous_width"> <span class="method-name">ambiguous_width</span><span class="attribute-access-type">[RW]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-config"> <span class="method-name">config</span><span class="attribute-access-type">[RW]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-key_stroke"> <span class="method-name">key_stroke</span><span class="attribute-access-type">[RW]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-last_incremental_search"> <span class="method-name">last_incremental_search</span><span class="attribute-access-type">[RW]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-line_editor"> <span class="method-name">line_editor</span><span class="attribute-access-type">[RW]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-output"> <span class="method-name">output</span><span class="attribute-access-type">[R]</span> </div>  </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">() { |self| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 43
def initialize
  self.output = STDOUT
  yield self
  @completion_quote_character = nil
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-auto_indent_proc-3D"> <span class="method-name">auto_indent_proc=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="auto_indent_proc-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 116
def auto_indent_proc=(p)
  raise ArgumentError unless p.respond_to?(:call) or p.nil?
  @auto_indent_proc = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-basic_quote_characters-3D"> <span class="method-name">basic_quote_characters=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="basic_quote_characters-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 73
def basic_quote_characters=(v)
  @basic_quote_characters = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-basic_word_break_characters-3D"> <span class="method-name">basic_word_break_characters=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="basic_word_break_characters-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 65
def basic_word_break_characters=(v)
  @basic_word_break_characters = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completer_quote_characters-3D"> <span class="method-name">completer_quote_characters=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completer_quote_characters-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 77
def completer_quote_characters=(v)
  @completer_quote_characters = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completer_word_break_characters-3D"> <span class="method-name">completer_word_break_characters=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completer_word_break_characters-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 69
def completer_word_break_characters=(v)
  @completer_word_break_characters = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completion_append_character-3D"> <span class="method-name">completion_append_character=</span><span class="method-args">(val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completion_append_character-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 53
def completion_append_character=(val)
  if val.nil?
    @completion_append_character = nil
  elsif val.size == 1
    @completion_append_character = val.encode(Reline::IOGate.encoding)
  elsif val.size &gt; 1
    @completion_append_character = val[0].encode(Reline::IOGate.encoding)
  else
    @completion_append_character = nil
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completion_case_fold"> <span class="method-name">completion_case_fold</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completion_case_fold-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 93
def completion_case_fold
  @config.completion_ignore_case
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completion_case_fold-3D"> <span class="method-name">completion_case_fold=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completion_case_fold-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 89
def completion_case_fold=(v)
  @config.completion_ignore_case = v
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completion_proc-3D"> <span class="method-name">completion_proc=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completion_proc-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 101
def completion_proc=(p)
  raise ArgumentError unless p.respond_to?(:call) or p.nil?
  @completion_proc = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-completion_quote_character"> <span class="method-name">completion_quote_character</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="completion_quote_character-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 97
def completion_quote_character
  @completion_quote_character
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-dig_perfect_match_proc-3D"> <span class="method-name">dig_perfect_match_proc=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="dig_perfect_match_proc-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 125
def dig_perfect_match_proc=(p)
  raise ArgumentError unless p.respond_to?(:call) or p.nil?
  @dig_perfect_match_proc = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-emacs_editing_mode"> <span class="method-name">emacs_editing_mode</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="emacs_editing_mode-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 154
def emacs_editing_mode
  config.editing_mode = :emacs
  nil
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-emacs_editing_mode-3F"> <span class="method-name">emacs_editing_mode?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="emacs_editing_mode-3F-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 163
def emacs_editing_mode?
  config.editing_mode_is?(:emacs)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-encoding"> <span class="method-name">encoding</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="encoding-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 49
def encoding
  Reline::IOGate.encoding
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-filename_quote_characters-3D"> <span class="method-name">filename_quote_characters=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="filename_quote_characters-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 81
def filename_quote_characters=(v)
  @filename_quote_characters = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-get_screen_size"> <span class="method-name">get_screen_size</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="get_screen_size-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 167
def get_screen_size
  Reline::IOGate.get_screen_size
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-input-3D"> <span class="method-name">input=</span><span class="method-args">(val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="input-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 130
def input=(val)
  raise TypeError unless val.respond_to?(:getc) or val.nil?
  if val.respond_to?(:getc)
    if defined?(Reline::ANSI) and Reline::IOGate == Reline::ANSI
      Reline::ANSI.input = val
    elsif Reline::IOGate == Reline::GeneralIO
      Reline::GeneralIO.input = val
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-output-3D"> <span class="method-name">output=</span><span class="method-args">(val)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="output-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 141
def output=(val)
  raise TypeError unless val.respond_to?(:write) or val.nil?
  @output = val
  if defined?(Reline::ANSI) and Reline::IOGate == Reline::ANSI
    Reline::ANSI.output = val
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-output_modifier_proc-3D"> <span class="method-name">output_modifier_proc=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="output_modifier_proc-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 106
def output_modifier_proc=(p)
  raise ArgumentError unless p.respond_to?(:call) or p.nil?
  @output_modifier_proc = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pre_input_hook-3D"> <span class="method-name">pre_input_hook=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="pre_input_hook-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 121
def pre_input_hook=(p)
  @pre_input_hook = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-prompt_proc-3D"> <span class="method-name">prompt_proc=</span><span class="method-args">(p)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="prompt_proc-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 111
def prompt_proc=(p)
  raise ArgumentError unless p.respond_to?(:call) or p.nil?
  @prompt_proc = p
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-readline"> <span class="method-name">readline</span><span class="method-args">(prompt = '', add_hist = false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="readline-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 187
def readline(prompt = '', add_hist = false)
  inner_readline(prompt, add_hist, false)

  line = line_editor.line.dup
  line.taint if RUBY_VERSION &lt; '2.7'
  if add_hist and line and line.chomp("\n").size &gt; 0
    Reline::HISTORY &lt;&lt; line.chomp("\n")
  end

  line_editor.reset_line if line_editor.line.nil?
  line
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-readmultiline"> <span class="method-name">readmultiline</span><span class="method-args">(prompt = '', add_hist = false, &amp;confirm_multiline_termination)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="readmultiline-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 171
def readmultiline(prompt = '', add_hist = false, &amp;confirm_multiline_termination)
  unless confirm_multiline_termination
    raise ArgumentError.new('#readmultiline needs block to confirm multiline termination')
  end
  inner_readline(prompt, add_hist, true, &amp;confirm_multiline_termination)

  whole_buffer = line_editor.whole_buffer.dup
  whole_buffer.taint if RUBY_VERSION &lt; '2.7'
  if add_hist and whole_buffer and whole_buffer.chomp("\n").size &gt; 0
    Reline::HISTORY &lt;&lt; whole_buffer
  end

  line_editor.reset_line if line_editor.whole_buffer.nil?
  whole_buffer
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-special_prefixes-3D"> <span class="method-name">special_prefixes=</span><span class="method-args">(v)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="special_prefixes-3D-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 85
def special_prefixes=(v)
  @special_prefixes = v.encode(Reline::IOGate.encoding)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-vi_editing_mode"> <span class="method-name">vi_editing_mode</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="vi_editing_mode-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 149
def vi_editing_mode
  config.editing_mode = :vi_insert
  nil
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-vi_editing_mode-3F"> <span class="method-name">vi_editing_mode?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="vi_editing_mode-3F-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 159
def vi_editing_mode?
  config.editing_mode_is?(:vi_insert, :vi_command)
end</pre> </div>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-inner_readline"> <span class="method-name">inner_readline</span><span class="method-args">(prompt, add_hist, multiline, &amp;confirm_multiline_termination)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="inner_readline-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 200
        def inner_readline(prompt, add_hist, multiline, &amp;confirm_multiline_termination)
  if ENV['RELINE_STDERR_TTY']
    $stderr.reopen(ENV['RELINE_STDERR_TTY'], 'w')
    $stderr.sync = true
    $stderr.puts "Reline is used by #{Process.pid}"
  end
  otio = Reline::IOGate.prep

  may_req_ambiguous_char_width
  line_editor.reset(prompt, encoding: Reline::IOGate.encoding)
  if multiline
    line_editor.multiline_on
    if block_given?
      line_editor.confirm_multiline_termination_proc = confirm_multiline_termination
    end
  else
    line_editor.multiline_off
  end
  line_editor.output = output
  line_editor.completion_proc = completion_proc
  line_editor.completion_append_character = completion_append_character
  line_editor.output_modifier_proc = output_modifier_proc
  line_editor.prompt_proc = prompt_proc
  line_editor.auto_indent_proc = auto_indent_proc
  line_editor.dig_perfect_match_proc = dig_perfect_match_proc
  line_editor.pre_input_hook = pre_input_hook

  unless config.test_mode
    config.read
    config.reset_default_key_bindings
    Reline::IOGate::RAW_KEYSTROKE_CONFIG.each_pair do |key, func|
      config.add_default_key_binding(key, func)
    end
  end

  line_editor.rerender

  begin
    loop do
      read_io(config.keyseq_timeout) { |inputs|
        inputs.each { |c|
          line_editor.input_key(c)
          line_editor.rerender
        }
      }
      break if line_editor.finished?
    end
    Reline::IOGate.move_cursor_column(0)
  rescue Errno::EIO
    # Maybe the I/O has been closed.
  rescue StandardError =&gt; e
    line_editor.finalize
    Reline::IOGate.deprep(otio)
    raise e
  end

  line_editor.finalize
  Reline::IOGate.deprep(otio)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-may_req_ambiguous_char_width"> <span class="method-name">may_req_ambiguous_char_width</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="may_req_ambiguous_char_width-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 339
        def may_req_ambiguous_char_width
  @ambiguous_width = 2 if Reline::IOGate == Reline::GeneralIO or STDOUT.is_a?(File)
  return if ambiguous_width
  Reline::IOGate.move_cursor_column(0)
  begin
    output.write "\u{25bd}"
  rescue Encoding::UndefinedConversionError
    # LANG=C
    @ambiguous_width = 1
  else
    @ambiguous_width = Reline::IOGate.cursor_pos.x
  end
  Reline::IOGate.move_cursor_column(0)
  Reline::IOGate.erase_after_cursor
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-read_escaped_key"> <span class="method-name">read_escaped_key</span><span class="method-args">(keyseq_timeout, c, block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="read_escaped_key-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 318
        def read_escaped_key(keyseq_timeout, c, block)
  begin
    escaped_c = nil
    Timeout.timeout(keyseq_timeout / 1000.0) {
      escaped_c = Reline::IOGate.getc
    }
  rescue Timeout::Error # independent ESC
    block.([Reline::Key.new(c, c, false)])
  else
    if escaped_c.nil?
      block.([Reline::Key.new(c, c, false)])
    elsif escaped_c &gt;= 128 # maybe, first byte of multi byte
      block.([Reline::Key.new(c, c, false), Reline::Key.new(escaped_c, escaped_c, false)])
    elsif escaped_c == "\e".ord # escape twice
      block.([Reline::Key.new(c, c, false), Reline::Key.new(c, c, false)])
    else
      block.([Reline::Key.new(escaped_c, escaped_c | 0b10000000, true)])
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-read_io"> <span class="method-name">read_io</span><span class="method-args">(keyseq_timeout, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="read_io-source"> <pre class="ruby" data-language="ruby"># File lib/reline.rb, line 268
        def read_io(keyseq_timeout, &amp;block)
  buffer = []
  loop do
    c = Reline::IOGate.getc
    buffer &lt;&lt; c
    result = key_stroke.match_status(buffer)
    case result
    when :matched
      expanded = key_stroke.expand(buffer).map{ |expanded_c|
        Reline::Key.new(expanded_c, expanded_c, false)
      }
      block.(expanded)
      break
    when :matching
      if buffer.size == 1
        begin
          succ_c = nil
          Timeout.timeout(keyseq_timeout / 1000.0) {
            succ_c = Reline::IOGate.getc
          }
        rescue Timeout::Error # cancel matching only when first byte
          block.([Reline::Key.new(c, c, false)])
          break
        else
          if key_stroke.match_status(buffer.dup.push(succ_c)) == :unmatched
            if c == "\e".ord
              block.([Reline::Key.new(succ_c, succ_c | 0b10000000, true)])
            else
              block.([Reline::Key.new(c, c, false), Reline::Key.new(succ_c, succ_c, false)])
            end
            break
          else
            Reline::IOGate.ungetc(succ_c)
          end
        end
      end
    when :unmatched
      if buffer.size == 1 and c == "\e".ord
        read_escaped_key(keyseq_timeout, c, block)
      else
        expanded = buffer.map{ |expanded_c|
          Reline::Key.new(expanded_c, expanded_c, false)
        }
        block.(expanded)
      end
      break
    end
  end
end</pre> </div> <p>Keystrokes of GNU <a href="../readline"><code>Readline</code></a> will timeout it with the specification of “keyseq-timeout” when waiting for the 2nd character after the 1st one. If the 2nd character comes after 1st ESC without timeout it has a meta-property of meta-key to discriminate modified key with meta-key from multibyte characters that come with 8th bit on.</p> <p>GNU <a href="../readline"><code>Readline</code></a> will wait for the 2nd character with “keyseq-timeout” milli-seconds but wait forever after 3rd characters.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

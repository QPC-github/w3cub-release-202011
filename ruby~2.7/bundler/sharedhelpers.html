
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Bundler&#58;&#58;SharedHelpers - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Rescues permissions errors raised by file system operations (ie. Errno&#58;EACCESS, Errno&#58;&#58;EAGAIN) and raises more friendly errors instead. ">
  <meta name="keywords" content="module, bundler, sharedhelpers, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/bundler/sharedhelpers.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/ruby~2.7.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="module-Bundler::SharedHelpers" class="module"> module Bundler::SharedHelpers </h1>  <section id="5Buntitled-5D" class="documentation-section"> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-chdir"> <span class="method-name">chdir</span><span class="method-args">(dir, &amp;blk)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="chdir-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 50
def chdir(dir, &amp;blk)
  Bundler.rubygems.ext_lock.synchronize do
    Dir.chdir dir, &amp;blk
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-const_get_safely"> <span class="method-name">const_get_safely</span><span class="method-args">(constant_name, namespace)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="const_get_safely-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 120
def const_get_safely(constant_name, namespace)
  const_in_namespace = namespace.constants.include?(constant_name.to_s) ||
    namespace.constants.include?(constant_name.to_sym)
  return nil unless const_in_namespace
  namespace.const_get(constant_name)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-default_bundle_dir"> <span class="method-name">default_bundle_dir</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_bundle_dir-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 34
def default_bundle_dir
  bundle_dir = find_directory(".bundle")
  return nil unless bundle_dir

  bundle_dir = Pathname.new(bundle_dir)

  global_bundle_dir = Bundler.user_home.join(".bundle")
  return nil if bundle_dir == global_bundle_dir

  bundle_dir
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-default_gemfile"> <span class="method-name">default_gemfile</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_gemfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 19
def default_gemfile
  gemfile = find_gemfile
  raise GemfileNotFound, "Could not locate Gemfile" unless gemfile
  Pathname.new(gemfile).tap{|x| x.untaint if RUBY_VERSION &lt; "2.7" }.expand_path
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-default_lockfile"> <span class="method-name">default_lockfile</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="default_lockfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 25
def default_lockfile
  gemfile = default_gemfile

  case gemfile.basename.to_s
  when "gems.rb" then Pathname.new(gemfile.sub(/.rb$/, ".locked"))
  else Pathname.new("#{gemfile}.lock")
  end.tap{|x| x.untaint if RUBY_VERSION &lt; "2.7" }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-digest"> <span class="method-name">digest</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="digest-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 206
def digest(name)
  require "digest"
  Digest(name)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ensure_same_dependencies"> <span class="method-name">ensure_same_dependencies</span><span class="method-args">(spec, old_deps, new_deps)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ensure_same_dependencies-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 162
def ensure_same_dependencies(spec, old_deps, new_deps)
  new_deps = new_deps.reject {|d| d.type == :development }
  old_deps = old_deps.reject {|d| d.type == :development }

  without_type = proc {|d| Gem::Dependency.new(d.name, d.requirements_list.sort) }
  new_deps.map!(&amp;without_type)
  old_deps.map!(&amp;without_type)

  extra_deps = new_deps - old_deps
  return if extra_deps.empty?

  Bundler.ui.debug "#{spec.full_name} from #{spec.remote} has either corrupted API or lockfile dependencies" \
    " (was expecting #{old_deps.map(&amp;:to_s)}, but the real spec has #{new_deps.map(&amp;:to_s)})"
  raise APIResponseMismatchError,
    "Downloading #{spec.full_name} revealed dependencies not in the API or the lockfile (#{extra_deps.join(", ")})." \
    "\nEither installing with `--full-index` or running `bundle update #{spec.name}` should fix the problem."
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-filesystem_access"> <span class="method-name">filesystem_access</span><span class="method-args">(path, action = :write) { |dup.tap{|x| untaint| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="filesystem_access-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 102
def filesystem_access(path, action = :write, &amp;block)
  yield(path.dup.tap{|x| x.untaint if RUBY_VERSION &lt; "2.7" })
rescue Errno::EACCES
  raise PermissionError.new(path, action)
rescue Errno::EAGAIN
  raise TemporaryResourceError.new(path, action)
rescue Errno::EPROTO
  raise VirtualProtocolError.new
rescue Errno::ENOSPC
  raise NoSpaceOnDeviceError.new(path, action)
rescue *[const_get_safely(:ENOTSUP, Errno)].compact
  raise OperationNotSupportedError.new(path, action)
rescue Errno::EEXIST, Errno::ENOENT
  raise
rescue SystemCallError =&gt; e
  raise GenericSystemCallError.new(e, "There was an error accessing `#{path}`.")
end</pre> </div> <p>Rescues permissions errors raised by file system operations (ie. Errno:EACCESS, Errno::EAGAIN) and raises more friendly errors instead.</p> <p>@param path [String] the path that the action will be attempted to @param action [Symbol, to_s] the type of operation that will be</p> <pre>performed. For example: :write, :read, :exec</pre> <p>@yield path</p> <p>@raise [Bundler::PermissionError] if Errno:EACCES is raised in the</p> <pre class="ruby" data-language="ruby">given block
</pre> <p>@raise [Bundler::TemporaryResourceError] if Errno:EAGAIN is raised in the</p> <pre class="ruby" data-language="ruby">given block
</pre> <p>@example</p> <pre class="ruby" data-language="ruby">filesystem_access("vendor/cache", :write) do
  FileUtils.mkdir_p("vendor/cache")
end
</pre> <p>@see {Bundler::PermissionError}</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-in_bundle-3F"> <span class="method-name">in_bundle?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="in_bundle-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 46
def in_bundle?
  find_gemfile
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-major_deprecation"> <span class="method-name">major_deprecation</span><span class="method-args">(major_version, message, print_caller_location: false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="major_deprecation-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 127
def major_deprecation(major_version, message, print_caller_location: false)
  if print_caller_location
    caller_location = caller_locations(2, 2).first
    message = "#{message} (called at #{caller_location.path}:#{caller_location.lineno})"
  end

  bundler_major_version = Bundler.bundler_major_version
  if bundler_major_version &gt; major_version
    require_relative "errors"
    raise DeprecatedError, "[REMOVED] #{message}"
  end

  return unless bundler_major_version &gt;= major_version &amp;&amp; prints_major_deprecations?
  Bundler.ui.warn("[DEPRECATED] #{message}")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-md5_available-3F"> <span class="method-name">md5_available?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="md5_available-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 193
def md5_available?
  return @md5_available if defined?(@md5_available)
  @md5_available = begin
    require "openssl"
    OpenSSL::Digest::MD5.digest("")
    true
  rescue LoadError
    true
  rescue OpenSSL::Digest::DigestError
    false
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pretty_dependency"> <span class="method-name">pretty_dependency</span><span class="method-args">(dep, print_source = false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="pretty_dependency-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 180
def pretty_dependency(dep, print_source = false)
  msg = String.new(dep.name)
  msg &lt;&lt; " (#{dep.requirement})" unless dep.requirement == Gem::Requirement.default

  if dep.is_a?(Bundler::Dependency)
    platform_string = dep.platforms.join(", ")
    msg &lt;&lt; " " &lt;&lt; platform_string if !platform_string.empty? &amp;&amp; platform_string != Gem::Platform::RUBY
  end

  msg &lt;&lt; " from the `#{dep.source}` source" if print_source &amp;&amp; dep.source
  msg
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-print_major_deprecations-21"> <span class="method-name">print_major_deprecations!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="print_major_deprecations-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 143
def print_major_deprecations!
  multiple_gemfiles = search_up(".") do |dir|
    gemfiles = gemfile_names.select {|gf| File.file? File.expand_path(gf, dir) }
    next if gemfiles.empty?
    break gemfiles.size != 1
  end
  return unless multiple_gemfiles
  message = "Multiple gemfiles (gems.rb and Gemfile) detected. " \
            "Make sure you remove Gemfile and Gemfile.lock since bundler is ignoring them in favor of gems.rb and gems.rb.locked."
  Bundler.ui.warn message
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pwd"> <span class="method-name">pwd</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="pwd-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 56
def pwd
  Bundler.rubygems.ext_lock.synchronize do
    Pathname.pwd
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-root"> <span class="method-name">root</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="root-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 13
def root
  gemfile = find_gemfile
  raise GemfileNotFound, "Could not locate Gemfile" unless gemfile
  Pathname.new(gemfile).tap{|x| x.untaint if RUBY_VERSION &lt; "2.7" }.expand_path.parent
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_bundle_environment"> <span class="method-name">set_bundle_environment</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_bundle_environment-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 75
def set_bundle_environment
  set_bundle_variables
  set_path
  set_rubyopt
  set_rubylib
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_env"> <span class="method-name">set_env</span><span class="method-args">(key, value)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 278
def set_env(key, value)
  raise ArgumentError, "new key #{key}" unless EnvironmentPreserver::BUNDLER_KEYS.include?(key)
  orig_key = "#{EnvironmentPreserver::BUNDLER_PREFIX}#{key}"
  orig = ENV[key]
  orig ||= EnvironmentPreserver::INTENTIONALLY_NIL
  ENV[orig_key] ||= orig

  ENV[key] = value
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-trap"> <span class="method-name">trap</span><span class="method-args">(signal, override = false, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="trap-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 155
def trap(signal, override = false, &amp;block)
  prior = Signal.trap(signal) do
    block.call
    prior.call unless override
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-with_clean_git_env"> <span class="method-name">with_clean_git_env</span><span class="method-args">(&amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="with_clean_git_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 62
def with_clean_git_env(&amp;block)
  keys    = %w[GIT_DIR GIT_WORK_TREE]
  old_env = keys.inject({}) do |h, k|
    h.update(k =&gt; ENV[k])
  end

  keys.each {|key| ENV.delete(key) }

  block.call
ensure
  keys.each {|key| ENV[key] = old_env[key] }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-write_to_gemfile"> <span class="method-name">write_to_gemfile</span><span class="method-args">(gemfile_path, contents)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="write_to_gemfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 211
def write_to_gemfile(gemfile_path, contents)
  filesystem_access(gemfile_path) {|g| File.open(g, "w") {|file| file.puts contents } }
end</pre> </div>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-bundler_ruby_lib"> <span class="method-name">bundler_ruby_lib</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="bundler_ruby_lib-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 325
def bundler_ruby_lib
  resolve_path File.expand_path("../..", __FILE__)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-clean_load_path"> <span class="method-name">clean_load_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="clean_load_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 329
def clean_load_path
  bundler_lib = bundler_ruby_lib

  loaded_gem_paths = Bundler.rubygems.loaded_gem_paths

  $LOAD_PATH.reject! do |p|
    next if resolve_path(p).start_with?(bundler_lib)
    loaded_gem_paths.delete(p)
  end
  $LOAD_PATH.uniq!
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-find_directory"> <span class="method-name">find_directory</span><span class="method-args">(*names)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_directory-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 245
def find_directory(*names)
  search_up(*names) do |dirname|
    return dirname if File.directory?(dirname)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-find_file"> <span class="method-name">find_file</span><span class="method-args">(*names)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_file-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 239
def find_file(*names)
  search_up(*names) do |filename|
    return filename if File.file?(filename)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-find_gemfile"> <span class="method-name">find_gemfile</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_gemfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 229
def find_gemfile
  given = ENV["BUNDLE_GEMFILE"]
  return given if given &amp;&amp; !given.empty?
  find_file(*gemfile_names)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-gemfile_names"> <span class="method-name">gemfile_names</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="gemfile_names-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 235
def gemfile_names
  ["gems.rb", "Gemfile"]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-prints_major_deprecations-3F"> <span class="method-name">prints_major_deprecations?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="prints_major_deprecations-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 348
def prints_major_deprecations?
  require_relative "../bundler"
  return false if Bundler.settings[:silence_deprecations]
  require_relative "deprecate"
  return false if Bundler::Deprecate.skip
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-resolve_path"> <span class="method-name">resolve_path</span><span class="method-args">(path)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="resolve_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 341
def resolve_path(path)
  expanded = File.expand_path(path)
  return expanded unless File.respond_to?(:realpath) &amp;&amp; File.exist?(expanded)

  File.realpath(expanded)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search_up"> <span class="method-name">search_up</span><span class="method-args">(*names) { |filename| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search_up-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 251
def search_up(*names)
  previous = nil
  current  = File.expand_path(SharedHelpers.pwd).tap{|x| x.untaint if RUBY_VERSION &lt; "2.7" }

  until !File.directory?(current) || current == previous
    if ENV["BUNDLE_SPEC_RUN"]
      # avoid stepping above the tmp directory when testing
      gemspec = if ENV["GEM_COMMAND"]
        # for Ruby Core
        "lib/bundler/bundler.gemspec"
      else
        "bundler.gemspec"
      end

      # avoid stepping above the tmp directory when testing
      return nil if File.file?(File.join(current, gemspec))
    end

    names.each do |name|
      filename = File.join(current, name)
      yield filename
    end
    previous = current
    current = File.expand_path("..", current)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_bundle_variables"> <span class="method-name">set_bundle_variables</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_bundle_variables-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 289
def set_bundle_variables
  # bundler exe &amp; lib folders have same root folder, typical gem installation
  exe_file = File.expand_path("../../../exe/bundle", __FILE__)

  # for Ruby core repository testing
  exe_file = File.expand_path("../../../libexec/bundle", __FILE__) unless File.exist?(exe_file)

  # bundler is a default gem, exe path is separate
  exe_file = Bundler.rubygems.bin_path("bundler", "bundle", VERSION) unless File.exist?(exe_file)

  Bundler::SharedHelpers.set_env "BUNDLE_BIN_PATH", exe_file
  Bundler::SharedHelpers.set_env "BUNDLE_GEMFILE", find_gemfile.to_s
  Bundler::SharedHelpers.set_env "BUNDLER_VERSION", Bundler::VERSION
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_path"> <span class="method-name">set_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 304
def set_path
  validate_bundle_path
  paths = (ENV["PATH"] || "").split(File::PATH_SEPARATOR)
  paths.unshift "#{Bundler.bundle_path}/bin"
  Bundler::SharedHelpers.set_env "PATH", paths.uniq.join(File::PATH_SEPARATOR)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_rubylib"> <span class="method-name">set_rubylib</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_rubylib-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 319
def set_rubylib
  rubylib = (ENV["RUBYLIB"] || "").split(File::PATH_SEPARATOR)
  rubylib.unshift bundler_ruby_lib unless RbConfig::CONFIG["rubylibdir"] == bundler_ruby_lib
  Bundler::SharedHelpers.set_env "RUBYLIB", rubylib.uniq.join(File::PATH_SEPARATOR)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set_rubyopt"> <span class="method-name">set_rubyopt</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="set_rubyopt-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 311
def set_rubyopt
  rubyopt = [ENV["RUBYOPT"]].compact
  setup_require = "-r#{File.expand_path("setup", __dir__)}"
  return if !rubyopt.empty? &amp;&amp; rubyopt.first =~ /#{setup_require}/
  rubyopt.unshift setup_require
  Bundler::SharedHelpers.set_env "RUBYOPT", rubyopt.join(" ")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-validate_bundle_path"> <span class="method-name">validate_bundle_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="validate_bundle_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/shared_helpers.rb, line 217
def validate_bundle_path
  path_separator = Bundler.rubygems.path_separator
  return unless Bundler.bundle_path.to_s.split(path_separator).size &gt; 1
  message = "Your bundle path contains text matching #{path_separator.inspect}, " \
            "which is the path separator for your system. Bundler cannot " \
            "function correctly when the Bundle path contains the " \
            "system's PATH separator. Please change your " \
            "bundle path to not match #{path_separator.inspect}." \
            "\nYour current bundle path is '#{Bundler.bundle_path}'."
  raise Bundler::PathError, message
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

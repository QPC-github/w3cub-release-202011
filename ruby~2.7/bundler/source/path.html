
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Bundler&#58;&#58;Source&#58;&#58;Path - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Ruby Core © 1993–2017 Yukihiro MatsumotoLicensed under the Ruby License.Ruby Standard Library © contributorsLicensed under their own licenses. ">
  <meta name="keywords" content="class, bundler, source, path, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/bundler/source/path.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/ruby~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="class-Bundler::Source::Path" class="class"> class Bundler::Source::Path </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../source">Bundler::Source</a></dd>
</dl>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="DEFAULT_GLOB">DEFAULT_GLOB </dt>

</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-name"> <span class="method-name">name</span><span class="attribute-access-type">[W]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-options"> <span class="method-name">options</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-original_path"> <span class="method-name">original_path</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-path"> <span class="method-name">path</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-root_path"> <span class="method-name">root_path</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-version"> <span class="method-name">version</span><span class="attribute-access-type">[RW]</span> </div>  </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-from_lock"> <span class="method-name">from_lock</span><span class="method-args">(options)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="from_lock-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 53
def self.from_lock(options)
  new(options.merge("path" =&gt; options.delete("remote")))
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(options)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 16
def initialize(options)
  @options = options.dup
  @glob = options["glob"] || DEFAULT_GLOB

  @allow_cached = false
  @allow_remote = false

  @root_path = options["root_path"] || root

  if options["path"]
    @path = Pathname.new(options["path"])
    expanded_path = expand(@path)
    @path = if @path.relative?
      expanded_path.relative_path_from(root_path.expand_path)
    else
      expanded_path
    end
  end

  @name    = options["name"]
  @version = options["version"]

  # Stores the original path. If at any point we move to the
  # cached directory, we still have the original path to copy from.
  @original_path = @path
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-3D-3D"> <span class="method-name">==</span><span class="method-args">(other)</span> </div>  <div class="aliases"> Alias for: <a href="path#method-i-eql-3F">eql?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-app_cache_dirname"> <span class="method-name">app_cache_dirname</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="app_cache_dirname-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 116
def app_cache_dirname
  name
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-cache"> <span class="method-name">cache</span><span class="method-args">(spec, custom_path = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="cache-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 90
def cache(spec, custom_path = nil)
  app_cache_path = app_cache_path(custom_path)
  return unless Bundler.feature_flag.cache_all?
  return if expand(@original_path).to_s.index(root_path.to_s + "/") == 0

  unless @original_path.exist?
    raise GemNotFound, "Can't cache gem #{version_message(spec)} because #{self} is missing!"
  end

  FileUtils.rm_rf(app_cache_path)
  FileUtils.cp_r("#{@original_path}/.", app_cache_path)
  FileUtils.touch(app_cache_path.join(".bundlecache"))
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-cached-21"> <span class="method-name">cached!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="cached-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 48
def cached!
  @local_specs = nil
  @allow_cached = true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-eql-3F"> <span class="method-name">eql?</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="eql-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 72
def eql?(other)
  return unless other.class == self.class
  expanded_original_path == other.expanded_original_path &amp;&amp;
    version == other.version
end</pre> </div>  </div> <div class="aliases"> Also aliased as: <a href="path#method-i-3D-3D">==</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-expanded_original_path"> <span class="method-name">expanded_original_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="expanded_original_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 124
def expanded_original_path
  @expanded_original_path ||= expand(original_path)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-hash"> <span class="method-name">hash</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="hash-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 68
def hash
  [self.class, expanded_path, version].hash
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-install"> <span class="method-name">install</span><span class="method-args">(spec, options = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="install-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 84
def install(spec, options = {})
  print_using_message "Using #{version_message(spec)} from #{self}"
  generate_bin(spec, :disable_extensions =&gt; true)
  nil # no post-install message
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-local_specs"> <span class="method-name">local_specs</span><span class="method-args">(*)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="local_specs-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 104
def local_specs(*)
  @local_specs ||= load_spec_files
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-name"> <span class="method-name">name</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="name-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 80
def name
  File.basename(expanded_path.to_s)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-remote-21"> <span class="method-name">remote!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="remote-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 43
def remote!
  @local_specs = nil
  @allow_remote = true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-root"> <span class="method-name">root</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="root-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 120
def root
  Bundler.root
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-specs"> <span class="method-name">specs</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="specs-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 108
def specs
  if has_app_cache?
    @path = app_cache_path
    @expanded_path = nil # Invalidate
  end
  local_specs
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_lock"> <span class="method-name">to_lock</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_lock-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 57
def to_lock
  out = String.new("PATH\n")
  out &lt;&lt; "  remote: #{lockfile_path}\n"
  out &lt;&lt; "  glob: #{@glob}\n" unless @glob == DEFAULT_GLOB
  out &lt;&lt; "  specs:\n"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_s"> <span class="method-name">to_s</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="to_s-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 64
def to_s
  "source at `#{@path}`"
end</pre> </div>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-app_cache_path"> <span class="method-name">app_cache_path</span><span class="method-args">(custom_path = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="app_cache_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 147
def app_cache_path(custom_path = nil)
  @app_cache_path ||= Bundler.app_cache(custom_path).join(app_cache_dirname)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-expand"> <span class="method-name">expand</span><span class="method-args">(somepath)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="expand-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 134
def expand(somepath)
  somepath.expand_path(root_path)
rescue ArgumentError =&gt; e
  Bundler.ui.debug(e)
  raise PathError, "There was an error while trying to use the path " \
    "`#{somepath}`.\nThe error message was: #{e.message}."
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-expanded_path"> <span class="method-name">expanded_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="expanded_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 130
def expanded_path
  @expanded_path ||= expand(path)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-generate_bin"> <span class="method-name">generate_bin</span><span class="method-args">(spec, options = {})</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="generate_bin-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 216
def generate_bin(spec, options = {})
  gem_dir = Pathname.new(spec.full_gem_path)

  # Some gem authors put absolute paths in their gemspec
  # and we have to save them from themselves
  spec.files = spec.files.map do |p|
    next p unless p =~ /\A#{Pathname::SEPARATOR_PAT}/
    next if File.directory?(p)
    begin
      Pathname.new(p).relative_path_from(gem_dir).to_s
    rescue ArgumentError
      p
    end
  end.compact

  installer = Path::Installer.new(
    spec,
    :env_shebang =&gt; false,
    :disable_extensions =&gt; options[:disable_extensions],
    :build_args =&gt; options[:build_args],
    :bundler_extension_cache_path =&gt; extension_cache_path(spec)
  )
  installer.post_install
rescue Gem::InvalidSpecificationException =&gt; e
  Bundler.ui.warn "\n#{spec.name} at #{spec.full_gem_path} did not have a valid gemspec.\n" \
                  "This prevents bundler from installing bins or native extensions, but " \
                  "that may not affect its functionality."

  if !spec.extensions.empty? &amp;&amp; !spec.email.empty?
    Bundler.ui.warn "If you need to use this package without installing it from a gem " \
                    "repository, please contact #{spec.email} and ask them " \
                    "to modify their .gemspec so it can work with `gem build`."
  end

  Bundler.ui.warn "The validation message from RubyGems was:\n  #{e.message}"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-has_app_cache-3F"> <span class="method-name">has_app_cache?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="has_app_cache-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 151
def has_app_cache?
  SharedHelpers.in_bundle? &amp;&amp; app_cache_path.exist?
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-load_gemspec"> <span class="method-name">load_gemspec</span><span class="method-args">(file)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="load_gemspec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 155
def load_gemspec(file)
  return unless spec = Bundler.load_gemspec(file)
  Bundler.rubygems.set_installed_by_version(spec)
  spec
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-load_spec_files"> <span class="method-name">load_spec_files</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="load_spec_files-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 165
def load_spec_files
  index = Index.new

  if File.directory?(expanded_path)
    # We sort depth-first since `&lt;&lt;` will override the earlier-found specs
    Dir["#{expanded_path}/#{@glob}"].sort_by {|p| -p.split(File::SEPARATOR).size }.each do |file|
      next unless spec = load_gemspec(file)
      spec.source = self

      # Validation causes extension_dir to be calculated, which depends
      # on #source, so we validate here instead of load_gemspec
      validate_spec(spec)
      index &lt;&lt; spec
    end

    if index.empty? &amp;&amp; @name &amp;&amp; @version
      index &lt;&lt; Gem::Specification.new do |s|
        s.name     = @name
        s.source   = self
        s.version  = Gem::Version.new(@version)
        s.platform = Gem::Platform::RUBY
        s.summary  = "Fake gemspec for #{@name}"
        s.relative_loaded_from = "#{@name}.gemspec"
        s.authors = ["no one"]
        if expanded_path.join("bin").exist?
          executables = expanded_path.join("bin").children
          executables.reject! {|p| File.directory?(p) }
          s.executables = executables.map {|c| c.basename.to_s }
        end
      end
    end
  else
    message = String.new("The path `#{expanded_path}` ")
    message &lt;&lt; if File.exist?(expanded_path)
      "is not a directory."
    else
      "does not exist."
    end
    raise PathError, message
  end

  index
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-lockfile_path"> <span class="method-name">lockfile_path</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="lockfile_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 142
def lockfile_path
  return relative_path(original_path) if original_path.absolute?
  expand(original_path).relative_path_from(root)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-relative_path"> <span class="method-name">relative_path</span><span class="method-args">(path = self.path)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="relative_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 209
def relative_path(path = self.path)
  if path.to_s.start_with?(root_path.to_s)
    return path.relative_path_from(root_path)
  end
  path
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-validate_spec"> <span class="method-name">validate_spec</span><span class="method-args">(spec)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="validate_spec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/source/path.rb, line 161
def validate_spec(spec)
  Bundler.rubygems.validate(spec)
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Bundler&#58;&#58;Thor&#58;&#58;Util - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" This module holds several utilities&#58; ">
  <meta name="keywords" content="module, bundler, thor, util, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/bundler/thor/util.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/ruby~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="module-Bundler::Thor::Util" class="module"> module Bundler::Thor::Util </h1> <section class="description"> <p>This module holds several utilities:</p> <p>1) Methods to convert thor namespaces to constants and vice-versa.</p> <pre class="ruby" data-language="ruby">Bundler::Thor::Util.namespace_from_thor_class(Foo::Bar::Baz) #=&gt; "foo:bar:baz"
</pre> <p>2) Loading thor files and sandboxing:</p> <pre class="ruby" data-language="ruby">Bundler::Thor::Util.load_thorfile("~/.thor/foo")
</pre> </section> <section id="5Buntitled-5D" class="documentation-section"> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-camel_case"> <span class="method-name">camel_case</span><span class="method-args">(str)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="camel_case-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 104
def camel_case(str)
  return str if str !~ /_/ &amp;&amp; str =~ /[A-Z]+.*/
  str.split("_").map(&amp;:capitalize).join
end</pre> </div> <p>Receives a string and convert it to camel case. <a href="util#method-c-camel_case"><code>camel_case</code></a> returns CamelCase.</p> <h4 id="method-c-camel_case-label-Parameters">Parameters</h4> <p><a href="../../string"><code>String</code></a></p> <h4 id="method-c-camel_case-label-Returns">Returns</h4> <p><a href="../../string"><code>String</code></a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-escape_globs"> <span class="method-name">escape_globs</span><span class="method-args">(path)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="escape_globs-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 263
def escape_globs(path)
  path.to_s.gsub(/[*?{}\[\]]/, '\\\\\\&amp;')
end</pre> </div> <p>Returns a string that has had any glob characters escaped. The glob characters are `* ? { } [ ]`.</p> <h4 id="method-c-escape_globs-label-Examples">Examples</h4> <pre class="ruby" data-language="ruby">Bundler::Thor::Util.escape_globs('[apps]')   # =&gt; '\[apps\]'
</pre> <h4 id="method-c-escape_globs-label-Parameters">Parameters</h4> <p><a href="../../string"><code>String</code></a></p> <h4 id="method-c-escape_globs-label-Returns">Returns</h4> <p><a href="../../string"><code>String</code></a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-escape_html"> <span class="method-name">escape_html</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="escape_html-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 279
def escape_html(string)
  CGI.escapeHTML(string)
end</pre> </div> <p>Returns a string that has had any HTML characters escaped.</p> <h4 id="method-c-escape_html-label-Examples">Examples</h4> <pre class="ruby" data-language="ruby">Bundler::Thor::Util.escape_html('&lt;div&gt;')   # =&gt; "&amp;lt;div&amp;gt;"
</pre> <h4 id="method-c-escape_html-label-Parameters">Parameters</h4> <p><a href="../../string"><code>String</code></a></p> <h4 id="method-c-escape_html-label-Returns">Returns</h4> <p><a href="../../string"><code>String</code></a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-find_by_namespace"> <span class="method-name">find_by_namespace</span><span class="method-args">(namespace)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_by_namespace-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 24
def find_by_namespace(namespace)
  namespace = "default#{namespace}" if namespace.empty? || namespace =~ /^:/
  Bundler::Thor::Base.subclasses.detect { |klass| klass.namespace == namespace }
end</pre> </div> <p>Receives a namespace and search for it in the <a href="base"><code>Bundler::Thor::Base</code></a> subclasses.</p> <h4 id="method-c-find_by_namespace-label-Parameters">Parameters</h4> <dl class="rdoc-list note-list">
<dt>namespace&lt;String&gt; </dt>
<dd> <p>The namespace to search for.</p> </dd>
</dl>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-find_class_and_command_by_namespace"> <span class="method-name">find_class_and_command_by_namespace</span><span class="method-args">(namespace, fallback = true)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="find_class_and_command_by_namespace-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 131
def find_class_and_command_by_namespace(namespace, fallback = true)
  if namespace.include?(":") # look for a namespaced command
    pieces  = namespace.split(":")
    command = pieces.pop
    klass   = Bundler::Thor::Util.find_by_namespace(pieces.join(":"))
  end
  unless klass # look for a Bundler::Thor::Group with the right name
    klass = Bundler::Thor::Util.find_by_namespace(namespace)
    command = nil
  end
  if !klass &amp;&amp; fallback # try a command in the default namespace
    command = namespace
    klass   = Bundler::Thor::Util.find_by_namespace("")
  end
  [klass, command]
end</pre> </div> <p>Receives a namespace and tries to retrieve a Bundler::Thor or <a href="group"><code>Bundler::Thor::Group</code></a> class from it. It first searches for a class using the all the given namespace, if it's not found, removes the highest entry and searches for the class again. If found, returns the highest entry as the class name.</p> <h4 id="method-c-find_class_and_command_by_namespace-label-Examples">Examples</h4> <pre class="ruby" data-language="ruby">class Foo::Bar &lt; Bundler::Thor
  def baz
  end
end

class Baz::Foo &lt; Bundler::Thor::Group
end

Bundler::Thor::Util.namespace_to_thor_class("foo:bar")     #=&gt; Foo::Bar, nil # will invoke default command
Bundler::Thor::Util.namespace_to_thor_class("baz:foo")     #=&gt; Baz::Foo, nil
Bundler::Thor::Util.namespace_to_thor_class("foo:bar:baz") #=&gt; Foo::Bar, "baz"
</pre> <h4 id="method-c-find_class_and_command_by_namespace-label-Parameters">Parameters</h4> <p>namespace&lt;String&gt;</p>  </div> <div class="aliases"> Also aliased as: <a href="util#method-c-find_class_and_task_by_namespace">find_class_and_task_by_namespace</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-c-find_class_and_task_by_namespace"> <span class="method-name">find_class_and_task_by_namespace</span><span class="method-args">(namespace, fallback = true)</span> </div>  <div class="aliases"> Alias for: <a href="util#method-c-find_class_and_command_by_namespace">find_class_and_command_by_namespace</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-globs_for"> <span class="method-name">globs_for</span><span class="method-args">(path)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="globs_for-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 212
def globs_for(path)
  path = escape_globs(path)
  ["#{path}/Thorfile", "#{path}/*.thor", "#{path}/tasks/*.thor", "#{path}/lib/tasks/*.thor"]
end</pre> </div> <p>Where to look for Bundler::Thor files.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-load_thorfile"> <span class="method-name">load_thorfile</span><span class="method-args">(path, content = nil, debug = false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="load_thorfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 152
def load_thorfile(path, content = nil, debug = false)
  content ||= File.binread(path)

  begin
    Bundler::Thor::Sandbox.class_eval(content, path)
  rescue StandardError =&gt; e
    $stderr.puts("WARNING: unable to load thorfile #{path.inspect}: #{e.message}")
    if debug
      $stderr.puts(*e.backtrace)
    else
      $stderr.puts(e.backtrace.first)
    end
  end
end</pre> </div> <p>Receives a path and load the thor file in the path. The file is evaluated inside the sandbox to avoid namespacing conflicts.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-namespace_from_thor_class"> <span class="method-name">namespace_from_thor_class</span><span class="method-args">(constant)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="namespace_from_thor_class-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 43
def namespace_from_thor_class(constant)
  constant = constant.to_s.gsub(/^Bundler::Thor::Sandbox::/, "")
  constant = snake_case(constant).squeeze(":")
  constant
end</pre> </div> <p>Receives a constant and converts it to a Bundler::Thor namespace. Since Bundler::Thor commands can be added to a sandbox, this method is also responsible for removing the sandbox namespace.</p> <p>This method should not be used in general because it's used to deal with older versions of Bundler::Thor. On current versions, if you need to get the namespace from a class, just call namespace on it.</p> <h4 id="method-c-namespace_from_thor_class-label-Parameters">Parameters</h4> <dl class="rdoc-list note-list">
<dt>constant&lt;Object&gt; </dt>
<dd> <p>The constant to be converted to the thor path.</p> </dd>
</dl> <h4 id="method-c-namespace_from_thor_class-label-Returns">Returns</h4> <dl class="rdoc-list note-list">
<dt>
<a href="../../string"><code>String</code></a> </dt>
<dd> <p>If we receive Foo::Bar::Baz it returns “foo:bar:baz”</p> </dd>
</dl>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-namespaces_in_content"> <span class="method-name">namespaces_in_content</span><span class="method-args">(contents, file = __FILE__)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="namespaces_in_content-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 58
def namespaces_in_content(contents, file = __FILE__)
  old_constants = Bundler::Thor::Base.subclasses.dup
  Bundler::Thor::Base.subclasses.clear

  load_thorfile(file, contents)

  new_constants = Bundler::Thor::Base.subclasses.dup
  Bundler::Thor::Base.subclasses.replace(old_constants)

  new_constants.map!(&amp;:namespace)
  new_constants.compact!
  new_constants
end</pre> </div> <p>Given the contents, evaluate it inside the sandbox and returns the namespaces defined in the sandbox.</p> <h4 id="method-c-namespaces_in_content-label-Parameters">Parameters</h4> <p>contents&lt;String&gt;</p> <h4 id="method-c-namespaces_in_content-label-Returns">Returns</h4> <p><span>Array</span></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-ruby_command"> <span class="method-name">ruby_command</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="ruby_command-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 220
def ruby_command
  @ruby_command ||= begin
    ruby_name = RbConfig::CONFIG["ruby_install_name"]
    ruby = File.join(RbConfig::CONFIG["bindir"], ruby_name)
    ruby &lt;&lt; RbConfig::CONFIG["EXEEXT"]

    # avoid using different name than ruby (on platforms supporting links)
    if ruby_name != "ruby" &amp;&amp; File.respond_to?(:readlink)
      begin
        alternate_ruby = File.join(RbConfig::CONFIG["bindir"], "ruby")
        alternate_ruby &lt;&lt; RbConfig::CONFIG["EXEEXT"]

        # ruby is a symlink
        if File.symlink? alternate_ruby
          linked_ruby = File.readlink alternate_ruby

          # symlink points to 'ruby_install_name'
          ruby = alternate_ruby if linked_ruby == ruby_name || linked_ruby == ruby
        end
      rescue NotImplementedError # rubocop:disable HandleExceptions
        # just ignore on windows
      end
    end

    # escape string in case path to ruby executable contain spaces.
    ruby.sub!(/.*\s.*/m, '"\&amp;"')
    ruby
  end
end</pre> </div> <p>Return the path to the ruby interpreter taking into account multiple installations and windows extensions.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-snake_case"> <span class="method-name">snake_case</span><span class="method-args">(str)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="snake_case-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 90
def snake_case(str)
  return str.downcase if str =~ /^[A-Z_]+$/
  str.gsub(/\B[A-Z]/, '_\&amp;').squeeze("_") =~ /_*(.*)/
  $+.downcase
end</pre> </div> <p>Receives a string and convert it to snake case. SnakeCase returns snake_case.</p> <h4 id="method-c-snake_case-label-Parameters">Parameters</h4> <p><a href="../../string"><code>String</code></a></p> <h4 id="method-c-snake_case-label-Returns">Returns</h4> <p><a href="../../string"><code>String</code></a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-thor_classes_in"> <span class="method-name">thor_classes_in</span><span class="method-args">(klass)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="thor_classes_in-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 74
def thor_classes_in(klass)
  stringfied_constants = klass.constants.map(&amp;:to_s)
  Bundler::Thor::Base.subclasses.select do |subclass|
    next unless subclass.name
    stringfied_constants.include?(subclass.name.gsub("#{klass.name}::", ""))
  end
end</pre> </div> <p>Returns the thor classes declared inside the given class.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-thor_root"> <span class="method-name">thor_root</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="thor_root-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 191
def thor_root
  File.join(user_home, ".thor").tr('\\', "/")
end</pre> </div> <p>Returns the root where thor files are located, depending on the OS.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-thor_root_glob"> <span class="method-name">thor_root_glob</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="thor_root_glob-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 202
def thor_root_glob
  files = Dir["#{escape_globs(thor_root)}/*"]

  files.map! do |file|
    File.directory?(file) ? File.join(file, "main.thor") : file
  end
end</pre> </div> <p>Returns the files in the thor root. On Windows <a href="util#method-c-thor_root"><code>thor_root</code></a> will be something like this:</p> <pre>C:\Documents and Settings\james\.thor</pre> <p>If we don't gsub the \ character, <a href="../../dir#method-c-glob"><code>Dir.glob</code></a> will fail.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-user_home"> <span class="method-name">user_home</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="user_home-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/vendor/thor/lib/thor/util.rb, line 167
def user_home
  @@user_home ||= if ENV["HOME"]
    ENV["HOME"]
  elsif ENV["USERPROFILE"]
    ENV["USERPROFILE"]
  elsif ENV["HOMEDRIVE"] &amp;&amp; ENV["HOMEPATH"]
    File.join(ENV["HOMEDRIVE"], ENV["HOMEPATH"])
  elsif ENV["APPDATA"]
    ENV["APPDATA"]
  else
    begin
      File.expand_path("~")
    rescue
      if File::ALT_SEPARATOR
        "C:/"
      else
        "/"
      end
    end
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

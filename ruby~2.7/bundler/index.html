
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Bundler - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Whether all the specs in self are in other TODO&#58; rename to include? ">
  <meta name="keywords" content="class, bundler, index, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/bundler/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/ruby~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="class-Bundler::Index" class="class"> class Bundler::Index </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="../enumerable">Enumerable</a></dd>
</dl>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="EMPTY_SEARCH">EMPTY_SEARCH </dt>

<dt id="NULL">NULL </dt>

<dt id="RUBY">RUBY </dt>

</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-all_specs"> <span class="method-name">all_specs</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-sources"> <span class="method-name">sources</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-specs"> <span class="method-name">specs</span><span class="attribute-access-type">[R]</span> </div>  </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-build"> <span class="method-name">build</span><span class="method-args">() { |i| ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="build-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 9
def self.build
  i = new
  yield i
  i
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 21
def initialize
  @sources = []
  @cache = {}
  @specs = Hash.new {|h, k| h[k] = {} }
  @all_specs = Hash.new {|h, k| h[k] = EMPTY_SEARCH }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-sort_specs"> <span class="method-name">sort_specs</span><span class="method-args">(specs)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="sort_specs-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 80
def self.sort_specs(specs)
  specs.sort_by do |s|
    platform_string = s.platform.to_s
    [s.version, platform_string == RUBY ? NULL : platform_string]
  end
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-3C-3C"> <span class="method-name">&lt;&lt;</span><span class="method-args">(spec)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3C-3C-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 104
def &lt;&lt;(spec)
  @specs[spec.name][spec.full_name] = spec
  spec
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3D-3D"> <span class="method-name">==</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="3D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 163
def ==(other)
  all? do |spec|
    other_spec = other[spec].first
    other_spec &amp;&amp; dependencies_eql?(spec, other_spec) &amp;&amp; spec.source == other_spec.source
  end
end</pre> </div> <p>Whether all the specs in self are in other TODO: rename to <a href="../enumerable#method-i-include-3F"><code>include?</code></a></p>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-5B-5D"> <span class="method-name">[]</span><span class="method-args">(query, base = nil)</span> </div>  <div class="aliases"> Alias for: <a href="index#method-i-search">search</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-add_source"> <span class="method-name">add_source</span><span class="method-args">(index)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="add_source-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 176
def add_source(index)
  raise ArgumentError, "Source must be an index, not #{index.class}" unless index.is_a?(Index)
  @sources &lt;&lt; index
  @sources.uniq! # need to use uniq! here instead of checking for the item before adding
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-dependencies_eql-3F"> <span class="method-name">dependencies_eql?</span><span class="method-args">(spec, other_spec)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="dependencies_eql-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 170
def dependencies_eql?(spec, other_spec)
  deps       = spec.dependencies.select {|d| d.type != :development }
  other_deps = other_spec.dependencies.select {|d| d.type != :development }
  Set.new(deps) == Set.new(other_deps)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-dependency_names"> <span class="method-name">dependency_names</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="dependency_names-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 131
def dependency_names
  names = []
  each do |spec|
    spec.dependencies.each do |dep|
      next if dep.type == :development
      names &lt;&lt; dep.name
    end
  end
  names.uniq
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-each"> <span class="method-name">each</span><span class="method-args">(&amp;blk)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="each-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 109
def each(&amp;blk)
  return enum_for(:each) unless blk
  specs.values.each do |spec_sets|
    spec_sets.values.each(&amp;blk)
  end
  sources.each {|s| s.each(&amp;blk) }
  self
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-empty-3F"> <span class="method-name">empty?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="empty-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 46
def empty?
  each { return false }
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-initialize_copy"> <span class="method-name">initialize_copy</span><span class="method-args">(o)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="initialize_copy-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 28
def initialize_copy(o)
  @sources = o.sources.dup
  @cache = {}
  @specs = Hash.new {|h, k| h[k] = {} }
  @all_specs = Hash.new {|h, k| h[k] = EMPTY_SEARCH }

  o.specs.each do |name, hash|
    @specs[name] = hash.dup
  end
  o.all_specs.each do |name, array|
    @all_specs[name] = array.dup
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-inspect"> <span class="method-name">inspect</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="inspect-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 42
def inspect
  "#&lt;#{self.class}:0x#{object_id} sources=#{sources.map(&amp;:inspect)} specs.size=#{specs.size}&gt;"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-local_search"> <span class="method-name">local_search</span><span class="method-args">(query, base = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="local_search-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 91
def local_search(query, base = nil)
  case query
  when Gem::Specification, RemoteSpecification, LazySpecification, EndpointSpecification then search_by_spec(query)
  when String then specs_by_name(query)
  when Gem::Dependency then search_by_dependency(query, base)
  when DepProxy then search_by_dependency(query.dep, base)
  else
    raise "You can't search for a #{query.inspect}."
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search"> <span class="method-name">search</span><span class="method-args">(query, base = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 61
def search(query, base = nil)
  sort_specs(unsorted_search(query, base))
end</pre> </div> <p>Search this index's specs, and any source indexes that this index knows about, returning all of the results.</p>  </div> <div class="aliases"> Also aliased as: <a href="index#method-i-5B-5D">[]</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search_all"> <span class="method-name">search_all</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search_all-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 51
def search_all(name)
  all_matches = local_search(name) + @all_specs[name]
  @sources.each do |source|
    all_matches.concat(source.search_all(name))
  end
  all_matches
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-size"> <span class="method-name">size</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="size-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 155
def size
  @sources.inject(@specs.size) do |size, source|
    size += source.size
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-sort_specs"> <span class="method-name">sort_specs</span><span class="method-args">(specs)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="sort_specs-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 87
def sort_specs(specs)
  self.class.sort_specs(specs)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-spec_names"> <span class="method-name">spec_names</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="spec_names-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 118
def spec_names
  names = specs.keys + sources.map(&amp;:spec_names)
  names.uniq!
  names
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unmet_dependency_names"> <span class="method-name">unmet_dependency_names</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unmet_dependency_names-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 125
def unmet_dependency_names
  dependency_names.select do |name|
    name != "bundler" &amp;&amp; search(name).empty?
  end
end</pre> </div> <p>returns a list of the dependencies</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-use"> <span class="method-name">use</span><span class="method-args">(other, override_dupes = false)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="use-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 142
def use(other, override_dupes = false)
  return unless other
  other.each do |s|
    if (dupes = search_by_spec(s)) &amp;&amp; !dupes.empty?
      # safe to &lt;&lt; since it's a new array when it has contents
      @all_specs[s.name] = dupes &lt;&lt; s
      next unless override_dupes
    end
    self &lt;&lt; s
  end
  self
end</pre> </div>  </div> </div> </section> <section id="protected-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Protected Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-unsorted_search"> <span class="method-name">unsorted_search</span><span class="method-args">(query, base)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unsorted_search-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 65
def unsorted_search(query, base)
  results = local_search(query, base)

  seen = results.map(&amp;:full_name).to_set unless @sources.empty?

  @sources.each do |source|
    source.unsorted_search(query, base).each do |spec|
      results &lt;&lt; spec if seen.add?(spec.full_name)
    end
  end

  results
end</pre> </div>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-search_by_dependency"> <span class="method-name">search_by_dependency</span><span class="method-args">(dependency, base = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search_by_dependency-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 188
def search_by_dependency(dependency, base = nil)
  @cache[base || false] ||= {}
  @cache[base || false][dependency] ||= begin
    specs = specs_by_name(dependency.name)
    specs += base if base
    found = specs.select do |spec|
      next true if spec.source.is_a?(Source::Gemspec)
      if base # allow all platforms when searching from a lockfile
        dependency.matches_spec?(spec)
      else
        dependency.matches_spec?(spec) &amp;&amp; Gem::Platform.match(spec.platform)
      end
    end

    found
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-search_by_spec"> <span class="method-name">search_by_spec</span><span class="method-args">(spec)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="search_by_spec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 208
def search_by_spec(spec)
  spec = @specs[spec.name][spec.full_name]
  spec ? [spec] : EMPTY_SEARCH
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-specs_by_name"> <span class="method-name">specs_by_name</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="specs_by_name-source"> <pre class="ruby" data-language="ruby"># File lib/bundler/index.rb, line 184
def specs_by_name(name)
  @specs[name].values
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

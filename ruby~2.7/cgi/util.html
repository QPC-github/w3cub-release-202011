
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CGI&#58;&#58;Util - Ruby 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Abbreviated day-of-week names specified by RFC 822 ">
  <meta name="keywords" content="module, cgi, util, ruby, ruby~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ruby~2.7/cgi/util.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/ruby~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.7/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="module-CGI::Util" class="module"> module CGI::Util </h1>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="RFC822_DAYS">RFC822_DAYS </dt>
<dd>
<p>Abbreviated day-of-week names specified by RFC 822</p> </dd>
<dt id="RFC822_MONTHS">RFC822_MONTHS </dt>
<dd>
<p>Abbreviated month names specified by RFC 822</p> </dd>
<dt id="TABLE_FOR_ESCAPE_HTML__">TABLE_FOR_ESCAPE_HTML__ </dt>
<dd>
<p>The set of special characters and their escaped values</p> </dd>
</dl> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-escape"> <span class="method-name">escape</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="escape-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 12
def escape(string)
  encoding = string.encoding
  string.b.gsub(/([^ a-zA-Z0-9_.\-~]+)/) do |m|
    '%' + m.unpack('H2' * m.bytesize).join('%').upcase
  end.tr(' ', '+').force_encoding(encoding)
end</pre> </div> <p>URL-encode a string.</p> <pre class="ruby" data-language="ruby">url_encoded_string = CGI.escape("'Stop!' said Fred")
   # =&gt; "%27Stop%21%27+said+Fred"
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-escapeElement"> <span class="method-name">escapeElement</span><span class="method-args">(string, *elements)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="escapeElement-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 140
def escapeElement(string, *elements)
  elements = elements[0] if elements[0].kind_of?(Array)
  unless elements.empty?
    string.gsub(/&lt;\/?(?:#{elements.join("|")})(?!\w)(?:.|\n)*?&gt;/i) do
      CGI.escapeHTML($&amp;)
    end
  else
    string
  end
end</pre> </div> <p>Escape only the tags of certain HTML elements in <code>string</code>.</p> <p>Takes an element or elements or array of elements. Each element is specified by the name of the element, without angle brackets. This matches both the start and the end tag of that element. The attribute list of the open tag will also be escaped (for instance, the double-quotes surrounding attribute values).</p> <pre class="ruby" data-language="ruby">print CGI.escapeElement('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;', "A", "IMG")
  # "&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt"

print CGI.escapeElement('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;', ["A", "IMG"])
  # "&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt"
</pre>  </div> <div class="aliases"> Also aliased as: <a href="util#method-i-escape_element">escape_element</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-escapeHTML"> <span class="method-name">escapeHTML</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="escapeHTML-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 41
def escapeHTML(string)
  enc = string.encoding
  unless enc.ascii_compatible?
    if enc.dummy?
      origenc = enc
      enc = Encoding::Converter.asciicompat_encoding(enc)
      string = enc ? string.encode(enc) : string.b
    end
    table = Hash[TABLE_FOR_ESCAPE_HTML__.map {|pair|pair.map {|s|s.encode(enc)}}]
    string = string.gsub(/#{"['&amp;\"&lt;&gt;]".encode(enc)}/, table)
    string.encode!(origenc) if origenc
    return string
  end
  string.gsub(/['&amp;\"&lt;&gt;]/, TABLE_FOR_ESCAPE_HTML__)
end</pre> </div> <p>Escape special characters in HTML, namely '&amp;"&lt;&gt;</p> <pre class="ruby" data-language="ruby">CGI.escapeHTML('Usage: foo "bar" &lt;baz&gt;')
   # =&gt; "Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;"
</pre>  </div> <div class="aliases"> Also aliased as: <a href="util#method-i-escape_html">escape_html</a>, <a href="util#method-i-h">h</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-escape_element"> <span class="method-name">escape_element</span><span class="method-args">(string, *elements)</span> </div> <div class="method-description"> <p>Synonym for <a href="util#method-i-escapeElement"><code>CGI.escapeElement(str)</code></a></p> </div> <div class="aliases"> Alias for: <a href="util#method-i-escapeElement">escapeElement</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-escape_html"> <span class="method-name">escape_html</span><span class="method-args">(string)</span> </div> <div class="method-description"> <p>Synonym for <a href="util#method-i-escapeHTML"><code>CGI.escapeHTML(str)</code></a></p> </div> <div class="aliases"> Alias for: <a href="util#method-i-escapeHTML">escapeHTML</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-h"> <span class="method-name">h</span><span class="method-args">(string)</span> </div>  <div class="aliases"> Alias for: <a href="util#method-i-escapeHTML">escapeHTML</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pretty"> <span class="method-name">pretty</span><span class="method-args">(string, shift = " ")</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="pretty-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 211
def pretty(string, shift = "  ")
  lines = string.gsub(/(?!\A)&lt;.*?&gt;/m, "\n\\0").gsub(/&lt;.*?&gt;(?!\n)/m, "\\0\n")
  end_pos = 0
  while end_pos = lines.index(/^&lt;\/(\w+)/, end_pos)
    element = $1.dup
    start_pos = lines.rindex(/^\s*&lt;#{element}/i, end_pos)
    lines[start_pos ... end_pos] = "__" + lines[start_pos ... end_pos].gsub(/\n(?!\z)/, "\n" + shift) + "__"
  end
  lines.gsub(/^((?:#{Regexp::quote(shift)})*)__(?=&lt;\/?\w)/, '\1')
end</pre> </div> <p>Prettify (indent) an HTML string.</p> <p><code>string</code> is the HTML string to indent. <code>shift</code> is the indentation unit to use; it defaults to two spaces.</p> <pre class="ruby" data-language="ruby">print CGI.pretty("&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;")
  # &lt;HTML&gt;
  #   &lt;BODY&gt;
  #   &lt;/BODY&gt;
  # &lt;/HTML&gt;

print CGI.pretty("&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;", "\t")
  # &lt;HTML&gt;
  #         &lt;BODY&gt;
  #         &lt;/BODY&gt;
  # &lt;/HTML&gt;
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-rfc1123_date"> <span class="method-name">rfc1123_date</span><span class="method-args">(time)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="rfc1123_date-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 187
def rfc1123_date(time)
  t = time.clone.gmtime
  return format("%s, %.2d %s %.4d %.2d:%.2d:%.2d GMT",
                RFC822_DAYS[t.wday], t.day, RFC822_MONTHS[t.month-1], t.year,
                t.hour, t.min, t.sec)
end</pre> </div> <p>Format a <code>Time</code> object as a <a href="../string"><code>String</code></a> using the format specified by RFC 1123.</p> <pre class="ruby" data-language="ruby">CGI.rfc1123_date(Time.now)
  # Sat, 01 Jan 2000 00:00:00 GMT
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescape"> <span class="method-name">unescape</span><span class="method-args">(string,encoding=@@accept_charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unescape-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 22
def unescape(string,encoding=@@accept_charset)
  str=string.tr('+', ' ').b.gsub(/((?:%[0-9a-fA-F]{2})+)/) do |m|
    [m.delete('%')].pack('H*')
  end.force_encoding(encoding)
  str.valid_encoding? ? str : str.force_encoding(string.encoding)
end</pre> </div> <p>URL-decode a string with encoding(optional).</p> <pre class="ruby" data-language="ruby">string = CGI.unescape("%27Stop%21%27+said+Fred")
   # =&gt; "'Stop!' said Fred"
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescapeElement"> <span class="method-name">unescapeElement</span><span class="method-args">(string, *elements)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unescapeElement-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 160
def unescapeElement(string, *elements)
  elements = elements[0] if elements[0].kind_of?(Array)
  unless elements.empty?
    string.gsub(/&amp;lt;\/?(?:#{elements.join("|")})(?!\w)(?:.|\n)*?&amp;gt;/i) do
      unescapeHTML($&amp;)
    end
  else
    string
  end
end</pre> </div> <p>Undo escaping such as that done by <a href="util#method-i-escapeElement"><code>CGI.escapeElement()</code></a></p> <pre class="ruby" data-language="ruby">print CGI.unescapeElement(
        CGI.escapeHTML('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;'), "A", "IMG")
  # "&amp;lt;BR&amp;gt;&lt;A HREF="url"&gt;&lt;/A&gt;"

print CGI.unescapeElement(
        CGI.escapeHTML('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;'), ["A", "IMG"])
  # "&amp;lt;BR&amp;gt;&lt;A HREF="url"&gt;&lt;/A&gt;"
</pre>  </div> <div class="aliases"> Also aliased as: <a href="util#method-i-unescape_element">unescape_element</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescapeHTML"> <span class="method-name">unescapeHTML</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="unescapeHTML-source"> <pre class="ruby" data-language="ruby"># File lib/cgi/util.rb, line 65
def unescapeHTML(string)
  enc = string.encoding
  unless enc.ascii_compatible?
    if enc.dummy?
      origenc = enc
      enc = Encoding::Converter.asciicompat_encoding(enc)
      string = enc ? string.encode(enc) : string.b
    end
    string = string.gsub(Regexp.new('&amp;(apos|amp|quot|gt|lt|#[0-9]+|#x[0-9A-Fa-f]+);'.encode(enc))) do
      case $1.encode(Encoding::US_ASCII)
      when 'apos'                then "'".encode(enc)
      when 'amp'                 then '&amp;'.encode(enc)
      when 'quot'                then '"'.encode(enc)
      when 'gt'                  then '&gt;'.encode(enc)
      when 'lt'                  then '&lt;'.encode(enc)
      when /\A#0*(\d+)\z/        then $1.to_i.chr(enc)
      when /\A#x([0-9a-f]+)\z/i  then $1.hex.chr(enc)
      end
    end
    string.encode!(origenc) if origenc
    return string
  end
  return string unless string.include? '&amp;'
  charlimit = case enc
              when Encoding::UTF_8; 0x10ffff
              when Encoding::ISO_8859_1; 256
              else 128
              end
  string.gsub(/&amp;(apos|amp|quot|gt|lt|\#[0-9]+|\#[xX][0-9A-Fa-f]+);/) do
    match = $1.dup
    case match
    when 'apos'                then "'"
    when 'amp'                 then '&amp;'
    when 'quot'                then '"'
    when 'gt'                  then '&gt;'
    when 'lt'                  then '&lt;'
    when /\A#0*(\d+)\z/
      n = $1.to_i
      if n &lt; charlimit
        n.chr(enc)
      else
        "&amp;##{$1};"
      end
    when /\A#x([0-9a-f]+)\z/i
      n = $1.hex
      if n &lt; charlimit
        n.chr(enc)
      else
        "&amp;#x#{$1};"
      end
    else
      "&amp;#{match};"
    end
  end
end</pre> </div> <p>Unescape a string that has been HTML-escaped</p> <pre class="ruby" data-language="ruby">CGI.unescapeHTML("Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;")
   # =&gt; "Usage: foo \"bar\" &lt;baz&gt;"
</pre>  </div> <div class="aliases"> Also aliased as: <a href="util#method-i-unescape_html">unescape_html</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-unescape_element"> <span class="method-name">unescape_element</span><span class="method-args">(string, *elements)</span> </div> <div class="method-description"> <p>Synonym for <a href="util#method-i-unescapeElement"><code>CGI.unescapeElement(str)</code></a></p> </div> <div class="aliases"> Alias for: <a href="util#method-i-unescapeElement">unescapeElement</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-unescape_html"> <span class="method-name">unescape_html</span><span class="method-args">(string)</span> </div> <div class="method-description"> <p>Synonym for <a href="util#method-i-unescapeHTML"><code>CGI.unescapeHTML(str)</code></a></p> </div> <div class="aliases"> Alias for: <a href="util#method-i-unescapeHTML">unescapeHTML</a> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2017 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

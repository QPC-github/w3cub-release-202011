
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Perldebguts - Perl 5.26 - W3cubDocs</title>
  
  <meta name="description" content=" perldebguts - Guts of Perl debugging ">
  <meta name="keywords" content="perldebguts, perl, perl~5.26">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/perl~5.26/perldebguts.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/perl~5.26.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/perl~5.26/" class="_nav-link" title="" style="margin-left:0;">Perl 5.26</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _perl">
				
				
<h1>perldebguts</h1>  <ul>
<li><a href="#NAME">NAME</a></li>
<li><a href="#DESCRIPTION">DESCRIPTION</a></li>
<li>
<a href="#Debugger-Internals">Debugger Internals</a><ul><li><a href="#Writing-Your-Own-Debugger">Writing Your Own Debugger</a></li></ul>
</li>
<li><a href="#Frame-Listing-Output-Examples">Frame Listing Output Examples</a></li>
<li>
<a href="#Debugging-Regular-Expressions">Debugging Regular Expressions</a><ul>
<li><a href="#Compile-time-Output">Compile-time Output</a></li>
<li><a href="#Types-of-Nodes">Types of Nodes</a></li>
<li><a href="#Run-time-Output">Run-time Output</a></li>
</ul>
</li>
<li>
<a href="#Debugging-Perl-Memory-Usage">Debugging Perl Memory Usage</a><ul><li><a href="#Using-%24ENV%7bPERL_DEBUG_MSTATS%7d">Using $ENV{PERL_DEBUG_MSTATS}</a></li></ul>
</li>
<li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>
<h2 id="NAME">NAME</h2> <p>perldebguts - Guts of Perl debugging</p> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>This is not <a href="perldebug">perldebug</a>, which tells you how to use the debugger. This manpage describes low-level details concerning the debugger's internals, which range from difficult to impossible to understand for anyone who isn't incredibly intimate with Perl's guts. Caveat lector.</p> <h2 id="Debugger-Internals">Debugger Internals</h2> <p>Perl has special debugging hooks at compile-time and run-time used to create debugging environments. These hooks are not to be confused with the <i>perl -Dxxx</i> command described in <a href="perlrun">perlrun</a>, which is usable only if a special Perl is built per the instructions in the <i>INSTALL</i> podpage in the Perl source tree.</p> <p>For example, whenever you call Perl's built-in <code class="inline"><a class="l_k" href="functions/caller">caller</a></code> function from the package <code class="inline"><span class="w">DB</span></code> , the arguments that the corresponding stack frame was called with are copied to the <code class="inline"><span class="i">@DB::args</span></code> array. These mechanisms are enabled by calling Perl with the <b>-d</b> switch. Specifically, the following additional features are enabled (cf. <a href="perlvar#%24%5eP">$^P in perlvar</a>):</p> <ul> <li> <p>Perl inserts the contents of <code class="inline"><span class="i">$ENV</span>{<span class="w">PERL5DB</span>}</code> (or <code class="inline">BEGIN <span class="s">{</span><a class="l_k" href="functions/require">require</a>
<span class="q">'perl5db.pl'</span><span class="s">}</span></code> if not present) before the first line of your program.</p> </li> <li> <p>Each array <code class="inline"><span class="i">@</span>{<span class="q">"_&lt;$filename"</span>}</code> holds the lines of $filename for a file compiled by Perl. The same is also true for <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>ed strings that contain subroutines, or which are currently being executed. The $filename for <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>ed strings looks like <code class="inline"><span class="s">(</span><a class="l_k" href="functions/eval">eval</a> <span class="n">34</span><span class="s">)</span></code> .</p> <p>Values in this array are magical in numeric context: they compare equal to zero only if the line is not breakable.</p> </li> <li> <p>Each hash <code class="inline"><span class="i">%</span>{<span class="q">"_&lt;$filename"</span>}</code> contains breakpoints and actions keyed by line number. Individual entries (as opposed to the whole hash) are settable. Perl only cares about Boolean true here, although the values used by <i>perl5db.pl</i> have the form <code class="inline"><span class="q">"$break_condition\0$action"</span></code> .</p> <p>The same holds for evaluated strings that contain subroutines, or which are currently being executed. The $filename for <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>ed strings looks like <code class="inline"><span class="s">(</span><a class="l_k" href="functions/eval">eval</a> <span class="n">34</span><span class="s">)</span></code> .</p> </li> <li> <p>Each scalar <code class="inline"><span class="i">$</span>{<span class="q">"_&lt;$filename"</span>}</code> contains <code class="inline"><span class="q">"_&lt;$filename"</span></code> . This is also the case for evaluated strings that contain subroutines, or which are currently being executed. The $filename for <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>ed strings looks like <code class="inline"><span class="s">(</span><a class="l_k" href="functions/eval">eval</a> <span class="n">34</span><span class="s">)</span></code> .</p> </li> <li> <p>After each <code class="inline"><a class="l_k" href="functions/require">require</a></code>d file is compiled, but before it is executed, <code class="inline"><span class="i">DB::postponed</span><span class="s">(</span><span class="i">*</span>{<span class="q">"_&lt;$filename"</span>}<span class="s">)</span></code> is called if the subroutine <code class="inline"><span class="w">DB::postponed</span></code> exists. Here, the $filename is the expanded name of the <code class="inline"><a class="l_k" href="functions/require">require</a></code>d file, as found in the values of %INC.</p> </li> <li> <p>After each subroutine <code class="inline"><span class="w">subname</span></code> is compiled, the existence of <code class="inline"><span class="i">$DB::postponed</span>{<span class="w">subname</span>}</code> is checked. If this key exists, <code class="inline"><span class="i">DB::postponed</span><span class="s">(</span><span class="w">subname</span><span class="s">)</span></code> is called if the <code class="inline"><span class="w">DB::postponed</span></code> subroutine also exists.</p> </li> <li> <p>A hash <code class="inline"><span class="i">%DB::sub</span></code> is maintained, whose keys are subroutine names and whose values have the form <code class="inline"><span class="j">filename:</span><span class="w">startline</span>-<span class="w">endline</span></code> . <code class="inline"><span class="w">filename</span></code> has the form <code class="inline"><span class="s">(</span><a class="l_k" href="functions/eval">eval</a> <span class="n">34</span><span class="s">)</span></code> for subroutines defined inside <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>s.</p> </li> <li> <p>When the execution of your program reaches a point that can hold a breakpoint, the <code class="inline"><span class="i">DB::DB</span><span class="s">(</span><span class="s">)</span></code> subroutine is called if any of the variables <code class="inline"><span class="i">$DB::trace</span></code> , <code class="inline"><span class="i">$DB::single</span></code> , or <code class="inline"><span class="i">$DB::signal</span></code> is true. These variables are not <code class="inline"><a class="l_k" href="functions/local">local</a></code>izable. This feature is disabled when executing inside <code class="inline"><span class="i">DB::DB</span><span class="s">(</span><span class="s">)</span></code> , including functions called from it unless <code class="inline"><span class="i">$^D</span> &amp; <span class="s">(</span><span class="n">1</span>&lt;&lt;<span class="n">30</span><span class="s">)</span></code> is true.</p> </li> <li> <p>When execution of the program reaches a subroutine call, a call to <code class="inline"><span class="i">&amp;DB::sub</span></code> (<i>args</i>) is made instead, with <code class="inline"><span class="i">$DB::sub</span></code> holding the name of the called subroutine. (This doesn't happen if the subroutine was compiled in the <code class="inline"><span class="w">DB</span></code> package.)</p> <p>If the call is to an lvalue subroutine, and <code class="inline"><span class="i">&amp;DB::lsub</span></code> is defined <code class="inline"><span class="i">&amp;DB::lsub</span></code> (<i>args</i>) is called instead, otherwise falling back to <code class="inline"><span class="i">&amp;DB::sub</span></code> (<i>args</i>).</p> </li> <li> <p>When execution of the program uses <code class="inline"><a class="l_k" href="functions/goto">goto</a></code> to enter a non-XS subroutine and the 0x80 bit is set in <code class="inline"><span class="i">$^P</span></code> , a call to <code class="inline"><span class="i">&amp;DB::goto</span></code> is made, with <code class="inline"><span class="i">$DB::sub</span></code> holding the name of the subroutine being entered.</p> </li> </ul> <p>Note that if <code class="inline"><span class="i">&amp;DB::sub</span></code> needs external data for it to work, no subroutine call is possible without it. As an example, the standard debugger's <code class="inline"><span class="i">&amp;DB::sub</span></code> depends on the <code class="inline"><span class="i">$DB::deep</span></code> variable (it defines how many levels of recursion deep into the debugger you can go before a mandatory break). If <code class="inline"><span class="i">$DB::deep</span></code> is not defined, subroutine calls are not possible, even though <code class="inline"><span class="i">&amp;DB::sub</span></code> exists.</p> <h3 id="Writing-Your-Own-Debugger">Writing Your Own Debugger</h3> <h4 id="Environment-Variables">Environment Variables</h4> <p>The <code class="inline"><span class="w">PERL5DB</span></code> environment variable can be used to define a debugger. For example, the minimal "working" debugger (it actually doesn't do anything) consists of one line:</p> <pre class="verbatim" data-language="perl">sub DB::DB {}
</pre>
<p>It can easily be defined like this:</p> <pre class="verbatim" data-language="perl">$ PERL5DB="sub DB::DB {}" perl -d your-script
</pre>
<p>Another brief debugger, slightly more useful, can be created with only the line:</p> <pre class="verbatim" data-language="perl">sub DB::DB {print ++$i; scalar &lt;STDIN&gt;}
</pre>
<p>This debugger prints a number which increments for each statement encountered and waits for you to hit a newline before continuing to the next statement.</p> <p>The following debugger is actually useful:</p> <pre class="verbatim" data-language="perl">{
  package DB;
  sub DB  {}
  sub sub {print ++$i, " $sub\n"; &amp;$sub}
}
</pre>
<p>It prints the sequence number of each subroutine call and the name of the called subroutine. Note that <code class="inline"><span class="i">&amp;DB::sub</span></code> is being compiled into the package <code class="inline"><span class="w">DB</span></code> through the use of the <code class="inline"><a class="l_k" href="functions/package">package</a></code> directive.</p> <p>When it starts, the debugger reads your rc file (<i>./.perldb</i> or <i>~/.perldb</i> under Unix), which can set important options. (A subroutine (<code class="inline"><span class="i">&amp;afterinit</span></code> ) can be defined here as well; it is executed after the debugger completes its own initialization.)</p> <p>After the rc file is read, the debugger reads the PERLDB_OPTS environment variable and uses it to set debugger options. The contents of this variable are treated as if they were the argument of an <code class="inline"><span class="w">o</span> ...</code> debugger command (q.v. in <a href="perldebug#Configurable-Options">Configurable Options in perldebug</a>).</p> <h4 id="Debugger-Internal-Variables">Debugger Internal Variables</h4> <p>In addition to the file and subroutine-related variables mentioned above, the debugger also maintains various magical internal variables.</p> <ul> <li> <p><code class="inline"><span class="i">@DB::dbline</span></code> is an alias for <code class="inline"><span class="i">@</span>{<span class="q">"::_&lt;current_file"</span>}</code> , which holds the lines of the currently-selected file (compiled by Perl), either explicitly chosen with the debugger's <code class="inline"><span class="w">f</span></code> command, or implicitly by flow of execution.</p> <p>Values in this array are magical in numeric context: they compare equal to zero only if the line is not breakable.</p> </li> <li> <p><code class="inline"><span class="i">%DB::dbline</span></code> is an alias for <code class="inline"><span class="i">%</span>{<span class="q">"::_&lt;current_file"</span>}</code> , which contains breakpoints and actions keyed by line number in the currently-selected file, either explicitly chosen with the debugger's <code class="inline"><span class="w">f</span></code> command, or implicitly by flow of execution.</p> <p>As previously noted, individual entries (as opposed to the whole hash) are settable. Perl only cares about Boolean true here, although the values used by <i>perl5db.pl</i> have the form <code class="inline"><span class="q">"$break_condition\0$action"</span></code> .</p> </li> </ul> <h4 id="Debugger-Customization-Functions">Debugger Customization Functions</h4> <p>Some functions are provided to simplify customization.</p> <ul> <li> <p>See <a href="perldebug#Configurable-Options">Configurable Options in perldebug</a> for a description of options parsed by <code class="inline"><span class="i">DB::parse_options</span><span class="s">(</span><span class="w">string</span><span class="s">)</span></code> .</p> </li> <li> <p><code class="inline"><span class="i">DB::dump_trace</span><span class="s">(</span><span class="w">skip</span><span class="s">[</span><span class="cm">,</span><span class="w">count</span><span class="s">]</span><span class="s">)</span></code> skips the specified number of frames and returns a list containing information about the calling frames (all of them, if <code class="inline"><span class="w">count</span></code> is missing). Each entry is reference to a hash with keys <code class="inline"><span class="w">context</span></code> (either <code class="inline">.</code>, <code class="inline"><span class="i">$</span></code> , or <code class="inline"><span class="i">@</span></code> ), <code class="inline"><a class="l_k" href="functions/sub">sub</a></code> (subroutine name, or info about <code class="inline"><a class="l_k" href="functions/eval">eval</a></code>), <code class="inline"><span class="w">args</span></code> (<code class="inline"><a class="l_k" href="functions/undef">undef</a></code> or a reference to an array), <code class="inline"><span class="w">file</span></code> , and <code class="inline"><span class="w">line</span></code> .</p> </li> <li> <p><code class="inline"><span class="i">DB::print_trace</span><span class="s">(</span><span class="w">FH</span><span class="cm">,</span> <span class="w">skip</span><span class="s">[</span><span class="cm">,</span> <span class="w">count</span><span class="s">[</span><span class="cm">,</span> <span class="w">short</span><span class="s">]</span><span class="s">]</span><span class="s">)</span></code> prints formatted info about caller frames. The last two functions may be convenient as arguments to <code class="inline">&lt;</code> , <code class="inline">&lt;&lt;</code> commands.</p> </li> </ul> <p>Note that any variables and functions that are not documented in this manpages (or in <a href="perldebug">perldebug</a>) are considered for internal use only, and as such are subject to change without notice.</p> <h2 id="Frame-Listing-Output-Examples">Frame Listing Output Examples</h2> <p>The <code class="inline"><span class="w">frame</span></code> option can be used to control the output of frame information. For example, contrast this expression trace:</p> <pre class="verbatim" data-language="perl">$ perl -de 42
Stack dump during die enabled outside of evals.

Loading DB routines from perl5db.pl patch level 0.94
Emacs support available.

Enter h or 'h h' for help.

main::(-e:1):   0
  DB&lt;1&gt; sub foo { 14 }

  DB&lt;2&gt; sub bar { 3 }

  DB&lt;3&gt; t print foo() * bar()
main::((eval 172):3):   print foo() + bar();
main::foo((eval 168):2):
main::bar((eval 170):2):
42
</pre>
<p>with this one, once the <code class="inline"><span class="w">o</span></code> ption <code class="inline"><span class="w">frame</span>=<span class="n">2</span></code> has been set:</p> <pre class="verbatim" data-language="perl">  DB&lt;4&gt; o f=2
               frame = '2'
  DB&lt;5&gt; t print foo() * bar()
3:      foo() * bar()
entering main::foo
 2:     sub foo { 14 };
exited main::foo
entering main::bar
 2:     sub bar { 3 };
exited main::bar
42
</pre>
<p>By way of demonstration, we present below a laborious listing resulting from setting your <code class="inline"><span class="w">PERLDB_OPTS</span></code> environment variable to the value <code class="inline"><span class="w">f</span>=<span class="w">n</span> <span class="w">N</span></code> , and running <i>perl -d -V</i> from the command line. Examples using various values of <code class="inline"><span class="w">n</span></code> are shown to give you a feel for the difference between settings. Long though it may be, this is not a complete listing, but only excerpts.</p> <dl> <dt>1</dt>
<dd> <pre class="verbatim" data-language="perl">entering main::BEGIN
 entering Config::BEGIN
  Package lib/Exporter.pm.
  Package lib/Carp.pm.
 Package lib/Config.pm.
 entering Config::TIEHASH
 entering Exporter::import
  entering Exporter::export
entering Config::myconfig
 entering Config::FETCH
 entering Config::FETCH
 entering Config::FETCH
 entering Config::FETCH
</pre>
</dd> <dt>2</dt>
<dd> <pre class="verbatim" data-language="perl">entering main::BEGIN
 entering Config::BEGIN
  Package lib/Exporter.pm.
  Package lib/Carp.pm.
 exited Config::BEGIN
 Package lib/Config.pm.
 entering Config::TIEHASH
 exited Config::TIEHASH
 entering Exporter::import
  entering Exporter::export
  exited Exporter::export
 exited Exporter::import
exited main::BEGIN
entering Config::myconfig
 entering Config::FETCH
 exited Config::FETCH
 entering Config::FETCH
 exited Config::FETCH
 entering Config::FETCH
</pre>
</dd> <dt>3</dt>
<dd> <pre class="verbatim" data-language="perl">in  $=main::BEGIN() from /dev/null:0
 in  $=Config::BEGIN() from lib/Config.pm:2
  Package lib/Exporter.pm.
  Package lib/Carp.pm.
 Package lib/Config.pm.
 in  $=Config::TIEHASH('Config') from lib/Config.pm:644
 in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
  in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from li
in  @=Config::myconfig() from /dev/null:0
 in  $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'PERL_SUBVERSION') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'osname') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'osvers') from lib/Config.pm:574
</pre>
</dd> <dt>4</dt>
<dd> <pre class="verbatim" data-language="perl">in  $=main::BEGIN() from /dev/null:0
 in  $=Config::BEGIN() from lib/Config.pm:2
  Package lib/Exporter.pm.
  Package lib/Carp.pm.
 out $=Config::BEGIN() from lib/Config.pm:0
 Package lib/Config.pm.
 in  $=Config::TIEHASH('Config') from lib/Config.pm:644
 out $=Config::TIEHASH('Config') from lib/Config.pm:644
 in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
  in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/
  out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/
 out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
out $=main::BEGIN() from /dev/null:0
in  @=Config::myconfig() from /dev/null:0
 in  $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
 out $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
 out $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
 out $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
 in  $=Config::FETCH(ref(Config), 'PERL_SUBVERSION') from lib/Config.pm:574
</pre>
</dd> <dt>5</dt>
<dd> <pre class="verbatim" data-language="perl">in  $=main::BEGIN() from /dev/null:0
 in  $=Config::BEGIN() from lib/Config.pm:2
  Package lib/Exporter.pm.
  Package lib/Carp.pm.
 out $=Config::BEGIN() from lib/Config.pm:0
 Package lib/Config.pm.
 in  $=Config::TIEHASH('Config') from lib/Config.pm:644
 out $=Config::TIEHASH('Config') from lib/Config.pm:644
 in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
  in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/E
  out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/E
 out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
out $=main::BEGIN() from /dev/null:0
in  @=Config::myconfig() from /dev/null:0
 in  $=Config::FETCH('Config=HASH(0x1aa444)', 'package') from lib/Config.pm:574
 out $=Config::FETCH('Config=HASH(0x1aa444)', 'package') from lib/Config.pm:574
 in  $=Config::FETCH('Config=HASH(0x1aa444)', 'baserev') from lib/Config.pm:574
 out $=Config::FETCH('Config=HASH(0x1aa444)', 'baserev') from lib/Config.pm:574
</pre>
</dd> <dt>6</dt>
<dd> <pre class="verbatim" data-language="perl">in  $=CODE(0x15eca4)() from /dev/null:0
 in  $=CODE(0x182528)() from lib/Config.pm:2
  Package lib/Exporter.pm.
 out $=CODE(0x182528)() from lib/Config.pm:0
 scalar context return from CODE(0x182528): undef
 Package lib/Config.pm.
 in  $=Config::TIEHASH('Config') from lib/Config.pm:628
 out $=Config::TIEHASH('Config') from lib/Config.pm:628
 scalar context return from Config::TIEHASH:   empty hash
 in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
  in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/Exporter.pm:171
  out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/Exporter.pm:171
  scalar context return from Exporter::export: ''
 out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
 scalar context return from Exporter::import: ''
</pre>
</dd> </dl> <p>In all cases shown above, the line indentation shows the call tree. If bit 2 of <code class="inline"><span class="w">frame</span></code> is set, a line is printed on exit from a subroutine as well. If bit 4 is set, the arguments are printed along with the caller info. If bit 8 is set, the arguments are printed even if they are tied or references. If bit 16 is set, the return value is printed, too.</p> <p>When a package is compiled, a line like this</p> <pre class="verbatim" data-language="perl">Package lib/Carp.pm.
</pre>
<p>is printed with proper indentation.</p> <h2 id="Debugging-Regular-Expressions">Debugging Regular Expressions</h2> <p>There are two ways to enable debugging output for regular expressions.</p> <p>If your perl is compiled with <code class="inline">-<span class="w">DDEBUGGING</span></code> , you may use the <b>-Dr</b> flag on the command line.</p> <p>Otherwise, one can <code class="inline"><a class="l_k" href="functions/use">use</a> <span class="w">re</span> <span class="q">'debug'</span></code> , which has effects at compile time and run time. Since Perl 5.9.5, this pragma is lexically scoped.</p> <h3 id="Compile-time-Output">Compile-time Output</h3> <p>The debugging output at compile time looks like this:</p> <pre class="verbatim" data-language="perl">Compiling REx '[bc]d(ef*g)+h[ij]k$'
size 45 Got 364 bytes for offset annotations.
first at 1
rarest char g at 0
rarest char d at 0
   1: ANYOF[bc](12)
  12: EXACT &lt;d&gt;(14)
  14: CURLYX[0] {1,32767}(28)
  16:   OPEN1(18)
  18:     EXACT &lt;e&gt;(20)
  20:     STAR(23)
  21:       EXACT &lt;f&gt;(0)
  23:     EXACT &lt;g&gt;(25)
  25:   CLOSE1(27)
  27:   WHILEM[1/1](0)
  28: NOTHING(29)
  29: EXACT &lt;h&gt;(31)
  31: ANYOF[ij](42)
  42: EXACT &lt;k&gt;(44)
  44: EOL(45)
  45: END(0)
anchored 'de' at 1 floating 'gh' at 3..2147483647 (checking floating) 
      stclass 'ANYOF[bc]' minlen 7 
Offsets: [45]
	1[4] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 5[1]
	0[0] 12[1] 0[0] 6[1] 0[0] 7[1] 0[0] 9[1] 8[1] 0[0] 10[1] 0[0]
	11[1] 0[0] 12[0] 12[0] 13[1] 0[0] 14[4] 0[0] 0[0] 0[0] 0[0]
	0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 18[1] 0[0] 19[1] 20[0]  
Omitting $` $&amp; $' support.
</pre>
<p>The first line shows the pre-compiled form of the regex. The second shows the size of the compiled form (in arbitrary units, usually 4-byte words) and the total number of bytes allocated for the offset/length table, usually 4+<code class="inline"><span class="w">size</span></code> *8. The next line shows the label <i>id</i> of the first node that does a match.</p> <p>The</p> <pre class="verbatim" data-language="perl">anchored 'de' at 1 floating 'gh' at 3..2147483647 (checking floating) 
      stclass 'ANYOF[bc]' minlen 7
</pre>
<p>line (split into two lines above) contains optimizer information. In the example shown, the optimizer found that the match should contain a substring <code class="inline"><span class="w">de</span></code> at offset 1, plus substring <code class="inline"><span class="w">gh</span></code> at some offset between 3 and infinity. Moreover, when checking for these substrings (to abandon impossible matches quickly), Perl will check for the substring <code class="inline"><span class="w">gh</span></code> before checking for the substring <code class="inline"><span class="w">de</span></code> . The optimizer may also use the knowledge that the match starts (at the <code class="inline"><span class="w">first</span></code> <i>id</i>) with a character class, and no string shorter than 7 characters can possibly match.</p> <p>The fields of interest which may appear in this line are</p> <ul> <li id="anchored-_STRING_-at-_POS_">
<b><code class="inline"><span class="w">anchored</span></code> <i>STRING</i> <code class="inline"><span class="w">at</span></code> <i>POS</i></b> </li> <li id="floating-_STRING_-at-_POS1..POS2_">
<b><code class="inline"><span class="w">floating</span></code> <i>STRING</i> <code class="inline"><span class="w">at</span></code> <i>POS1..POS2</i></b> <p>See above.</p> </li> <li id="matching-floating%2fanchored">
<b><code class="inline"><span class="w">matching</span> <span class="w">floating</span>/<span class="w">anchored</span></code> </b> <p>Which substring to check first.</p> </li> <li id="minlen">
<b><code class="inline"><span class="w">minlen</span></code> </b> <p>The minimal length of the match.</p> </li> <li id="stclass-_TYPE_">
<b><code class="inline"><span class="w">stclass</span></code> <i>TYPE</i></b> <p>Type of first matching node.</p> </li> <li id="noscan">
<b><code class="inline"><span class="w">noscan</span></code> </b> <p>Don't scan for the found substrings.</p> </li> <li id="isall">
<b><code class="inline"><span class="w">isall</span></code> </b> <p>Means that the optimizer information is all that the regular expression contains, and thus one does not need to enter the regex engine at all.</p> </li> <li id="GPOS">
<b><code class="inline"><span class="w">GPOS</span></code> </b> <p>Set if the pattern contains <code class="inline">\<span class="w">G</span></code> .</p> </li> <li id="plus">
<b><code class="inline"><span class="w">plus</span></code> </b> <p>Set if the pattern starts with a repeated char (as in <code class="inline">x+y</code>).</p> </li> <li id="implicit">
<b><code class="inline"><span class="w">implicit</span></code> </b> <p>Set if the pattern starts with <code class="inline">.*</code>.</p> </li> <li id="with-eval">
<b><code class="inline"><span class="w">with</span> <a class="l_k" href="functions/eval">eval</a></code> </b> <p>Set if the pattern contain eval-groups, such as <code class="inline">(?{ code })</code> and <code class="inline"><span class="s">(</span><span class="q">??</span><span class="s">{</span> <span class="w">code</span> <span class="s">}</span><span class="s">)</span></code> .</p> </li> <li id="anchored(TYPE)">
<b><code class="inline"><span class="i">anchored</span><span class="s">(</span><span class="w">TYPE</span><span class="s">)</span></code> </b> <p>If the pattern may match only at a handful of places, with <code class="inline"><span class="w">TYPE</span></code> being <code class="inline"><span class="w">SBOL</span></code> , <code class="inline"><span class="w">MBOL</span></code> , or <code class="inline"><span class="w">GPOS</span></code> . See the table below.</p> </li> </ul> <p>If a substring is known to match at end-of-line only, it may be followed by <code class="inline"><span class="i">$</span></code> , as in <code class="inline"><span class="w">floating</span> <span class="q">'k'</span><span class="i">$</span></code> .</p> <p>The optimizer-specific information is used to avoid entering (a slow) regex engine on strings that will not definitely match. If the <code class="inline"><span class="w">isall</span></code> flag is set, a call to the regex engine may be avoided even when the optimizer found an appropriate place for the match.</p> <p>Above the optimizer section is the list of <i>nodes</i> of the compiled form of the regex. Each line has format</p> <p> <i>id</i>: <i>TYPE</i> <i>OPTIONAL-INFO</i> (<i>next-id</i>)</p> <h3 id="Types-of-Nodes">Types of Nodes</h3> <p>Here are the current possible types, with short descriptions:</p> <pre class="verbatim" data-language="perl"># TYPE arg-description [num-args] [longjump-len] DESCRIPTION

# Exit points

END             no         End of program.
SUCCEED         no         Return from a subroutine, basically.

# Line Start Anchors:
SBOL            no         Match "" at beginning of line: /^/, /\A/
MBOL            no         Same, assuming multiline: /^/m

# Line End Anchors:
SEOL            no         Match "" at end of line: /$/
MEOL            no         Same, assuming multiline: /$/m
EOS             no         Match "" at end of string: /\z/

# Match Start Anchors:
GPOS            no         Matches where last m//g left off.

# Word Boundary Opcodes:
BOUND           no         Like BOUNDA for non-utf8, otherwise match ""
                           between any Unicode \w\W or \W\w
BOUNDL          no         Like BOUND/BOUNDU, but \w and \W are defined
                           by current locale
BOUNDU          no         Match "" at any boundary of a given type
                           using Unicode rules
BOUNDA          no         Match "" at any boundary between \w\W or
                           \W\w, where \w is [_a-zA-Z0-9]
NBOUND          no         Like NBOUNDA for non-utf8, otherwise match
                           "" between any Unicode \w\w or \W\W
NBOUNDL         no         Like NBOUND/NBOUNDU, but \w and \W are
                           defined by current locale
NBOUNDU         no         Match "" at any non-boundary of a given type
                           using using Unicode rules
NBOUNDA         no         Match "" betweeen any \w\w or \W\W, where \w
                           is [_a-zA-Z0-9]

# [Special] alternatives:
REG_ANY         no         Match any one character (except newline).
SANY            no         Match any one character.
CANY            no         Match any one byte.
ANYOF           sv 1       Match character in (or not in) this class,
                           single char match only
ANYOFL          sv 1       Like ANYOF, but /l is in effect

# POSIX Character Classes:
POSIXD          none       Some [[:class:]] under /d; the FLAGS field
                           gives which one
POSIXL          none       Some [[:class:]] under /l; the FLAGS field
                           gives which one
POSIXU          none       Some [[:class:]] under /u; the FLAGS field
                           gives which one
POSIXA          none       Some [[:class:]] under /a; the FLAGS field
                           gives which one
NPOSIXD         none       complement of POSIXD, [[:^class:]]
NPOSIXL         none       complement of POSIXL, [[:^class:]]
NPOSIXU         none       complement of POSIXU, [[:^class:]]
NPOSIXA         none       complement of POSIXA, [[:^class:]]

CLUMP           no         Match any extended grapheme cluster sequence

# Alternation

# BRANCH        The set of branches constituting a single choice are
#               hooked together with their "next" pointers, since
#               precedence prevents anything being concatenated to
#               any individual branch.  The "next" pointer of the last
#               BRANCH in a choice points to the thing following the
#               whole choice.  This is also where the final "next"
#               pointer of each individual branch points; each branch
#               starts with the operand node of a BRANCH node.
#
BRANCH          node       Match this alternative, or the next...

# Literals

EXACT           str        Match this string (preceded by length).
EXACTL          str        Like EXACT, but /l is in effect.
EXACTF          str        Match this non-UTF-8 string (not guaranteed
                           to be folded) using /id rules (w/len).
EXACTFL         str        Match this string (not guaranteed to be
                           folded) using /il rules (w/len).
EXACTFU         str        Match this string (folded iff in UTF-8,
                           length in folding doesn't change if not in
                           UTF-8) using /iu rules (w/len).
EXACTFA         str        Match this string (not guaranteed to be
                           folded) using /iaa rules (w/len).

EXACTFU_SS      str        Match this string (folded iff in UTF-8,
                           length in folding may change even if not in
                           UTF-8) using /iu rules (w/len).
EXACTFLU8       str        Rare cirucmstances: like EXACTFU, but is
                           under /l, UTF-8, folded, and everything in
                           it is above 255.
EXACTFA_NO_TRIE str        Match this string (which is not trie-able;
                           not guaranteed to be folded) using /iaa
                           rules (w/len).

# Do nothing types

NOTHING         no         Match empty string.
# A variant of above which delimits a group, thus stops optimizations
TAIL            no         Match empty string. Can jump here from
                           outside.

# Loops

# STAR,PLUS    '?', and complex '*' and '+', are implemented as
#               circular BRANCH structures.  Simple cases
#               (one character per match) are implemented with STAR
#               and PLUS for speed and to minimize recursive plunges.
#
STAR            node       Match this (simple) thing 0 or more times.
PLUS            node       Match this (simple) thing 1 or more times.

CURLY           sv 2       Match this simple thing {n,m} times.
 CURLYN          no 2       Capture next-after-this simple thing
 CURLYM          no 2       Capture this medium-complex thing {n,m}
                           times.
CURLYX          sv 2       Match this complex thing {n,m} times.

 # This terminator creates a loop structure for CURLYX
 WHILEM          no         Do curly processing and see if rest matches.

 # Buffer related

 # OPEN,CLOSE,GROUPP     ...are numbered at compile time.
 OPEN            num 1      Mark this point in input as start of #n.
 CLOSE           num 1      Analogous to OPEN.

 REF             num 1      Match some already matched string
 REFF            num 1      Match already matched string, folded using
                                                       native charset rules for non-utf8
 REFFL           num 1      Match already matched string, folded in loc.
 REFFU           num 1      Match already matched string, folded using
                                                       unicode rules for non-utf8
 REFFA           num 1      Match already matched string, folded using
                                                       unicode rules for non-utf8, no mixing ASCII,
                                                       non-ASCII

 # Named references.  Code in regcomp.c assumes that these all are after
 # the numbered references
 NREF            no-sv 1    Match some already matched string
 NREFF           no-sv 1    Match already matched string, folded using
                                                       native charset rules for non-utf8
 NREFFL          no-sv 1    Match already matched string, folded in loc.
 NREFFU          num 1      Match already matched string, folded using
                                                       unicode rules for non-utf8
 NREFFA          num 1      Match already matched string, folded using
                                                       unicode rules for non-utf8, no mixing ASCII,
                                                       non-ASCII

 # Support for long RE
 LONGJMP         off 1 1    Jump far away.
 BRANCHJ         off 1 1    BRANCH with long offset.

 # Special Case Regops
 IFMATCH         off 1 2    Succeeds if the following matches.
 UNLESSM         off 1 2    Fails if the following matches.
 SUSPEND         off 1 1    "Independent" sub-RE.
 IFTHEN          off 1 1    Switch, should be preceded by switcher.
 GROUPP          num 1      Whether the group matched.

 # The heavy worker

 EVAL            evl/flags  Execute some Perl code.
                                 2L

 # Modifiers

 MINMOD          no         Next operator is not greedy.
 LOGICAL         no         Next opcode should set the flag only.

 # This is not used yet
 RENUM           off 1 1    Group with independently numbered parens.

 # Trie Related

 # Behave the same as A|LIST|OF|WORDS would. The '..C' variants
 # have inline charclass data (ascii only), the 'C' store it in the
 # structure.

 TRIE            trie 1     Match many EXACT(F[ALU]?)? at once.
                                                       flags==type
 TRIEC           trie       Same as TRIE, but with embedded charclass
                                 charclass  data

 AHOCORASICK     trie 1     Aho Corasick stclass. flags==type
 AHOCORASICKC    trie       Same as AHOCORASICK, but with embedded
                                 charclass  charclass data

 # Regex Subroutines
 GOSUB           num/ofs 2L recurse to paren arg1 at (signed) ofs arg2
 GOSTART         no         recurse to start of pattern

 # Special conditionals
 NGROUPP         no-sv 1    Whether the group matched.
 INSUBP          num 1      Whether we are in a specific recurse.
 DEFINEP         none 1     Never execute directly.

 # Backtracking Verbs
 ENDLIKE         none       Used only for the type field of verbs
 OPFAIL          none       Same as (?!)
 ACCEPT          parno 1    Accepts the current matched string.

 # Verbs With Arguments
 VERB            no-sv 1    Used only for the type field of verbs
 PRUNE           no-sv 1    Pattern fails at this startpoint if no-
                                                       backtracking through this
 MARKPOINT       no-sv 1    Push the current location for rollback by
                                                       cut.
 SKIP            no-sv 1    On failure skip forward (to the mark) before
                                                       retrying
 COMMIT          no-sv 1    Pattern fails outright if backtracking
                                                       through this
 CUTGROUP        no-sv 1    On failure go to the next alternation in the
                                                       group

 # Control what to keep in $&amp;.
 KEEPS           no         $&amp; begins here.

 # New charclass like patterns
 LNBREAK         none       generic newline pattern

 # SPECIAL  REGOPS

 # This is not really a node, but an optimized away piece of a "long"
 # node.  To simplify debugging output, we mark it as if it were a node
 OPTIMIZED       off        Placeholder for dump.

 # Special opcode with the property that no opcode in a compiled program
 # will ever be of this type. Thus it can be used as a flag value that
 # no other opcode has been seen. END is used similarly, in that an END
 # node cant be optimized. So END implies "unoptimizable" and PSEUDO
 # mean "not seen anything to optimize yet".
 PSEUDO          off        Pseudo opcode for internal use.
</pre>
<p>Following the optimizer information is a dump of the offset/length table, here split across several lines:</p> <pre class="verbatim" data-language="perl">Offsets: [45]
	1[4] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 5[1]
	0[0] 12[1] 0[0] 6[1] 0[0] 7[1] 0[0] 9[1] 8[1] 0[0] 10[1] 0[0]
	11[1] 0[0] 12[0] 12[0] 13[1] 0[0] 14[4] 0[0] 0[0] 0[0] 0[0]
	0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 18[1] 0[0] 19[1] 20[0]
</pre>
<p>The first line here indicates that the offset/length table contains 45 entries. Each entry is a pair of integers, denoted by <code class="inline"><span class="w">offset</span><span class="s">[</span><a class="l_k" href="functions/length">length</a><span class="s">]</span></code> . Entries are numbered starting with 1, so entry #1 here is <code class="inline"><span class="n">1</span><span class="s">[</span><span class="n">4</span><span class="s">]</span></code> and entry #12 is <code class="inline"><span class="n">5</span><span class="s">[</span><span class="n">1</span><span class="s">]</span></code> . <code class="inline"><span class="n">1</span><span class="s">[</span><span class="n">4</span><span class="s">]</span></code> indicates that the node labeled <code class="inline">1:</code> (the <code class="inline">1: ANYOF[bc]</code>) begins at character position 1 in the pre-compiled form of the regex, and has a length of 4 characters. <code class="inline"><span class="n">5</span><span class="s">[</span><span class="n">1</span><span class="s">]</span></code> in position 12 indicates that the node labeled <code class="inline">12:</code> (the <code class="inline">12: EXACT &lt;d&gt;</code>) begins at character position 5 in the pre-compiled form of the regex, and has a length of 1 character. <code class="inline"><span class="n">12</span><span class="s">[</span><span class="n">1</span><span class="s">]</span></code> in position 14 indicates that the node labeled <code class="inline">14:</code> (the <code class="inline">14: CURLYX[0] {1,32767}</code>) begins at character position 12 in the pre-compiled form of the regex, and has a length of 1 character---that is, it corresponds to the <code class="inline">+</code> symbol in the precompiled regex.</p> <p><code class="inline"><span class="n">0</span><span class="s">[</span><span class="n">0</span><span class="s">]</span></code> items indicate that there is no corresponding node.</p> <h3 id="Run-time-Output">Run-time Output</h3> <p>First of all, when doing a match, one may get no run-time output even if debugging is enabled. This means that the regex engine was never entered and that all of the job was therefore done by the optimizer.</p> <p>If the regex engine was entered, the output may look like this:</p> <pre class="verbatim" data-language="perl">  Matching '[bc]d(ef*g)+h[ij]k$' against 'abcdefg__gh__'
    Setting an EVAL scope, savestack=3
     2 &lt;ab&gt; &lt;cdefg__gh_&gt;    |  1: ANYOF
     3 &lt;abc&gt; &lt;defg__gh_&gt;    | 11: EXACT &lt;d&gt;
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 13: CURLYX {1,32767}
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 26:   WHILEM
0 out of 1..32767  cc=effff31c
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 15:     OPEN1
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 17:     EXACT &lt;e&gt;
     5 &lt;abcde&gt; &lt;fg__gh_&gt;    | 19:     STAR
			     EXACT &lt;f&gt; can match 1 times out of 32767...
    Setting an EVAL scope, savestack=3
     6 &lt;bcdef&gt; &lt;g__gh__&gt;    | 22:       EXACT &lt;g&gt;
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 24:       CLOSE1
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 26:       WHILEM
    1 out of 1..32767  cc=effff31c
    Setting an EVAL scope, savestack=12
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 15:         OPEN1
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 17:         EXACT &lt;e&gt;
       restoring \1 to 4(4)..7
    failed, try continuation...
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 27:         NOTHING
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 28:         EXACT &lt;h&gt;
    failed...
failed...
</pre>
<p>The most significant information in the output is about the particular <i>node</i> of the compiled regex that is currently being tested against the target string. The format of these lines is</p> <p> <i>STRING-OFFSET</i> &lt;<i>PRE-STRING</i>&gt; &lt;<i>POST-STRING</i>&gt; |<i>ID</i>: <i>TYPE</i></p> <p>The <i>TYPE</i> info is indented with respect to the backtracking level. Other incidental information appears interspersed within.</p> <h2 id="Debugging-Perl-Memory-Usage">Debugging Perl Memory Usage</h2> <p>Perl is a profligate wastrel when it comes to memory use. There is a saying that to estimate memory usage of Perl, assume a reasonable algorithm for memory allocation, multiply that estimate by 10, and while you still may miss the mark, at least you won't be quite so astonished. This is not absolutely true, but may provide a good grasp of what happens.</p> <p>Assume that an integer cannot take less than 20 bytes of memory, a float cannot take less than 24 bytes, a string cannot take less than 32 bytes (all these examples assume 32-bit architectures, the result are quite a bit worse on 64-bit architectures). If a variable is accessed in two of three different ways (which require an integer, a float, or a string), the memory footprint may increase yet another 20 bytes. A sloppy malloc(3) implementation can inflate these numbers dramatically.</p> <p>On the opposite end of the scale, a declaration like</p> <pre class="verbatim" data-language="perl">sub foo;
</pre>
<p>may take up to 500 bytes of memory, depending on which release of Perl you're running.</p> <p>Anecdotal estimates of source-to-compiled code bloat suggest an eightfold increase. This means that the compiled form of reasonable (normally commented, properly indented etc.) code will take about eight times more space in memory than the code took on disk.</p> <p>The <b>-DL</b> command-line switch is obsolete since circa Perl 5.6.0 (it was available only if Perl was built with <code class="inline">-<span class="w">DDEBUGGING</span></code> ). The switch was used to track Perl's memory allocations and possible memory leaks. These days the use of malloc debugging tools like <i>Purify</i> or <i>valgrind</i> is suggested instead. See also <a href="perlhacktips#PERL_MEM_LOG">PERL_MEM_LOG in perlhacktips</a>.</p> <p>One way to find out how much memory is being used by Perl data structures is to install the Devel::Size module from CPAN: it gives you the minimum number of bytes required to store a particular data structure. Please be mindful of the difference between the size() and total_size().</p> <p>If Perl has been compiled using Perl's malloc you can analyze Perl memory usage by setting $ENV{PERL_DEBUG_MSTATS}.</p> <h3 id="Using-%24ENV%7bPERL_DEBUG_MSTATS%7d">Using <code class="inline"><span class="i">$ENV</span>{<span class="w">PERL_DEBUG_MSTATS</span>}</code> </h3> <p>If your perl is using Perl's malloc() and was compiled with the necessary switches (this is the default), then it will print memory usage statistics after compiling your code when <code class="inline"><span class="i">$ENV</span>{<span class="w">PERL_DEBUG_MSTATS</span>}
&gt; <span class="n">1</span></code> , and before termination of the program when <code class="inline"><span class="i">$ENV</span>{<span class="w">PERL_DEBUG_MSTATS</span>} &gt;= <span class="n">1</span></code> . The report format is similar to the following example:</p> <pre class="verbatim" data-language="perl">  $ PERL_DEBUG_MSTATS=2 perl -e "require Carp"
  Memory allocation statistics after compilation: (buckets 4(4)..8188(8192)
     14216 free:   130   117    28     7     9   0   2     2   1 0 0
437    61    36     0     5
     60924 used:   125   137   161    55     7   8   6    16   2 0 1
 74   109   304    84    20
  Total sbrk(): 77824/21:119. Odd ends: pad+heads+chain+tail: 0+636+0+2048.
  Memory allocation statistics after execution:   (buckets 4(4)..8188(8192)
     30888 free:   245    78    85    13     6   2   1     3   2 0 1
315   162    39    42    11
    175816 used:   265   176  1112   111    26  22  11    27   2 1 1
196   178  1066   798    39
  Total sbrk(): 215040/47:145. Odd ends: pad+heads+chain+tail: 0+2192+0+6144.
</pre>
<p>It is possible to ask for such a statistic at arbitrary points in your execution using the mstat() function out of the standard Devel::Peek module.</p> <p>Here is some explanation of that format:</p> <ul> <li id="buckets-SMALLEST(APPROX)..GREATEST(APPROX)">
<b><code class="inline"><span class="w">buckets</span> <span class="i">SMALLEST</span><span class="s">(</span><span class="w">APPROX</span><span class="s">)</span>..<span class="i">GREATEST</span><span class="s">(</span><span class="w">APPROX</span><span class="s">)</span></code> </b> <p>Perl's malloc() uses bucketed allocations. Every request is rounded up to the closest bucket size available, and a bucket is taken from the pool of buckets of that size.</p> <p>The line above describes the limits of buckets currently in use. Each bucket has two sizes: memory footprint and the maximal size of user data that can fit into this bucket. Suppose in the above example that the smallest bucket were size 4. The biggest bucket would have usable size 8188, and the memory footprint would be 8192.</p> <p>In a Perl built for debugging, some buckets may have negative usable size. This means that these buckets cannot (and will not) be used. For larger buckets, the memory footprint may be one page greater than a power of 2. If so, the corresponding power of two is printed in the <code class="inline"><span class="w">APPROX</span></code> field above.</p> </li> <li id="Free%2fUsed">
<b>Free/Used</b> <p>The 1 or 2 rows of numbers following that correspond to the number of buckets of each size between <code class="inline"><span class="w">SMALLEST</span></code> and <code class="inline"><span class="w">GREATEST</span></code> . In the first row, the sizes (memory footprints) of buckets are powers of two--or possibly one page greater. In the second row, if present, the memory footprints of the buckets are between the memory footprints of two buckets "above".</p> <p>For example, suppose under the previous example, the memory footprints were</p> <pre class="verbatim" data-language="perl">     free:    8     16    32    64    128  256 512 1024 2048 4096 8192
4     12    24    48    80
</pre>
<p>With a non-<code class="inline"><span class="w">DEBUGGING</span></code> perl, the buckets starting from <code class="inline"><span class="n">128</span></code> have a 4-byte overhead, and thus an 8192-long bucket may take up to 8188-byte allocations.</p> </li> <li id="Total-sbrk()%3a-SBRKed%2fSBRKs%3aCONTINUOUS">
<b><code class="inline">Total sbrk(): SBRKed/SBRKs:CONTINUOUS</code></b> <p>The first two fields give the total amount of memory perl sbrk(2)ed (ess-broken? :-) and number of sbrk(2)s used. The third number is what perl thinks about continuity of returned chunks. So long as this number is positive, malloc() will assume that it is probable that sbrk(2) will provide continuous memory.</p> <p>Memory allocated by external libraries is not counted.</p> </li> <li id="pad%3a-0">
<b><code class="inline"><span class="j">pad:</span> <span class="n">0</span></code> </b> <p>The amount of sbrk(2)ed memory needed to keep buckets aligned.</p> </li> <li id="heads%3a-2192">
<b><code class="inline"><span class="j">heads:</span> <span class="n">2192</span></code> </b> <p>Although memory overhead of bigger buckets is kept inside the bucket, for smaller buckets, it is kept in separate areas. This field gives the total size of these areas.</p> </li> <li id="chain%3a-0">
<b><code class="inline"><span class="j">chain:</span> <span class="n">0</span></code> </b> <p>malloc() may want to subdivide a bigger bucket into smaller buckets. If only a part of the deceased bucket is left unsubdivided, the rest is kept as an element of a linked list. This field gives the total size of these chunks.</p> </li> <li id="tail%3a-6144">
<b><code class="inline"><span class="j">tail:</span> <span class="n">6144</span></code> </b> <p>To minimize the number of sbrk(2)s, malloc() asks for more memory. This field gives the size of the yet unused part, which is sbrk(2)ed, but never touched.</p> </li> </ul> <h2 id="SEE-ALSO">SEE ALSO</h2> <p><a href="perldebug">perldebug</a>, <a href="perlguts">perlguts</a>, <a href="perlrun">perlrun</a> <a href="re">re</a>, and <a href="http://search.cpan.org/perldoc/Devel::DProf">Devel::DProf</a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 1993–2016 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.26.0/perldebguts.html" class="_attribution-link">https://perldoc.perl.org/5.26.0/perldebguts.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

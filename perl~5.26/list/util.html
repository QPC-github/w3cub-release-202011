
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>List&#58;&#58;Util - Perl 5.26 - W3cubDocs</title>
  
  <meta name="description" content=" List&#58;&#58;Util - A selection of general-utility list subroutines ">
  <meta name="keywords" content="list, util, perl, perl~5.26">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/perl~5.26/list/util.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/perl~5.26.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/perl~5.26/" class="_nav-link" title="" style="margin-left:0;">Perl 5.26</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _perl">
				
				
<h1>List::Util</h1>  <ul>
<li><a href="#NAME">NAME</a></li>
<li><a href="#SYNOPSIS">SYNOPSIS</a></li>
<li><a href="#DESCRIPTION">DESCRIPTION</a></li>
<li>
<a href="#LIST-REDUCTION-FUNCTIONS">LIST-REDUCTION FUNCTIONS</a><ul>
<li><a href="#%24result-%3d-reduce-%7b-BLOCK-%7d-%40list">$result = reduce { BLOCK } @list</a></li>
<li><a href="#any">any</a></li>
<li><a href="#all">all</a></li>
<li><a href="#none">none</a></li>
<li><a href="#notall">notall</a></li>
<li><a href="#first">first</a></li>
<li><a href="#max">max</a></li>
<li><a href="#maxstr">maxstr</a></li>
<li><a href="#min">min</a></li>
<li><a href="#minstr">minstr</a></li>
<li><a href="#product">product</a></li>
<li><a href="#sum">sum</a></li>
<li><a href="#sum0">sum0</a></li>
</ul>
</li>
<li>
<a href="#KEY%2fVALUE-PAIR-LIST-FUNCTIONS">KEY/VALUE PAIR LIST FUNCTIONS</a><ul>
<li><a href="#pairgrep">pairgrep</a></li>
<li><a href="#pairfirst">pairfirst</a></li>
<li><a href="#pairmap">pairmap</a></li>
<li><a href="#pairs">pairs</a></li>
<li><a href="#pairkeys">pairkeys</a></li>
<li><a href="#pairvalues">pairvalues</a></li>
</ul>
</li>
<li>
<a href="#OTHER-FUNCTIONS">OTHER FUNCTIONS</a><ul><li><a href="#shuffle">shuffle</a></li></ul>
</li>
<li>
<a href="#KNOWN-BUGS">KNOWN BUGS</a><ul><li><a href="#RT-%2395409">RT #95409</a></li></ul>
</li>
<li><a href="#SUGGESTED-ADDITIONS">SUGGESTED ADDITIONS</a></li>
<li><a href="#SEE-ALSO">SEE ALSO</a></li>
<li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>
<h2 id="NAME">NAME</h2> <p>List::Util - A selection of general-utility list subroutines</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre class="verbatim" data-language="perl">use List::Util qw(first max maxstr min minstr reduce shuffle sum);
</pre>
<h2 id="DESCRIPTION">DESCRIPTION</h2> <p><code class="inline"><span class="w">List::Util</span></code> contains a selection of subroutines that people have expressed would be nice to have in the perl core, but the usage would not really be high enough to warrant the use of a keyword, and the size so small such that being individual extensions would be wasteful.</p> <p>By default <code class="inline"><span class="w">List::Util</span></code> does not export any subroutines.</p> <h2 id="LIST-REDUCTION-FUNCTIONS">LIST-REDUCTION FUNCTIONS</h2> <p>The following set of functions all reduce a list down to a single value.</p> <h3 id="%24result-%3d-reduce-%7b-BLOCK-%7d-%40list">$result = reduce { BLOCK } @list</h3> <p>Reduces <code class="inline"><span class="i">@list</span></code> by calling <code class="inline"><span class="w">BLOCK</span></code> in a scalar context multiple times, setting <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> each time. The first call will be with <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> set to the first two elements of the list, subsequent calls will be done by setting <code class="inline"><span class="i">$a</span></code> to the result of the previous call and <code class="inline"><span class="i">$b</span></code> to the next element in the list.</p> <p>Returns the result of the last call to the <code class="inline"><span class="w">BLOCK</span></code> . If <code class="inline"><span class="i">@list</span></code> is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned. If <code class="inline"><span class="i">@list</span></code> only contains one element then that element is returned and <code class="inline"><span class="w">BLOCK</span></code> is not executed.</p> <p>The following examples all demonstrate how <code class="inline"><span class="w">reduce</span></code> could be used to implement the other list-reduction functions in this module. (They are not in fact implemented like this, but instead in a more efficient manner in individual C functions).</p> <pre class="verbatim" data-language="perl">$foo = reduce { defined($a)            ? $a :
                $code-&gt;(local $_ = $b) ? $b :
                                         undef } undef, @list # first

$foo = reduce { $a &gt; $b ? $a : $b } 1..10       # max
$foo = reduce { $a gt $b ? $a : $b } 'A'..'Z'   # maxstr
$foo = reduce { $a &lt; $b ? $a : $b } 1..10       # min
$foo = reduce { $a lt $b ? $a : $b } 'aa'..'zz' # minstr
$foo = reduce { $a + $b } 1 .. 10               # sum
$foo = reduce { $a . $b } @bar                  # concat

$foo = reduce { $a || $code-&gt;(local $_ = $b) } 0, @bar   # any
$foo = reduce { $a &amp;&amp; $code-&gt;(local $_ = $b) } 1, @bar   # all
$foo = reduce { $a &amp;&amp; !$code-&gt;(local $_ = $b) } 1, @bar  # none
$foo = reduce { $a || !$code-&gt;(local $_ = $b) } 0, @bar  # notall
   # Note that these implementations do not fully short-circuit
</pre>
<p>If your algorithm requires that <code class="inline"><span class="w">reduce</span></code> produce an identity value, then make sure that you always pass that identity value as the first argument to prevent <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> being returned</p> <pre class="verbatim" data-language="perl">$foo = reduce { $a + $b } 0, @values;             # sum with 0 identity value
</pre>
<p>The remaining list-reduction functions are all specialisations of this generic idea.</p> <h3 id="any">any</h3> <pre class="verbatim" data-language="perl">my $bool = any { BLOCK } @list;
</pre>
<p><i>Since version 1.33.</i></p> <p>Similar to <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> in that it evaluates <code class="inline"><span class="w">BLOCK</span></code> setting <code class="inline"><span class="i">$_</span></code> to each element of <code class="inline"><span class="i">@list</span></code> in turn. <code class="inline"><span class="w">any</span></code> returns true if any element makes the <code class="inline"><span class="w">BLOCK</span></code> return a true value. If <code class="inline"><span class="w">BLOCK</span></code> never returns true or <code class="inline"><span class="i">@list</span></code> was empty then it returns false.</p> <p>Many cases of using <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> in a conditional can be written using <code class="inline"><span class="w">any</span></code> instead, as it can short-circuit after the first true result.</p> <pre class="verbatim" data-language="perl">if( any { length &gt; 10 } @strings ) {
    # at least one string has more than 10 characters
}
</pre>
<h3 id="all">all</h3> <pre class="verbatim" data-language="perl">my $bool = all { BLOCK } @list;
</pre>
<p><i>Since version 1.33.</i></p> <p>Similar to <a href="#any">any</a>, except that it requires all elements of the <code class="inline"><span class="i">@list</span></code> to make the <code class="inline"><span class="w">BLOCK</span></code> return true. If any element returns false, then it returns false. If the <code class="inline"><span class="w">BLOCK</span></code> never returns false or the <code class="inline"><span class="i">@list</span></code> was empty then it returns true.</p> <h3 id="none">none</h3> <h3 id="notall">notall</h3> <pre class="verbatim" data-language="perl">my $bool = none { BLOCK } @list;

my $bool = notall { BLOCK } @list;
</pre>
<p><i>Since version 1.33.</i></p> <p>Similar to <a href="#any">any</a> and <a href="#all">all</a>, but with the return sense inverted. <code class="inline"><span class="w">none</span></code> returns true only if no value in the <code class="inline"><span class="i">@list</span></code> causes the <code class="inline"><span class="w">BLOCK</span></code> to return true, and <code class="inline"><span class="w">notall</span></code> returns true only if not all of the values do.</p> <h3 id="first">first</h3> <pre class="verbatim" data-language="perl">my $val = first { BLOCK } @list;
</pre>
<p>Similar to <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> in that it evaluates <code class="inline"><span class="w">BLOCK</span></code> setting <code class="inline"><span class="i">$_</span></code> to each element of <code class="inline"><span class="i">@list</span></code> in turn. <code class="inline"><span class="w">first</span></code> returns the first element where the result from <code class="inline"><span class="w">BLOCK</span></code> is a true value. If <code class="inline"><span class="w">BLOCK</span></code> never returns true or <code class="inline"><span class="i">@list</span></code> was empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = first { defined($_) } @list    # first defined value in @list
$foo = first { $_ &gt; $value } @list    # first value in @list which
                                      # is greater than $value
</pre>
<h3 id="max">max</h3> <pre class="verbatim" data-language="perl">my $num = max @list;
</pre>
<p>Returns the entry in the list with the highest numerical value. If the list is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = max 1..10                # 10
$foo = max 3,9,12               # 12
$foo = max @bar, @baz           # whatever
</pre>
<h3 id="maxstr">maxstr</h3> <pre class="verbatim" data-language="perl">my $str = maxstr @list;
</pre>
<p>Similar to <a href="#max">max</a>, but treats all the entries in the list as strings and returns the highest string as defined by the <code class="inline">gt</code> operator. If the list is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = maxstr 'A'..'Z'          # 'Z'
$foo = maxstr "hello","world"   # "world"
$foo = maxstr @bar, @baz        # whatever
</pre>
<h3 id="min">min</h3> <pre class="verbatim" data-language="perl">my $num = min @list;
</pre>
<p>Similar to <a href="#max">max</a> but returns the entry in the list with the lowest numerical value. If the list is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = min 1..10                # 1
$foo = min 3,9,12               # 3
$foo = min @bar, @baz           # whatever
</pre>
<h3 id="minstr">minstr</h3> <pre class="verbatim" data-language="perl">my $str = minstr @list;
</pre>
<p>Similar to <a href="#min">min</a>, but treats all the entries in the list as strings and returns the lowest string as defined by the <code class="inline">lt</code> operator. If the list is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = minstr 'A'..'Z'          # 'A'
$foo = minstr "hello","world"   # "hello"
$foo = minstr @bar, @baz        # whatever
</pre>
<h3 id="product">product</h3> <pre class="verbatim" data-language="perl">my $num = product @list;
</pre>
<p><i>Since version 1.35.</i></p> <p>Returns the numerical product of all the elements in <code class="inline"><span class="i">@list</span></code> . If <code class="inline"><span class="i">@list</span></code> is empty then <code class="inline"><span class="n">1</span></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = product 1..10            # 3628800
$foo = product 3,9,12           # 324
</pre>
<h3 id="sum">sum</h3> <pre class="verbatim" data-language="perl">my $num_or_undef = sum @list;
</pre>
<p>Returns the numerical sum of all the elements in <code class="inline"><span class="i">@list</span></code> . For backwards compatibility, if <code class="inline"><span class="i">@list</span></code> is empty then <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code> is returned.</p> <pre class="verbatim" data-language="perl">$foo = sum 1..10                # 55
$foo = sum 3,9,12               # 24
$foo = sum @bar, @baz           # whatever
</pre>
<h3 id="sum0">sum0</h3> <pre class="verbatim" data-language="perl">my $num = sum0 @list;
</pre>
<p><i>Since version 1.26.</i></p> <p>Similar to <a href="#sum">sum</a>, except this returns 0 when given an empty list, rather than <code class="inline"><a class="l_k" href="../functions/undef">undef</a></code>.</p> <h2 id="KEY%2fVALUE-PAIR-LIST-FUNCTIONS">KEY/VALUE PAIR LIST FUNCTIONS</h2> <p>The following set of functions, all inspired by <a href="http://search.cpan.org/perldoc/List::Pairwise">List::Pairwise</a>, consume an even-sized list of pairs. The pairs may be key/value associations from a hash, or just a list of values. The functions will all preserve the original ordering of the pairs, and will not be confused by multiple pairs having the same "key" value - nor even do they require that the first of each pair be a plain string.</p> <h3 id="pairgrep">pairgrep</h3> <pre class="verbatim" data-language="perl">my @kvlist = pairgrep { BLOCK } @kvlist;

my $count = pairgrep { BLOCK } @kvlist;
</pre>
<p><i>Since version 1.29.</i></p> <p>Similar to perl's <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> keyword, but interprets the given list as an even-sized list of pairs. It invokes the <code class="inline"><span class="w">BLOCK</span></code> multiple times, in scalar context, with <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> set to successive pairs of values from the <code class="inline"><span class="i">@kvlist</span></code> .</p> <p>Returns an even-sized list of those pairs for which the <code class="inline"><span class="w">BLOCK</span></code> returned true in list context, or the count of the <b>number of pairs</b> in scalar context. (Note, therefore, in scalar context that it returns a number half the size of the count of items it would have returned in list context).</p> <pre class="verbatim" data-language="perl">@subset = pairgrep { $a =~ m/^[[:upper:]]+$/ } @kvlist
</pre>
<p>As with <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> aliasing <code class="inline"><span class="i">$_</span></code> to list elements, <code class="inline"><span class="w">pairgrep</span></code> aliases <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> to elements of the given list. Any modifications of it by the code block will be visible to the caller.</p> <h3 id="pairfirst">pairfirst</h3> <pre class="verbatim" data-language="perl">my ( $key, $val ) = pairfirst { BLOCK } @kvlist;

my $found = pairfirst { BLOCK } @kvlist;
</pre>
<p><i>Since version 1.30.</i></p> <p>Similar to the <a href="#first">first</a> function, but interprets the given list as an even-sized list of pairs. It invokes the <code class="inline"><span class="w">BLOCK</span></code> multiple times, in scalar context, with <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> set to successive pairs of values from the <code class="inline"><span class="i">@kvlist</span></code> .</p> <p>Returns the first pair of values from the list for which the <code class="inline"><span class="w">BLOCK</span></code> returned true in list context, or an empty list of no such pair was found. In scalar context it returns a simple boolean value, rather than either the key or the value found.</p> <pre class="verbatim" data-language="perl">( $key, $value ) = pairfirst { $a =~ m/^[[:upper:]]+$/ } @kvlist
</pre>
<p>As with <code class="inline"><a class="l_k" href="../functions/grep">grep</a></code> aliasing <code class="inline"><span class="i">$_</span></code> to list elements, <code class="inline"><span class="w">pairfirst</span></code> aliases <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> to elements of the given list. Any modifications of it by the code block will be visible to the caller.</p> <h3 id="pairmap">pairmap</h3> <pre class="verbatim" data-language="perl">my @list = pairmap { BLOCK } @kvlist;

my $count = pairmap { BLOCK } @kvlist;
</pre>
<p><i>Since version 1.29.</i></p> <p>Similar to perl's <code class="inline"><a class="l_k" href="../functions/map">map</a></code> keyword, but interprets the given list as an even-sized list of pairs. It invokes the <code class="inline"><span class="w">BLOCK</span></code> multiple times, in list context, with <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> set to successive pairs of values from the <code class="inline"><span class="i">@kvlist</span></code> .</p> <p>Returns the concatenation of all the values returned by the <code class="inline"><span class="w">BLOCK</span></code> in list context, or the count of the number of items that would have been returned in scalar context.</p> <pre class="verbatim" data-language="perl">@result = pairmap { "The key $a has value $b" } @kvlist
</pre>
<p>As with <code class="inline"><a class="l_k" href="../functions/map">map</a></code> aliasing <code class="inline"><span class="i">$_</span></code> to list elements, <code class="inline"><span class="w">pairmap</span></code> aliases <code class="inline"><span class="i">$a</span></code> and <code class="inline"><span class="i">$b</span></code> to elements of the given list. Any modifications of it by the code block will be visible to the caller.</p> <p>See <a href="#KNOWN-BUGS">KNOWN BUGS</a> for a known-bug with <code class="inline"><span class="w">pairmap</span></code> , and a workaround.</p> <h3 id="pairs">pairs</h3> <pre class="verbatim" data-language="perl">my @pairs = pairs @kvlist;
</pre>
<p><i>Since version 1.29.</i></p> <p>A convenient shortcut to operating on even-sized lists of pairs, this function returns a list of ARRAY references, each containing two items from the given list. It is a more efficient version of</p> <pre class="verbatim" data-language="perl">@pairs = pairmap { [ $a, $b ] } @kvlist
</pre>
<p>It is most convenient to use in a <code class="inline">foreach</code> loop, for example:</p> <pre class="verbatim" data-language="perl">foreach my $pair ( pairs @KVLIST ) {
   my ( $key, $value ) = @$pair;
   ...
}
</pre>
<p>Since version <code class="inline"><span class="n">1.39</span></code> these ARRAY references are blessed objects, recognising the two methods <code class="inline"><span class="w">key</span></code> and <code class="inline"><span class="w">value</span></code> . The following code is equivalent:</p> <pre class="verbatim" data-language="perl">foreach my $pair ( pairs @KVLIST ) {
   my $key   = $pair-&gt;key;
   my $value = $pair-&gt;value;
   ...
}
</pre>
<h3 id="pairkeys">pairkeys</h3> <pre class="verbatim" data-language="perl">my @keys = pairkeys @kvlist;
</pre>
<p><i>Since version 1.29.</i></p> <p>A convenient shortcut to operating on even-sized lists of pairs, this function returns a list of the the first values of each of the pairs in the given list. It is a more efficient version of</p> <pre class="verbatim" data-language="perl">@keys = pairmap { $a } @kvlist
</pre>
<h3 id="pairvalues">pairvalues</h3> <pre class="verbatim" data-language="perl">my @values = pairvalues @kvlist;
</pre>
<p><i>Since version 1.29.</i></p> <p>A convenient shortcut to operating on even-sized lists of pairs, this function returns a list of the the second values of each of the pairs in the given list. It is a more efficient version of</p> <pre class="verbatim" data-language="perl">@values = pairmap { $b } @kvlist
</pre>
<h2 id="OTHER-FUNCTIONS">OTHER FUNCTIONS</h2> <h3 id="shuffle">shuffle</h3> <pre class="verbatim" data-language="perl">my @values = shuffle @values;
</pre>
<p>Returns the values of the input in a random order</p> <pre class="verbatim" data-language="perl">@cards = shuffle 0..51      # 0..51 in a random order
</pre>
<h2 id="KNOWN-BUGS">KNOWN BUGS</h2> <h3 id="RT-%2395409">RT #95409</h3> <p><a href="https://rt.cpan.org/Ticket/Display.html?id=95409">https://rt.cpan.org/Ticket/Display.html?id=95409</a></p> <p>If the block of code given to <a href="#pairmap">pairmap</a> contains lexical variables that are captured by a returned closure, and the closure is executed after the block has been re-used for the next iteration, these lexicals will not see the correct values. For example:</p> <pre class="verbatim" data-language="perl">my @subs = pairmap {
   my $var = "$a is $b";
   sub { print "$var\n" };
} one =&gt; 1, two =&gt; 2, three =&gt; 3;

$_-&gt;() for @subs;
</pre>
<p>Will incorrectly print</p> <pre class="verbatim" data-language="perl">three is 3
three is 3
three is 3
</pre>
<p>This is due to the performance optimisation of using <code class="inline"><span class="w">MULTICALL</span></code> for the code block, which means that fresh SVs do not get allocated for each call to the block. Instead, the same SV is re-assigned for each iteration, and all the closures will share the value seen on the final iteration.</p> <p>To work around this bug, surround the code with a second set of braces. This creates an inner block that defeats the <code class="inline"><span class="w">MULTICALL</span></code> logic, and does get fresh SVs allocated each time:</p> <pre class="verbatim" data-language="perl">my @subs = pairmap {
   {
      my $var = "$a is $b";
      sub { print "$var\n"; }
   }
} one =&gt; 1, two =&gt; 2, three =&gt; 3;
</pre>
<p>This bug only affects closures that are generated by the block but used afterwards. Lexical variables that are only used during the lifetime of the block's execution will take their individual values for each invocation, as normal.</p> <h2 id="SUGGESTED-ADDITIONS">SUGGESTED ADDITIONS</h2> <p>The following are additions that have been requested, but I have been reluctant to add due to them being very simple to implement in perl</p> <pre class="verbatim" data-language="perl"># How many elements are true

sub true { scalar grep { $_ } @_ }

# How many elements are false

sub false { scalar grep { !$_ } @_ }
</pre>
<h2 id="SEE-ALSO">SEE ALSO</h2> <p><a href="../scalar/util">Scalar::Util</a>, <a href="http://search.cpan.org/perldoc/List::MoreUtils">List::MoreUtils</a></p> <h2 id="COPYRIGHT">COPYRIGHT</h2> <p>Copyright (c) 1997-2007 Graham Barr &lt;gbarr@pobox.com&gt;. All rights reserved. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p> <p>Recent additions and current maintenance by Paul Evans, &lt;leonerd@leonerd.org.uk&gt;.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 1993–2016 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.26.0/List/Util.html" class="_attribution-link">https://perldoc.perl.org/5.26.0/List/Util.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

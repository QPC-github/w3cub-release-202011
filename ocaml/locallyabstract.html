
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>08.04. Locally Abstract Types - OCaml - W3cubDocs</title>
  
  <meta name="description" content=" (Introduced in OCaml 3.12, short syntax added in 4.03) ">
  <meta name="keywords" content="locally, abstract, types, ocaml">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ocaml/locallyabstract.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/ocaml.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ocaml/" class="_nav-link" title="" style="margin-left:0;">OCaml</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _ocaml">
				
				
<a href="privatetypes"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIgPgogIDxwYXRoIGQ9Ik00IDEybDggOGwxLjQxNCAtMS40MTRMNy44MjggMTNIMjB2LTJINy44MjhMMTMuNDE0IDUuNDE0TDEyIDR6Ii8+Cjwvc3ZnPgo=" alt="Previous"></a> <a href="extn"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiPgogIDxwYXRoIGQ9Ik0xMiA0bDggOGwtMS40MTQgMS40MTRMMTMgNy44MjhWMjBoLTJWNy44MjhMNS40MTQgMTMuNDE0TDQgMTJ6Ii8+Cjwvc3ZnPgo=" alt="Up"></a> <a href="firstclassmodules"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIgPgogIDxwYXRoIGQ9Ik0yMCAxMmwtOCA4bC0xLjQxNCAtMS40MTRMMTYuMTcyIDEzSDR2LTJIMTYuMTcyTDEwLjU4NiA1LjQxNEwxMiA0IHoiLz4KPC9zdmc+Cg==" alt="Next"></a> <hr> <h2 class="section" id="s:locally-abstract">
<a class="section-anchor" href="#s:locally-abstract" aria-hidden="true">﻿</a>8.4 Locally abstract types</h2> 
<p>(Introduced in OCaml 3.12, short syntax added in 4.03)</p>
<div class="syntax"><table class="display dcenter">
<tr class="c019"><td class="dcell"><table class="c001 cellpading0">
<tr>
<td class="c018"> <a class="syntax" href="expr#parameter"><span class="c010">parameter</span></a>
</td>
<td class="c015">::=</td>
<td class="c017"> ... </td>
</tr> <tr>
<td class="c018"> </td>
<td class="c015">∣</td>
<td class="c017"> <span class="c004">(</span> <span class="c004">type</span> {<a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a>}<sup>+</sup> <span class="c004">)</span> </td>
</tr> </table></td></tr> </table></div>
<p>The expression <span class="c002"><span class="c003">fun</span> <span class="c003">(</span> <span class="c003">type</span></span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> <span class="c002"><span class="c003">)</span> <span class="c003">-&gt;</span></span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> introduces a type constructor named <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> which is considered abstract in the scope of the sub-expression, but then replaced by a fresh type variable. Note that contrary to what the syntax could suggest, the expression <span class="c002"><span class="c003">fun</span> <span class="c003">(</span> <span class="c003">type</span></span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> <span class="c002"><span class="c003">)</span> <span class="c003">-&gt;</span></span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> itself does not suspend the evaluation of <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> as a regular abstraction would. The syntax has been chosen to fit nicely in the context of function declarations, where it is generally used. It is possible to freely mix regular function parameters with pseudo type parameters, as in: </p>
<pre class="caml-example verbatim" data-language="ocaml">   let f = fun (type t) (foo : t list) -&gt; … </pre>
<p> and even use the alternative syntax for declaring functions: </p>
<pre class="caml-example verbatim" data-language="ocaml">   let f (type t) (foo : t list) = … </pre>
<p> If several locally abstract types need to be introduced, it is possible to use the syntax <span class="c002"><span class="c003">fun</span> <span class="c003">(</span> <span class="c003">type</span></span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a><sub>1</sub> … <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a><sub><span class="c009">n</span></sub> <span class="c002"><span class="c003">)</span> <span class="c003">-&gt;</span></span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> as syntactic sugar for <span class="c002"><span class="c003">fun</span> <span class="c003">(</span> <span class="c003">type</span></span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a><sub>1</sub> <span class="c002"><span class="c003">)</span> <span class="c003">-&gt;</span></span> … <span class="c002"><span class="c003">-&gt;</span> <span class="c003">fun</span> <span class="c003">(</span> <span class="c003">type</span></span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a><sub><span class="c009">n</span></sub> <span class="c002"><span class="c003">)</span> <span class="c003">-&gt;</span></span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a>. For instance, </p>
<pre class="caml-example verbatim" data-language="ocaml">   let f = fun (type t u v) -&gt; fun (foo : (t * u * v) list) -&gt; … let f' (type t u v) (foo : (t * u * v) list) = … </pre>
<p>This construction is useful because the type constructors it introduces can be used in places where a type variable is not allowed. For instance, one can use it to define an exception in a local module within a polymorphic function. </p>
<pre class="caml-example verbatim" data-language="ocaml">   let f (type t) () = let module M = struct exception E of t end in (fun x -&gt; M.E x), (function M.E x -&gt; Some x | _ -&gt; None) </pre>
<p>Here is another example: </p>
<pre class="caml-example verbatim" data-language="ocaml">   let sort_uniq (type s) (cmp : s -&gt; s -&gt; int) = let module S = Set.Make(struct type t = s let compare = cmp end) in fun l -&gt; S.elements (List.fold_right S.add l S.empty) </pre>
<p>It is also extremely useful for first-class modules (see section <a href="firstclassmodules#s%3Afirst-class-modules">8.5</a>) and generalized algebraic datatypes (GADTs: see section <a href="gadts#s%3Agadts">8.10</a>).</p> <h5 class="paragraph" id="p:polymorpic-locally-abstract">
<a class="section-anchor" href="#p:polymorpic-locally-abstract" aria-hidden="true">﻿</a>Polymorphic syntax</h5> <p> (Introduced in OCaml 4.00)</p>
<div class="syntax"><table class="display dcenter">
<tr class="c019"><td class="dcell"><table class="c001 cellpading0">
<tr>
<td class="c018"> <a class="syntax" href="expr#let-binding"><span class="c010">let-binding</span></a>
</td>
<td class="c015">::=</td>
<td class="c017"> ... </td>
</tr> <tr>
<td class="c018"> </td>
<td class="c015">∣</td>
<td class="c017"> <a class="syntax" href="names#value-name"><span class="c010">value-name</span></a> <span class="c004">:</span> <span class="c004">type</span> { <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> }<sup>+</sup> <span class="c004">.</span> <a class="syntax" href="types#typexpr"><span class="c010">typexpr</span></a> <span class="c004">=</span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> </td>
</tr> <tr><td class="c018"> </td></tr> <tr>
<td class="c018"> <a class="syntax" href="classes#class-field"><span class="c010">class-field</span></a>
</td>
<td class="c015">::=</td>
<td class="c017"> ... </td>
</tr> <tr>
<td class="c018"> </td>
<td class="c015">∣</td>
<td class="c017"> <span class="c004">method</span> [<span class="c004">private</span>] <a class="syntax" href="names#method-name"><span class="c010">method-name</span></a> <span class="c004">:</span> <span class="c004">type</span> { <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> }<sup>+</sup> <span class="c004">.</span> <a class="syntax" href="types#typexpr"><span class="c010">typexpr</span></a> <span class="c004">=</span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> </td>
</tr> <tr>
<td class="c018"> </td>
<td class="c015">∣</td>
<td class="c017"> <span class="c004">method!</span> [<span class="c004">private</span>] <a class="syntax" href="names#method-name"><span class="c010">method-name</span></a> <span class="c004">:</span> <span class="c004">type</span> { <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a> }<sup>+</sup> <span class="c004">.</span> <a class="syntax" href="types#typexpr"><span class="c010">typexpr</span></a> <span class="c004">=</span> <a class="syntax" href="expr#expr"><span class="c010">expr</span></a> </td>
</tr> </table></td></tr> </table></div>
<p>The <span class="c004">(type</span> <a class="syntax" href="names#typeconstr-name"><span class="c010">typeconstr-name</span></a><span class="c004">)</span> syntax construction by itself does not make polymorphic the type variable it introduces, but it can be combined with explicit polymorphic annotations where needed. The above rule is provided as syntactic sugar to make this easier: </p>
<pre class="caml-example verbatim" data-language="ocaml">   let rec f : type t1 t2. t1 * t2 list -&gt; t1 = … </pre>
<p> is automatically expanded into </p>
<pre class="caml-example verbatim" data-language="ocaml">   let rec f : 't1 't2. 't1 * 't2 list -&gt; 't1 = fun (type t1) (type t2) -&gt; ( … : t1 * t2 list -&gt; t1) </pre>
<p> This syntax can be very useful when defining recursive functions involving GADTs, see the section <a href="gadts#s%3Agadts">8.10</a> for a more detailed explanation.</p>
<p>The same feature is provided for method definitions.</p> <hr> <a href="privatetypes"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIgPgogIDxwYXRoIGQ9Ik00IDEybDggOGwxLjQxNCAtMS40MTRMNy44MjggMTNIMjB2LTJINy44MjhMMTMuNDE0IDUuNDE0TDEyIDR6Ii8+Cjwvc3ZnPgo=" alt="Previous"></a> <a href="extn"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB3aWR0aD0iMjQiPgogIDxwYXRoIGQ9Ik0xMiA0bDggOGwtMS40MTQgMS40MTRMMTMgNy44MjhWMjBoLTJWNy44MjhMNS40MTQgMTMuNDE0TDQgMTJ6Ii8+Cjwvc3ZnPgo=" alt="Up"></a> <a href="firstclassmodules"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIgPgogIDxwYXRoIGQ9Ik0yMCAxMmwtOCA4bC0xLjQxNCAtMS40MTRMMTYuMTcyIDEzSDR2LTJIMTYuMTcyTDEwLjU4NiA1LjQxNEwxMiA0IHoiLz4KPC9zdmc+Cg==" alt="Next"></a><div class="_attribution">
  <p class="_attribution-p">
    © INRIA 1995-2020.<br>
    <a href="https://www.ocaml.org/releases/4.11/htmlman/locallyabstract.html" class="_attribution-link">https://www.ocaml.org/releases/4.11/htmlman/locallyabstract.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Std&#58;&#58;realloc - C++ - W3cubDocs</title>
  
  <meta name="description" content="Reallocates the given area of memory. It must be previously allocated by std&#58;&#58;malloc(), std&#58;&#58;calloc() or std&#58;&#58;realloc() and &hellip;">
  <meta name="keywords" content="std, realloc, c++, cpp">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/cpp/memory/c/realloc.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/cpp.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/cpp/" class="_nav-link" title="" style="margin-left:0;">C++</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _c">
				
				
<h1 id="firstHeading" class="firstHeading">std::realloc</h1>            <table class="t-dcl-begin"> <tr class="t-dsc-header"> <th> Defined in header <code><a href="../../header/cstdlib" title="cpp/header/cstdlib">&lt;cstdlib&gt;</a></code> </th> <th> </th> <th> </th> </tr> <tr class="t-dcl"> <td class="t-dcl-nopad"> <pre data-language="cpp">void* realloc( void* ptr, std::size_t new_size );</pre>
</td> <td class="t-dcl-nopad"> </td> <td class="t-dcl-nopad"> </td> </tr>  </table> <p>Reallocates the given area of memory. It must be previously allocated by <code><a href="malloc" title="cpp/memory/c/malloc">std::malloc()</a></code>, <code><a href="calloc" title="cpp/memory/c/calloc">std::calloc()</a></code> or <code>std::realloc()</code> and not yet freed with <code><a href="free" title="cpp/memory/c/free">std::free()</a></code>, otherwise, the results are undefined.</p>
<p>The reallocation is done by either:</p>
<div class="t-li1">
<span class="t-li">a)</span> expanding or contracting the existing area pointed to by <code>ptr</code>, if possible. The contents of the area remain unchanged up to the lesser of the new and old sizes. If the area is expanded, the contents of the new part of the array are undefined. </div> <div class="t-li1">
<span class="t-li">b)</span> allocating a new memory block of size <code>new_size</code> bytes, copying memory area with size equal the lesser of the new and the old sizes, and freeing the old block.</div> <p>If there is not enough memory, the old memory block is not freed and null pointer is returned.</p>
<p>If <code>ptr</code> is a null pointer, the behavior is the same as calling <code><a href="malloc" title="cpp/memory/c/malloc">std::malloc</a></code>(<code>new_size</code>).</p>
<p>If <code>new_size</code> is zero, the behavior is implementation defined: null pointer may be returned (in which case the old memory block may or may not be freed) or some non-null pointer may be returned that may not be used to access storage.</p>
<table class="t-rev-begin"> <tr class="t-rev t-since-cxx11">
<td> <p>The following functions are required to be thread-safe:</p>
<ul>
<li> The library versions of <a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a> and <a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li> User replacement versions of global <a href="../new/operator_new" title="cpp/memory/new/operator new"><code>operator new</code></a> and <a href="../new/operator_delete" title="cpp/memory/new/operator delete"><code>operator delete</code></a> </li>
<li> <code><a href="calloc" title="cpp/memory/c/calloc">std::calloc</a></code>, <code><a href="malloc" title="cpp/memory/c/malloc">std::malloc</a></code>, <code>std::realloc</code><span class="t-rev-inl t-since-cxx17"><span>, <code><a href="aligned_alloc" title="cpp/memory/c/aligned alloc">std::aligned_alloc</a></code></span> <span><span class="t-mark-rev t-since-cxx17">(since C++17)</span></span></span>, <code><a href="free" title="cpp/memory/c/free">std::free</a></code> </li>
</ul> <p>Calls to these functions that allocate or deallocate a particular unit of storage occur in a single total order, and each such deallocation call <a href="../../atomic/memory_order" title="cpp/atomic/memory order">happens-before</a> the next allocation (if any) in this order.</p>
</td> <td><span class="t-mark-rev t-since-cxx11">(since C++11)</span></td>
</tr> </table> <h3 id="Parameters">Parameters</h3> <table class="t-par-begin"> <tr class="t-par"> <td> ptr </td> <td> - </td> <td> pointer to the memory area to be reallocated </td>
</tr> <tr class="t-par"> <td> new_size </td> <td> - </td> <td> new size of the array </td>
</tr>
</table> <h3 id="Return_value">Return value</h3> <p>On success, returns a pointer to the beginning of newly allocated memory. To avoid a memory leak, the returned pointer must be deallocated with <code><a href="free" title="cpp/memory/c/free">std::free()</a></code>, the original pointer <code>ptr</code> is invalidated and any access to it is <a href="../../language/ub" title="cpp/language/ub">undefined behavior</a> (even if reallocation was in-place).</p>
<p>On failure, returns a null pointer. The original pointer <code>ptr</code> remains valid and may need to be deallocated with <code><a href="free" title="cpp/memory/c/free">std::free()</a></code>.</p>
<h3 id="Notes">Notes</h3> <p>Because reallocation may involve bytewise copying (regardless of whether it's to expand or to contract), only the objects of <a href="../../named_req/triviallycopyable" title="cpp/named req/TriviallyCopyable">TriviallyCopyable</a> types are safe to access in the preserved part of the memory block after a call to <code>realloc</code>.</p>
<p>Some non-standard libraries define a type trait "BitwiseMovable" or "Relocatable", which describes a type that doesn't have:</p>
<ul>
<li> external references (e.g. nodes of a list or a tree that holds reference to another element), and </li>
<li> internal references (e.g. member pointer which might hold the address of another member). </li>
</ul> <p>Objects of such type can be accessed after their storage is reallocated even if their copy constructors are not trivial.</p>
<h3 id="Example">Example</h3> <div class="t-example"> <div class="cpp source-cpp"><pre data-language="cpp">#include &lt;cstdlib&gt;
#include &lt;new&gt;
#include &lt;cassert&gt;
 
class MallocDynamicBuffer
{
    char* p;
public:
    explicit MallocDynamicBuffer(std::size_t initial = 0) : p(nullptr) {
       resize(initial);
    }
    ~MallocDynamicBuffer() { std::free(p); }
    void resize(std::size_t newSize) {
        if(newSize == 0) { // this check is not strictly needed, 
            std::free(p);  // but zero-size realloc is deprecated in C
            p = nullptr;
        } else {
            if(void* mem = std::realloc(p, newSize))
                p = static_cast&lt;char*&gt;(mem);
            else
                throw std::bad_alloc();
        }
    }
    char&amp; operator[](size_t n) { return p[n]; }
    char operator[](size_t n) const { return p[n]; }
};
 
int main()
{
    MallocDynamicBuffer buf1(1024);
    buf1[5] = 'f';
    buf1.resize(10); // shrink
    assert(buf1[5] == 'f');
    buf1.resize(1024); // grow
    assert(buf1[5] == 'f');
}</pre></div> </div> <h3 id="See_also">See also</h3>           <div class="_attribution">
  <p class="_attribution-p">
    Â© cppreference.com<br>Licensed under the Creative Commons Attribution-ShareAlike Unported License v3.0.<br>
    <a href="http://en.cppreference.com/w/cpp/memory/c/realloc" class="_attribution-link">http://en.cppreference.com/w/cpp/memory/c/realloc</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Row Values - SQLite - W3cubDocs</title>
  
  <meta name="description" content="A &#34;value&#34; is a single number, string, BLOB or NULL. Sometimes the qualified name &#34;scalar value&#34; is used to emphasize that only a &hellip;">
  <meta name="keywords" content="row, values, definitions, syntax, example, uses, backwards, compatibility, sqlite">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/sqlite/rowvalue.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/sqlite.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/sqlite/" class="_nav-link" title="" style="margin-left:0;">SQLite</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sqlite">
				
				
<h1 class="fancy_title"> Row Values </h1> <div class="fancy_toc">  <div id="toc_sub">
<div class="fancy-toc1"><a href="#definitions">1. Definitions</a></div> <div class="fancy-toc1"><a href="#syntax">2. Syntax</a></div> <div class="fancy-toc2"><a href="#row_value_comparisons">2.1. Row Value Comparisons</a></div> <div class="fancy-toc2"><a href="#row_values_in_update_statements">2.2. Row Values In UPDATE Statements</a></div> <div class="fancy-toc1"><a href="#example_uses_of_row_values">3. Example Uses Of Row Values</a></div> <div class="fancy-toc2"><a href="#scrolling_window_queries">3.1. Scrolling Window Queries</a></div> <div class="fancy-toc2"><a href="#comparison_of_dates_stored_as_separate_fields">3.2. Comparison of dates stored as separate fields</a></div> <div class="fancy-toc2"><a href="#search_against_multi_column_keys">3.3. Search against multi-column keys</a></div> <div class="fancy-toc2"><a href="#update_multiple_columns_of_a_table_based_on_a_query">3.4. Update multiple columns of a table based on a query</a></div> <div class="fancy-toc2"><a href="#clarity_of_presentation">3.5. Clarity of presentation</a></div> <div class="fancy-toc1"><a href="#backwards_compatibility">4. Backwards Compatibility</a></div> </div> </div>   <h1 id="definitions">
<span>1. </span>Definitions</h1> <p>A "value" is a single number, string, BLOB or NULL. Sometimes the qualified name "scalar value" is used to emphasize that only a single quantity is involved. </p>
<p>A "row value" is an ordered list of two or more scalar values. In other words, a "row value" is a vector. </p>
<p>The "size" of a row value is the number of scalar values the row value contains. The size of a row value is always at least 2. A row value with a single column is just a scalar value. A row value with no columns is a syntax error. </p>
<h1 id="syntax">
<span>2. </span>Syntax</h1> <p>SQLite allows row values to be expressed in two ways: </p>
<ol> <li>A parenthesized, comma-separated list of scalar values. </li>
<li>A subquery expression with two or more result columns. </li>
</ol> <p>SQLite can use row values in two contexts: </p>
<ol> <li>Two row values of the same size can be compared using operators &lt;, &lt;=, &gt;, &gt;=, =, &lt;&gt;, IS, IS NOT, IN, NOT IN, BETWEEN, or CASE. </li>
<li>In an <a href="lang_update">UPDATE</a> statement, a list of column names can be set to a row value of the same size. </li>
</ol> <p>The syntax for row values and the circumstances in which row values can be used are illustrated in examples below. </p>
<h2 id="row_value_comparisons">
<span>2.1. </span>Row Value Comparisons</h2> <p>Two row values are compared by looking at the constituent scalar values from left to right. A NULL means of "unknown". The overall result of comparison is NULL if it is possible to make the result either true or false by substituting alternative values in place of the constituent NULLs. The following query demonstrates some row value comparisons: </p>
<pre data-language="sql">SELECT
  (1,2,3) = (1,2,3),          -- 1
  (1,2,3) = (1,NULL,3),       -- NULL
  (1,2,3) = (1,NULL,4),       -- 0
  (1,2,3) &lt; (2,3,4),          -- 1
  (1,2,3) &lt; (1,2,4),          -- 1
  (1,2,3) &lt; (1,3,NULL),       -- 1
  (1,2,3) &lt; (1,2,NULL),       -- NULL
  (1,3,5) &lt; (1,2,NULL),       -- 0
  (1,2,NULL) IS (1,2,NULL);   -- 1
</pre> <p>The result of "(1,2,3)=(1,NULL,3)" is NULL because the result might be true if we replaced NULL→2 or false if we replaced NULL→9. The result of "(1,2,3)=(1,NULL,4)" is not NULL because there is no substitutions of the constituent NULL that will make the expression true, since 3 will never equal 4 in the third column. </p>
<p>Any of the row values in the previous example could be replace by a subquery that returns three columns and the same answer would result. For example: </p>
<pre data-language="sql">CREATE TABLE t1(a,b,c);
INSERT INTO t1(a,b,c) VALUES(1,2,3);
SELECT (1,2,3)=(SELECT * FROM t1); -- 1
</pre> <p>For a row-value <a href="lang_expr#in_op">IN operator</a>, the left-hand side (hereafter "LHS") can be either a parenthesized list of values or a subquery with multiple columns. But the right-hand side (hereafter "RHS") must be a subquery expression. </p>
<pre data-language="sql">CREATE TABLE t2(x,y,z);
INSERT INTO t2(x,y,z) VALUES(1,2,3),(2,3,4),(1,NULL,5);
SELECT
   (1,2,3) IN (SELECT * FROM t2),  -- 1
   (7,8,9) IN (SELECT * FROM t2),  -- 0
   (1,3,5) IN (SELECT * FROM t2);  -- NULL
</pre> <h2 id="row_values_in_update_statements">
<span>2.2. </span>Row Values In UPDATE Statements</h2> <p>Row values can also be used in the SET clause of an <a href="lang_update">UPDATE</a> statement. The LHS must be a list of column names. The RHS can be any row value. For example: </p>
<pre data-language="sql">UPDATE tab3 
   SET (a,b,c) = (SELECT x,y,z
                    FROM tab4
                   WHERE tab4.w=tab3.d)
 WHERE tab3.e BETWEEN 55 AND 66;
</pre> <h1 id="example_uses_of_row_values">
<span>3. </span>Example Uses Of Row Values</h1> <h2 id="scrolling_window_queries">
<span>3.1. </span>Scrolling Window Queries</h2> <p>Suppose an application wants to display a list of contacts in alphabetical order by lastname, firstname, in a scrolling window that can only show 7 contacts at a time. Initialize the scrolling window to the first 7 entries is easy: </p>
<pre data-language="sql">SELECT * FROM contacts
 ORDER BY lastname, firstname
 LIMIT 7;
</pre> <p>When the user scrolls down, the application needs to find the second set of 7 entries. One way to do this is to use the OFFSET clause: </p>
<pre data-language="sql">SELECT * FROM contacts
 ORDER BY lastname, firstname
 LIMIT 7 OFFSET 7;
</pre> <p>OFFSET gives the correct answer. However, OFFSET requires time proportional to the offset value. What really happens with "LIMIT x OFFSET y" is that SQLite computes the query as "LIMIT x+y" and discards the first y values without returning them to the application. So as the window scrolls down toward the bottom of a long list, and the y value becomes larger and larger, successive offset computations take more and more time. </p>
<p>A more efficient approach is to remember the last entry currently displayed and then use a row value comparison in the WHERE clause: </p>
<pre data-language="sql">SELECT * FROM contacts
 WHERE (lastname,firstname) &gt; (?1,?2)
 ORDER BY lastname, firstname
 LIMIT 7;
</pre> <p>If the lastname and firstname on the bottom row of the previous screen are bound to ?1 and ?2, then the query above computes the next 7 rows. And, assuming there is an appropriate index, it does so very efficiently — much more efficiently than OFFSET. </p>
<h2 id="comparison_of_dates_stored_as_separate_fields">
<span>3.2. </span>Comparison of dates stored as separate fields</h2> <p>The usual way of storing a date in a database table is as a single field, as either a unix timestamp, a julian day number, or an ISO-8601 dates string. But some application store dates as three separate fields for the year, month, and day. </p>
<pre data-language="sql">CREATE TABLE info(
  year INT,          -- 4 digit year
  month INT,         -- 1 through 12
  day INT,           -- 1 through 31
  other_stuff BLOB   -- blah blah blah
);
</pre> <p>When dates are stored this way, row value comparisons provide a convenient way to compare dates: </p>
<pre data-language="sql">SELECT * FROM info
 WHERE (year,month,day) BETWEEN (2015,9,12) AND (2016,9,12);
</pre> <h2 id="search_against_multi_column_keys">
<span>3.3. </span>Search against multi-column keys</h2> <p>Suppose we want to know the order number, product number, and quantity for any item in which the product number and quantity match the product number and quantity of any item in order number 365: </p>
<pre data-language="sql">SELECT ordid, prodid, qty
  FROM item
 WHERE (prodid, qty) IN (SELECT prodid, qty
                           FROM item
                          WHERE ordid = 365);
</pre> <p>The query above could be rewritten as a join and without the use of row values: </p>
<pre data-language="sql">SELECT t1.ordid, t1.prodid, t1.qty
  FROM item AS t1, item AS t2
 WHERE t1.prodid=t2.prodid
   AND t1.qty=t2.qty
   AND t2.ordid=365;
</pre> <p>Because the same query could be written without the use of row values, row values do not provide new capabilities. However, many developers say that the row value format is easier to read, write, and debug. </p>
<p>Even in the JOIN form, the query can be made clearer through the use of row values: </p>
<pre data-language="sql">SELECT t1.ordid, t1.prodid, t1.qty
  FROM item AS t1, item AS t2
 WHERE (t1.prodid,t1.qty) = (t2.prodid,t2.qty)
   AND t2.ordid=365;
</pre> <p>This later query generates exactly the same <a href="opcode">bytecode</a> as the previous scalar formulation, but using syntax that it cleaner and easier to read. </p>
<h2 id="update_multiple_columns_of_a_table_based_on_a_query">
<span>3.4. </span>Update multiple columns of a table based on a query</h2> <p>The row-value notation is useful for updating two or more columns of a table from the result of a single query. An example of this is in the full-text search feature of the <a href="https://www.fossil-scm.org/">Fossil version control system</a>. </p>
<p>In the Fossil full-text search system, documents that participate in the full-text search (wiki pages, tickets, check-ins, documentation files, etc) are tracked by a table called "ftsdocs" (<u>f</u>ull <u>t</u>ext <u>s</u>earch <u>doc</u>ument<u>s</u>). As new documents are added to the repository, they are not indexed right away. Indexing is deferred until there is a search request. The ftsdocs table contains an "idxed" field which is true if the document has been indexed and false if not. </p>
<p>When a search request occurs and pending documents are indexed for the first time, the ftsdocs table must be updated by setting the idxed column to true and also filling in several other columns with information pertinent to the search. That other information is obtained from a join. The query is this: </p>
<pre data-language="sql">UPDATE ftsdocs SET
  idxed=1,
  name=NULL,
  (label,url,mtime) = 
      (SELECT printf('Check-in [%%.16s] on %%s',blob.uuid,
                     datetime(event.mtime)),
              printf('/timeline?y=ci&amp;c=%%.20s',blob.uuid),
              event.mtime
         FROM event, blob
        WHERE event.objid=ftsdocs.rid
          AND blob.rid=ftsdocs.rid)
WHERE ftsdocs.type='c' AND NOT ftsdocs.idxed
</pre> <p>(See the <a href="https://www.fossil-scm.org/fossil/artifact/e5d6a82d?ln=1594-1605">source code</a> for further detail. Other examples <a href="https://www.fossil-scm.org/fossil/artifact/e5d6a82d?ln=1618-1628">here</a> and <a href="https://www.fossil-scm.org/fossil/artifact/e5d6a82d?ln=1641-1650">here</a>.) </p>
<p>Five out of nine columns in the ftsdocs table are updated. Two of the modified columns, "idxed" and "name", can be updated independently of the query. But the three columns "label", "url", and "mtime" all require a join query against the "event" and "blob" tables. Without row values, the equivalent UPDATE would require that the join be repeated three times, once for each column to be updated. </p>
<h2 id="clarity_of_presentation">
<span>3.5. </span>Clarity of presentation</h2> <p>Sometimes the use of row values just makes the SQL easier to read and write. Consider the following two UPDATE statements: </p>
<pre data-language="sql">UPDATE tab1 SET (a,b)=(b,a);
UPDATE tab1 SET a=b, b=a;
</pre> <p>Both UPDATE statements do exactly the same thing. (They generate identical <a href="opcode">bytecode</a>.) But the first form, the row value form, seems to make it clearer that the intent of the statement is to swap the values in columns A and B. </p>
<p>Or consider these identical queries: </p>
<pre data-language="sql">SELECT * FROM tab1 WHERE a=?1 AND b=?2;
SELECT * FROM tab1 WHERE (a,b)=(?1,?2);
</pre> <p>Once again, the SQL statements generate identical bytecode and thus do exactly the same job in exactly the same way. But the second form is made easier for humans to read by grouping the query parameters together into a single row value rather than scattering them across the WHERE clause. </p>
<h1 id="backwards_compatibility">
<span>4. </span>Backwards Compatibility</h1> <p>Row values were added to SQLite <a href="https://sqlite.org/releaselog/3_15_0.html">version 3.15.0</a> (2016-10-14). Attempts to use row values in prior versions of SQLite will generate syntax errors. </p>
<div class="_attribution">
  <p class="_attribution-p">
    SQLite is in the Public Domain.<br>
    <a href="https://sqlite.org/rowvalue.html" class="_attribution-link">https://sqlite.org/rowvalue.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

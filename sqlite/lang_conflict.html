
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>The on CONFLICT Clause - SQLite - W3cubDocs</title>
  
  <meta name="description" content=" conflict-clause&#58; hide ">
  <meta name="keywords" content="on, conflict, clause, sqlite">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/sqlite/lang_conflict.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-1810d67ab7e57be09d8247710d2feb6954566959eb82322d1fee3a0c9156f56974b78ebaa9928774f00767342bbe58b0799d91fcc336b92b319170b196f9b64b.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/sqlite.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/sqlite/" class="_nav-link" title="" style="margin-left:0;">SQLite</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sqlite">
				
				
<h1 class="fancy_title"> The ON CONFLICT Clause </h1>  <p><b><a href="syntax/conflict-clause">conflict-clause:</a></b> <button id="x1379" class="_btn" data-toggle="x1380">hide</button></p> <div id="x1380"> <div style="max-width:451px">
<svg xmlns="http://www.w3.org/2000/svg" class="pikchr" viewbox="0 0 451.517 205.2"> <circle cx="5" cy="6" r="3.6" class="stroke"></circle> <polygon points="32,6 20,10 20,2" class="fill"></polygon> <path d="M9,6L26,6" class="stroke"></path> <polygon points="70,36 58,41 58,32" class="fill"></polygon> <path d="M32,6 L 39,6 Q 47,6 47,21 L 47,21 Q 47,36 56,36 L 64,36" class="stroke"></path> <path d="M85,51L94,51A15 15 0 0 0 109 36L109,36A15 15 0 0 0 94 21L85,21A15 15 0 0 0 70 36L70,36A15 15 0 0 0 85 51Z" class="stroke"></path> <text x="90" y="36" text-anchor="middle" dominant-baseline="central" class="fill">ON</text> <polygon points="132,36 121,41 121,32" class="fill"></polygon> <path d="M109,36L126,36" class="stroke"></path> <path d="M147,51L222,51A15 15 0 0 0 237 36L237,36A15 15 0 0 0 222 21L147,21A15 15 0 0 0 132 36L132,36A15 15 0 0 0 147 51Z" class="stroke"></path> <text x="184" y="36" text-anchor="middle" dominant-baseline="central" class="fill">CONFLICT</text> <polygon points="273,36 261,41 261,32" class="fill"></polygon> <path d="M237,36L267,36" class="stroke"></path> <path d="M288,51L365,51A15 15 0 0 0 381 36L381,36A15 15 0 0 0 365 21L288,21A15 15 0 0 0 273 36L273,36A15 15 0 0 0 288 51Z" class="stroke"></path> <text x="327" y="36" text-anchor="middle" dominant-baseline="central" class="fill">ROLLBACK</text> <path d="M288,89L330,89A15 15 0 0 0 345 74L345,74A15 15 0 0 0 330 59L288,59A15 15 0 0 0 273 74L273,74A15 15 0 0 0 288 89Z" class="stroke"></path> <text x="309" y="74" text-anchor="middle" dominant-baseline="central" class="fill">ABORT</text> <path d="M288,127L310,127A15 15 0 0 0 325 112A15 15 0 0 0 310 97L288,97A15 15 0 0 0 273 112A15 15 0 0 0 288 127Z" class="stroke"></path> <text x="299" y="112" text-anchor="middle" dominant-baseline="central" class="fill">FAIL</text> <path d="M288,165L340,165A15 15 0 0 0 355 150A15 15 0 0 0 340 135L288,135A15 15 0 0 0 273 150A15 15 0 0 0 288 165Z" class="stroke"></path> <text x="314" y="150" text-anchor="middle" dominant-baseline="central" class="fill">IGNORE</text> <path d="M288,203L352,203A15 15 0 0 0 367 187A15 15 0 0 0 352 172L288,172A15 15 0 0 0 273 187A15 15 0 0 0 288 203Z" class="stroke"></path> <text x="320" y="187" text-anchor="middle" dominant-baseline="central" class="fill">REPLACE</text> <polygon points="404,36 392,41 392,32" class="fill"></polygon> <path d="M381,36L398,36" class="stroke"></path> <polygon points="442,6 430,10 430,2" class="fill"></polygon> <path d="M404,36 L 411,36 Q 419,36 419,21 L 419,21 Q 419,6 427,6 L 436,6" class="stroke"></path> <circle cx="445" cy="6" r="3.6" class="stroke"></circle> <polygon points="225,6 214,10 214,2" class="fill"></polygon> <path d="M9,6L219,6" class="stroke"></path> <path d="M225,6L434,6" class="stroke"></path> <polygon points="273,187 261,192 261,183" class="fill"></polygon> <path d="M237,36 L 244,36 Q 252,36 252,51 L 252,172 Q 252,187 259,187 L 267,187" class="stroke"></path> <polygon points="404,187 392,192 392,183" class="fill"></polygon> <path d="M367,187L398,187" class="stroke"></path> <path d="M404,187 L 411,187 Q 419,187 419,172 L 419,36 L 419,21" class="stroke"></path> <polygon points="273,74 261,78 261,70" class="fill"></polygon> <path d="M252,59 L 252,66 Q 252,74 259,74 L 267,74" class="stroke"></path> <polygon points="404,74 392,78 392,70" class="fill"></polygon> <path d="M345,74L398,74" class="stroke"></path> <path d="M404,74 L 411,74 Q 419,74 419,67 L 419,59" class="stroke"></path> <polygon points="273,112 261,116 261,108" class="fill"></polygon> <path d="M252,97 L 252,104 Q 252,112 259,112 L 267,112" class="stroke"></path> <polygon points="404,112 392,116 392,108" class="fill"></polygon> <path d="M325,112L398,112" class="stroke"></path> <path d="M404,112 L 411,112 Q 419,112 419,104 L 419,97" class="stroke"></path> <polygon points="273,150 261,154 261,145" class="fill"></polygon> <path d="M252,135 L 252,142 Q 252,150 259,150 L 267,150" class="stroke"></path> <polygon points="404,150 392,154 392,145" class="fill"></polygon> <path d="M355,150L398,150" class="stroke"></path> <path d="M404,150 L 411,150 Q 419,150 419,142 L 419,135" class="stroke"></path> </svg> </div> </div> <p>The ON CONFLICT clause is a non-standard extension specific to SQLite that can appear in many other SQL commands. It is given its own section in this document because it is not part of standard SQL and therefore might not be familiar.</p> <p>The ON CONFLICT clause described here has been a part of SQLite since before version 3.0.0 (2004-06-18). The phrase "ON CONFLICT" is also part of <a href="lang_upsert">UPSERT</a>, which is an extension to <a href="lang_insert">INSERT</a> added in version 3.24.0 (2018-06-04). Do not confuse these two separate uses of the "ON CONFLICT" phrase. </p>
<p>The syntax for the ON CONFLICT clause is as shown above for the CREATE TABLE command. For the INSERT and UPDATE commands, the keywords "ON CONFLICT" are replaced by "OR" so that the syntax reads more naturally. For example, instead of "INSERT ON CONFLICT IGNORE" we have "INSERT OR IGNORE". The keywords change but the meaning of the clause is the same either way.</p> <p>The ON CONFLICT clause applies to <a href="lang_createtable#uniqueconst">UNIQUE</a>, <a href="lang_createtable#notnullconst">NOT NULL</a>, <a href="lang_createtable#ckconst">CHECK</a>, and <a href="lang_createtable#primkeyconst">PRIMARY KEY</a> constraints. The ON CONFLICT algorithm does not apply to <a href="foreignkeys">FOREIGN KEY constraints</a>. There are five conflict resolution algorithm choices: ROLLBACK, ABORT, FAIL, IGNORE, and REPLACE. The default conflict resolution algorithm is ABORT. This is what they mean:</p> <dl> <dt><b>ROLLBACK</b></dt> <dd><p> When an applicable constraint violation occurs, the ROLLBACK resolution algorithm aborts the current SQL statement with an SQLITE_CONSTRAINT error and rolls back the current transaction. If no transaction is active (other than the implied transaction that is created on every command) then the ROLLBACK resolution algorithm works the same as the ABORT algorithm.</p></dd> <dt><b>ABORT</b></dt> <dd><p> When an applicable constraint violation occurs, the ABORT resolution algorithm aborts the current SQL statement with an SQLITE_CONSTRAINT error and backs out any changes made by the current SQL statement; but changes caused by prior SQL statements within the same transaction are preserved and the transaction remains active. This is the default behavior and the behavior specified by the SQL standard.</p></dd> <dt><b>FAIL</b></dt> <dd>
<p> When an applicable constraint violation occurs, the FAIL resolution algorithm aborts the current SQL statement with an SQLITE_CONSTRAINT error. But the FAIL resolution does not back out prior changes of the SQL statement that failed nor does it end the transaction. For example, if an UPDATE statement encountered a constraint violation on the 100th row that it attempts to update, then the first 99 row changes are preserved but changes to rows 100 and beyond never occur.</p> <p>The FAIL behavior only works for uniqueness, NOT NULL, and CHECK constraints. A <a href="foreignkeys">foreign key constraint</a> violation causes an ABORT. </p>
</dd> <dt><b>IGNORE</b></dt> <dd>
<p> When an applicable constraint violation occurs, the IGNORE resolution algorithm skips the one row that contains the constraint violation and continues processing subsequent rows of the SQL statement as if nothing went wrong. Other rows before and after the row that contained the constraint violation are inserted or updated normally. No error is returned for uniqueness, NOT NULL, and UNIQUE constraint errors when the IGNORE conflict resolution algorithm is used. However, the IGNORE conflict resolution algorithm works like ABORT for <a href="foreignkeys">foreign key constraint</a> errors. </p> </dd> <dt><b>REPLACE</b></dt> <dd>
<p> When a <a href="lang_createtable#uniqueconst">UNIQUE</a> or <a href="lang_createtable#primkeyconst">PRIMARY KEY</a> constraint violation occurs, the REPLACE algorithm deletes pre-existing rows that are causing the constraint violation prior to inserting or updating the current row and the command continues executing normally. If a <a href="lang_createtable#notnullconst">NOT NULL</a> constraint violation occurs, the REPLACE conflict resolution replaces the NULL value with the default value for that column, or if the column has no default value, then the ABORT algorithm is used. If a <a href="lang_createtable#ckconst">CHECK constraint</a> or <a href="foreignkeys">foreign key constraint</a> violation occurs, the REPLACE conflict resolution algorithm works like ABORT.</p> <p>When the REPLACE conflict resolution strategy deletes rows in order to satisfy a constraint, <a href="lang_createtrigger">delete triggers</a> fire if and only if <a href="pragma#pragma_recursive_triggers">recursive triggers</a> are enabled.</p> <p>The <a href="c3ref/update_hook">update hook</a> is not invoked for rows that are deleted by the REPLACE conflict resolution strategy. Nor does REPLACE increment the <a href="c3ref/changes">change counter</a>. The exceptional behaviors defined in this paragraph might change in a future release.</p> </dd>
</dl> <p>The algorithm specified in the OR clause of an INSERT or UPDATE overrides any algorithm specified in a CREATE TABLE. If no algorithm is specified anywhere, the ABORT algorithm is used.</p> <div class="_attribution">
  <p class="_attribution-p">
    SQLite is in the Public Domain.<br>
    <a href="https://sqlite.org/lang_conflict.html" class="_attribution-link">https://sqlite.org/lang_conflict.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

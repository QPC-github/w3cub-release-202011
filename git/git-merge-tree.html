
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Git Merge-tree - Git - W3cubDocs</title>
  
  <meta name="description" content=" git-merge-tree - Perform merge without touching index or working tree ">
  <meta name="keywords" content="git-merge-tree, git, merge-tree">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/git/git-merge-tree.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/git.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/git/" class="_nav-link" title="" style="margin-left:0;">Git</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _git">
				
				
<h1>git-merge-tree</h1>  <h2 id="_name">Name</h2> <div class="sectionbody">  <p>git-merge-tree - Perform merge without touching index or working tree</p>  </div>   <h2 id="_synopsis">Synopsis</h2> <div class="sectionbody"> <div class="verseblock"> <pre class="content" data-language="shell">git merge-tree [--write-tree] [&lt;options&gt;] &lt;branch1&gt; &lt;branch2&gt;
git merge-tree [--trivial-merge] &lt;base-tree&gt; &lt;branch1&gt; &lt;branch2&gt; (deprecated)</pre> </div> </div>   <h2 id="NEWMERGE">Description</h2> <div class="sectionbody">  <p>This command has a modern <code>--write-tree</code> mode and a deprecated <code>--trivial-merge</code> mode. With the exception of the <a href="#DEPMERGE">DEPRECATED DESCRIPTION</a> section at the end, the rest of this documentation describes modern <code>--write-tree</code> mode.</p>   <p>Performs a merge, but does not make any new commits and does not read from or write to either the working tree or index.</p>   <p>The performed merge will use the same feature as the "real" <a href="git-merge">git-merge[1]</a>, including:</p>  <div class="ulist"> <ul> <li> <p>three way content merges of individual files</p> </li> <li> <p>rename detection</p> </li> <li> <p>proper directory/file conflict handling</p> </li> <li> <p>recursive ancestor consolidation (i.e. when there is more than one merge base, creating a virtual merge base by merging the merge bases)</p> </li> <li> <p>etc.</p> </li> </ul> </div>  <p>After the merge completes, a new toplevel tree object is created. See <code>OUTPUT</code> below for details.</p>  </div>   <h2 id="_options">Options</h2> <div class="sectionbody"> <div class="dlist"> <dl> <dt class="hdlist1" id="Documentation/git-merge-tree.txt--z"> -z </dt> <dd> <p>Do not quote filenames in the &lt;Conflicted file info&gt; section, and end each filename with a NUL character rather than newline. Also begin the messages section with a NUL character instead of a newline. See <a href="#OUTPUT">OUTPUT</a> below for more information.</p> </dd> <dt class="hdlist1" id="Documentation/git-merge-tree.txt---name-only"> --name-only </dt> <dd> <p>In the Conflicted file info section, instead of writing a list of (mode, oid, stage, path) tuples to output for conflicted files, just provide a list of filenames with conflicts (and do not list filenames multiple times if they have multiple conflicting stages).</p> </dd> <dt class="hdlist1" id="Documentation/git-merge-tree.txt---no-messages"> --[no-]messages </dt> <dd> <p>Write any informational messages such as "Auto-merging &lt;path&gt;" or CONFLICT notices to the end of stdout. If unspecified, the default is to include these messages if there are merge conflicts, and to omit them otherwise.</p> </dd> <dt class="hdlist1" id="Documentation/git-merge-tree.txt---allow-unrelated-histories"> --allow-unrelated-histories </dt> <dd> <p>merge-tree will by default error out if the two branches specified share no common history. This flag can be given to override that check and make the merge proceed anyway.</p> </dd> </dl> </div> </div>   <h2 id="OUTPUT">Output</h2> <div class="sectionbody">  <p>For a successful merge, the output from git-merge-tree is simply one line:</p>  <div class="literalblock"> <div class="content"> <pre>&lt;OID of toplevel tree&gt;</pre> </div> </div>  <p>Whereas for a conflicted merge, the output is by default of the form:</p>  <div class="literalblock"> <div class="content"> <pre>&lt;OID of toplevel tree&gt;
&lt;Conflicted file info&gt;
&lt;Informational messages&gt;</pre> </div> </div>  <p>These are discussed individually below.</p>  <div class="sect2"> <h3 id="OIDTLT">
OID of toplevel tree</h3>  <p>This is a tree object that represents what would be checked out in the working tree at the end of <code>git merge</code>. If there were conflicts, then files within this tree may have embedded conflict markers. This section is always followed by a newline (or NUL if <code>-z</code> is passed).</p>  </div> <div class="sect2"> <h3 id="CFI">
Conflicted file info</h3>  <p>This is a sequence of lines with the format</p>  <div class="literalblock"> <div class="content"> <pre>&lt;mode&gt; &lt;object&gt; &lt;stage&gt; &lt;filename&gt;</pre> </div> </div>  <p>The filename will be quoted as explained for the configuration variable <code>core.quotePath</code> (see <a href="git-config">git-config[1]</a>). However, if the <code>--name-only</code> option is passed, the mode, object, and stage will be omitted. If <code>-z</code> is passed, the "lines" are terminated by a NUL character instead of a newline character.</p>  </div> <div class="sect2"> <h3 id="IM">
Informational messages</h3>  <p>This always starts with a blank line (or NUL if <code>-z</code> is passed) to separate it from the previous sections, and then has free-form messages about the merge, such as:</p>  <div class="ulist"> <ul> <li> <p>"Auto-merging &lt;file&gt;"</p> </li> <li> <p>"CONFLICT (rename/delete): &lt;oldfile&gt; renamed…​but deleted in…​"</p> </li> <li> <p>"Failed to merge submodule &lt;submodule&gt; (&lt;reason&gt;)"</p> </li> <li> <p>"Warning: cannot merge binary files: &lt;filename&gt;"</p> </li> </ul> </div>  <p>Note that these free-form messages will never have a NUL character in or between them, even if -z is passed. It is simply a large block of text taking up the remainder of the output.</p>  </div> </div>   <h2 id="_exit_status">Exit status</h2> <div class="sectionbody">  <p>For a successful, non-conflicted merge, the exit status is 0. When the merge has conflicts, the exit status is 1. If the merge is not able to complete (or start) due to some kind of error, the exit status is something other than 0 or 1 (and the output is unspecified).</p>  </div>   <h2 id="_usage_notes">Usage notes</h2> <div class="sectionbody">  <p>This command is intended as low-level plumbing, similar to <a href="git-hash-object">git-hash-object[1]</a>, <a href="git-mktree">git-mktree[1]</a>, <a href="git-commit-tree">git-commit-tree[1]</a>, <a href="git-write-tree">git-write-tree[1]</a>, <a href="git-update-ref">git-update-ref[1]</a>, and <a href="git-mktag">git-mktag[1]</a>. Thus, it can be used as a part of a series of steps such as:</p>  <div class="literalblock"> <div class="content"> <pre>NEWTREE=$(git merge-tree --write-tree $BRANCH1 $BRANCH2)
test $? -eq 0 || die "There were conflicts..."
NEWCOMMIT=$(git commit-tree $NEWTREE -p $BRANCH1 -p $BRANCH2)
git update-ref $BRANCH1 $NEWCOMMIT</pre> </div> </div>  <p>Note that when the exit status is non-zero, <code>NEWTREE</code> in this sequence will contain a lot more output than just a tree.</p>   <p>For conflicts, the output includes the same information that you’d get with <a href="git-merge">git-merge[1]</a>:</p>  <div class="ulist"> <ul> <li> <p>what would be written to the working tree (the <a href="#OIDTLT">OID of toplevel tree</a>)</p> </li> <li> <p>the higher order stages that would be written to the index (the <a href="#CFI">Conflicted file info</a>)</p> </li> <li> <p>any messages that would have been printed to stdout (the <a href="#IM">Informational messages</a>)</p> </li> </ul> </div> </div>   <h2 id="_mistakes_to_avoid">Mistakes to avoid</h2> <div class="sectionbody">  <p>Do NOT look through the resulting toplevel tree to try to find which files conflict; parse the <a href="#CFI">Conflicted file info</a> section instead. Not only would parsing an entire tree be horrendously slow in large repositories, there are numerous types of conflicts not representable by conflict markers (modify/delete, mode conflict, binary file changed on both sides, file/directory conflicts, various rename conflict permutations, etc.)</p>   <p>Do NOT interpret an empty <a href="#CFI">Conflicted file info</a> list as a clean merge; check the exit status. A merge can have conflicts without having individual files conflict (there are a few types of directory rename conflicts that fall into this category, and others might also be added in the future).</p>   <p>Do NOT attempt to guess or make the user guess the conflict types from the <a href="#CFI">Conflicted file info</a> list. The information there is insufficient to do so. For example: Rename/rename(1to2) conflicts (both sides renamed the same file differently) will result in three different file having higher order stages (but each only has one higher order stage), with no way (short of the <a href="#IM">Informational messages</a> section) to determine which three files are related. File/directory conflicts also result in a file with exactly one higher order stage. Possibly-involved-in-directory-rename conflicts (when "merge.directoryRenames" is unset or set to "conflicts") also result in a file with exactly one higher order stage. In all cases, the <a href="#IM">Informational messages</a> section has the necessary info, though it is not designed to be machine parseable.</p>   <p>Do NOT assume that each paths from <a href="#CFI">Conflicted file info</a>, and the logical conflicts in the <a href="#IM">Informational messages</a> have a one-to-one mapping, nor that there is a one-to-many mapping, nor a many-to-one mapping. Many-to-many mappings exist, meaning that each path can have many logical conflict types in a single merge, and each logical conflict type can affect many paths.</p>   <p>Do NOT assume all filenames listed in the <a href="#IM">Informational messages</a> section had conflicts. Messages can be included for files that have no conflicts, such as "Auto-merging &lt;file&gt;".</p>   <p>AVOID taking the OIDS from the <a href="#CFI">Conflicted file info</a> and re-merging them to present the conflicts to the user. This will lose information. Instead, look up the version of the file found within the <a href="#OIDTLT">OID of toplevel tree</a> and show that instead. In particular, the latter will have conflict markers annotated with the original branch/commit being merged and, if renames were involved, the original filename. While you could include the original branch/commit in the conflict marker annotations when re-merging, the original filename is not available from the <a href="#CFI">Conflicted file info</a> and thus you would be losing information that might help the user resolve the conflict.</p>  </div>   <h2 id="DEPMERGE">Deprecated description</h2> <div class="sectionbody">  <p>Per the <a href="#NEWMERGE">DESCRIPTION</a> and unlike the rest of this documentation, this section describes the deprecated <code>--trivial-merge</code> mode.</p>   <p>Other than the optional <code>--trivial-merge</code>, this mode accepts no options.</p>   <p>This mode reads three tree-ish, and outputs trivial merge results and conflicting stages to the standard output in a semi-diff format. Since this was designed for higher level scripts to consume and merge the results back into the index, it omits entries that match &lt;branch1&gt;. The result of this second form is similar to what three-way <code>git read-tree -m</code> does, but instead of storing the results in the index, the command outputs the entries to the standard output.</p>   <p>This form not only has limited applicability (a trivial merge cannot handle content merges of individual files, rename detection, proper directory/file conflict handling, etc.), the output format is also difficult to work with, and it will generally be less performant than the first form even on successful merges (especially if working in large repositories).</p>  </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2022 Scott Chacon and others<br>Licensed under the MIT License.<br>
    <a href="https://git-scm.com/docs/git-merge-tree" class="_attribution-link">https://git-scm.com/docs/git-merge-tree</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

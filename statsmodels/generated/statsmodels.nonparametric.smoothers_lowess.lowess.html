
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>nonparametric.smoothers_lowess.lowess() - Statsmodels - W3cubDocs</title>
  
  <meta name="description" content=" LOWESS (Locally Weighted Scatterplot Smoothing) ">
  <meta name="keywords" content="statsmodels, nonparametric, smoothers, lowess">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/statsmodels/generated/statsmodels.nonparametric.smoothers_lowess.lowess.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/statsmodels.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/statsmodels/" class="_nav-link" title="" style="margin-left:0;">Statsmodels</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="statsmodels-nonparametric-smoothers-lowess-lowess">statsmodels.nonparametric.smoothers_lowess.lowess</h1> <dl class="function"> <dt id="statsmodels.nonparametric.smoothers_lowess.lowess">
<code>statsmodels.nonparametric.smoothers_lowess.lowess(endog, exog, frac=0.6666666666666666, it=3, delta=0.0, is_sorted=False, missing='drop', return_sorted=True)</code> <a class="reference internal" href="http://www.statsmodels.org/stable/_modules/statsmodels/nonparametric/smoothers_lowess.html#lowess"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>LOWESS (Locally Weighted Scatterplot Smoothing)</p> <p>A lowess function that outs smoothed estimates of endog at the given exog values from points (exog, endog)</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>endog</strong> (<em>1-D numpy array</em>) – The y-values of the observed points</li> <li>
<strong>exog</strong> (<em>1-D numpy array</em>) – The x-values of the observed points</li> <li>
<strong>frac</strong> (<em>float</em>) – Between 0 and 1. The fraction of the data used when estimating each y-value.</li> <li>
<strong>it</strong> (<em>int</em>) – The number of residual-based reweightings to perform.</li> <li>
<strong>delta</strong> (<em>float</em>) – Distance within which to use linear-interpolation instead of weighted regression.</li> <li>
<strong>is_sorted</strong> (<em>bool</em>) – If False (default), then the data will be sorted by exog before calculating lowess. If True, then it is assumed that the data is already sorted by exog.</li> <li>
<strong>missing</strong> (<em>str</em>) – Available options are ‘none’, ‘drop’, and ‘raise’. If ‘none’, no nan checking is done. If ‘drop’, any observations with nans are dropped. If ‘raise’, an error is raised. Default is ‘drop’.</li> <li>
<strong>return_sorted</strong> (<em>bool</em>) – If True (default), then the returned array is sorted by exog and has missing (nan or infinite) observations removed. If False, then the returned array is in the same length and the same sequence of observations as the input array.</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first"><strong>out</strong> – The returned array is two-dimensional if return_sorted is True, and one dimensional if return_sorted is False. If return_sorted is True, then a numpy array with two columns. The first column contains the sorted x (exog) values and the second column the associated estimated y (endog) values. If return_sorted is False, then only the fitted values are returned, and the observations will be in the same order as the input arrays.</p> </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">ndarray, float</p> </td> </tr>  </table> <h4 class="rubric">Notes</h4> <p>This lowess function implements the algorithm given in the reference below using local linear estimates.</p> <p>Suppose the input data has N points. The algorithm works by estimating the <code>smooth</code> y_i by taking the frac*N closest points to (x_i,y_i) based on their x values and estimating y_i using a weighted linear regression. The weight for (x_j,y_j) is tricube function applied to abs(x_i-x_j).</p> <p>If it &gt; 1, then further weighted local linear regressions are performed, where the weights are the same as above times the _lowess_bisquare function of the residuals. Each iteration takes approximately the same amount of time as the original fit, so these iterations are expensive. They are most useful when the noise has extremely heavy tails, such as Cauchy noise. Noise with less heavy-tails, such as t-distributions with df&gt;2, are less problematic. The weights downgrade the influence of points with large residuals. In the extreme case, points whose residuals are larger than 6 times the median absolute residual are given weight 0.</p> <p><code>delta</code> can be used to save computations. For each <code>x_i</code>, regressions are skipped for points closer than <code>delta</code>. The next regression is fit for the farthest point within delta of <code>x_i</code> and all points in between are estimated by linearly interpolating between the two regression fits.</p> <p>Judicious choice of delta can cut computation time considerably for large data (N &gt; 5000). A good choice is <code>delta = 0.01 * range(exog)</code>.</p> <p>Some experimentation is likely required to find a good choice of <code>frac</code> and <code>iter</code> for a particular dataset.</p> <h4 class="rubric">References</h4> <p>Cleveland, W.S. (1979) “Robust Locally Weighted Regression and Smoothing Scatterplots”. Journal of the American Statistical Association 74 (368): 829-836.</p> <h4 class="rubric">Examples</h4> <p>The below allows a comparison between how different the fits from lowess for different values of frac can be.</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import statsmodels.api as sm
&gt;&gt;&gt; lowess = sm.nonparametric.lowess
&gt;&gt;&gt; x = np.random.uniform(low = -2*np.pi, high = 2*np.pi, size=500)
&gt;&gt;&gt; y = np.sin(x) + np.random.normal(size=len(x))
&gt;&gt;&gt; z = lowess(y, x)
&gt;&gt;&gt; w = lowess(y, x, frac=1./3)
</pre> <p>This gives a similar comparison for when it is 0 vs not.</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import scipy.stats as stats
&gt;&gt;&gt; import statsmodels.api as sm
&gt;&gt;&gt; lowess = sm.nonparametric.lowess
&gt;&gt;&gt; x = np.random.uniform(low = -2*np.pi, high = 2*np.pi, size=500)
&gt;&gt;&gt; y = np.sin(x) + stats.cauchy.rvs(size=len(x))
&gt;&gt;&gt; z = lowess(y, x, frac= 1./3, it=0)
&gt;&gt;&gt; w = lowess(y, x, frac=1./3)
</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2009–2012 Statsmodels Developers<br>© 2006–2008 Scipy Developers<br>© 2006 Jonathan E. Taylor<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://www.statsmodels.org/stable/generated/statsmodels.nonparametric.smoothers_lowess.lowess.html" class="_attribution-link">http://www.statsmodels.org/stable/generated/statsmodels.nonparametric.smoothers_lowess.lowess.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

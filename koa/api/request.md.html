
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Request - Koa - W3cubDocs</title>
  
  <meta name="description" content="A Koa Request object is an abstraction on top of node&#39;s vanilla request object, providing additional functionality that is useful for every day &hellip;">
  <meta name="keywords" content="request, koa">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/koa/api/request.md.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/koa.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/koa/" class="_nav-link" title="" style="margin-left:0;">Koa</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _github">
				
				
<h1 id="request">Request</h1> <p>A Koa <code>Request</code> object is an abstraction on top of node's vanilla request object, providing additional functionality that is useful for every day HTTP server development.</p> <h2 id="api">API</h2> <h3 id="requestheader">request.header</h3> <p>Request header object.</p> <h3 id="requestheader-1">request.header=</h3> <p>Set request header object.</p> <h3 id="requestheaders">request.headers</h3> <p>Request header object. Alias as <code>request.header</code>.</p> <h3 id="requestheaders-1">request.headers=</h3> <p>Set request header object. Alias as <code>request.header=</code>.</p> <h3 id="requestmethod">request.method</h3> <p>Request method.</p> <h3 id="requestmethod-1">request.method=</h3> <p>Set request method, useful for implementing middleware such as <code>methodOverride()</code>.</p> <h3 id="requestlength">request.length</h3> <p>Return request Content-Length as a number when present, or <code>undefined</code>.</p> <h3 id="requesturl">request.url</h3> <p>Get request URL.</p> <h3 id="requesturl-1">request.url=</h3> <p>Set request URL, useful for url rewrites.</p> <h3 id="requestoriginalurl">request.originalUrl</h3> <p>Get request original URL.</p> <h3 id="requestorigin">request.origin</h3> <p>Get origin of URL, include <code>protocol</code> and <code>host</code>.</p> <pre data-language="js">ctx.request.origin
// =&gt; http://example.com</pre> <h3 id="requesthref">request.href</h3> <p>Get full request URL, include <code>protocol</code>, <code>host</code> and <code>url</code>.</p> <pre data-language="js">ctx.request.href;
// =&gt; http://example.com/foo/bar?q=1</pre> <h3 id="requestpath">request.path</h3> <p>Get request pathname.</p> <h3 id="requestpath-1">request.path=</h3> <p>Set request pathname and retain query-string when present.</p> <h3 id="requestquerystring">request.querystring</h3> <p>Get raw query string void of <code>?</code>.</p> <h3 id="requestquerystring-1">request.querystring=</h3> <p>Set raw query string.</p> <h3 id="requestsearch">request.search</h3> <p>Get raw query string with the <code>?</code>.</p> <h3 id="requestsearch-1">request.search=</h3> <p>Set raw query string.</p> <h3 id="requesthost">request.host</h3> <p>Get host (hostname:port) when present. Supports <code>X-Forwarded-Host</code> when <code>app.proxy</code> is <strong>true</strong>, otherwise <code>Host</code> is used.</p> <h3 id="requesthostname">request.hostname</h3> <p>Get hostname when present. Supports <code>X-Forwarded-Host</code> when <code>app.proxy</code> is <strong>true</strong>, otherwise <code>Host</code> is used.</p> <p>If host is IPv6, Koa delegates parsing to <a href="https://nodejs.org/dist/latest-v8.x/docs/api/url.html#url_the_whatwg_url_api" rel="nofollow">WHATWG URL API</a>, <em>Note</em> This may impact performance.</p> <h3 id="requesturl-2">request.URL</h3> <p>Get WHATWG parsed URL object.</p> <h3 id="requesttype">request.type</h3> <p>Get request <code>Content-Type</code> void of parameters such as "charset".</p> <pre data-language="js">const ct = ctx.request.type;
// =&gt; "image/png"</pre> <h3 id="requestcharset">request.charset</h3> <p>Get request charset when present, or <code>undefined</code>:</p> <pre data-language="js">ctx.request.charset;
// =&gt; "utf-8"</pre> <h3 id="requestquery">request.query</h3> <p>Get parsed query-string, returning an empty object when no query-string is present. Note that this getter does <em>not</em> support nested parsing.</p> <p>For example "color=blue&amp;size=small":</p> <pre data-language="js">{
  color: 'blue',
  size: 'small'
}</pre> <h3 id="requestquery-1">request.query=</h3> <p>Set query-string to the given object. Note that this setter does <em>not</em> support nested objects.</p> <pre data-language="js">ctx.query = { next: '/login' };</pre> <h3 id="requestfresh">request.fresh</h3> <p>Check if a request cache is "fresh", aka the contents have not changed. This method is for cache negotiation between <code>If-None-Match</code> / <code>ETag</code>, and <code>If-Modified-Since</code> and <code>Last-Modified</code>. It should be referenced after setting one or more of these response headers.</p> <pre data-language="js">// freshness check requires status 20x or 304
ctx.status = 200;
ctx.set('ETag', '123');

// cache is ok
if (ctx.fresh) {
  ctx.status = 304;
  return;
}

// cache is stale
// fetch new data
ctx.body = await db.find('something');</pre> <h3 id="requeststale">request.stale</h3> <p>Inverse of <code>request.fresh</code>.</p> <h3 id="requestprotocol">request.protocol</h3> <p>Return request protocol, "https" or "http". Supports <code>X-Forwarded-Proto</code> when <code>app.proxy</code> is <strong>true</strong>.</p> <h3 id="requestsecure">request.secure</h3> <p>Shorthand for <code>ctx.protocol == "https"</code> to check if a request was issued via TLS.</p> <h3 id="requestip">request.ip</h3> <p>Request remote address. Supports <code>X-Forwarded-For</code> when <code>app.proxy</code> is <strong>true</strong>.</p> <h3 id="requestips">request.ips</h3> <p>When <code>X-Forwarded-For</code> is present and <code>app.proxy</code> is enabled an array of these ips is returned, ordered from upstream -&gt; downstream. When disabled an empty array is returned.</p> <h3 id="requestsubdomains">request.subdomains</h3> <p>Return subdomains as an array.</p> <p>Subdomains are the dot-separated parts of the host before the main domain of the app. By default, the domain of the app is assumed to be the last two parts of the host. This can be changed by setting <code>app.subdomainOffset</code>.</p> <p>For example, if the domain is "tobi.ferrets.example.com": If <code>app.subdomainOffset</code> is not set, <code>ctx.subdomains</code> is <code>["ferrets", "tobi"]</code>. If <code>app.subdomainOffset</code> is 3, <code>ctx.subdomains</code> is <code>["tobi"]</code>.</p> <h3 id="requestistypes">request.is(types...)</h3> <p>Check if the incoming request contains the "Content-Type" header field, and it contains any of the give mime <code>type</code>s. If there is no request body, <code>null</code> is returned. If there is no content type, or the match fails <code>false</code> is returned. Otherwise, it returns the matching content-type.</p> <pre data-language="js">// With Content-Type: text/html; charset=utf-8
ctx.is('html'); // =&gt; 'html'
ctx.is('text/html'); // =&gt; 'text/html'
ctx.is('text/*', 'text/html'); // =&gt; 'text/html'

// When Content-Type is application/json
ctx.is('json', 'urlencoded'); // =&gt; 'json'
ctx.is('application/json'); // =&gt; 'application/json'
ctx.is('html', 'application/*'); // =&gt; 'application/json'

ctx.is('html'); // =&gt; false</pre> <p>For example if you want to ensure that only images are sent to a given route:</p> <pre data-language="js">if (ctx.is('image/*')) {
  // process
} else {
  ctx.throw(415, 'images only!');
}</pre> <h3 id="content-negotiation">Content Negotiation</h3> <p>Koa's <code>request</code> object includes helpful content negotiation utilities powered by <a href="http://github.com/expressjs/accepts">accepts</a> and <a href="https://github.com/federomero/negotiator">negotiator</a>. These utilities are:</p> <ul> <li><code>request.accepts(types)</code></li> <li><code>request.acceptsEncodings(types)</code></li> <li><code>request.acceptsCharsets(charsets)</code></li> <li><code>request.acceptsLanguages(langs)</code></li> </ul> <p>If no types are supplied, <strong>all</strong> acceptable types are returned.</p> <p>If multiple types are supplied, the best match will be returned. If no matches are found, a <code>false</code> is returned, and you should send a <code>406 "Not Acceptable"</code> response to the client.</p> <p>In the case of missing accept headers where any type is acceptable, the first type will be returned. Thus, the order of types you supply is important.</p> <h3 id="requestacceptstypes">request.accepts(types)</h3> <p>Check if the given <code>type(s)</code> is acceptable, returning the best match when true, otherwise <code>false</code>. The <code>type</code> value may be one or more mime type string such as "application/json", the extension name such as "json", or an array <code>["json", "html", "text/plain"]</code>.</p> <pre data-language="js">// Accept: text/html
ctx.accepts('html');
// =&gt; "html"

// Accept: text/*, application/json
ctx.accepts('html');
// =&gt; "html"
ctx.accepts('text/html');
// =&gt; "text/html"
ctx.accepts('json', 'text');
// =&gt; "json"
ctx.accepts('application/json');
// =&gt; "application/json"

// Accept: text/*, application/json
ctx.accepts('image/png');
ctx.accepts('png');
// =&gt; false

// Accept: text/*;q=.5, application/json
ctx.accepts(['html', 'json']);
ctx.accepts('html', 'json');
// =&gt; "json"

// No Accept header
ctx.accepts('html', 'json');
// =&gt; "html"
ctx.accepts('json', 'html');
// =&gt; "json"</pre> <p>You may call <code>ctx.accepts()</code> as many times as you like, or use a switch:</p> <pre data-language="js">switch (ctx.accepts('json', 'html', 'text')) {
  case 'json': break;
  case 'html': break;
  case 'text': break;
  default: ctx.throw(406, 'json, html, or text only');
}</pre> <h3 id="requestacceptsencodingsencodings">request.acceptsEncodings(encodings)</h3> <p>Check if <code>encodings</code> are acceptable, returning the best match when true, otherwise <code>false</code>. Note that you should include <code>identity</code> as one of the encodings!</p> <pre data-language="js">// Accept-Encoding: gzip
ctx.acceptsEncodings('gzip', 'deflate', 'identity');
// =&gt; "gzip"

ctx.acceptsEncodings(['gzip', 'deflate', 'identity']);
// =&gt; "gzip"</pre> <p>When no arguments are given all accepted encodings are returned as an array:</p> <pre data-language="js">// Accept-Encoding: gzip, deflate
ctx.acceptsEncodings();
// =&gt; ["gzip", "deflate", "identity"]</pre> <p>Note that the <code>identity</code> encoding (which means no encoding) could be unacceptable if the client explicitly sends <code>identity;q=0</code>. Although this is an edge case, you should still handle the case where this method returns <code>false</code>.</p> <h3 id="requestacceptscharsetscharsets">request.acceptsCharsets(charsets)</h3> <p>Check if <code>charsets</code> are acceptable, returning the best match when true, otherwise <code>false</code>.</p> <pre data-language="js">// Accept-Charset: utf-8, iso-8859-1;q=0.2, utf-7;q=0.5
ctx.acceptsCharsets('utf-8', 'utf-7');
// =&gt; "utf-8"

ctx.acceptsCharsets(['utf-7', 'utf-8']);
// =&gt; "utf-8"</pre> <p>When no arguments are given all accepted charsets are returned as an array:</p> <pre data-language="js">// Accept-Charset: utf-8, iso-8859-1;q=0.2, utf-7;q=0.5
ctx.acceptsCharsets();
// =&gt; ["utf-8", "utf-7", "iso-8859-1"]</pre> <h3 id="requestacceptslanguageslangs">request.acceptsLanguages(langs)</h3> <p>Check if <code>langs</code> are acceptable, returning the best match when true, otherwise <code>false</code>.</p> <pre data-language="js">// Accept-Language: en;q=0.8, es, pt
ctx.acceptsLanguages('es', 'en');
// =&gt; "es"

ctx.acceptsLanguages(['en', 'es']);
// =&gt; "es"</pre> <p>When no arguments are given all accepted languages are returned as an array:</p> <pre data-language="js">// Accept-Language: en;q=0.8, es, pt
ctx.acceptsLanguages();
// =&gt; ["es", "pt", "en"]</pre> <h3 id="requestidempotent">request.idempotent</h3> <p>Check if the request is idempotent.</p> <h3 id="requestsocket">request.socket</h3> <p>Return the request socket.</p> <h3 id="requestgetfield">request.get(field)</h3> <p>Return request header.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2018 Koa contributors<br>Licensed under the MIT License.<br>
    <a href="https://github.com/koajs/koa/blob/master/docs/api/request.md" class="_attribution-link">https://github.com/koajs/koa/blob/master/docs/api/request.md</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

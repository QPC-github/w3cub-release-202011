
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>3.23.1. Module Mapper - GCC 11 - W3cubDocs</title>
  
  <meta name="description" content="A module mapper provides a server or file that the compiler queries to determine the mapping between module names and CMI files. It is also used to &hellip;">
  <meta name="keywords" content="module, mapper, gcc, gcc~11">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/gcc~11/c_002b_002b-module-mapper.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/gcc~11.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/gcc~11/" class="_nav-link" title="" style="margin-left:0;">GCC 11</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1 class="subsection" id="Module-Mapper">3.23.1 Module Mapper</h1>  <p id="index-C_002b_002b-Module-Mapper">A module mapper provides a server or file that the compiler queries to determine the mapping between module names and CMI files. It is also used to build CMIs on demand. <em>Mapper functionality is in its infancy and is intended for experimentation with build system interactions.</em> </p> <p>You can specify a mapper with the <samp>-fmodule-mapper=<var>val</var></samp> option or <code>CXX_MODULE_MAPPER</code> environment variable. The value may have one of the following forms: </p> <dl compact> <dt><code><span class="roman">[</span><var>hostname</var><span class="roman">]</span>:<var>port</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dd>
<p>An optional hostname and a numeric port number to connect to. If the hostname is omitted, the loopback address is used. If the hostname corresponds to multiple IPV6 addresses, these are tried in turn, until one is successful. If your host lacks IPv6, this form is non-functional. If you must use IPv4 use <samp>-fmodule-mapper='|ncat <var>ipv4host</var> <var>port</var>'</samp>. </p> </dd> <dt><code>=<var>socket</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dd>
<p>A local domain socket. If your host lacks local domain sockets, this form is non-functional. </p> </dd> <dt><code>|<var>program</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span> <span class="roman">[</span><var>args...</var><span class="roman">]</span></code></dt> <dd>
<p>A program to spawn, and communicate with on its stdin/stdout streams. Your <var>PATH</var> environment variable is searched for the program. Arguments are separated by space characters, (it is not possible for one of the arguments delivered to the program to contain a space). An exception is if <var>program</var> begins with @. In that case <var>program</var> (sans @) is looked for in the compiler’s internal binary directory. Thus the sample mapper-server can be specified with <code>@g++-mapper-server</code>. </p> </dd> <dt><code>&lt;&gt;<span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dt><code>&lt;&gt;<var>inout</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dt><code>&lt;<var>in</var>&gt;<var>out</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dd>
<p>Named pipes or file descriptors to communicate over. The first form, <samp>&lt;&gt;</samp>, communicates over stdin and stdout. The other forms allow you to specify a file descriptor or name a pipe. A numeric value is interpreted as a file descriptor, otherwise named pipe is opened. The second form specifies a bidirectional pipe and the last form allows specifying two independent pipes. Using file descriptors directly in this manner is fragile in general, as it can require the cooperation of intermediate processes. In particular using stdin &amp; stdout is fraught with danger as other compiler options might also cause the compiler to read stdin or write stdout, and it can have unfortunate interactions with signal delivery from the terminal. </p> </dd> <dt><code><var>file</var><span class="roman">[</span>?<var>ident</var><span class="roman">]</span></code></dt> <dd>
<p>A mapping file consisting of space-separated module-name, filename pairs, one per line. Only the mappings for the direct imports and any module export name need be provided. If other mappings are provided, they override those stored in any imported CMI files. A repository root may be specified in the mapping file by using ‘<samp>$root</samp>’ as the module name in the first active line. Use of this option will disable any default module-&gt;CMI name mapping. </p> </dd> </dl> <p>As shown, an optional <var>ident</var> may suffix the first word of the option, indicated by a ‘<samp>?</samp>’ prefix. The value is used in the initial handshake with the module server, or to specify a prefix on mapping file lines. In the server case, the main source file name is used if no <var>ident</var> is specified. In the file case, all non-blank lines are significant, unless a value is specified, in which case only lines beginning with <var>ident</var> are significant. The <var>ident</var> must be separated by whitespace from the module name. Be aware that ‘<samp>&lt;</samp>’, ‘<samp>&gt;</samp>’, ‘<samp>?</samp>’, and ‘<samp>|</samp>’ characters are often significant to the shell, and therefore may need quoting. </p> <p>The mapper is connected to or loaded lazily, when the first module mapping is required. The networking protocols are only supported on hosts that provide networking. If no mapper is specified a default is provided. </p> <p>A project-specific mapper is expected to be provided by the build system that invokes the compiler. It is not expected that a general-purpose server is provided for all compilations. As such, the server will know the build configuration, the compiler it invoked, and the environment (such as working directory) in which that is operating. As it may parallelize builds, several compilations may connect to the same socket. </p> <p>The default mapper generates CMI files in a ‘<samp>gcm.cache</samp>’ directory. CMI files have a ‘<samp>.gcm</samp>’ suffix. The module unit name is used directly to provide the basename. Header units construct a relative path using the underlying header file name. If the path is already relative, a ‘<samp>,</samp>’ directory is prepended. Internal ‘<samp>..</samp>’ components are translated to ‘<samp>,,</samp>’. No attempt is made to canonicalize these filenames beyond that done by the preprocessor’s include search algorithm, as in general it is ambiguous when symbolic links are present. </p> <p>The mapper protocol was published as “A Module Mapper” <a href="https://wg21.link/p1184">https://wg21.link/p1184</a>. The implementation is provided by <code>libcody</code>, <a href="https://github.com/urnathan/libcody">https://github.com/urnathan/libcody</a>, which specifies the canonical protocol definition. A proof of concept server implementation embedded in <code>make</code> was described in ”Make Me A Module”, <a href="https://wg21.link/p1602">https://wg21.link/p1602</a>. </p>  <p class="header"> </p>
<p> Next: <a href="c_002b_002b-module-preprocessing#C_002b_002b-Module-Preprocessing" accesskey="n" rel="next">C++ Module Preprocessing</a>, Up: <a href="c_002b_002b-modules#C_002b_002b-Modules" accesskey="u" rel="up">C++ Modules</a> [<a href="index#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="https://gcc.gnu.org/onlinedocs/gcc-11.1.0/gcc/Option-Index.html#Option-Index" title="Index" rel="index">Index</a>]</p> <div class="_attribution">
  <p class="_attribution-p">
    © Free Software Foundation<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://gcc.gnu.org/onlinedocs/gcc-11.1.0/gcc/C_002b_002b-Module-Mapper.html" class="_attribution-link">https://gcc.gnu.org/onlinedocs/gcc-11.1.0/gcc/C_002b_002b-Module-Mapper.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

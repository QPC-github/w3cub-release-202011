
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Synchronize – a Wrapper Around Rsync to Make Common Tasks in Your Playbooks Quick and Easy - Ansible 2.10 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="ansible, posix, synchronize, –, wrapper, around, rsync, make, common, tasks, your, playbooks, quick, and, easy, ansible~2.10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.10/collections/ansible/posix/synchronize_module.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/ansible~2.10.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.10/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.10</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="ansible-posix-synchronize-a-wrapper-around-rsync-to-make-common-tasks-in-your-playbooks-quick-and-easy">ansible.posix.synchronize – A wrapper around rsync to make common tasks in your playbooks quick and easy</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ansible/posix">ansible.posix collection</a>.</p> <p>To install it use: <code>ansible-galaxy collection install ansible.posix</code>.</p> <p>To use it in a playbook, specify: <code>ansible.posix.synchronize</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of ansible.posix</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>
<code>synchronize</code> is a wrapper around rsync to make common tasks in your playbooks quick and easy.</li> <li>It is run and originates on the local host where Ansible is being run.</li> <li>Of course, you could just use the <code>command</code> action to call rsync yourself, but you also have to add a fair number of boilerplate options and host facts.</li> <li>This module is not intended to provide access to the full power of rsync, but does make the most common invocations easier to implement. You <code>still</code> may need to call rsync directly via <code>command</code> or <code>shell</code> depending on your use case.</li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module has a corresponding <a class="reference internal" href="../../../plugins/action#action-plugins"><span class="std std-ref">action plugin</span></a>.</p> </div>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>archive</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Mirrors the rsync archive flag, enables recursive, links, perms, times, owner, group flags and -D.</div> </td> </tr> <tr> <td colspan="1">  <b>checksum</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Skip based on checksum, rather than mod-time &amp; size; Note that that "archive" option is still enabled by default - the "checksum" option will not disable it.</div> </td> </tr> <tr> <td colspan="1">  <b>compress</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Compress file data during the transfer.</div> <div>In most cases, leave this enabled unless it causes problems.</div> </td> </tr> <tr> <td colspan="1">  <b>copy_links</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Copy symlinks as the item that they point to (the referent) is copied, rather than the symlink.</div> </td> </tr> <tr> <td colspan="1">  <b>delete</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Delete files in <code>dest</code> that don't exist (after transfer, not before) in the <code>src</code> path.</div> <div>This option requires <code>recursive=yes</code>.</div> <div>This option ignores excluded files and behaves like the rsync opt --delete-excluded.</div> </td> </tr> <tr> <td colspan="1">  <b>dest</b>  <div style="font-size: small"> <span style="color: purple">string</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div>Path on the destination host that will be synchronized from the source.</div> <div>The path can be absolute or relative.</div> </td> </tr> <tr> <td colspan="1">  <b>dest_port</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Port number for ssh on the destination host.</div> <div>Prior to Ansible 2.0, the ansible_ssh_port inventory var took precedence over this value.</div> <div>This parameter defaults to the value of <code>ansible_ssh_port</code> or <code>ansible_port</code>, the <code>remote_port</code> config setting or the value from ssh client configuration if none of the former have been set.</div> </td> </tr> <tr> <td colspan="1">  <b>dirs</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Transfer directories without recursing.</div> </td> </tr> <tr> <td colspan="1">  <b>existing_only</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Skip creating new files on receiver.</div> </td> </tr> <tr> <td colspan="1">  <b>group</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Preserve group.</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>link_dest</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>Add a destination to hard link against during the rsync.</div> </td> </tr> <tr> <td colspan="1">  <b>links</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Copy symlinks as symlinks.</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>mode</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>pull</li> <li><div style="color: blue">
<b>push</b> ←</div></li> </ul> </td> <td> <div>Specify the direction of the synchronization.</div> <div>In push mode the localhost or delegate is the source.</div> <div>In pull mode the remote host in context is the source.</div> </td> </tr> <tr> <td colspan="1">  <b>owner</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Preserve owner (super user only).</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>partial</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Tells rsync to keep the partial file which should make a subsequent transfer of the rest of the file much faster.</div> </td> </tr> <tr> <td colspan="1">  <b>perms</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Preserve permissions.</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>private_key</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>Specify the private key to use for SSH-based rsync connections (e.g. <code>~/.ssh/id_rsa</code>).</div> </td> </tr> <tr> <td colspan="1">  <b>recursive</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Recurse into directories.</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>rsync_opts</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>Specify additional rsync options by passing in an array.</div> <div>Note that an empty string in <code>rsync_opts</code> will end up transfer the current working directory.</div> </td> </tr> <tr> <td colspan="1">  <b>rsync_path</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specify the rsync command to run on the remote host. See <code>--rsync-path</code> on the rsync man page.</div> <div>To specify the rsync command to run on the local host, you need to set this your task var <code>ansible_rsync_path</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>rsync_timeout</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">0</div> </td> <td> <div>Specify a <code>--timeout</code> for the rsync command in seconds.</div> </td> </tr> <tr> <td colspan="1">  <b>set_remote_user</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Put user@ for the remote paths.</div> <div>If you have a custom ssh config to define the remote user for a host that does not match the inventory user, you should set this parameter to <code>no</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>src</b>  <div style="font-size: small"> <span style="color: purple">string</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div>Path on the source host that will be synchronized to the destination.</div> <div>The path can be absolute or relative.</div> </td> </tr> <tr> <td colspan="1">  <b>times</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Preserve modification times.</div> <div>This parameter defaults to the value of the archive option.</div> </td> </tr> <tr> <td colspan="1">  <b>use_ssh_args</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use the ssh_args specified in ansible.cfg.</div> </td> </tr> <tr> <td colspan="1">  <b>verify_host</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Verify destination host key.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>rsync must be installed on both the local and remote host.</li> <li>For the <code>synchronize</code> module, the “local host” is the host <code>the synchronize task originates on</code>, and the “destination host” is the host <code>synchronize is connecting to</code>.</li> <li>The “local host” can be changed to a different host by using <code>delegate_to</code>. This enables copying between two remote hosts or entirely on one remote machine.</li> <li>The user and permissions for the synchronize <code>src</code> are those of the user running the Ansible task on the local host (or the remote_user for a delegate_to host when delegate_to is used).</li> <li>The user and permissions for the synchronize <code>dest</code> are those of the <code>remote_user</code> on the destination host or the <code>become_user</code> if <code>become=yes</code> is active.</li> <li>In Ansible 2.0 a bug in the synchronize module made become occur on the “local host”. This was fixed in Ansible 2.0.1.</li> <li>Currently, synchronize is limited to elevating permissions via passwordless sudo. This is because rsync itself is connecting to the remote machine and rsync doesn’t give us a way to pass sudo credentials in.</li> <li>Currently there are only a few connection types which support synchronize (ssh, paramiko, local, and docker) because a sync strategy has been determined for those connection types. Note that the connection for these must not need a password as rsync itself is making the connection and rsync does not provide us a way to pass a password to the connection.</li> <li>Expect that dest=~/x will be ~&lt;remote_user&gt;/x even if using sudo.</li> <li>Inspect the verbose output to validate the destination user/host/path are what was expected.</li> <li>To exclude files and directories from being synchronized, you may add <code>.rsync-filter</code> files to the source directory.</li> <li>rsync daemon must be up and running with correct permission when using rsync protocol in source or destination path.</li> <li>The <code>synchronize</code> module forces <code>–delay-updates</code> to avoid leaving a destination in a broken in-between state if the underlying rsync process encounters an error. Those synchronizing large numbers of files that are willing to trade safety for performance should call rsync directly.</li> <li>link_destination is subject to the same limitations as the underlying rsync daemon. Hard links are only preserved if the relative subtrees of the source and destination are the same. Attempts to hardlink into a directory that is a subdirectory of the source will be prevented.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><span class="xref std std-ref">copy</span></dt>
<dd>
<p>The official documentation on the <strong>copy</strong> module.</p> </dd> <dt><a class="reference internal" href="../../community/windows/win_robocopy_module#ansible-collections-community-windows-win-robocopy-module"><span class="std std-ref">community.windows.win_robocopy</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.windows.win_robocopy</strong> module.</p> </dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Synchronization of src on the control machine to dest on the remote hosts
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path

- name: Synchronization using rsync protocol (push)
  ansible.posix.synchronize:
    src: some/relative/path/
    dest: rsync://somehost.com/path/

- name: Synchronization using rsync protocol (pull)
  ansible.posix.synchronize:
    mode: pull
    src: rsync://somehost.com/path/
    dest: /some/absolute/path/

- name:  Synchronization using rsync protocol on delegate host (push)
  ansible.posix.synchronize:
    src: /some/absolute/path/
    dest: rsync://somehost.com/path/
  delegate_to: delegate.host

- name: Synchronization using rsync protocol on delegate host (pull)
  ansible.posix.synchronize:
    mode: pull
    src: rsync://somehost.com/path/
    dest: /some/absolute/path/
  delegate_to: delegate.host

- name: Synchronization without any --archive options enabled
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    archive: no

- name: Synchronization with --archive options enabled except for --recursive
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    recursive: no

- name: Synchronization with --archive options enabled except for --times, with --checksum option enabled
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    checksum: yes
    times: no

- name: Synchronization without --archive options enabled except use --links
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    archive: no
    links: yes

- name: Synchronization of two paths both on the control machine
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
  delegate_to: localhost

- name: Synchronization of src on the inventory host to the dest on the localhost in pull mode
  ansible.posix.synchronize:
    mode: pull
    src: some/relative/path
    dest: /some/absolute/path

- name: Synchronization of src on delegate host to dest on the current inventory host.
  ansible.posix.synchronize:
    src: /first/absolute/path
    dest: /second/absolute/path
  delegate_to: delegate.host

- name: Synchronize two directories on one remote host.
  ansible.posix.synchronize:
    src: /first/absolute/path
    dest: /second/absolute/path
  delegate_to: "{{ inventory_hostname }}"

- name: Synchronize and delete files in dest on the remote host that are not found in src of localhost.
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    delete: yes
    recursive: yes

# This specific command is granted su privileges on the destination
- name: Synchronize using an alternate rsync command
  ansible.posix.synchronize:
    src: some/relative/path
    dest: /some/absolute/path
    rsync_path: su -c rsync

# Example .rsync-filter file in the source directory
# - var       # exclude any path whose last part is 'var'
# - /var      # exclude any path starting with 'var' starting at the source directory
# + /var/conf # include /var/conf even though it was previously excluded

- name: Synchronize passing in extra rsync options
  ansible.posix.synchronize:
    src: /tmp/helloworld
    dest: /var/www/helloworld
    rsync_opts:
      - "--no-motd"
      - "--exclude=.git"

# Hardlink files if they didn't change
- name: Use hardlinks when synchronizing filesystems
  ansible.posix.synchronize:
    src: /tmp/path_a/foo.txt
    dest: /tmp/path_b/foo.txt
    link_dest: /tmp/path_a/

# Specify the rsync binary to use on remote host and on local host
- hosts: groupofhosts
  vars:
        ansible_rsync_path: /usr/gnu/bin/rsync

  tasks:
    - name: copy /tmp/localpath/ to remote location /tmp/remotepath
      ansible.posix.synchronize:
        src: /tmp/localpath/
        dest: /tmp/remotepath
        rsync_path: /usr/gnu/bin/rsync
</pre>  <h3 id="authors">Authors</h3> <ul class="simple"> <li>Timothy Appnel (@tima)</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.10/collections/ansible/posix/synchronize_module.html" class="_attribution-link">https://docs.ansible.com/ansible/2.10/collections/ansible/posix/synchronize_module.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

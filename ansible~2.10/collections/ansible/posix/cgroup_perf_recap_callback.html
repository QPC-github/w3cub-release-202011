
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Cgroup_perf_recap – Profiles System Activity of Tasks and Full Execution Using Cgroups - Ansible 2.10 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="ansible, posix, cgroup, perf, recap, –, profiles, system, activity, tasks, and, full, execution, using, cgroups, ansible~2.10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.10/collections/ansible/posix/cgroup_perf_recap_callback.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/ansible~2.10.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.10/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.10</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="ansible-posix-cgroup-perf-recap-profiles-system-activity-of-tasks-and-full-execution-using-cgroups">ansible.posix.cgroup_perf_recap – Profiles system activity of tasks and full execution using cgroups</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ansible/posix">ansible.posix collection</a>.</p> <p>To install it use: <code>ansible-galaxy collection install ansible.posix</code>.</p> <p>To use it in a playbook, specify: <code>ansible.posix.cgroup_perf_recap</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This is an ansible callback plugin utilizes cgroups to profile system activity of ansible and individual tasks, and display a recap at the end of the playbook execution</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the local controller node that executes this callback.</p> <ul class="simple"> <li>whitelist in configuration</li> <li>cgroups</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th>Configuration</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>control_group</b>  <div style="font-size: small"> <span style="color: purple">string</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>control_group = None </p> </div> <div> env:CGROUP_CONTROL_GROUP </div> </td> <td> <div>Name of cgroups control group</div> </td> </tr> <tr> <td colspan="1">  <b>cpu_poll_interval</b>  <div style="font-size: small"> <span style="color: purple">float</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">0.25</div> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>cpu_poll_interval = 0.25 </p> </div> <div> env:CGROUP_CPU_POLL_INTERVAL </div> </td> <td> <div>Interval between CPU polling for determining CPU usage. A lower value may produce inaccurate results, a higher value may not be short enough to collect results for short tasks.</div> </td> </tr> <tr> <td colspan="1">  <b>display_recap</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>display_recap = yes </p> </div> <div> env:CGROUP_DISPLAY_RECAP </div> </td> <td> <div>Controls whether the recap is printed at the end, useful if you will automatically process the output files</div> </td> </tr> <tr> <td colspan="1">  <b>file_name_format</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"%(feature)s.%(ext)s"</div> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>file_name_format = %(feature)s.%(ext)s </p> </div> <div> env:CGROUP_FILE_NAME_FORMAT </div> </td> <td> <div>Format of filename. Accepts <code>%(counter</code>s), <code>%(task_uuid</code>s), <code>%(feature</code>s), <code>%(ext</code>s). Defaults to <code>%(feature</code>s.%(ext)s) when <code>file_per_task</code> is <code>False</code> and <code>%(counter</code>s-%(task_uuid)s-%(feature)s.%(ext)s) when <code>True</code>
</div> </td> </tr> <tr> <td colspan="1">  <b>file_per_task</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>file_per_task = no </p> </div> <div> env:CGROUP_FILE_PER_TASK </div> </td> <td> <div>When set as <code>True</code> along with <code>write_files</code>, this callback will write 1 file per task instead of 1 file for the entire playbook run</div> </td> </tr> <tr> <td colspan="1">  <b>memory_poll_interval</b>  <div style="font-size: small"> <span style="color: purple">float</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">0.25</div> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>memory_poll_interval = 0.25 </p> </div> <div> env:CGROUP_MEMORY_POLL_INTERVAL </div> </td> <td> <div>Interval between memory polling for determining memory usage. A lower value may produce inaccurate results, a higher value may not be short enough to collect results for short tasks.</div> </td> </tr> <tr> <td colspan="1">  <b>output_dir</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"/tmp/ansible-perf-%s"</div> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>output_dir = /tmp/ansible-perf-%s </p> </div> <div> env:CGROUP_OUTPUT_DIR </div> </td> <td> <div>Output directory for files containing recorded performance readings. If the value contains a single %s, the start time of the playbook run will be inserted in that space. Only the deepest level directory will be created if it does not exist, parent directories will not be created.</div> </td> </tr> <tr> <td colspan="1">  <b>output_format</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>csv</b> ←</div></li> <li>json</li> </ul> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>output_format = csv </p> </div> <div> env:CGROUP_OUTPUT_FORMAT </div> </td> <td> <div>Output format, either CSV or JSON-seq</div> </td> </tr> <tr> <td colspan="1">  <b>pid_poll_interval</b>  <div style="font-size: small"> <span style="color: purple">float</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">0.25</div> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>pid_poll_interval = 0.25 </p> </div> <div> env:CGROUP_PID_POLL_INTERVAL </div> </td> <td> <div>Interval between PID polling for determining PID count. A lower value may produce inaccurate results, a higher value may not be short enough to collect results for short tasks.</div> </td> </tr> <tr> <td colspan="1">  <b>write_files</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div> ini entries: <p> [callback_cgroup_perf_recap]<br>write_files = no </p> </div> <div> env:CGROUP_WRITE_FILES </div> </td> <td> <div>Dictates whether files will be written containing performance readings</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Requires ansible to be run from within a cgroup, such as with <code>cgexec -g cpuacct,memory,pids:ansible_profile ansible-playbook ...</code>
</li> <li>This cgroup should only be used by ansible to get accurate results</li> <li>To create the cgroup, first use a command such as <code>sudo cgcreate -a ec2-user:ec2-user -t ec2-user:ec2-user -g cpuacct,memory,pids:ansible_profile</code>
</li> </ul> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.10/collections/ansible/posix/cgroup_perf_recap_callback.html" class="_attribution-link">https://docs.ansible.com/ansible/2.10/collections/ansible/posix/cgroup_perf_recap_callback.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

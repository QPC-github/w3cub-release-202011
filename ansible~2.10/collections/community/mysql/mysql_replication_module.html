
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Mysql_replication – Manage MySQL Replication - Ansible 2.10 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="community, mysql, replication, –, manage, ansible, ansible~2.10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.10/collections/community/mysql/mysql_replication_module.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/ansible~2.10.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.10/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.10</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="community-mysql-mysql-replication-manage-mysql-replication">community.mysql.mysql_replication – Manage MySQL replication</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/mysql">community.mysql collection</a>.</p> <p>To install it use: <code>ansible-galaxy collection install community.mysql</code>.</p> <p>To use it in a playbook, specify: <code>community.mysql.mysql_replication</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id7">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Manages MySQL server replication, slave, master status, get and change master host.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>PyMySQL (Python 2.7 and Python 3.X), or</li> <li>MySQLdb (Python 2.x)</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>ca_cert</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>The path to a Certificate Authority (CA) certificate. This option, if used, must specify the same certificate as used by the server.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: ssl_ca</div> </td> </tr> <tr> <td colspan="1">  <b>channel</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 0.1.0 of community.mysql </div> </td> <td> </td> <td> <div>Name of replication channel.</div> <div>Multi-source replication is supported from MySQL 5.7.</div> <div>Mutually exclusive with <em>connection_name</em>.</div> <div>For more information see <a href="https://dev.mysql.com/doc/refman/8.0/en/replication-multi-source.html">https://dev.mysql.com/doc/refman/8.0/en/replication-multi-source.html</a>.</div> </td> </tr> <tr> <td colspan="1">  <b>check_hostname</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 1.1.0 of community.mysql </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether to validate the server host name when an SSL connection is required.</div> <div>Setting this to <code>false</code> disables hostname verification. Use with caution.</div> <div>Requires pymysql &gt;= 0.7.11.</div> <div>This optoin has no effect on MySQLdb.</div> </td> </tr> <tr> <td colspan="1">  <b>client_cert</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>The path to a client public key certificate.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: ssl_cert</div> </td> </tr> <tr> <td colspan="1">  <b>client_key</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>The path to the client private key.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: ssl_key</div> </td> </tr> <tr> <td colspan="1">  <b>config_file</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"~/.my.cnf"</div> </td> <td> <div>Specify a config file from which user and password are to be read.</div> </td> </tr> <tr> <td colspan="1">  <b>connect_timeout</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">30</div> </td> <td> <div>The connection timeout when connecting to the MySQL server.</div> </td> </tr> <tr> <td colspan="1">  <b>connection_name</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 0.1.0 of community.mysql </div> </td> <td> </td> <td> <div>Name of the master connection.</div> <div>Supported from MariaDB 10.0.1.</div> <div>Mutually exclusive with <em>channel</em>.</div> <div>For more information see <a href="https://mariadb.com/kb/en/library/multi-source-replication/">https://mariadb.com/kb/en/library/multi-source-replication/</a>.</div> </td> </tr> <tr> <td colspan="1">  <b>fail_on_error</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 0.1.0 of community.mysql </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Fails on error when calling mysql.</div> </td> </tr> <tr> <td colspan="1">  <b>login_host</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"localhost"</div> </td> <td> <div>Host running the database.</div> <div>In some cases for local connections the <em>login_unix_socket=/path/to/mysqld/socket</em>, that is usually <code>/var/run/mysqld/mysqld.sock</code>, needs to be used instead of <em>login_host=localhost</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>login_password</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The password used to authenticate with.</div> </td> </tr> <tr> <td colspan="1">  <b>login_port</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">3306</div> </td> <td> <div>Port of the MySQL server. Requires <em>login_host</em> be defined as other than localhost if login_port is used.</div> </td> </tr> <tr> <td colspan="1">  <b>login_unix_socket</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The path to a Unix domain socket for local connections.</div> </td> </tr> <tr> <td colspan="1">  <b>login_user</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The username used to authenticate with.</div> </td> </tr> <tr> <td colspan="1">  <b>master_auto_position</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether the host uses GTID based replication or not.</div> </td> </tr> <tr> <td colspan="1">  <b>master_connect_retry</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_delay</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 0.1.0 of community.mysql </div> </td> <td> </td> <td> <div>Time lag behind the master's state (in seconds).</div> <div>Available from MySQL 5.6.</div> <div>For more information see <a href="https://dev.mysql.com/doc/refman/8.0/en/replication-delayed.html">https://dev.mysql.com/doc/refman/8.0/en/replication-delayed.html</a>.</div> </td> </tr> <tr> <td colspan="1">  <b>master_host</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_log_file</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_log_pos</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_password</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_port</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl_ca</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl_capath</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl_cert</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl_cipher</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_ssl_key</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>master_use_gtid</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen"> added in 0.1.0 of community.mysql </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>current_pos</li> <li>slave_pos</li> <li>disabled</li> </ul> </td> <td> <div>Configures the slave to use the MariaDB Global Transaction ID.</div> <div>
<code>disabled</code> equals MASTER_USE_GTID=no command.</div> <div>To find information about available values see <a href="https://mariadb.com/kb/en/library/change-master-to/#master_use_gtid">https://mariadb.com/kb/en/library/change-master-to/#master_use_gtid</a>.</div> <div>Available since MariaDB 10.0.2.</div> </td> </tr> <tr> <td colspan="1">  <b>master_user</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>mode</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>changemaster</li> <li>getmaster</li> <li><div style="color: blue">
<b>getslave</b> ←</div></li> <li>startslave</li> <li>stopslave</li> <li>resetmaster</li> <li>resetslave</li> <li>resetslaveall</li> </ul> </td> <td> <div>Module operating mode. Could be <code>changemaster</code> (CHANGE MASTER TO), <code>getmaster</code> (SHOW MASTER STATUS), <code>getslave</code> (SHOW SLAVE STATUS), <code>startslave</code> (START SLAVE), <code>stopslave</code> (STOP SLAVE), <code>resetmaster</code> (RESET MASTER) - supported since community.mysql 0.1.0, <code>resetslave</code> (RESET SLAVE), <code>resetslaveall</code> (RESET SLAVE ALL).</div> </td> </tr> <tr> <td colspan="1">  <b>relay_log_file</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> <tr> <td colspan="1">  <b>relay_log_pos</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Same as mysql variable.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If an empty value for the parameter of string type is needed, use an empty string.</li> <li>Requires the PyMySQL (Python 2.7 and Python 3.X) or MySQL-python (Python 2.X) package installed on the remote host. The Python package may be installed with apt-get install python-pymysql (Ubuntu; see <a class="reference internal" href="../../ansible/builtin/apt_module#ansible-collections-ansible-builtin-apt-module"><span class="std std-ref">ansible.builtin.apt</span></a>) or yum install python2-PyMySQL (RHEL/CentOS/Fedora; see <a class="reference internal" href="../../ansible/builtin/yum_module#ansible-collections-ansible-builtin-yum-module"><span class="std std-ref">ansible.builtin.yum</span></a>). You can also use dnf install python2-PyMySQL for newer versions of Fedora; see <a class="reference internal" href="../../ansible/builtin/dnf_module#ansible-collections-ansible-builtin-dnf-module"><span class="std std-ref">ansible.builtin.dnf</span></a>.</li> <li>Be sure you have PyMySQL or MySQLdb library installed on the target machine for the Python interpreter Ansible uses, for example, if it is Python 3, you must install the library for Python 3. You can also change the interpreter. For more information, see <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/interpreter_discovery.html">https://docs.ansible.com/ansible/latest/reference_appendices/interpreter_discovery.html</a>.</li> <li>Both <code>login_password</code> and <code>login_user</code> are required when you are passing credentials. If none are present, the module will attempt to read the credentials from <code>~/.my.cnf</code>, and finally fall back to using the MySQL default login of ‘root’ with no password.</li> <li>If there are problems with local connections, using <em>login_unix_socket=/path/to/mysqld/socket</em> instead of <em>login_host=localhost</em> might help. As an example, the default MariaDB installation of version 10.4 and later uses the unix_socket authentication plugin by default that without using <em>login_unix_socket=/var/run/mysqld/mysqld.sock</em> (the default path) causes the error <code>Host '127.0.0.1' is not allowed to connect to this MariaDB server</code>.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="mysql_info_module#ansible-collections-community-mysql-mysql-info-module"><span class="std std-ref">community.mysql.mysql_info</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.mysql.mysql_info</strong> module.</p> </dd> <dt><a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/replication.html">MySQL replication reference</a></dt>
<dd>
<p>Complete reference of the MySQL replication documentation.</p> </dd> <dt><a class="reference external" href="https://mariadb.com/kb/en/library/setting-up-replication/">MariaDB replication reference</a></dt>
<dd>
<p>Complete reference of the MariaDB replication documentation.</p> </dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Stop mysql slave thread
  community.mysql.mysql_replication:
    mode: stopslave

- name: Get master binlog file name and binlog position
  community.mysql.mysql_replication:
    mode: getmaster

- name: Change master to master server 192.0.2.1 and use binary log 'mysql-bin.000009' with position 4578
  community.mysql.mysql_replication:
    mode: changemaster
    master_host: 192.0.2.1
    master_log_file: mysql-bin.000009
    master_log_pos: 4578

- name: Check slave status using port 3308
  community.mysql.mysql_replication:
    mode: getslave
    login_host: ansible.example.com
    login_port: 3308

- name: On MariaDB change master to use GTID current_pos
  community.mysql.mysql_replication:
    mode: changemaster
    master_use_gtid: current_pos

- name: Change master to use replication delay 3600 seconds
  community.mysql.mysql_replication:
    mode: changemaster
    master_host: 192.0.2.1
    master_delay: 3600

- name: Start MariaDB standby with connection name master-1
  community.mysql.mysql_replication:
    mode: startslave
    connection_name: master-1

- name: Stop replication in channel master-1
  community.mysql.mysql_replication:
    mode: stopslave
    channel: master-1

- name: &gt;
    Run RESET MASTER command which will delete all existing binary log files
    and reset the binary log index file on the master
  community.mysql.mysql_replication:
    mode: resetmaster

- name: Run start slave and fail the task on errors
  community.mysql.mysql_replication:
    mode: startslave
    connection_name: master-1
    fail_on_error: yes

- name: Change master and fail on error (like when slave thread is running)
  community.mysql.mysql_replication:
    mode: changemaster
    fail_on_error: yes
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>queries</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 0.1.0 of community.mysql</div> </td> <td>always</td> <td> <div>List of executed queries which modified DB's state.</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">["CHANGE MASTER TO MASTER_HOST='master2.example.com',MASTER_PORT=3306"]</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Balazs Pocze (@banyek)</li> <li>Andrew Klychkov (@Andersson007)</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.10/collections/community/mysql/mysql_replication_module.html" class="_attribution-link">https://docs.ansible.com/ansible/2.10/collections/community/mysql/mysql_replication_module.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

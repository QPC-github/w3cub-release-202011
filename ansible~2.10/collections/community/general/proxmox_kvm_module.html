
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Proxmox_kvm – Management of Qemu(KVM) Virtual Machines in Proxmox VE Cluster - Ansible 2.10 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="community, general, proxmox, kvm, –, management, qemu, virtual, machines, ve, cluster, ansible, ansible~2.10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.10/collections/community/general/proxmox_kvm_module.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/ansible~2.10.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.10/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.10</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="community-general-proxmox-kvm-management-of-qemu-kvm-virtual-machines-in-proxmox-ve-cluster">community.general.proxmox_kvm – Management of Qemu(KVM) Virtual Machines in Proxmox VE cluster.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/general">community.general collection</a>.</p> <p>To install it use: <code>ansible-galaxy collection install community.general</code>.</p> <p>To use it in a playbook, specify: <code>community.general.proxmox_kvm</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id5">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Allows you to create/delete/stop Qemu(KVM) Virtual Machines in Proxmox VE cluster.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>proxmoxer</li> <li>requests</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>acpi</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Specify if ACPI should be enabled/disabled.</div> </td> </tr> <tr> <td colspan="1">  <b>agent</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Specify if the QEMU Guest Agent should be enabled/disabled.</div> </td> </tr> <tr> <td colspan="1">  <b>api_host</b>  <div style="font-size: small"> <span style="color: purple">string</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div>Specify the target host of the Proxmox VE cluster.</div> </td> </tr> <tr> <td colspan="1">  <b>api_password</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specify the password to authenticate with.</div> <div>You can use <code>PROXMOX_PASSWORD</code> environment variable.</div> </td> </tr> <tr> <td colspan="1">  <b>api_user</b>  <div style="font-size: small"> <span style="color: purple">string</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div>Specify the user to authenticate with.</div> </td> </tr> <tr> <td colspan="1">  <b>args</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"-serial unix:/var/run/qemu-server/VMID.serial,server,nowait"</div> </td> <td> <div>Pass arbitrary arguments to kvm.</div> <div>This option is for experts only!</div> </td> </tr> <tr> <td colspan="1">  <b>autostart</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Specify if the VM should be automatically restarted after crash (currently ignored in PVE API).</div> </td> </tr> <tr> <td colspan="1">  <b>balloon</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">0</div> </td> <td> <div>Specify the amount of RAM for the VM in MB.</div> <div>Using zero disables the balloon driver.</div> </td> </tr> <tr> <td colspan="1">  <b>bios</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>seabios</li> <li>ovmf</li> </ul> </td> <td> <div>Specify the BIOS implementation.</div> </td> </tr> <tr> <td colspan="1">  <b>boot</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"cnd"</div> </td> <td> <div>Specify the boot order -&gt; boot on floppy <code>a</code>, hard disk <code>c</code>, CD-ROM <code>d</code>, or network <code>n</code>.</div> <div>You can combine to set order.</div> </td> </tr> <tr> <td colspan="1">  <b>bootdisk</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Enable booting from specified disk. <code>(ide|sata|scsi|virtio</code>\d+)</div> </td> </tr> <tr> <td colspan="1">  <b>clone</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Name of VM to be cloned. If <code>vmid</code> is setted, <code>clone</code> can take arbitrary value but required for initiating the clone.</div> </td> </tr> <tr> <td colspan="1">  <b>cores</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">1</div> </td> <td> <div>Specify number of cores per socket.</div> </td> </tr> <tr> <td colspan="1">  <b>cpu</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"kvm64"</div> </td> <td> <div>Specify emulated CPU type.</div> </td> </tr> <tr> <td colspan="1">  <b>cpulimit</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Specify if CPU usage will be limited. Value 0 indicates no CPU limit.</div> <div>If the computer has 2 CPUs, it has total of '2' CPU time</div> </td> </tr> <tr> <td colspan="1">  <b>cpuunits</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">1000</div> </td> <td> <div>Specify CPU weight for a VM.</div> <div>You can disable fair-scheduler configuration by setting this to 0</div> </td> </tr> <tr> <td colspan="1">  <b>delete</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specify a list of settings you want to delete.</div> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specify the description for the VM. Only used on the configuration web interface.</div> <div>This is saved as comment inside the configuration file.</div> </td> </tr> <tr> <td colspan="1">  <b>digest</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specify if to prevent changes if current configuration file has different SHA1 digest.</div> <div>This can be used to prevent concurrent modifications.</div> </td> </tr> <tr> <td colspan="1">  <b>force</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Allow to force stop VM.</div> <div>Can be used with states <code>stopped</code> and <code>restarted</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>format</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>cloop</li> <li>cow</li> <li>qcow</li> <li><div style="color: blue">
<b>qcow2</b> ←</div></li> <li>qed</li> <li>raw</li> <li>vmdk</li> </ul> </td> <td> <div>Target drive's backing file's data format.</div> <div>Used only with clone</div> </td> </tr> <tr> <td colspan="1">  <b>freeze</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Specify if PVE should freeze CPU at startup (use 'c' monitor command to start execution).</div> </td> </tr> <tr> <td colspan="1">  <b>full</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Create a full copy of all disk. This is always done when you clone a normal VM.</div> <div>For VM templates, we try to create a linked clone by default.</div> <div>Used only with clone</div> </td> </tr> <tr> <td colspan="1">  <b>hostpci</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>Specify a hash/dictionary of map host pci devices into guest. <code>hostpci='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>hostpci[n]</code> where 0 ≤ n ≤ N.</div> <div>Values allowed are - <code>"host="HOSTPCIID[;HOSTPCIID2...]",pcie="1|0",rombar="1|0",x-vga="1|0""</code>.</div> <div>The <code>host</code> parameter is Host PCI device pass through. HOSTPCIID syntax is <code>bus:dev.func</code> (hexadecimal numbers).</div> <div>
<code>pcie=boolean</code> <em>default=0</em> Choose the PCI-express bus (needs the q35 machine model).</div> <div>
<code>rombar=boolean</code> <em>default=1</em> Specify whether or not the device's ROM will be visible in the guest's memory map.</div> <div>
<code>x-vga=boolean</code> <em>default=0</em> Enable vfio-vga device support.</div> <div>/!\ This option allows direct access to host hardware. So it is no longer possible to migrate such machines - use with special care.</div> </td> </tr> <tr> <td colspan="1">  <b>hotplug</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Selectively enable hotplug features.</div> <div>This is a comma separated list of hotplug features <code>'network', 'disk', 'cpu', 'memory' and 'usb'</code>.</div> <div>Value 0 disables hotplug completely and value 1 is an alias for the default <code>'network,disk,usb'</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>hugepages</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>any</li> <li>2</li> <li>1024</li> </ul> </td> <td> <div>Enable/disable hugepages memory.</div> </td> </tr> <tr> <td colspan="1">  <b>ide</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of volume used as IDE hard disk or CD-ROM. <code>ide='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>ide[n]</code> where 0 ≤ n ≤ 3.</div> <div>Values allowed are - <code>"storage:size,format=value"</code>.</div> <div>
<code>storage</code> is the storage identifier where to create the disk.</div> <div>
<code>size</code> is the size of the disk in GB.</div> <div>
<code>format</code> is the drive's backing file's data format. <code>qcow2|raw|subvol</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>keyboard</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Sets the keyboard layout for VNC server.</div> </td> </tr> <tr> <td colspan="1">  <b>kvm</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Enable/disable KVM hardware virtualization.</div> </td> </tr> <tr> <td colspan="1">  <b>localtime</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Sets the real time clock to local time.</div> <div>This is enabled by default if ostype indicates a Microsoft OS.</div> </td> </tr> <tr> <td colspan="1">  <b>lock</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>migrate</li> <li>backup</li> <li>snapshot</li> <li>rollback</li> </ul> </td> <td> <div>Lock/unlock the VM.</div> </td> </tr> <tr> <td colspan="1">  <b>machine</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specifies the Qemu machine type.</div> <div>type =&gt; <code>(pc|pc(-i440fx</code>?-\d+\.\d+(\.pxe)?|q35|pc-q35-\d+\.\d+(\.pxe)?))</div> </td> </tr> <tr> <td colspan="1">  <b>memory</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">512</div> </td> <td> <div>Memory size in MB for instance.</div> </td> </tr> <tr> <td colspan="1">  <b>migrate_downtime</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Sets maximum tolerated downtime (in seconds) for migrations.</div> </td> </tr> <tr> <td colspan="1">  <b>migrate_speed</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Sets maximum speed (in MB/s) for migrations.</div> <div>A value of 0 is no limit.</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specifies the VM name. Only used on the configuration web interface.</div> <div>Required only for <code>state=present</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>net</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of network interfaces for the VM. <code>net='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>net[n]</code> where 0 ≤ n ≤ N.</div> <div>Values allowed are - <code>"model="XX:XX:XX:XX:XX:XX",bridge="value",rate="value",tag="value",firewall="1|0",trunks="vlanid""</code>.</div> <div>Model is one of <code>e1000 e1000-82540em e1000-82544gc e1000-82545em i82551 i82557b i82559er ne2k_isa ne2k_pci pcnet rtl8139 virtio vmxnet3</code>.</div> <div>
<code>XX:XX:XX:XX:XX:XX</code> should be an unique MAC address. This is automatically generated if not specified.</div> <div>The <code>bridge</code> parameter can be used to automatically add the interface to a bridge device. The Proxmox VE standard bridge is called 'vmbr0'.</div> <div>Option <code>rate</code> is used to limit traffic bandwidth from and to this interface. It is specified as floating point number, unit is 'Megabytes per second'.</div> <div>If you specify no bridge, we create a kvm 'user' (NATed) network device, which provides DHCP and DNS services.</div> </td> </tr> <tr> <td colspan="1">  <b>newid</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>VMID for the clone. Used only with clone.</div> <div>If newid is not set, the next available VM ID will be fetched from ProxmoxAPI.</div> </td> </tr> <tr> <td colspan="1">  <b>node</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Proxmox VE node, where the new VM will be created.</div> <div>Only required for <code>state=present</code>.</div> <div>For other states, it will be autodiscovered.</div> </td> </tr> <tr> <td colspan="1">  <b>numa</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionaries of NUMA topology. <code>numa='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>numa[n]</code> where 0 ≤ n ≤ N.</div> <div>Values allowed are - <code>"cpu="&lt;id[-id];...&gt;",hostnodes="&lt;id[-id];...&gt;",memory="number",policy="(bind|interleave|preferred</code>"").</div> <div>
<code>cpus</code> CPUs accessing this NUMA node.</div> <div>
<code>hostnodes</code> Host NUMA nodes to use.</div> <div>
<code>memory</code> Amount of memory this NUMA node provides.</div> <div>
<code>policy</code> NUMA allocation policy.</div> </td> </tr> <tr> <td colspan="1">  <b>onboot</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Specifies whether a VM will be started during system bootup.</div> </td> </tr> <tr> <td colspan="1">  <b>ostype</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>other</li> <li>wxp</li> <li>w2k</li> <li>w2k3</li> <li>w2k8</li> <li>wvista</li> <li>win7</li> <li>win8</li> <li>win10</li> <li>l24</li> <li><div style="color: blue">
<b>l26</b> ←</div></li> <li>solaris</li> </ul> </td> <td> <div>Specifies guest operating system. This is used to enable special optimization/features for specific operating systems.</div> <div>The l26 is Linux 2.6/3.X Kernel.</div> </td> </tr> <tr> <td colspan="1">  <b>parallel</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of map host parallel devices. <code>parallel='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - (parallel[n]) where 0 ≤ n ≤ 2.</div> <div>Values allowed are - <code>"/dev/parport\d+|/dev/usb/lp\d+"</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>pool</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Add the new VM to the specified pool.</div> </td> </tr> <tr> <td colspan="1">  <b>protection</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Enable/disable the protection flag of the VM. This will enable/disable the remove VM and remove disk operations.</div> </td> </tr> <tr> <td colspan="1">  <b>reboot</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Allow reboot. If set to <code>yes</code>, the VM exit on reboot.</div> </td> </tr> <tr> <td colspan="1">  <b>revert</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Revert a pending change.</div> </td> </tr> <tr> <td colspan="1">  <b>sata</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of volume used as sata hard disk or CD-ROM. <code>sata='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>sata[n]</code> where 0 ≤ n ≤ 5.</div> <div>Values allowed are - <code>"storage:size,format=value"</code>.</div> <div>
<code>storage</code> is the storage identifier where to create the disk.</div> <div>
<code>size</code> is the size of the disk in GB.</div> <div>
<code>format</code> is the drive's backing file's data format. <code>qcow2|raw|subvol</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>scsi</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of volume used as SCSI hard disk or CD-ROM. <code>scsi='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>sata[n]</code> where 0 ≤ n ≤ 13.</div> <div>Values allowed are - <code>"storage:size,format=value"</code>.</div> <div>
<code>storage</code> is the storage identifier where to create the disk.</div> <div>
<code>size</code> is the size of the disk in GB.</div> <div>
<code>format</code> is the drive's backing file's data format. <code>qcow2|raw|subvol</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>scsihw</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>lsi</li> <li>lsi53c810</li> <li>virtio-scsi-pci</li> <li>virtio-scsi-single</li> <li>megasas</li> <li>pvscsi</li> </ul> </td> <td> <div>Specifies the SCSI controller model.</div> </td> </tr> <tr> <td colspan="1">  <b>serial</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of serial device to create inside the VM. <code>'{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - serial[n](str; required) where 0 ≤ n ≤ 3.</div> <div>Values allowed are - <code>(/dev/.+|socket</code>).</div> <div>/!\ If you pass through a host serial device, it is no longer possible to migrate such machines - use with special care.</div> </td> </tr> <tr> <td colspan="1">  <b>shares</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Rets amount of memory shares for auto-ballooning. (0 - 50000).</div> <div>The larger the number is, the more memory this VM gets.</div> <div>The number is relative to weights of all other running VMs.</div> <div>Using 0 disables auto-ballooning, this means no limit.</div> </td> </tr> <tr> <td colspan="1">  <b>skiplock</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Ignore locks</div> <div>Only root is allowed to use this option.</div> </td> </tr> <tr> <td colspan="1">  <b>smbios</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Specifies SMBIOS type 1 fields.</div> </td> </tr> <tr> <td colspan="1">  <b>snapname</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The name of the snapshot. Used only with clone.</div> </td> </tr> <tr> <td colspan="1">  <b>sockets</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">1</div> </td> <td> <div>Sets the number of CPU sockets. (1 - N).</div> </td> </tr> <tr> <td colspan="1">  <b>startdate</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Sets the initial date of the real time clock.</div> <div>Valid format for date are <code>'now'</code> or <code>'2016-09-25T16:01:21'</code> or <code>'2016-09-25'</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>startup</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Startup and shutdown behavior. <code>[[order=]\d+] [,up=\d+] [,down=\d+]</code>.</div> <div>Order is a non-negative number defining the general startup order.</div> <div>Shutdown in done with reverse ordering.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>present</b> ←</div></li> <li>started</li> <li>absent</li> <li>stopped</li> <li>restarted</li> <li>current</li> </ul> </td> <td> <div>Indicates desired state of the instance.</div> <div>If <code>current</code>, the current state of the VM will be fetched. You can access it with <code>results.status</code>
</div> </td> </tr> <tr> <td colspan="1">  <b>storage</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Target storage for full clone.</div> </td> </tr> <tr> <td colspan="1">  <b>tablet</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Enables/disables the USB tablet device.</div> </td> </tr> <tr> <td colspan="1">  <b>target</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Target node. Only allowed if the original VM is on shared storage.</div> <div>Used only with clone</div> </td> </tr> <tr> <td colspan="1">  <b>tdf</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Enables/disables time drift fix.</div> </td> </tr> <tr> <td colspan="1">  <b>template</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Enables/disables the template.</div> </td> </tr> <tr> <td colspan="1">  <b>timeout</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">30</div> </td> <td> <div>Timeout for operations.</div> </td> </tr> <tr> <td colspan="1">  <b>update</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <code>yes</code>, the VM will be updated with new value.</div> <div>Cause of the operations of the API and security reasons, I have disabled the update of the following parameters</div> <div>
<code>net, virtio, ide, sata, scsi</code>. Per example updating <code>net</code> update the MAC address and <code>virtio</code> create always new disk...</div> </td> </tr> <tr> <td colspan="1">  <b>validate_certs</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <code>no</code>, SSL certificates will not be validated. This should only be used on personally controlled sites using self-signed certificates.</div> </td> </tr> <tr> <td colspan="1">  <b>vcpus</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Sets number of hotplugged vcpus.</div> </td> </tr> <tr> <td colspan="1">  <b>vga</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>std</b> ←</div></li> <li>cirrus</li> <li>vmware</li> <li>qxl</li> <li>serial0</li> <li>serial1</li> <li>serial2</li> <li>serial3</li> <li>qxl2</li> <li>qxl3</li> <li>qxl4</li> </ul> </td> <td> <div>Select VGA type. If you want to use high resolution modes (&gt;= 1280x1024x16) then you should use option 'std' or 'vmware'.</div> </td> </tr> <tr> <td colspan="1">  <b>virtio</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>A hash/dictionary of volume used as VIRTIO hard disk. <code>virtio='{"key":"value", "key":"value"}'</code>.</div> <div>Keys allowed are - <code>virto[n]</code> where 0 ≤ n ≤ 15.</div> <div>Values allowed are - <code>"storage:size,format=value"</code>.</div> <div>
<code>storage</code> is the storage identifier where to create the disk.</div> <div>
<code>size</code> is the size of the disk in GB.</div> <div>
<code>format</code> is the drive's backing file's data format. <code>qcow2|raw|subvol</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>vmid</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>Specifies the VM ID. Instead use <em>name</em> parameter.</div> <div>If vmid is not set, the next available VM ID will be fetched from ProxmoxAPI.</div> </td> </tr> <tr> <td colspan="1">  <b>watchdog</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Creates a virtual hardware watchdog device.</div> </td> </tr> </table> <br>  <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Create new VM with minimal options
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf

- name: Create new VM with minimal options and given vmid
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    vmid: 100

- name: Create new VM with two network interface options
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    net: '{"net0":"virtio,bridge=vmbr1,rate=200", "net1":"e1000,bridge=vmbr2,"}'

- name: Create new VM with one network interface, three virto hard disk, 4 cores, and 2 vcpus
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    net: '{"net0":"virtio,bridge=vmbr1,rate=200"}'
    virtio: '{"virtio0":"VMs_LVM:10", "virtio1":"VMs:2,format=qcow2", "virtio2":"VMs:5,format=raw"}'
    cores: 4
    vcpus: 2

- name: &gt;
    Clone VM with only source VM name.
    The VM source is spynal.
    The target VM name is zavala
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    clone: spynal
    name: zavala
    node: sabrewulf
    storage: VMs
    format: qcow2
    timeout: 500

- name: Clone VM with source vmid and target newid and raw format
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    clone: arbitrary_name
    vmid: 108
    newid: 152
    name: zavala
    node: sabrewulf
    storage: LVM_STO
    format: raw
    timeout: 300

- name: Create new VM and lock it for snapashot
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    lock: snapshot

- name: Create new VM and set protection to disable the remove VM and remove disk operations
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    protection: yes

- name: Start VM
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: started

- name: Stop VM
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: stopped

- name: Stop VM with force
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: stopped
    force: yes

- name: Restart VM
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: restarted

- name: Remove VM
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: absent

- name: Get VM current state
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    state: current

- name: Update VM configuration
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    cores: 8
    memory: 16384
    update: yes

- name: Delete QEMU parameters
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    delete: 'args,template,cpulimit'

- name: Revert a pending change
  community.general.proxmox_kvm:
    api_user: root@pam
    api_password: secret
    api_host: helldorado
    name: spynal
    node: sabrewulf
    revert: 'template,cpulimit'
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>devices</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td>success</td> <td> <div>The list of devices created or used.</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">{ "ide0": "VMS_LVM:vm-115-disk-1", "ide1": "VMs:115/vm-115-disk-3.raw", "virtio0": "VMS_LVM:vm-115-disk-2", "virtio1": "VMs:115/vm-115-disk-1.qcow2", "virtio2": "VMs:115/vm-115-disk-2.raw" }</div> </td> </tr> <tr> <td colspan="1">  <b>mac</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td>success</td> <td> <div>List of mac address created and net[n] attached. Useful when you want to use provision systems like Foreman via PXE.</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">{ "net0": "3E:6E:97:D2:31:9F", "net1": "B6:A1:FC:EF:78:A4" }</div> </td> </tr> <tr> <td colspan="1">  <b>status</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td>success</td> <td> <div>The current virtual machine status.</div> <div>Returned only when <code>state=current</code>
</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">{ "changed": false, "msg": "VM kropta with vmid = 110 is running", "status": "running" }</div> </td> </tr> <tr> <td colspan="1">  <b>vmid</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td>success</td> <td> <div>The VM vmid.</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">115</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Abdoul Bah (@helldorado) &lt;bahabdoul at gmail.com&gt;</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.10/collections/community/general/proxmox_kvm_module.html" class="_attribution-link">https://docs.ansible.com/ansible/2.10/collections/community/general/proxmox_kvm_module.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

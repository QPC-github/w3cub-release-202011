
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>UNITY_BUILD - CMake 3.19 - W3cubDocs</title>
  
  <meta name="description" content=" New in version 3.16. ">
  <meta name="keywords" content="unity, build, cmake, cmake~3.19">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/cmake~3.19/prop_tgt/unity_build.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/cmake~3.19.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/cmake~3.19/" class="_nav-link" title="" style="margin-left:0;">CMake 3.19</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx_simple">
				
				
<h1 id="prop_tgt:UNITY_BUILD">UNITY_BUILD</h1> <div class="versionadded" id="unity-build"> <p><span class="versionmodified added">New in version 3.16.</span></p> </div> <p>When this property is set to true, the target source files will be combined into batches for faster compilation. This is done by creating a (set of) unity sources which <code>#include</code> the original sources, then compiling these unity sources instead of the originals. This is known as a <em>Unity</em> or <em>Jumbo</em> build.</p> <p>CMake provides different algorithms for selecting which sources are grouped together into a <em>bucket</em>. Algorithm selection is decided by the <a class="reference internal" href="unity_build_mode#prop_tgt:UNITY_BUILD_MODE" title="UNITY_BUILD_MODE" id="index-0-prop_tgt:UNITY_BUILD_MODE"><code>UNITY_BUILD_MODE</code></a> target property, which has the following acceptable values:</p> <ul class="simple"> <li>
<code>BATCH</code> When in this mode CMake determines which files are grouped together. The <a class="reference internal" href="unity_build_batch_size#prop_tgt:UNITY_BUILD_BATCH_SIZE" title="UNITY_BUILD_BATCH_SIZE" id="index-0-prop_tgt:UNITY_BUILD_BATCH_SIZE"><code>UNITY_BUILD_BATCH_SIZE</code></a> property controls the upper limit on how many sources can be combined per unity source file.</li> <li>
<code>GROUP</code> When in this mode each target explicitly specifies how to group source files. Each source file that has the same <a class="reference internal" href="../prop_sf/unity_group#prop_sf:UNITY_GROUP" title="UNITY_GROUP" id="index-0-prop_sf:UNITY_GROUP"><code>UNITY_GROUP</code></a> value will be grouped together. Any sources that donâ€™t have this property will be compiled individually. The <a class="reference internal" href="unity_build_batch_size#prop_tgt:UNITY_BUILD_BATCH_SIZE" title="UNITY_BUILD_BATCH_SIZE" id="index-1-prop_tgt:UNITY_BUILD_BATCH_SIZE"><code>UNITY_BUILD_BATCH_SIZE</code></a> property is ignored when using this mode.</li> </ul> <p>If no explicit <a class="reference internal" href="unity_build_mode#prop_tgt:UNITY_BUILD_MODE" title="UNITY_BUILD_MODE" id="index-1-prop_tgt:UNITY_BUILD_MODE"><code>UNITY_BUILD_MODE</code></a> has been specified, CMake will default to <code>BATCH</code>.</p> <p>Unity builds are not currently supported for all languages. CMake version 3.19.0-rc3 supports combining <code>C</code> and <code>CXX</code> source files. For targets that mix source files from more than one language, CMake will separate the languages such that each generated unity source file only contains sources for a single language.</p> <p>This property is initialized by the value of the <a class="reference internal" href="../variable/cmake_unity_build#variable:CMAKE_UNITY_BUILD" title="CMAKE_UNITY_BUILD" id="index-0-variable:CMAKE_UNITY_BUILD"><code>CMAKE_UNITY_BUILD</code></a> variable when a target is created.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Projects should not directly set the <code>UNITY_BUILD</code> property or its associated <a class="reference internal" href="../variable/cmake_unity_build#variable:CMAKE_UNITY_BUILD" title="CMAKE_UNITY_BUILD" id="index-1-variable:CMAKE_UNITY_BUILD"><code>CMAKE_UNITY_BUILD</code></a> variable to true. Depending on the capabilities of the build machine and compiler used, it might or might not be appropriate to enable unity builds. Therefore, this feature should be under developer control, which would normally be through the developer choosing whether or not to set the <a class="reference internal" href="../variable/cmake_unity_build#variable:CMAKE_UNITY_BUILD" title="CMAKE_UNITY_BUILD" id="index-2-variable:CMAKE_UNITY_BUILD"><code>CMAKE_UNITY_BUILD</code></a> variable on the <a class="reference internal" href="../manual/cmake.1#manual:cmake(1)" title="cmake(1)" id="index-0-manual:cmake(1)"><code>cmake(1)</code></a> command line or some other equivalent method. However, it IS recommended to set the <code>UNITY_BUILD</code> target property to false if it is known that enabling unity builds for the target can lead to problems.</p> </div>  <h2 id="odr-one-definition-rule-errors">ODR (One definition rule) errors</h2> <p>When multiple source files are included into one source file, as is done for unity builds, it can potentially lead to ODR errors. CMake provides a number of measures to help address such problems:</p> <ul class="simple"> <li>Any source file that has a non-empty <a class="reference internal" href="../prop_sf/compile_options#prop_sf:COMPILE_OPTIONS" title="COMPILE_OPTIONS" id="index-0-prop_sf:COMPILE_OPTIONS"><code>COMPILE_OPTIONS</code></a>, <a class="reference internal" href="../prop_sf/compile_definitions#prop_sf:COMPILE_DEFINITIONS" title="COMPILE_DEFINITIONS" id="index-0-prop_sf:COMPILE_DEFINITIONS"><code>COMPILE_DEFINITIONS</code></a>, <a class="reference internal" href="../prop_sf/compile_flags#prop_sf:COMPILE_FLAGS" title="COMPILE_FLAGS" id="index-0-prop_sf:COMPILE_FLAGS"><code>COMPILE_FLAGS</code></a>, or <a class="reference internal" href="../prop_sf/include_directories#prop_sf:INCLUDE_DIRECTORIES" title="INCLUDE_DIRECTORIES" id="index-0-prop_sf:INCLUDE_DIRECTORIES"><code>INCLUDE_DIRECTORIES</code></a> source property will not be combined into a unity source.</li> <li>Projects can prevent an individual source file from being combined into a unity source by setting its <a class="reference internal" href="../prop_sf/skip_unity_build_inclusion#prop_sf:SKIP_UNITY_BUILD_INCLUSION" title="SKIP_UNITY_BUILD_INCLUSION" id="index-0-prop_sf:SKIP_UNITY_BUILD_INCLUSION"><code>SKIP_UNITY_BUILD_INCLUSION</code></a> source property to true. This can be a more effective way to prevent problems with specific files than disabling unity builds for an entire target.</li> <li>The <a class="reference internal" href="unity_build_code_before_include#prop_tgt:UNITY_BUILD_CODE_BEFORE_INCLUDE" title="UNITY_BUILD_CODE_BEFORE_INCLUDE" id="index-0-prop_tgt:UNITY_BUILD_CODE_BEFORE_INCLUDE"><code>UNITY_BUILD_CODE_BEFORE_INCLUDE</code></a> and <a class="reference internal" href="unity_build_code_after_include#prop_tgt:UNITY_BUILD_CODE_AFTER_INCLUDE" title="UNITY_BUILD_CODE_AFTER_INCLUDE" id="index-0-prop_tgt:UNITY_BUILD_CODE_AFTER_INCLUDE"><code>UNITY_BUILD_CODE_AFTER_INCLUDE</code></a> target properties can be used to inject code into the unity source files before and after every <code>#include</code> statement.</li> <li>The order of source files added to the target via commands like <a class="reference internal" href="../command/add_library#command:add_library" title="add_library" id="index-0-command:add_library"><code>add_library()</code></a>, <a class="reference internal" href="../command/add_executable#command:add_executable" title="add_executable" id="index-0-command:add_executable"><code>add_executable()</code></a> or <a class="reference internal" href="../command/target_sources#command:target_sources" title="target_sources" id="index-0-command:target_sources"><code>target_sources()</code></a> will be preserved in the generated unity source files. This can be used to manually enforce a specific grouping based on the <a class="reference internal" href="unity_build_batch_size#prop_tgt:UNITY_BUILD_BATCH_SIZE" title="UNITY_BUILD_BATCH_SIZE" id="index-2-prop_tgt:UNITY_BUILD_BATCH_SIZE"><code>UNITY_BUILD_BATCH_SIZE</code></a> target property.</li> </ul>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2000â€“2020 Kitware, Inc. and Contributors<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://cmake.org/cmake/help/v3.19/prop_tgt/UNITY_BUILD.html" class="_attribution-link">https://cmake.org/cmake/help/v3.19/prop_tgt/UNITY_BUILD.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

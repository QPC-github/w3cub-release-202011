
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Non-parametric Tilted Bootstrap - R - W3cubDocs</title>
  
  <meta name="description" content="This function will run an initial bootstrap with equal resampling probabilities (if required) and will use the output of the initial run to find &hellip;">
  <meta name="keywords" content="non-parametric, tilted, bootstrap, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/boot/html/tilt.boot.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>tilt.boot</code>  Non-parametric Tilted Bootstrap </h2> <h3>Description</h3> <p>This function will run an initial bootstrap with equal resampling probabilities (if required) and will use the output of the initial run to find resampling probabilities which put the value of the statistic at required values. It then runs an importance resampling bootstrap using the calculated probabilities as the resampling distribution. </p> <h3>Usage</h3> <pre data-language="r">
tilt.boot(data, statistic, R, sim = "ordinary", stype = "i", 
          strata = rep(1, n), L = NULL, theta = NULL, 
          alpha = c(0.025, 0.975), tilt = TRUE, width = 0.5, 
          index = 1, ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>data</code></td> <td> <p>The data as a vector, matrix or data frame. If it is a matrix or data frame then each row is considered as one (multivariate) observation. </p> </td>
</tr> <tr valign="top">
<td><code>statistic</code></td> <td> <p>A function which when applied to data returns a vector containing the statistic(s) of interest. It must take at least two arguments. The first argument will always be <code>data</code> and the second should be a vector of indices, weights or frequencies describing the bootstrap sample. Any other arguments must be supplied to <code>tilt.boot</code> and will be passed unchanged to statistic each time it is called. </p> </td>
</tr> <tr valign="top">
<td><code>R</code></td> <td> <p>The number of bootstrap replicates required. This will generally be a vector, the first value stating how many uniform bootstrap simulations are to be performed at the initial stage. The remaining values of <code>R</code> are the number of simulations to be performed resampling from each reweighted distribution. The first value of <code>R</code> must always be present, a value of 0 implying that no uniform resampling is to be carried out. Thus <code>length(R)</code> should always equal <code>1+length(theta)</code>. </p> </td>
</tr> <tr valign="top">
<td><code>sim</code></td> <td> <p>This is a character string indicating the type of bootstrap simulation required. There are only two possible values that this can take: <code>"ordinary"</code> and <code>"balanced"</code>. If other simulation types are required for the initial un-weighted bootstrap then it will be necessary to run <code>boot</code>, calculate the weights appropriately, and run <code>boot</code> again using the calculated weights. </p> </td>
</tr> <tr valign="top">
<td><code>stype</code></td> <td> <p>A character string indicating the type of second argument expected by <code>statistic</code>. The possible values that <code>stype</code> can take are <code>"i"</code> (indices), <code>"w"</code> (weights) and <code>"f"</code> (frequencies). </p> </td>
</tr> <tr valign="top">
<td><code>strata</code></td> <td> <p>An integer vector or factor representing the strata for multi-sample problems. </p> </td>
</tr> <tr valign="top">
<td><code>L</code></td> <td> <p>The empirical influence values for the statistic of interest. They are used only for exponential tilting when <code>tilt</code> is <code>TRUE</code>. If <code>tilt</code> is <code>TRUE</code> and they are not supplied then <code>tilt.boot</code> uses <code>empinf</code> to calculate them. </p> </td>
</tr> <tr valign="top">
<td><code>theta</code></td> <td> <p>The required parameter value(s) for the tilted distribution(s). There should be one value of <code>theta</code> for each of the non-uniform distributions. If <code>R[1]</code> is 0 <code>theta</code> is a required argument. Otherwise <code>theta</code> values can be estimated from the initial uniform bootstrap and the values in <code>alpha</code>. </p> </td>
</tr> <tr valign="top">
<td><code>alpha</code></td> <td> <p>The alpha level to which tilting is required. This parameter is ignored if <code>R[1]</code> is 0 or if <code>theta</code> is supplied, otherwise it is used to find the values of <code>theta</code> as quantiles of the initial uniform bootstrap. In this case <code>R[1]</code> should be large enough that <code>min(c(alpha, 1-alpha))*R[1] &gt; 5</code>, if this is not the case then a warning is generated to the effect that the <code>theta</code> are extreme values and so the tilted output may be unreliable. </p> </td>
</tr> <tr valign="top">
<td><code>tilt</code></td> <td> <p>A logical variable which if <code>TRUE</code> (the default) indicates that exponential tilting should be used, otherwise local frequency smoothing (<code>smooth.f</code>) is used. If <code>tilt</code> is <code>FALSE</code> then <code>R[1]</code> must be positive. In fact in this case the value of <code>R[1]</code> should be fairly large (in the region of 500 or more). </p> </td>
</tr> <tr valign="top">
<td><code>width</code></td> <td> <p>This argument is used only if <code>tilt</code> is <code>FALSE</code>, in which case it is passed unchanged to <code>smooth.f</code> as the standardized bandwidth for the smoothing operation. The value should generally be in the range (0.2, 1). See <code>smooth.f</code> for for more details. </p> </td>
</tr> <tr valign="top">
<td><code>index</code></td> <td> <p>The index of the statistic of interest in the output from <code>statistic</code>. By default the first element of the output of <code>statistic</code> is used. </p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>Any additional arguments required by <code>statistic</code>. These are passed unchanged to <code>statistic</code> each time it is called. </p> </td>
</tr> </table> <h3>Value</h3> <p>An object of class <code>"boot"</code> with the following components </p> <table summary="R valueblock"> <tr valign="top">
<td><code>t0</code></td> <td> <p>The observed value of the statistic on the original data. </p> </td>
</tr> <tr valign="top">
<td><code>t</code></td> <td> <p>The values of the bootstrap replicates of the statistic. There will be <code>sum(R)</code> of these, the first <code>R[1]</code> corresponding to the uniform bootstrap and the remainder to the tilted bootstrap(s). </p> </td>
</tr> <tr valign="top">
<td><code>R</code></td> <td> <p>The input vector of the number of bootstrap replicates. </p> </td>
</tr> <tr valign="top">
<td><code>data</code></td> <td> <p>The original data as supplied. </p> </td>
</tr> <tr valign="top">
<td><code>statistic</code></td> <td> <p>The <code>statistic</code> function as supplied. </p> </td>
</tr> <tr valign="top">
<td><code>sim</code></td> <td> <p>The simulation type used in the bootstrap(s), it can either be <code>"ordinary"</code> or <code>"balanced"</code>. </p> </td>
</tr> <tr valign="top">
<td><code>stype</code></td> <td> <p>The type of statistic supplied, it is the same as the input value <code>stype</code>. </p> </td>
</tr> <tr valign="top">
<td><code>call</code></td> <td> <p>A copy of the original call to <code>tilt.boot</code>. </p> </td>
</tr> <tr valign="top">
<td><code>strata</code></td> <td> <p>The strata as supplied. </p> </td>
</tr> <tr valign="top">
<td><code>weights</code></td> <td> <p>The matrix of weights used. If <code>R[1]</code> is greater than 0 then the first row will be the uniform weights and each subsequent row the tilted weights. If <code>R[1]</code> equals 0 then the uniform weights are omitted and only the tilted weights are output. </p> </td>
</tr> <tr valign="top">
<td><code>theta</code></td> <td> <p>The values of <code>theta</code> used for the tilted distributions. These are either the input values or the values derived from the uniform bootstrap and <code>alpha</code>. </p> </td>
</tr> </table> <h3>References</h3> <p>Booth, J.G., Hall, P. and Wood, A.T.A. (1993) Balanced importance resampling for the bootstrap. <em>Annals of Statistics</em>, <b>21</b>, 286–298. </p> <p>Davison, A.C. and Hinkley, D.V. (1997) <em>Bootstrap Methods and Their Application</em>. Cambridge University Press. </p> <p>Hinkley, D.V. and Shi, S. (1989) Importance sampling and the nested bootstrap. <em>Biometrika</em>, <b>76</b>, 435–446. </p> <h3>See Also</h3> <p><code><a href="boot">boot</a></code>, <code><a href="exp.tilt">exp.tilt</a></code>, <code><a href="imp.estimates">Imp.Estimates</a></code>, <code><a href="imp.weights">imp.weights</a></code>, <code><a href="smooth.f">smooth.f</a></code> </p> <h3>Examples</h3> <pre data-language="r">
# Note that these examples can take a while to run.

# Example 9.9 of Davison and Hinkley (1997).
grav1 &lt;- gravity[as.numeric(gravity[,2]) &gt;= 7, ]
grav.fun &lt;- function(dat, w, orig) {
     strata &lt;- tapply(dat[, 2], as.numeric(dat[, 2]))
     d &lt;- dat[, 1]
     ns &lt;- tabulate(strata)
     w &lt;- w/tapply(w, strata, sum)[strata]
     mns &lt;- as.vector(tapply(d * w, strata, sum)) # drop names
     mn2 &lt;- tapply(d * d * w, strata, sum)
     s2hat &lt;- sum((mn2 - mns^2)/ns)
     c(mns[2]-mns[1],s2hat,(mns[2]-mns[1]-orig)/sqrt(s2hat))
}
grav.z0 &lt;- grav.fun(grav1, rep(1, 26), 0)
tilt.boot(grav1, grav.fun, R = c(249, 375, 375), stype = "w", 
          strata = grav1[,2], tilt = TRUE, index = 3, orig = grav.z0[1]) 


#  Example 9.10 of Davison and Hinkley (1997) requires a balanced 
#  importance resampling bootstrap to be run.  In this example we 
#  show how this might be run.  
acme.fun &lt;- function(data, i, bhat) {
     d &lt;- data[i,]
     n &lt;- nrow(d)
     d.lm &lt;- glm(d$acme~d$market)
     beta.b &lt;- coef(d.lm)[2]
     d.diag &lt;- boot::glm.diag(d.lm)
     SSx &lt;- (n-1)*var(d$market)
     tmp &lt;- (d$market-mean(d$market))*d.diag$res*d.diag$sd
     sr &lt;- sqrt(sum(tmp^2))/SSx
     c(beta.b, sr, (beta.b-bhat)/sr)
}
acme.b &lt;- acme.fun(acme, 1:nrow(acme), 0)
acme.boot1 &lt;- tilt.boot(acme, acme.fun, R = c(499, 250, 250), 
                        stype = "i", sim = "balanced", alpha = c(0.05, 0.95), 
                        tilt = TRUE, index = 3, bhat = acme.b[1])
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Predict Method for Linear Model Fits - R - W3cubDocs</title>
  
  <meta name="description" content=" Predicted values based on linear model object. ">
  <meta name="keywords" content="predict, method, for, linear, model, fits, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/predict.lm.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>predict.lm</code> Predict method for Linear Model Fits</h2> <h3>Description</h3> <p>Predicted values based on linear model object. </p> <h3>Usage</h3> <pre data-language="r">
## S3 method for class 'lm'
predict(object, newdata, se.fit = FALSE, scale = NULL, df = Inf,
        interval = c("none", "confidence", "prediction"),
        level = 0.95, type = c("response", "terms"),
        terms = NULL, na.action = na.pass,
        pred.var = res.var/weights, weights = 1, ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>object</code></td> <td> <p>Object of class inheriting from <code>"lm"</code></p> </td>
</tr> <tr valign="top">
<td><code>newdata</code></td> <td> <p>An optional data frame in which to look for variables with which to predict. If omitted, the fitted values are used.</p> </td>
</tr> <tr valign="top">
<td><code>se.fit</code></td> <td> <p>A switch indicating if standard errors are required.</p> </td>
</tr> <tr valign="top">
<td><code>scale</code></td> <td> <p>Scale parameter for std.err. calculation.</p> </td>
</tr> <tr valign="top">
<td><code>df</code></td> <td> <p>Degrees of freedom for scale.</p> </td>
</tr> <tr valign="top">
<td><code>interval</code></td> <td> <p>Type of interval calculation. Can be abbreviated.</p> </td>
</tr> <tr valign="top">
<td><code>level</code></td> <td> <p>Tolerance/confidence level.</p> </td>
</tr> <tr valign="top">
<td><code>type</code></td> <td> <p>Type of prediction (response or model term). Can be abbreviated.</p> </td>
</tr> <tr valign="top">
<td><code>terms</code></td> <td> <p>If <code>type = "terms"</code>, which terms (default is all terms), a <code><a href="../../base/html/character">character</a></code> vector.</p> </td>
</tr> <tr valign="top">
<td><code>na.action</code></td> <td> <p>function determining what should be done with missing values in <code>newdata</code>. The default is to predict <code>NA</code>.</p> </td>
</tr> <tr valign="top">
<td><code>pred.var</code></td> <td> <p>the variance(s) for future observations to be assumed for prediction intervals. See ‘Details’.</p> </td>
</tr> <tr valign="top">
<td><code>weights</code></td> <td> <p>variance weights for prediction. This can be a numeric vector or a one-sided model formula. In the latter case, it is interpreted as an expression evaluated in <code>newdata</code>.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>further arguments passed to or from other methods.</p> </td>
</tr> </table> <h3>Details</h3> <p><code>predict.lm</code> produces predicted values, obtained by evaluating the regression function in the frame <code>newdata</code> (which defaults to <code>model.frame(object)</code>). If the logical <code>se.fit</code> is <code>TRUE</code>, standard errors of the predictions are calculated. If the numeric argument <code>scale</code> is set (with optional <code>df</code>), it is used as the residual standard deviation in the computation of the standard errors, otherwise this is extracted from the model fit. Setting <code>intervals</code> specifies computation of confidence or prediction (tolerance) intervals at the specified <code>level</code>, sometimes referred to as narrow vs. wide intervals. </p> <p>If the fit is rank-deficient, some of the columns of the design matrix will have been dropped. Prediction from such a fit only makes sense if <code>newdata</code> is contained in the same subspace as the original data. That cannot be checked accurately, so a warning is issued. </p> <p>If <code>newdata</code> is omitted the predictions are based on the data used for the fit. In that case how cases with missing values in the original fit are handled is determined by the <code>na.action</code> argument of that fit. If <code>na.action = na.omit</code> omitted cases will not appear in the predictions, whereas if <code>na.action = na.exclude</code> they will appear (in predictions, standard errors or interval limits), with value <code>NA</code>. See also <code><a href="nafns">napredict</a></code>. </p> <p>The prediction intervals are for a single observation at each case in <code>newdata</code> (or by default, the data used for the fit) with error variance(s) <code>pred.var</code>. This can be a multiple of <code>res.var</code>, the estimated value of <i>σ^2</i>: the default is to assume that future observations have the same error variance as those used for fitting. If <code>weights</code> is supplied, the inverse of this is used as a scale factor. For a weighted fit, if the prediction is for the original data frame, <code>weights</code> defaults to the weights used for the model fit, with a warning since it might not be the intended result. If the fit was weighted and <code>newdata</code> is given, the default is to assume constant prediction variance, with a warning. </p> <h3>Value</h3> <p><code>predict.lm</code> produces a vector of predictions or a matrix of predictions and bounds with column names <code>fit</code>, <code>lwr</code>, and <code>upr</code> if <code>interval</code> is set. For <code>type = "terms"</code> this is a matrix with a column per term and may have an attribute <code>"constant"</code>. </p> <p>If <code>se.fit</code> is <code>TRUE</code>, a list with the following components is returned: </p> <table summary="R valueblock"> <tr valign="top">
<td><code>fit</code></td> <td> <p>vector or matrix as above</p> </td>
</tr> <tr valign="top">
<td><code>se.fit</code></td> <td> <p>standard error of predicted means</p> </td>
</tr> <tr valign="top">
<td><code>residual.scale</code></td> <td> <p>residual standard deviations</p> </td>
</tr> <tr valign="top">
<td><code>df</code></td> <td> <p>degrees of freedom for residual</p> </td>
</tr> </table> <h3>Note</h3> <p>Variables are first looked for in <code>newdata</code> and then searched for in the usual way (which will include the environment of the formula used in the fit). A warning will be given if the variables found are not of the same length as those in <code>newdata</code> if it was supplied. </p> <p>Notice that prediction variances and prediction intervals always refer to <em>future</em> observations, possibly corresponding to the same predictors as used for the fit. The variance of the <em>residuals</em> will be smaller. </p> <p>Strictly speaking, the formula used for prediction limits assumes that the degrees of freedom for the fit are the same as those for the residual variance. This may not be the case if <code>res.var</code> is not obtained from the fit. </p> <h3>See Also</h3> <p>The model fitting function <code><a href="lm">lm</a></code>, <code><a href="predict">predict</a></code>. </p> <p><a href="makepredictcall">SafePrediction</a> for prediction from (univariable) polynomial and spline fits. </p> <h3>Examples</h3> <pre data-language="r">
require(graphics)

## Predictions
x &lt;- rnorm(15)
y &lt;- x + rnorm(15)
predict(lm(y ~ x))
new &lt;- data.frame(x = seq(-3, 3, 0.5))
predict(lm(y ~ x), new, se.fit = TRUE)
pred.w.plim &lt;- predict(lm(y ~ x), new, interval = "prediction")
pred.w.clim &lt;- predict(lm(y ~ x), new, interval = "confidence")
matplot(new$x, cbind(pred.w.clim, pred.w.plim[,-1]),
        lty = c(1,2,2,3,3), type = "l", ylab = "predicted y")

## Prediction intervals, special cases
##  The first three of these throw warnings
w &lt;- 1 + x^2
fit &lt;- lm(y ~ x)
wfit &lt;- lm(y ~ x, weights = w)
predict(fit, interval = "prediction")
predict(wfit, interval = "prediction")
predict(wfit, new, interval = "prediction")
predict(wfit, new, interval = "prediction", weights = (new$x)^2)
predict(wfit, new, interval = "prediction", weights = ~x^2)

##-- From  aov(.) example ---- predict(.. terms)
npk.aov &lt;- aov(yield ~ block + N*P*K, npk)
(termL &lt;- attr(terms(npk.aov), "term.labels"))
(pt &lt;- predict(npk.aov, type = "terms"))
pt. &lt;- predict(npk.aov, type = "terms", terms = termL[1:4])
stopifnot(all.equal(pt[,1:4], pt.,
                    tolerance = 1e-12, check.attributes = FALSE))
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

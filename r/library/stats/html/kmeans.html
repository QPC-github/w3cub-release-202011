
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>fitted.kmeans - R - W3cubDocs</title>
  
  <meta name="description" content=" Perform k-means clustering on a data matrix. ">
  <meta name="keywords" content="fitted, kmeans, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/kmeans.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>kmeans</code>  K-Means Clustering </h2> <h3>Description</h3> <p>Perform k-means clustering on a data matrix. </p> <h3>Usage</h3> <pre data-language="r">
kmeans(x, centers, iter.max = 10, nstart = 1,
       algorithm = c("Hartigan-Wong", "Lloyd", "Forgy",
                     "MacQueen"), trace=FALSE)
## S3 method for class 'kmeans'
fitted(object, method = c("centers", "classes"), ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>numeric matrix of data, or an object that can be coerced to such a matrix (such as a numeric vector or a data frame with all numeric columns).</p> </td>
</tr> <tr valign="top">
<td><code>centers</code></td> <td> <p>either the number of clusters, say <i>k</i>, or a set of initial (distinct) cluster centres. If a number, a random set of (distinct) rows in <code>x</code> is chosen as the initial centres.</p> </td>
</tr> <tr valign="top">
<td><code>iter.max</code></td> <td> <p>the maximum number of iterations allowed.</p> </td>
</tr> <tr valign="top">
<td><code>nstart</code></td> <td> <p>if <code>centers</code> is a number, how many random sets should be chosen?</p> </td>
</tr> <tr valign="top">
<td><code>algorithm</code></td> <td> <p>character: may be abbreviated. Note that <code>"Lloyd"</code> and <code>"Forgy"</code> are alternative names for one algorithm.</p> </td>
</tr> <tr valign="top">
<td><code>object</code></td> <td> <p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>"kmeans"</code>, typically the result <code>ob</code> of <code>ob &lt;- kmeans(..)</code>.</p> </td>
</tr> <tr valign="top">
<td><code>method</code></td> <td> <p>character: may be abbreviated. <code>"centers"</code> causes <code>fitted</code> to return cluster centers (one for each input point) and <code>"classes"</code> causes <code>fitted</code> to return a vector of class assignments.</p> </td>
</tr> <tr valign="top">
<td><code>trace</code></td> <td> <p>logical or integer number, currently only used in the default method (<code>"Hartigan-Wong"</code>): if positive (or true), tracing information on the progress of the algorithm is produced. Higher values may produce more tracing information.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>not used.</p> </td>
</tr> </table> <h3>Details</h3> <p>The data given by <code>x</code> are clustered by the <i>k</i>-means method, which aims to partition the points into <i>k</i> groups such that the sum of squares from points to the assigned cluster centres is minimized. At the minimum, all cluster centres are at the mean of their Voronoi sets (the set of data points which are nearest to the cluster centre). </p> <p>The algorithm of Hartigan and Wong (1979) is used by default. Note that some authors use <i>k</i>-means to refer to a specific algorithm rather than the general method: most commonly the algorithm given by MacQueen (1967) but sometimes that given by Lloyd (1957) and Forgy (1965). The Hartigan–Wong algorithm generally does a better job than either of those, but trying several random starts (<code>nstart</code><i>&gt; 1</i>) is often recommended. In rare cases, when some of the points (rows of <code>x</code>) are extremely close, the algorithm may not converge in the “Quick-Transfer” stage, signalling a warning (and returning <code>ifault = 4</code>). Slight rounding of the data may be advisable in that case. </p> <p>For ease of programmatic exploration, <i>k=1</i> is allowed, notably returning the center and <code>withinss</code>. </p> <p>Except for the Lloyd–Forgy method, <i>k</i> clusters will always be returned if a number is specified. If an initial matrix of centres is supplied, it is possible that no point will be closest to one or more centres, which is currently an error for the Hartigan–Wong method. </p> <h3>Value</h3> <p><code>kmeans</code> returns an object of class <code>"kmeans"</code> which has a <code>print</code> and a <code>fitted</code> method. It is a list with at least the following components: </p> <table summary="R valueblock"> <tr valign="top">
<td><code>cluster</code></td> <td> <p>A vector of integers (from <code>1:k</code>) indicating the cluster to which each point is allocated. </p> </td>
</tr> <tr valign="top">
<td><code>centers</code></td> <td> <p>A matrix of cluster centres.</p> </td>
</tr> <tr valign="top">
<td><code>totss</code></td> <td> <p>The total sum of squares.</p> </td>
</tr> <tr valign="top">
<td><code>withinss</code></td> <td> <p>Vector of within-cluster sum of squares, one component per cluster.</p> </td>
</tr> <tr valign="top">
<td><code>tot.withinss</code></td> <td> <p>Total within-cluster sum of squares, i.e. <code>sum(withinss)</code>.</p> </td>
</tr> <tr valign="top">
<td><code>betweenss</code></td> <td> <p>The between-cluster sum of squares, i.e. <code>totss-tot.withinss</code>.</p> </td>
</tr> <tr valign="top">
<td><code>size</code></td> <td> <p>The number of points in each cluster.</p> </td>
</tr> <tr valign="top">
<td><code>iter</code></td> <td> <p>The number of (outer) iterations.</p> </td>
</tr> <tr valign="top">
<td><code>ifault</code></td> <td> <p>integer: indicator of a possible algorithm problem – for experts.</p> </td>
</tr> </table> <h3>References</h3> <p>Forgy, E. W. (1965). Cluster analysis of multivariate data: efficiency vs interpretability of classifications. <em>Biometrics</em>, <b>21</b>, 768–769. </p> <p>Hartigan, J. A. and Wong, M. A. (1979). Algorithm AS 136: A K-means clustering algorithm. <em>Applied Statistics</em>, <b>28</b>, 100–108. doi: <a href="https://doi.org/10.2307/2346830">10.2307/2346830</a>. </p> <p>Lloyd, S. P. (1957, 1982). Least squares quantization in PCM. Technical Note, Bell Laboratories. Published in 1982 in <em>IEEE Transactions on Information Theory</em>, <b>28</b>, 128–137. </p> <p>MacQueen, J. (1967). Some methods for classification and analysis of multivariate observations. In <em>Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</em>, eds L. M. Le Cam &amp; J. Neyman, <b>1</b>, pp. 281–297. Berkeley, CA: University of California Press. </p> <h3>Examples</h3> <pre data-language="r">
require(graphics)

# a 2-dimensional example
x &lt;- rbind(matrix(rnorm(100, sd = 0.3), ncol = 2),
           matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2))
colnames(x) &lt;- c("x", "y")
(cl &lt;- kmeans(x, 2))
plot(x, col = cl$cluster)
points(cl$centers, col = 1:2, pch = 8, cex = 2)

# sum of squares
ss &lt;- function(x) sum(scale(x, scale = FALSE)^2)

## cluster centers "fitted" to each obs.:
fitted.x &lt;- fitted(cl);  head(fitted.x)
resid.x &lt;- x - fitted(cl)

## Equalities : ----------------------------------
cbind(cl[c("betweenss", "tot.withinss", "totss")], # the same two columns
         c(ss(fitted.x), ss(resid.x),    ss(x)))
stopifnot(all.equal(cl$ totss,        ss(x)),
	  all.equal(cl$ tot.withinss, ss(resid.x)),
	  ## these three are the same:
	  all.equal(cl$ betweenss,    ss(fitted.x)),
	  all.equal(cl$ betweenss, cl$totss - cl$tot.withinss),
	  ## and hence also
	  all.equal(ss(x), ss(fitted.x) + ss(resid.x))
	  )

kmeans(x,1)$withinss # trivial one-cluster, (its W.SS == ss(x))

## random starts do help here with too many clusters
## (and are often recommended anyway!):
(cl &lt;- kmeans(x, 5, nstart = 25))
plot(x, col = cl$cluster)
points(cl$centers, col = 1:5, pch = 8)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

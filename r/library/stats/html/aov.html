
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Aov - R - W3cubDocs</title>
  
  <meta name="description" content=" Fit an analysis of variance model by a call to lm for each stratum. ">
  <meta name="keywords" content="aov, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/aov.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>aov</code> Fit an Analysis of Variance Model</h2> <h3>Description</h3> <p>Fit an analysis of variance model by a call to <code>lm</code> for each stratum. </p> <h3>Usage</h3> <pre data-language="r">
aov(formula, data = NULL, projections = FALSE, qr = TRUE,
    contrasts = NULL, ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>formula</code></td> <td> <p>A formula specifying the model.</p> </td>
</tr> <tr valign="top">
<td><code>data</code></td> <td> <p>A data frame in which the variables specified in the formula will be found. If missing, the variables are searched for in the standard way.</p> </td>
</tr> <tr valign="top">
<td><code>projections</code></td> <td> <p>Logical flag: should the projections be returned?</p> </td>
</tr> <tr valign="top">
<td><code>qr</code></td> <td> <p>Logical flag: should the QR decomposition be returned?</p> </td>
</tr> <tr valign="top">
<td><code>contrasts</code></td> <td> <p>A list of contrasts to be used for some of the factors in the formula. These are not used for any <code>Error</code> term, and supplying contrasts for factors only in the <code>Error</code> term will give a warning.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>Arguments to be passed to <code>lm</code>, such as <code>subset</code> or <code>na.action</code>. See ‘Details’ about <code>weights</code>.</p> </td>
</tr> </table> <h3>Details</h3> <p>This provides a wrapper to <code>lm</code> for fitting linear models to balanced or unbalanced experimental designs. </p> <p>The main difference from <code>lm</code> is in the way <code>print</code>, <code>summary</code> and so on handle the fit: this is expressed in the traditional language of the analysis of variance rather than that of linear models. </p> <p>If the formula contains a single <code>Error</code> term, this is used to specify error strata, and appropriate models are fitted within each error stratum. </p> <p>The formula can specify multiple responses. </p> <p>Weights can be specified by a <code>weights</code> argument, but should not be used with an <code>Error</code> term, and are incompletely supported (e.g., not by <code><a href="model.tables">model.tables</a></code>). </p> <h3>Value</h3> <p>An object of class <code>c("aov", "lm")</code> or for multiple responses of class <code>c("maov", "aov", "mlm", "lm")</code> or for multiple error strata of class <code>c("aovlist", "<a href="listof">listof</a>")</code>. There are <code><a href="../../base/html/print">print</a></code> and <code><a href="../../base/html/summary">summary</a></code> methods available for these. </p> <h3>Note</h3> <p><code>aov</code> is designed for balanced designs, and the results can be hard to interpret without balance: beware that missing values in the response(s) will likely lose the balance. If there are two or more error strata, the methods used are statistically inefficient without balance, and it may be better to use <code><a href="../../nlme/html/lme">lme</a></code> in package <a href="https://CRAN.R-project.org/package=nlme"><span class="pkg">nlme</span></a>. </p> <p>Balance can be checked with the <code><a href="replications">replications</a></code> function. </p> <p>The default ‘contrasts’ in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> are not orthogonal contrasts, and <code>aov</code> and its helper functions will work better with such contrasts: see the examples for how to select these. </p> <h3>Author(s)</h3> <p>The design was inspired by the S function of the same name described in Chambers <em>et al</em> (1992). </p> <h3>References</h3> <p>Chambers, J. M., Freeny, A and Heiberger, R. M. (1992) <em>Analysis of variance; designed experiments.</em> Chapter 5 of <em>Statistical Models in S</em> eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole. </p> <h3>See Also</h3> <p><code><a href="lm">lm</a></code>, <code><a href="summary.aov">summary.aov</a></code>, <code><a href="replications">replications</a></code>, <code><a href="alias">alias</a></code>, <code><a href="proj">proj</a></code>, <code><a href="model.tables">model.tables</a></code>, <code><a href="tukeyhsd">TukeyHSD</a></code> </p> <h3>Examples</h3> <pre data-language="r">
## From Venables and Ripley (2002) p.165.

## Set orthogonal contrasts.
op &lt;- options(contrasts = c("contr.helmert", "contr.poly"))
( npk.aov &lt;- aov(yield ~ block + N*P*K, npk) )
summary(npk.aov)
coefficients(npk.aov)

## to show the effects of re-ordering terms contrast the two fits
aov(yield ~ block + N * P + K, npk)
aov(terms(yield ~ block + N * P + K, keep.order = TRUE), npk)


## as a test, not particularly sensible statistically
npk.aovE &lt;- aov(yield ~  N*P*K + Error(block), npk)
npk.aovE
## IGNORE_RDIFF_BEGIN
summary(npk.aovE)
## IGNORE_RDIFF_END
options(op)  # reset to previous
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>chisq.test - R - W3cubDocs</title>
  
  <meta name="description" content=" chisq.test performs chi-squared contingency table tests and goodness-of-fit tests. ">
  <meta name="keywords" content="chisq, test, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/chisq.test.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>chisq.test</code> Pearson's Chi-squared Test for Count Data</h2> <h3>Description</h3> <p><code>chisq.test</code> performs chi-squared contingency table tests and goodness-of-fit tests. </p> <h3>Usage</h3> <pre data-language="r">
chisq.test(x, y = NULL, correct = TRUE,
           p = rep(1/length(x), length(x)), rescale.p = FALSE,
           simulate.p.value = FALSE, B = 2000)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>a numeric vector or matrix. <code>x</code> and <code>y</code> can also both be factors.</p> </td>
</tr> <tr valign="top">
<td><code>y</code></td> <td> <p>a numeric vector; ignored if <code>x</code> is a matrix. If <code>x</code> is a factor, <code>y</code> should be a factor of the same length.</p> </td>
</tr> <tr valign="top">
<td><code>correct</code></td> <td> <p>a logical indicating whether to apply continuity correction when computing the test statistic for 2 by 2 tables: one half is subtracted from all <i>|O - E|</i> differences; however, the correction will not be bigger than the differences themselves. No correction is done if <code>simulate.p.value = TRUE</code>.</p> </td>
</tr> <tr valign="top">
<td><code>p</code></td> <td> <p>a vector of probabilities of the same length of <code>x</code>. An error is given if any entry of <code>p</code> is negative.</p> </td>
</tr> <tr valign="top">
<td><code>rescale.p</code></td> <td> <p>a logical scalar; if TRUE then <code>p</code> is rescaled (if necessary) to sum to 1. If <code>rescale.p</code> is FALSE, and <code>p</code> does not sum to 1, an error is given.</p> </td>
</tr> <tr valign="top">
<td><code>simulate.p.value</code></td> <td> <p>a logical indicating whether to compute p-values by Monte Carlo simulation.</p> </td>
</tr> <tr valign="top">
<td><code>B</code></td> <td> <p>an integer specifying the number of replicates used in the Monte Carlo test.</p> </td>
</tr> </table> <h3>Details</h3> <p>If <code>x</code> is a matrix with one row or column, or if <code>x</code> is a vector and <code>y</code> is not given, then a <em>goodness-of-fit test</em> is performed (<code>x</code> is treated as a one-dimensional contingency table). The entries of <code>x</code> must be non-negative integers. In this case, the hypothesis tested is whether the population probabilities equal those in <code>p</code>, or are all equal if <code>p</code> is not given. </p> <p>If <code>x</code> is a matrix with at least two rows and columns, it is taken as a two-dimensional contingency table: the entries of <code>x</code> must be non-negative integers. Otherwise, <code>x</code> and <code>y</code> must be vectors or factors of the same length; cases with missing values are removed, the objects are coerced to factors, and the contingency table is computed from these. Then Pearson's chi-squared test is performed of the null hypothesis that the joint distribution of the cell counts in a 2-dimensional contingency table is the product of the row and column marginals. </p> <p>If <code>simulate.p.value</code> is <code>FALSE</code>, the p-value is computed from the asymptotic chi-squared distribution of the test statistic; continuity correction is only used in the 2-by-2 case (if <code>correct</code> is <code>TRUE</code>, the default). Otherwise the p-value is computed for a Monte Carlo test (Hope, 1968) with <code>B</code> replicates. </p> <p>In the contingency table case simulation is done by random sampling from the set of all contingency tables with given marginals, and works only if the marginals are strictly positive. Continuity correction is never used, and the statistic is quoted without it. Note that this is not the usual sampling situation assumed for the chi-squared test but rather that for Fisher's exact test. </p> <p>In the goodness-of-fit case simulation is done by random sampling from the discrete distribution specified by <code>p</code>, each sample being of size <code>n = sum(x)</code>. This simulation is done in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> and may be slow. </p> <h3>Value</h3> <p>A list with class <code>"htest"</code> containing the following components: </p> <table summary="R valueblock"> <tr valign="top">
<td><code>statistic</code></td> <td> <p>the value the chi-squared test statistic.</p> </td>
</tr> <tr valign="top">
<td><code>parameter</code></td> <td> <p>the degrees of freedom of the approximate chi-squared distribution of the test statistic, <code>NA</code> if the p-value is computed by Monte Carlo simulation.</p> </td>
</tr> <tr valign="top">
<td><code>p.value</code></td> <td> <p>the p-value for the test.</p> </td>
</tr> <tr valign="top">
<td><code>method</code></td> <td> <p>a character string indicating the type of test performed, and whether Monte Carlo simulation or continuity correction was used.</p> </td>
</tr> <tr valign="top">
<td><code>data.name</code></td> <td> <p>a character string giving the name(s) of the data.</p> </td>
</tr> <tr valign="top">
<td><code>observed</code></td> <td> <p>the observed counts.</p> </td>
</tr> <tr valign="top">
<td><code>expected</code></td> <td> <p>the expected counts under the null hypothesis.</p> </td>
</tr> <tr valign="top">
<td><code>residuals</code></td> <td> <p>the Pearson residuals, <code>(observed - expected) / sqrt(expected)</code>.</p> </td>
</tr> <tr valign="top">
<td><code>stdres</code></td> <td> <p>standardized residuals, <code>(observed - expected) / sqrt(V)</code>, where <code>V</code> is the residual cell variance (Agresti, 2007, section 2.4.5 for the case where <code>x</code> is a matrix, <code>n * p * (1 - p)</code> otherwise).</p> </td>
</tr> </table> <h3>Source</h3> <p>The code for Monte Carlo simulation is a C translation of the Fortran algorithm of Patefield (1981). </p> <h3>References</h3> <p>Hope, A. C. A. (1968). A simplified Monte Carlo significance test procedure. <em>Journal of the Royal Statistical Society Series B</em>, <b>30</b>, 582–598. doi: <a href="https://doi.org/10.1111/j.2517-6161.1968.tb00759.x">10.1111/j.2517-6161.1968.tb00759.x</a>. <a href="https://www.jstor.org/stable/2984263">https://www.jstor.org/stable/2984263</a>. </p> <p>Patefield, W. M. (1981). Algorithm AS 159: An efficient method of generating r x c tables with given row and column totals. <em>Applied Statistics</em>, <b>30</b>, 91–97. doi: <a href="https://doi.org/10.2307/2346669">10.2307/2346669</a>. </p> <p>Agresti, A. (2007). <em>An Introduction to Categorical Data Analysis</em>, 2nd ed. New York: John Wiley &amp; Sons. Page 38. </p> <h3>See Also</h3> <p>For goodness-of-fit testing, notably of continuous distributions, <code><a href="ks.test">ks.test</a></code>. </p> <h3>Examples</h3> <pre data-language="r">

## From Agresti(2007) p.39
M &lt;- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))
dimnames(M) &lt;- list(gender = c("F", "M"),
                    party = c("Democrat","Independent", "Republican"))
(Xsq &lt;- chisq.test(M))  # Prints test summary
Xsq$observed   # observed counts (same as M)
Xsq$expected   # expected counts under the null
Xsq$residuals  # Pearson residuals
Xsq$stdres     # standardized residuals


## Effect of simulating p-values
x &lt;- matrix(c(12, 5, 7, 7), ncol = 2)
chisq.test(x)$p.value           # 0.4233
chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value
                                # around 0.29!

## Testing for population probabilities
## Case A. Tabulated data
x &lt;- c(A = 20, B = 15, C = 25)
chisq.test(x)
chisq.test(as.table(x))             # the same
x &lt;- c(89,37,30,28,2)
p &lt;- c(40,20,20,15,5)
try(
chisq.test(x, p = p)                # gives an error
)
chisq.test(x, p = p, rescale.p = TRUE)
                                # works
p &lt;- c(0.40,0.20,0.20,0.19,0.01)
                                # Expected count in category 5
                                # is 1.86 &lt; 5 ==&gt; chi square approx.
chisq.test(x, p = p)            #               maybe doubtful, but is ok!
chisq.test(x, p = p, simulate.p.value = TRUE)

## Case B. Raw data
x &lt;- trunc(5 * runif(100))
chisq.test(table(x))            # NOT 'chisq.test(x)'!
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Construct Design Matrices - R - W3cubDocs</title>
  
  <meta name="description" content="model.matrix creates a design (or model) matrix, e.g., by expanding factors to a set of dummy variables (depending on the contrasts) and expanding &hellip;">
  <meta name="keywords" content="construct, design, matrices, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/model.matrix.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>model.matrix</code> Construct Design Matrices</h2> <h3>Description</h3> <p><code>model.matrix</code> creates a design (or model) matrix, e.g., by expanding factors to a set of dummy variables (depending on the contrasts) and expanding interactions similarly. </p> <h3>Usage</h3> <pre data-language="r">
model.matrix(object, ...)

## Default S3 method:
model.matrix(object, data = environment(object),
             contrasts.arg = NULL, xlev = NULL, ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>object</code></td> <td> <p>an object of an appropriate class. For the default method, a model <a href="formula">formula</a> or a <code><a href="terms">terms</a></code> object.</p> </td>
</tr> <tr valign="top">
<td><code>data</code></td> <td> <p>a data frame created with <code><a href="model.frame">model.frame</a></code>. If another sort of object, <code>model.frame</code> is called first.</p> </td>
</tr> <tr valign="top">
<td><code>contrasts.arg</code></td> <td> <p>a list, whose entries are values (numeric matrices, <code><a href="../../base/html/function">function</a></code>s or character strings naming functions) to be used as replacement values for the <code><a href="contrasts">contrasts</a></code> replacement function and whose names are the names of columns of <code>data</code> containing <code><a href="../../base/html/factor">factor</a></code>s.</p> </td>
</tr> <tr valign="top">
<td><code>xlev</code></td> <td> <p>to be used as argument of <code><a href="model.frame">model.frame</a></code> if <code>data</code> is such that <code>model.frame</code> is called.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>further arguments passed to or from other methods.</p> </td>
</tr> </table> <h3>Details</h3> <p><code>model.matrix</code> creates a design matrix from the description given in <code>terms(object)</code>, using the data in <code>data</code> which must supply variables with the same names as would be created by a call to <code>model.frame(object)</code> or, more precisely, by evaluating <code>attr(terms(object), "variables")</code>. If <code>data</code> is a data frame, there may be other columns and the order of columns is not important. Any character variables are coerced to factors. After coercion, all the variables used on the right-hand side of the formula must be logical, integer, numeric or factor. </p> <p>If <code>contrasts.arg</code> is specified for a factor it overrides the default factor coding for that variable and any <code>"contrasts"</code> attribute set by <code><a href="zc">C</a></code> or <code><a href="contrasts">contrasts</a></code>. Whereas invalid <code>contrasts.arg</code>s have been ignored always, they are warned about since <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> version 3.6.0. </p> <p>In an interaction term, the variable whose levels vary fastest is the first one to appear in the formula (and not in the term), so in <code>~ a + b + b:a</code> the interaction will have <code>a</code> varying fastest. </p> <p>By convention, if the response variable also appears on the right-hand side of the formula it is dropped (with a warning), although interactions involving the term are retained. </p> <h3>Value</h3> <p>The design matrix for a regression-like model with the specified formula and data. </p> <p>There is an attribute <code>"assign"</code>, an integer vector with an entry for each column in the matrix giving the term in the formula which gave rise to the column. Value <code>0</code> corresponds to the intercept (if any), and positive values to terms in the order given by the <code>term.labels</code> attribute of the <code>terms</code> structure corresponding to <code>object</code>. </p> <p>If there are any factors in terms in the model, there is an attribute <code>"contrasts"</code>, a named list with an entry for each factor. This specifies the contrasts that would be used in terms in which the factor is coded by contrasts (in some terms dummy coding may be used), either as a character vector naming a function or as a numeric matrix. </p> <h3>References</h3> <p>Chambers, J. M. (1992) <em>Data for models.</em> Chapter 3 of <em>Statistical Models in S</em> eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole. </p> <h3>See Also</h3> <p><code><a href="model.frame">model.frame</a></code>, <code><a href="model.extract">model.extract</a></code>, <code><a href="terms">terms</a></code> </p> <p><code><a href="../../matrix/html/sparse.model.matrix">sparse.model.matrix</a></code> from package <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a> for creating <em>sparse</em> model matrices, which may be more efficient in large dimensions. </p> <h3>Examples</h3> <pre data-language="r">
ff &lt;- log(Volume) ~ log(Height) + log(Girth)
utils::str(m &lt;- model.frame(ff, trees))
mat &lt;- model.matrix(ff, m)

dd &lt;- data.frame(a = gl(3,4), b = gl(4,1,12)) # balanced 2-way
options("contrasts") # typically 'treatment' (for unordered factors)
model.matrix(~ a + b, dd)
model.matrix(~ a + b, dd, contrasts.arg = list(a = "contr.sum"))
model.matrix(~ a + b, dd, contrasts.arg = list(a = "contr.sum", b = contr.poly))
m.orth &lt;- model.matrix(~a+b, dd, contrasts.arg = list(a = "contr.helmert"))
crossprod(m.orth) # m.orth is  ALMOST  orthogonal
# invalid contrasts.. ignored with a warning:
stopifnot(identical(
   model.matrix(~ a + b, dd),
   model.matrix(~ a + b, dd, contrasts.arg = "contr.FOO")))
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Nlm - R - W3cubDocs</title>
  
  <meta name="description" content=" This function carries out a minimization of the function f using a Newton-type algorithm. See the references for details. ">
  <meta name="keywords" content="nlm, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/nlm.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>nlm</code> Non-Linear Minimization</h2> <h3>Description</h3> <p>This function carries out a minimization of the function <code>f</code> using a Newton-type algorithm. See the references for details. </p> <h3>Usage</h3> <pre data-language="r">
nlm(f, p, ..., hessian = FALSE, typsize = rep(1, length(p)),
    fscale = 1, print.level = 0, ndigit = 12, gradtol = 1e-6,
    stepmax = max(1000 * sqrt(sum((p/typsize)^2)), 1000),
    steptol = 1e-6, iterlim = 100, check.analyticals = TRUE)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>f</code></td> <td> <p>the function to be minimized, returning a single numeric value. This should be a function with first argument a vector of the length of <code>p</code> followed by any other arguments specified by the <code>...</code> argument. </p> <p>If the function value has an attribute called <code>gradient</code> or both <code>gradient</code> and <code>hessian</code> attributes, these will be used in the calculation of updated parameter values. Otherwise, numerical derivatives are used. <code><a href="deriv">deriv</a></code> returns a function with suitable <code>gradient</code> attribute and optionally a <code>hessian</code> attribute.</p> </td>
</tr> <tr valign="top">
<td><code>p</code></td> <td> <p>starting parameter values for the minimization.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>additional arguments to be passed to <code>f</code>.</p> </td>
</tr> <tr valign="top">
<td><code>hessian</code></td> <td> <p>if <code>TRUE</code>, the hessian of <code>f</code> at the minimum is returned.</p> </td>
</tr> <tr valign="top">
<td><code>typsize</code></td> <td> <p>an estimate of the size of each parameter at the minimum.</p> </td>
</tr> <tr valign="top">
<td><code>fscale</code></td> <td> <p>an estimate of the size of <code>f</code> at the minimum.</p> </td>
</tr> <tr valign="top">
<td><code>print.level</code></td> <td> <p>this argument determines the level of printing which is done during the minimization process. The default value of <code>0</code> means that no printing occurs, a value of <code>1</code> means that initial and final details are printed and a value of 2 means that full tracing information is printed.</p> </td>
</tr> <tr valign="top">
<td><code>ndigit</code></td> <td> <p>the number of significant digits in the function <code>f</code>.</p> </td>
</tr> <tr valign="top">
<td><code>gradtol</code></td> <td> <p>a positive scalar giving the tolerance at which the scaled gradient is considered close enough to zero to terminate the algorithm. The scaled gradient is a measure of the relative change in <code>f</code> in each direction <code>p[i]</code> divided by the relative change in <code>p[i]</code>.</p> </td>
</tr> <tr valign="top">
<td><code>stepmax</code></td> <td> <p>a positive scalar which gives the maximum allowable scaled step length. <code>stepmax</code> is used to prevent steps which would cause the optimization function to overflow, to prevent the algorithm from leaving the area of interest in parameter space, or to detect divergence in the algorithm. <code>stepmax</code> would be chosen small enough to prevent the first two of these occurrences, but should be larger than any anticipated reasonable step.</p> </td>
</tr> <tr valign="top">
<td><code>steptol</code></td> <td> <p>A positive scalar providing the minimum allowable relative step length.</p> </td>
</tr> <tr valign="top">
<td><code>iterlim</code></td> <td> <p>a positive integer specifying the maximum number of iterations to be performed before the program is terminated.</p> </td>
</tr> <tr valign="top">
<td><code>check.analyticals</code></td> <td> <p>a logical scalar specifying whether the analytic gradients and Hessians, if they are supplied, should be checked against numerical derivatives at the initial parameter values. This can help detect incorrectly formulated gradients or Hessians.</p> </td>
</tr> </table> <h3>Details</h3> <p>Note that arguments after <code>...</code> must be matched exactly. </p> <p>If a gradient or hessian is supplied but evaluates to the wrong mode or length, it will be ignored if <code>check.analyticals = TRUE</code> (the default) with a warning. The hessian is not even checked unless the gradient is present and passes the sanity checks. </p> <p>The C code for the “perturbed” cholesky, <code>choldc()</code> has had a bug in all <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> versions before 3.4.1. </p> <p>From the three methods available in the original source, we always use method “1” which is line search. </p> <p>The functions supplied should always return finite (including not <code>NA</code> and not <code>NaN</code>) values: for the function value itself non-finite values are replaced by the maximum positive value with a warning. </p> <h3>Value</h3> <p>A list containing the following components: </p> <table summary="R valueblock"> <tr valign="top">
<td><code>minimum</code></td> <td> <p>the value of the estimated minimum of <code>f</code>.</p> </td>
</tr> <tr valign="top">
<td><code>estimate</code></td> <td> <p>the point at which the minimum value of <code>f</code> is obtained.</p> </td>
</tr> <tr valign="top">
<td><code>gradient</code></td> <td> <p>the gradient at the estimated minimum of <code>f</code>.</p> </td>
</tr> <tr valign="top">
<td><code>hessian</code></td> <td> <p>the hessian at the estimated minimum of <code>f</code> (if requested).</p> </td>
</tr> <tr valign="top">
<td><code>code</code></td> <td> <p>an integer indicating why the optimization process terminated. </p> <dl> <dt>1:</dt>
<dd>
<p>relative gradient is close to zero, current iterate is probably solution.</p> </dd> <dt>2:</dt>
<dd>
<p>successive iterates within tolerance, current iterate is probably solution.</p> </dd> <dt>3:</dt>
<dd>
<p>last global step failed to locate a point lower than <code>estimate</code>. Either <code>estimate</code> is an approximate local minimum of the function or <code>steptol</code> is too small.</p> </dd> <dt>4:</dt>
<dd>
<p>iteration limit exceeded.</p> </dd> <dt>5:</dt>
<dd>
<p>maximum step size <code>stepmax</code> exceeded five consecutive times. Either the function is unbounded below, becomes asymptotic to a finite value from above in some direction or <code>stepmax</code> is too small.</p> </dd> </dl> </td>
</tr> <tr valign="top">
<td><code>iterations</code></td> <td> <p>the number of iterations performed.</p> </td>
</tr> </table> <h3>Source</h3> <p>The current code is by Saikat DebRoy and the R Core team, using a C translation of Fortran code by Richard H. Jones. </p> <h3>References</h3> <p>Dennis, J. E. and Schnabel, R. B. (1983). <em>Numerical Methods for Unconstrained Optimization and Nonlinear Equations</em>. Prentice-Hall, Englewood Cliffs, NJ. </p> <p>Schnabel, R. B., Koontz, J. E. and Weiss, B. E. (1985). A modular system of algorithms for unconstrained minimization. <em>ACM Transactions on Mathematical Software</em>, <b>11</b>, 419–440. doi: <a href="https://doi.org/10.1145/6187.6192">10.1145/6187.6192</a>. </p> <h3>See Also</h3> <p><code><a href="optim">optim</a></code> and <code><a href="nlminb">nlminb</a></code>. </p> <p><code><a href="constroptim">constrOptim</a></code> for constrained optimization, <code><a href="optimize">optimize</a></code> for one-dimensional minimization and <code><a href="uniroot">uniroot</a></code> for root finding. <code><a href="deriv">deriv</a></code> to calculate analytical derivatives. </p> <p>For nonlinear regression, <code><a href="nls">nls</a></code> may be better. </p> <h3>Examples</h3> <pre data-language="r">
f &lt;- function(x) sum((x-1:length(x))^2)
nlm(f, c(10,10))
nlm(f, c(10,10), print.level = 2)
utils::str(nlm(f, c(5), hessian = TRUE))

f &lt;- function(x, a) sum((x-a)^2)
nlm(f, c(10,10), a = c(3,5))
f &lt;- function(x, a)
{
    res &lt;- sum((x-a)^2)
    attr(res, "gradient") &lt;- 2*(x-a)
    res
}
nlm(f, c(10,10), a = c(3,5))

## more examples, including the use of derivatives.
## Not run: demo(nlm)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

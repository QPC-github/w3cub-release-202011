
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>anova.mlm - R - W3cubDocs</title>
  
  <meta name="description" content=" Compute a (generalized) analysis of variance table for one or more multivariate linear models. ">
  <meta name="keywords" content="anova, mlm, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/stats/html/anova.mlm.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>anova.mlm</code> Comparisons between Multivariate Linear Models</h2> <h3>Description</h3> <p>Compute a (generalized) analysis of variance table for one or more multivariate linear models. </p> <h3>Usage</h3> <pre data-language="r">
## S3 method for class 'mlm'
anova(object, ...,
      test = c("Pillai", "Wilks", "Hotelling-Lawley", "Roy",
               "Spherical"),
      Sigma = diag(nrow = p), T = Thin.row(proj(M) - proj(X)),
      M = diag(nrow = p), X = ~0,
      idata = data.frame(index = seq_len(p)), tol = 1e-7)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>object</code></td> <td> <p>an object of class <code>"mlm"</code>.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>further objects of class <code>"mlm"</code>.</p> </td>
</tr> <tr valign="top">
<td><code>test</code></td> <td> <p>choice of test statistic (see below). Can be abbreviated.</p> </td>
</tr> <tr valign="top">
<td><code>Sigma</code></td> <td> <p>(only relevant if <code>test == "Spherical"</code>). Covariance matrix assumed proportional to <code>Sigma</code>.</p> </td>
</tr> <tr valign="top">
<td><code>T</code></td> <td> <p>transformation matrix. By default computed from <code>M</code> and <code>X</code>.</p> </td>
</tr> <tr valign="top">
<td><code>M</code></td> <td> <p>formula or matrix describing the outer projection (see below).</p> </td>
</tr> <tr valign="top">
<td><code>X</code></td> <td> <p>formula or matrix describing the inner projection (see below).</p> </td>
</tr> <tr valign="top">
<td><code>idata</code></td> <td> <p>data frame describing intra-block design.</p> </td>
</tr> </table> <table summary="R argblock"> <tr valign="top">
<td><code>tol</code></td> <td> <p>tolerance to be used in deciding if the residuals are rank-deficient: see <code><a href="../../matrix/html/qr-methods">qr</a></code>.</p> </td>
</tr> </table> <h3>Details</h3> <p>The <code>anova.mlm</code> method uses either a multivariate test statistic for the summary table, or a test based on sphericity assumptions (i.e. that the covariance is proportional to a given matrix). </p> <p>For the multivariate test, Wilks' statistic is most popular in the literature, but the default Pillai–Bartlett statistic is recommended by Hand and Taylor (1987). See <code><a href="summary.manova">summary.manova</a></code> for further details. </p> <p>For the <code>"Spherical"</code> test, proportionality is usually with the identity matrix but a different matrix can be specified using <code>Sigma</code>. Corrections for asphericity known as the Greenhouse–Geisser, respectively Huynh–Feldt, epsilons are given and adjusted <i>F</i> tests are performed. </p> <p>It is common to transform the observations prior to testing. This typically involves transformation to intra-block differences, but more complicated within-block designs can be encountered, making more elaborate transformations necessary. A transformation matrix <code>T</code> can be given directly or specified as the difference between two projections onto the spaces spanned by <code>M</code> and <code>X</code>, which in turn can be given as matrices or as model formulas with respect to <code>idata</code> (the tests will be invariant to parametrization of the quotient space <code>M/X</code>). </p> <p>As with <code>anova.lm</code>, all test statistics use the SSD matrix from the largest model considered as the (generalized) denominator. </p> <p>Contrary to other <code>anova</code> methods, the intercept is not excluded from the display in the single-model case. When contrast transformations are involved, it often makes good sense to test for a zero intercept. </p> <h3>Value</h3> <p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code> </p> <h3>Note</h3> <p>The Huynh–Feldt epsilon differs from that calculated by SAS (as of v. 8.2) except when the DF is equal to the number of observations minus one. This is believed to be a bug in SAS, not in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. </p> <h3>References</h3> <p>Hand, D. J. and Taylor, C. C. (1987) <em>Multivariate Analysis of Variance and Repeated Measures.</em> Chapman and Hall. </p> <h3>See Also</h3> <p><code><a href="summary.manova">summary.manova</a></code> </p> <h3>Examples</h3> <pre data-language="r">
require(graphics)
utils::example(SSD) # Brings in the mlmfit and reacttime objects

mlmfit0 &lt;- update(mlmfit, ~0)

### Traditional tests of intrasubj. contrasts
## Using MANOVA techniques on contrasts:
anova(mlmfit, mlmfit0, X = ~1)

## Assuming sphericity
anova(mlmfit, mlmfit0, X = ~1, test = "Spherical")


### tests using intra-subject 3x2 design
idata &lt;- data.frame(deg = gl(3, 1, 6, labels = c(0, 4, 8)),
                    noise = gl(2, 3, 6, labels = c("A", "P")))

anova(mlmfit, mlmfit0, X = ~ deg + noise,
      idata = idata, test = "Spherical")
anova(mlmfit, mlmfit0, M = ~ deg + noise, X = ~ noise,
      idata = idata, test = "Spherical" )
anova(mlmfit, mlmfit0, M = ~ deg + noise, X = ~ deg,
      idata = idata, test = "Spherical" )

f &lt;- factor(rep(1:2, 5)) # bogus, just for illustration
mlmfit2 &lt;- update(mlmfit, ~f)
anova(mlmfit2, mlmfit, mlmfit0, X = ~1, test = "Spherical")
anova(mlmfit2, X = ~1, test = "Spherical")
# one-model form, eqiv. to previous

### There seems to be a strong interaction in these data
plot(colMeans(reacttime))
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

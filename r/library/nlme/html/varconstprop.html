
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Constant Plus Proportion Variance Function - R - W3cubDocs</title>
  
  <meta name="description" content="This function is a constructor for the varConstProp class, representing a variance function structure corresponding to a two-component error model ( &hellip;">
  <meta name="keywords" content="constant, plus, proportion, variance, function, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/nlme/html/varconstprop.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>varConstProp</code> Constant Plus Proportion Variance Function</h2> <h3>Description</h3> <p>This function is a constructor for the <code>varConstProp</code> class, representing a variance function structure corresponding to a two-component error model (additive and proportional error). Letting <i>v</i> denote the variance covariate and <i>s2(v)</i> denote the variance function evaluated at <i>v</i>, the two-component variance function is defined as <i>s2(v) = a^2 + b^2 * v^2)</i>, where a is the additive component and b is the relative error component. In order to avoid overparameterisation of the model, it is recommended to use the possibility to fix sigma, preferably to a value of 1 (see examples). </p> <h3>Usage</h3> <pre data-language="r">
varConstProp(const, prop, form, fixed)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>const, prop</code></td> <td> <p>optional numeric vectors, or lists of numeric values, with, respectively, the coefficients for the constant and the proportional error terms. Both arguments must have length one, unless a grouping factor is specified in <code>form</code>. If either argument has length greater than one, it must have names which identify its elements to the levels of the grouping factor defined in <code>form</code>. If a grouping factor is present in <code>form</code> and the argument has length one, its value will be assigned to all grouping levels. Only positive values are allowed for <code>const</code>. Default is 0.1 for both <code>const</code> and <code>prop</code>. </p> </td>
</tr> <tr valign="top">
<td><code>form</code></td> <td> <p>an optional one-sided formula of the form <code>~ v</code>, or <code>~ v | g</code>, specifying a variance covariate <code>v</code> and, optionally, a grouping factor <code>g</code> for the coefficients. The variance covariate must evaluate to a numeric vector and may involve expressions using <code>"."</code>, representing a fitted model object from which fitted values (<code>fitted(.)</code>) and residuals (<code>resid(.)</code>) can be extracted (this allows the variance covariate to be updated during the optimization of an object function). When a grouping factor is present in <code>form</code>, a different coefficient value is used for each of its levels. Several grouping variables may be simultaneously specified, separated by the <code>*</code> operator, as in <code>~ v | g1 * g2 * g3</code>. In this case, the levels of each grouping variable are pasted together and the resulting factor is used to group the observations. Defaults to <code>~ fitted(.)</code> representing a variance covariate given by the fitted values of a fitted model object and no grouping factor. </p> </td>
</tr> <tr valign="top">
<td><code>fixed</code></td> <td> <p>an optional list with components <code>const</code> and/or <code>power</code>, consisting of numeric vectors, or lists of numeric values, specifying the values at which some or all of the coefficients in the variance function should be fixed. If a grouping factor is specified in <code>form</code>, the components of <code>fixed</code> must have names identifying which coefficients are to be fixed. Coefficients included in <code>fixed</code> are not allowed to vary during the optimization of an objective function. Defaults to <code>NULL</code>, corresponding to no fixed coefficients.</p> </td>
</tr> </table> <h3>Value</h3> <p>a <code>varConstProp</code> object representing a constant plus proportion variance function structure, also inheriting from class <code>varFunc</code>. </p> <h3>Note</h3> <p>The error model underlying this variance function structure can be understood to result from two uncorrelated sequences of standardized random variables (Lavielle(2015), p. 55) and has been proposed for use in analytical chemistry (Werner et al. (1978), Wilson et al. (2004)) and chemical degradation kinetics (Ranke and Meinecke (2019)). Note that the two-component error model proposed by Rocke and Lorenzato (1995) assumed a log-normal distribution of residuals at high absolute values, which is not compatible with the <code><a href="varfunc">varFunc</a></code> structures in package <span class="pkg">nlme</span>. </p> <h3>Author(s)</h3> <p>José Pinheiro and Douglas Bates (for <code><a href="varconstpower">varConstPower</a></code>) and Johannes Ranke (adaptation to <code>varConstProp()</code>). </p> <h3>References</h3> <p>Lavielle, M. (2015) <em>Mixed Effects Models for the Population Approach: Models, Tasks, Methods and Tools</em>, Chapman and Hall/CRC. doi: <a href="https://doi.org/10.1201/b17203">10.1201/b17203</a> </p> <p>Pinheiro, J.C., and Bates, D.M. (2000) <em>Mixed-Effects Models in S and S-PLUS</em>, Springer. doi: <a href="https://doi.org/10.1007/b98882">10.1007/b98882</a> </p> <p>Ranke, J., and Meinecke, S. (2019) Error Models for the Kinetic Evaluation of Chemical Degradation Data. <em>Environments</em> <b>6</b>(12), 124 doi: <a href="https://doi.org/10.3390/environments6120124">10.3390/environments6120124</a> </p> <p>Rocke, David M. and Lorenzato, Stefan (1995) A Two-Component Model for Measurement Error in Analytical Chemistry. <em>Technometrics</em> <b>37</b>(2), 176–184. doi: <a href="https://doi.org/10.1080/00401706.1995.10484302">10.1080/00401706.1995.10484302</a> </p> <p>Werner, Mario, Brooks, Samuel H., and Knott, Lancaster B. (1978) Additive, Multiplicative, and Mixed Analytical Errors. <em>Clinical Chemistry</em> <b>24</b>(11), 1895–1898. doi: <a href="https://doi.org/10.1093/clinchem/24.11.1895">10.1093/clinchem/24.11.1895</a> </p> <p>Wilson, M.D., Rocke, D.M., Durbin, B. and Kahn, H.D (2004) Detection Limits and Goodness-of-Fit Measures for the Two-Component Model of Chemical Analytical Error. <em>Analytica Chimica Acta</em> 2004, 509, 197–208 doi: <a href="https://doi.org/10.1016/j.aca.2003.12.047">10.1016/j.aca.2003.12.047</a> </p> <h3>See Also</h3> <p><code><a href="varclasses">varClasses</a></code>, <code><a href="varweights">varWeights.varFunc</a></code>, <code><a href="coef.varfunc">coef.varFunc</a></code></p> <h3>Examples</h3> <pre data-language="r">
# Generate some synthetic data using the two-component error model and use
# different variance functions, also with fixed sigma in order to avoid
# overparameterisation in the case of a constant term in the variance function
times &lt;- c(0, 1, 3, 7, 14, 28, 56, 120)
pred &lt;- 100 * exp(- 0.03 * times)
sd_pred &lt;- sqrt(3^2 + 0.07^2 * pred^2)
n_replicates &lt;- 2

set.seed(123456)
syn_data &lt;- data.frame(
  time = rep(times, each = n_replicates),
  value = rnorm(length(times) * n_replicates,
    rep(pred, each = n_replicates),
    rep(sd_pred, each = n_replicates)))
syn_data$value &lt;- ifelse(syn_data$value &lt; 0, NA, syn_data$value)

f_const &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  start = list(parent_0 = 100, lrc = -3))
f_varPower &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  start = list(parent_0 = 100, lrc = -3),
  weights = varPower())
f_varConstPower &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  start = list(parent_0 = 100, lrc = -3),
  weights = varConstPower())
f_varConstPower_sf &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  control = list(sigma = 1),
  start = list(parent_0 = 100, lrc = -3),
  weights = varConstPower())
f_varConstProp &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  start = list(parent_0 = 100, lrc = -3),
  weights = varConstProp())
f_varConstProp_sf &lt;- gnls(value ~ SSasymp(time, 0, parent_0, lrc),
  data = syn_data, na.action = na.omit,
  start = list(parent_0 = 100, lrc = -3),
  control = list(sigma = 1),
  weights = varConstProp())

AIC(f_const, f_varPower, f_varConstPower, f_varConstPower_sf,
  f_varConstProp, f_varConstProp_sf)

# The error model parameters 3 and 0.07 are approximately recovered
intervals(f_varConstProp_sf)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

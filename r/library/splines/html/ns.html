
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Generate a Basis Matrix for Natural Cubic Splines - R - W3cubDocs</title>
  
  <meta name="description" content=" Generate the B-spline basis matrix for a natural cubic spline. ">
  <meta name="keywords" content="generate, basis, matrix, for, natural, cubic, splines, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/splines/html/ns.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>ns</code> Generate a Basis Matrix for Natural Cubic Splines</h2> <h3>Description</h3> <p>Generate the B-spline basis matrix for a natural cubic spline. </p> <h3>Usage</h3> <pre data-language="r">
ns(x, df = NULL, knots = NULL, intercept = FALSE,
   Boundary.knots = range(x))
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>the predictor variable. Missing values are allowed.</p> </td>
</tr> <tr valign="top">
<td><code>df</code></td> <td> <p>degrees of freedom. One can supply <code>df</code> rather than knots; <code>ns()</code> then chooses <code>df - 1 - intercept</code> knots at suitably chosen quantiles of <code>x</code> (which will ignore missing values). The default, <code>df = NULL</code>, sets the number of inner knots as <code>length(knots)</code>.</p> </td>
</tr> <tr valign="top">
<td><code>knots</code></td> <td> <p>breakpoints that define the spline. The default is no knots; together with the natural boundary conditions this results in a basis for linear regression on <code>x</code>. Typical values are the mean or median for one knot, quantiles for more knots. See also <code>Boundary.knots</code>.</p> </td>
</tr> <tr valign="top">
<td><code>intercept</code></td> <td> <p>if <code>TRUE</code>, an intercept is included in the basis; default is <code>FALSE</code>.</p> </td>
</tr> <tr valign="top">
<td><code>Boundary.knots</code></td> <td> <p>boundary points at which to impose the natural boundary conditions and anchor the B-spline basis (default the range of the data). If both <code>knots</code> and <code>Boundary.knots</code> are supplied, the basis parameters do not depend on <code>x</code>. Data can extend beyond <code>Boundary.knots</code></p> </td>
</tr> </table> <h3>Details</h3> <p><code>ns</code> is based on the function <code><a href="splinedesign">splineDesign</a></code>. It generates a basis matrix for representing the family of piecewise-cubic splines with the specified sequence of interior knots, and the natural boundary conditions. These enforce the constraint that the function is linear beyond the boundary knots, which can either be supplied or default to the extremes of the data. </p> <p>A primary use is in modeling formula to directly specify a natural spline term in a model: see the examples. </p> <h3>Value</h3> <p>A matrix of dimension <code>length(x) * df</code> where either <code>df</code> was supplied or if <code>knots</code> were supplied, <code>df = length(knots) + 1 + intercept</code>. Attributes are returned that correspond to the arguments to <code>ns</code>, and explicitly give the <code>knots</code>, <code>Boundary.knots</code> etc for use by <code>predict.ns()</code>. </p> <h3>References</h3> <p>Hastie, T. J. (1992) Generalized additive models. Chapter 7 of <em>Statistical Models in S</em> eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole. </p> <h3>See Also</h3> <p><code><a href="bs">bs</a></code>, <code><a href="predict.bs">predict.ns</a></code>, <code><a href="../../stats/html/makepredictcall">SafePrediction</a></code> </p> <h3>Examples</h3> <pre data-language="r">
require(stats); require(graphics)
ns(women$height, df = 5)
summary(fm1 &lt;- lm(weight ~ ns(height, df = 5), data = women))

## To see what knots were selected
attr(terms(fm1), "predvars")

## example of safe prediction
plot(women, xlab = "Height (in)", ylab = "Weight (lb)")
ht &lt;- seq(57, 73, length.out = 200) ; nD &lt;- data.frame(height = ht)
lines(ht, p1 &lt;- predict(fm1, nD))
stopifnot(all.equal(p1, predict(update(fm1, . ~
                            splines::ns(height, df=5)), nD)))
          # not true in R &lt; 3.5.0

</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

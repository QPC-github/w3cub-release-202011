
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>predict.coxph - R - W3cubDocs</title>
  
  <meta name="description" content=" Compute fitted values and regression terms for a model fitted by coxph ">
  <meta name="keywords" content="predict, coxph, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/survival/html/predict.coxph.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>predict.coxph</code>  Predictions for a Cox model </h2> <h3>Description</h3> <p>Compute fitted values and regression terms for a model fitted by <code><a href="coxph">coxph</a></code> </p> <h3>Usage</h3> <pre data-language="r">
## S3 method for class 'coxph'
predict(object, newdata,
type=c("lp", "risk", "expected", "terms", "survival"),
se.fit=FALSE, na.action=na.pass, terms=names(object$assign), collapse,
reference=c("strata", "sample", "zero"),  ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>object</code></td> <td> <p>the results of a coxph fit. </p> </td>
</tr> <tr valign="top">
<td><code>newdata</code></td> <td> <p>Optional new data at which to do predictions. If absent predictions are for the data frame used in the original fit. When coxph has been called with a formula argument created in another context, i.e., coxph has been called within another function and the formula was passed as an argument to that function, there can be problems finding the data set. See the note below. </p> </td>
</tr> <tr valign="top">
<td><code>type</code></td> <td> <p>the type of predicted value. Choices are the linear predictor (<code>"lp"</code>), the risk score exp(lp) (<code>"risk"</code>), the expected number of events given the covariates and follow-up time (<code>"expected"</code>), and the terms of the linear predictor (<code>"terms"</code>). The survival probability for a subject is equal to exp(-expected). </p> </td>
</tr> <tr valign="top">
<td><code>se.fit</code></td> <td> <p>if TRUE, pointwise standard errors are produced for the predictions. </p> </td>
</tr> <tr valign="top">
<td><code>na.action</code></td> <td> <p>applies only when the <code>newdata</code> argument is present, and defines the missing value action for the new data. The default is to include all observations. When there is no newdata, then the behavior of missing is dictated by the na.action option of the original fit.</p> </td>
</tr> <tr valign="top">
<td><code>terms</code></td> <td> <p>if type="terms", this argument can be used to specify which terms should be included; the default is all. </p> </td>
</tr> <tr valign="top">
<td><code>collapse</code></td> <td> <p>optional vector of subject identifiers. If specified, the output will contain one entry per subject rather than one entry per observation. </p> </td>
</tr> <tr valign="top">
<td><code>reference</code></td> <td> <p>reference for centering predictions, see details below</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>For future methods</p> </td>
</tr> </table> <h3>Details</h3> <p>The Cox model is a <em>relative</em> risk model; predictions of type "linear predictor", "risk", and "terms" are all relative to the sample from which they came. By default, the reference value for each of these is the mean covariate within strata. The underlying reason is both statistical and practial. First, a Cox model only predicts relative risks between pairs of subjects within the same strata, and hence the addition of a constant to any covariate, either overall or only within a particular stratum, has no effect on the fitted results. Second, downstream calculations depend on the risk score exp(linear predictor), which will fall prey to numeric overflow for a linear predictor greater than <code>.Machine\$double.max.exp</code>. The <code>coxph</code> routines try to approximately center the predictors out of self protection. Using the <code>reference="strata"</code> option is the safest centering, since strata occassionally have different means. When the results of <code>predict</code> are used in further calculations it may be desirable to use a single reference level for all observations. Use of <code>reference="sample"</code> will use the overall means, and agrees with the <code>linear.predictors</code> component of the coxph object (which uses the overall mean for backwards compatability with older code). Predictions of <code>type="terms"</code> are almost invariably passed forward to further calculation, so for these we default to using the sample as the reference. A reference of <code>"zero"</code> causes no centering to be done. </p> <p>Predictions of type "expected" incorporate the baseline hazard and are thus absolute instead of relative; the <code>reference</code> option has no effect on these. These values depend on the follow-up time for the future subjects as well as covariates so the <code>newdata</code> argument needs to include both the right and <em>left</em> hand side variables from the formula. (The status variable will not be used, but is required since the underlying code needs to reconstruct the entire formula.) </p> <p>Models that contain a <code>frailty</code> term are a special case: due to the technical difficulty, when there is a <code>newdata</code> argument the predictions will always be for a random effect of zero. </p> <h3>Value</h3> <p>a vector or matrix of predictions, or a list containing the predictions (element "fit") and their standard errors (element "se.fit") if the se.fit option is TRUE. </p> <h3>Note</h3> <p>Some predictions can be obtained directly from the coxph object, and for others it is necessary for the routine to have the entirety of the original data set, e.g., for type = <code>terms</code> or if standard errors are requested. This extra information is saved in the coxph object if <code>model=TRUE</code>, if not the original data is reconstructed. If it is known that such residuals will be required overall execution will be slightly faster if the model information is saved. </p> <p>In some cases the reconstruction can fail. The most common is when coxph has been called inside another function and the formula was passed as one of the arguments to that enclosing function. Another is when the data set has changed between the original call and the time of the prediction call. In each of these the simple solution is to add <code>model=TRUE</code> to the original coxph call. </p> <h3>See Also</h3> <p><code><a href="../../stats/html/predict">predict</a></code>,<code><a href="coxph">coxph</a></code>,<code><a href="../../stats/html/termplot">termplot</a></code> </p> <h3>Examples</h3> <pre data-language="r">
options(na.action=na.exclude) # retain NA in predictions
fit &lt;- coxph(Surv(time, status) ~ age + ph.ecog + strata(inst), lung)
#lung data set has status coded as 1/2
mresid &lt;- (lung$status-1) - predict(fit, type='expected') #Martingale resid 
predict(fit,type="lp")
predict(fit,type="expected")
predict(fit,type="risk",se.fit=TRUE)
predict(fit,type="terms",se.fit=TRUE)

# For someone who demands reference='zero'
pzero &lt;- function(fit)
  predict(fit, reference="sample") + sum(coef(fit) * fit$means, na.rm=TRUE)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

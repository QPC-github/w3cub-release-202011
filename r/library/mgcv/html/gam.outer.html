
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>gam.outer - R - W3cubDocs</title>
  
  <meta name="description" content="Estimation of GAM smoothing parameters is most stable if optimization of the smoothness selection score (GCV, GACV, UBRE&#47;AIC, REML, ML etc) is &hellip;">
  <meta name="keywords" content="gam, outer, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/mgcv/html/gam.outer.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>gam.outer</code> Minimize GCV or UBRE score of a GAM using ‘outer’ iteration</h2> <h3>Description</h3> <p>Estimation of GAM smoothing parameters is most stable if optimization of the smoothness selection score (GCV, GACV, UBRE/AIC, REML, ML etc) is outer to the penalized iteratively re-weighted least squares scheme used to estimate the model given smoothing parameters. </p> <p>This routine optimizes a smoothness selection score in this way. Basically the score is evaluated for each trial set of smoothing parameters by estimating the GAM for those smoothing parameters. The score is minimized w.r.t. the parameters numerically, using <code>newton</code> (default), <code>bfgs</code>, <code>optim</code> or <code>nlm</code>. Exact (first and second) derivatives of the score can be used by fitting with <code><a href="gam.fit3">gam.fit3</a></code>. This improves efficiency and reliability relative to relying on finite difference derivatives. </p> <p>Not normally called directly, but rather a service routine for <code><a href="gam">gam</a></code>. </p> <h3>Usage</h3> <pre data-language="r">
gam.outer(lsp,fscale,family,control,method,optimizer,
          criterion,scale,gamma,G,start=NULL,...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>lsp</code></td> <td> <p>The log smoothing parameters.</p> </td>
</tr> <tr valign="top">
<td><code>fscale</code></td> <td> <p>Typical scale of the GCV or UBRE/AIC score.</p> </td>
</tr> <tr valign="top">
<td><code>family</code></td> <td> <p>the model family.</p> </td>
</tr> <tr valign="top">
<td><code>control</code></td> <td> <p>control argument to pass to <code><a href="gam.fit">gam.fit</a></code> if pure finite differencing is being used.</p> </td>
</tr> <tr valign="top">
<td><code>method</code></td> <td> <p>method argument to <code><a href="gam">gam</a></code> defining the smoothness criterion to use (but depending on whether or not scale known).</p> </td>
</tr> <tr valign="top">
<td><code>optimizer</code></td> <td> <p>The argument to <code><a href="gam">gam</a></code> defining the numerical optimization method to use. </p> </td>
</tr> <tr valign="top">
<td><code>criterion</code></td> <td> <p>Which smoothness selction criterion to use. One of <code>"UBRE"</code>, <code>"GCV"</code>, <code>"GACV"</code>, <code>"REML"</code> or <code>"P-REML"</code>. </p> </td>
</tr> <tr valign="top">
<td><code>scale</code></td> <td> <p>Supplied scale parameter. Positive indicates known.</p> </td>
</tr> <tr valign="top">
<td><code>gamma</code></td> <td> <p> The degree of freedom inflation factor for the GCV/UBRE/AIC score.</p> </td>
</tr> <tr valign="top">
<td><code>G</code></td> <td> <p>List produced by <code>mgcv:::gam.setup</code>, containing most of what's needed to actually fit a GAM.</p> </td>
</tr> <tr valign="top">
<td><code>start</code></td> <td> <p>starting parameter values.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>other arguments, typically for passing on to <code>gam.fit3</code> (ultimately).</p> </td>
</tr> </table> <h3>Details</h3> <p>See Wood (2008) for full details on ‘outer iteration’. </p> <h3>Author(s)</h3> <p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a></p> <h3>References</h3> <p>Wood, S.N. (2011) Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. Journal of the Royal Statistical Society (B) 73(1):3-36 </p> <p><a href="https://www.maths.ed.ac.uk/~swood34/">https://www.maths.ed.ac.uk/~swood34/</a> </p> <h3>See Also</h3> <p><code><a href="gam.fit3">gam.fit3</a></code>, <code><a href="gam">gam</a></code>, <code><a href="magic">magic</a></code></p>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

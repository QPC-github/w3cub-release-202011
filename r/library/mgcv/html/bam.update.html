
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>bam.update - R - W3cubDocs</title>
  
  <meta name="description" content="Gaussian with identity link models fitted by bam can be efficiently updated as new data becomes available, by simply updating the QR decomposition &hellip;">
  <meta name="keywords" content="bam, update, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/mgcv/html/bam.update.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>bam.update</code> Update a strictly additive bam model for new data.</h2> <h3>Description</h3> <p> Gaussian with identity link models fitted by <code><a href="bam">bam</a></code> can be efficiently updated as new data becomes available, by simply updating the QR decomposition on which estimation is based, and re-optimizing the smoothing parameters, starting from the previous estimates. This routine implements this. </p> <h3>Usage</h3> <pre data-language="r">
bam.update(b,data,chunk.size=10000)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>b</code></td> <td> <p> A <code>gam</code> object fitted by <code><a href="bam">bam</a></code> and representing a strictly additive model (i.e. <code>gaussian</code> errors, <code>identity</code> link).</p> </td>
</tr> <tr valign="top">
<td><code>data</code></td> <td> <p>Extra data to augment the original data used to obtain <code>b</code>. Must include a <code>weights</code> column if the original fit was weighted and a <code>AR.start</code> column if <code>AR.start</code> was non <code>NULL</code> in original fit.</p> </td>
</tr> <tr valign="top">
<td><code>chunk.size</code></td> <td> <p>size of subsets of data to process in one go when getting fitted values.</p> </td>
</tr> </table> <h3>Details</h3> <p><code>bam.update</code> updates the QR decomposition of the (weighted) model matrix of the GAM represented by <code>b</code> to take account of the new data. The orthogonal factor multiplied by the response vector is also updated. Given these updates the model and smoothing parameters can be re-estimated, as if the whole dataset (original and the new data) had been fitted in one go. The function will use the same AR1 model for the residuals as that employed in the original model fit (see <code>rho</code> parameter of <code><a href="bam">bam</a></code>). </p> <p>Note that there may be small numerical differences in fit between fitting the data all at once, and fitting in stages by updating, if the smoothing bases used have any of their details set with reference to the data (e.g. default knot locations). </p> <h3>Value</h3> <p>An object of class <code>"gam"</code> as described in <code><a href="gamobject">gamObject</a></code>. </p> <h3>WARNINGS </h3> <p>AIC computation does not currently take account of AR model, if used. </p> <h3>Author(s)</h3> <p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a> </p> <h3>References</h3> <p><a href="https://www.maths.ed.ac.uk/~swood34/">https://www.maths.ed.ac.uk/~swood34/</a> </p> <h3>See Also</h3> <p><code><a href="mgcv-package">mgcv-package</a></code>, <code><a href="bam">bam</a></code> </p> <h3>Examples</h3> <pre data-language="r">
library(mgcv)
## following is not *very* large, for obvious reasons...
set.seed(8)
n &lt;- 5000
dat &lt;- gamSim(1,n=n,dist="normal",scale=5)
dat[c(50,13,3000,3005,3100),]&lt;- NA
dat1 &lt;- dat[(n-999):n,]
dat0 &lt;- dat[1:(n-1000),]
bs &lt;- "ps";k &lt;- 20
method &lt;- "GCV.Cp"
b &lt;- bam(y ~ s(x0,bs=bs,k=k)+s(x1,bs=bs,k=k)+s(x2,bs=bs,k=k)+
           s(x3,bs=bs,k=k),data=dat0,method=method)

b1 &lt;- bam.update(b,dat1)

b2 &lt;- bam.update(bam.update(b,dat1[1:500,]),dat1[501:1000,])
 
b3 &lt;- bam(y ~ s(x0,bs=bs,k=k)+s(x1,bs=bs,k=k)+s(x2,bs=bs,k=k)+
           s(x3,bs=bs,k=k),data=dat,method=method)
b1;b2;b3

## example with AR1 errors...

e &lt;- rnorm(n)
for (i in 2:n) e[i] &lt;- e[i-1]*.7 + e[i]
dat$y &lt;- dat$f + e*3
dat[c(50,13,3000,3005,3100),]&lt;- NA
dat1 &lt;- dat[(n-999):n,]
dat0 &lt;- dat[1:(n-1000),]

b &lt;- bam(y ~ s(x0,bs=bs,k=k)+s(x1,bs=bs,k=k)+s(x2,bs=bs,k=k)+
           s(x3,bs=bs,k=k),data=dat0,rho=0.7)

b1 &lt;- bam.update(b,dat1)


summary(b1);summary(b2);summary(b3)

</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>anova.gam - R - W3cubDocs</title>
  
  <meta name="description" content="Performs hypothesis tests relating to one or more fitted gam objects. For a single fitted gam object, Wald tests of the significance of each &hellip;">
  <meta name="keywords" content="anova, gam, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/mgcv/html/anova.gam.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>anova.gam</code> Approximate hypothesis tests related to GAM fits</h2> <h3>Description</h3> <p> Performs hypothesis tests relating to one or more fitted <code>gam</code> objects. For a single fitted <code>gam</code> object, Wald tests of the significance of each parametric and smooth term are performed, so interpretation is analogous to <code><a href="../../stats/html/add1">drop1</a></code> rather than <code>anova.lm</code> (i.e. it's like type III ANOVA, rather than a sequential type I ANOVA). Otherwise the fitted models are compared using an analysis of deviance table or GLRT test: this latter approach should not be use to test the significance of terms which can be penalized to zero. Models to be compared should be fitted to the same data using the same smoothing parameter selection method. </p> <h3>Usage</h3> <pre data-language="r">
## S3 method for class 'gam'
anova(object, ..., dispersion = NULL, test = NULL,
                    freq = FALSE)
## S3 method for class 'anova.gam'
print(x, digits = max(3, getOption("digits") - 3),...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>object,...</code></td> <td> <p> fitted model objects of class <code>gam</code> as produced by <code>gam()</code>.</p> </td>
</tr> <tr valign="top">
<td><code>x</code></td> <td> <p>an <code>anova.gam</code> object produced by a single model call to <code>anova.gam()</code>.</p> </td>
</tr> <tr valign="top">
<td><code>dispersion</code></td> <td> <p> a value for the dispersion parameter: not normally used.</p> </td>
</tr> <tr valign="top">
<td><code>test</code></td> <td> <p>what sort of test to perform for a multi-model call. One of <code>"Chisq"</code>, <code>"F"</code> or <code>"Cp"</code>. Reset to <code>"Chisq"</code> for extended and general families unless <code>NULL</code>. </p> </td>
</tr> <tr valign="top">
<td><code>freq</code></td> <td> <p>whether to use frequentist or Bayesian approximations for parametric term p-values. See <code><a href="summary.gam">summary.gam</a></code> for details.</p> </td>
</tr> <tr valign="top">
<td><code>digits</code></td> <td> <p>number of digits to use when printing output.</p> </td>
</tr> </table> <h3>Details</h3> <p> If more than one fitted model is provided than <code>anova.glm</code> is used, with the difference in model degrees of freedom being taken as the difference in effective degress of freedom (when possible this is a smoothing parameter uncertainty corrected version). For extended and general families this is set so that a GLRT test is used. The p-values resulting from the multi-model case are only approximate, and must be used with care. The approximation is most accurate when the comparison relates to unpenalized terms, or smoothers with a null space of dimension greater than zero. (Basically we require that the difference terms could be well approximated by unpenalized terms with degrees of freedom approximately the effective degrees of freedom). In simulations the p-values are usually slightly too low. For terms with a zero-dimensional null space (i.e. those which can be penalized to zero) the approximation is often very poor, and significance can be greatly overstated: i.e. p-values are often substantially too low. This case applies to random effect terms. </p> <p>Note also that in the multi-model call to <code>anova.gam</code>, it is quite possible for a model with more terms to end up with lower effective degrees of freedom, but better fit, than the notionally null model with fewer terms. In such cases it is very rare that it makes sense to perform any sort of test, since there is then no basis on which to accept the notional null model. </p> <p>If only one model is provided then the significance of each model term is assessed using Wald like tests, conditional on the smoothing parameter estimates: see <code><a href="summary.gam">summary.gam</a></code> and Wood (2013a,b) for details. The p-values provided here are better justified than in the multi model case, and have close to the correct distribution under the null, unless smoothing parameters are poorly identified. ML or REML smoothing parameter selection leads to the best results in simulations as they tend to avoid occasional severe undersmoothing. In replication of the full simulation study of Scheipl et al. (2008) the tests give almost indistinguishable power to the method recommended there, but slightly too low p-values under the null in their section 3.1.8 test for a smooth interaction (the Scheipl et al. recommendation is not used directly, because it only applies in the Gaussian case, and requires model refits, but it is available in package <code>RLRsim</code>). </p> <p>In the single model case <code>print.anova.gam</code> is used as the printing method. </p> <p>By default the p-values for parametric model terms are also based on Wald tests using the Bayesian covariance matrix for the coefficients. This is appropriate when there are "re" terms present, and is otherwise rather similar to the results using the frequentist covariance matrix (<code>freq=TRUE</code>), since the parametric terms themselves are usually unpenalized. Default P-values for parameteric terms that are penalized using the <code>paraPen</code> argument will not be good. </p> <h3>Value</h3> <p>In the multi-model case <code>anova.gam</code> produces output identical to <code><a href="../../stats/html/anova.glm">anova.glm</a></code>, which it in fact uses. </p> <p>In the single model case an object of class <code>anova.gam</code> is produced, which is in fact an object returned from <code><a href="summary.gam">summary.gam</a></code>. </p> <p><code>print.anova.gam</code> simply produces tabulated output. </p> <h3>WARNING</h3> <p> If models 'a' and 'b' differ only in terms with no un-penalized components (such as random effects) then p values from anova(a,b) are unreliable, and usually much too low. </p> <p>Default P-values will usually be wrong for parametric terms penalized using ‘paraPen’: use freq=TRUE to obtain better p-values when the penalties are full rank and represent conventional random effects. </p> <p>For a single model, interpretation is similar to drop1, not anova.lm. </p> <h3>Author(s)</h3> <p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a> with substantial improvements by Henric Nilsson.</p> <h3>References</h3> <p>Scheipl, F., Greven, S. and Kuchenhoff, H. (2008) Size and power of tests for a zero random effect variance or polynomial regression in additive and linear mixed models. Comp. Statist. Data Anal. 52, 3283-3299 </p> <p>Wood, S.N. (2013a) On p-values for smooth components of an extended generalized additive model. Biometrika 100:221-228 </p> <p>Wood, S.N. (2013b) A simple test for random effects in regression models. Biometrika 100:1005-1010 </p> <h3>See Also</h3> <p><code><a href="gam">gam</a></code>, <code><a href="predict.gam">predict.gam</a></code>, <code><a href="gam.check">gam.check</a></code>, <code><a href="summary.gam">summary.gam</a></code> </p> <h3>Examples</h3> <pre data-language="r">
library(mgcv)
set.seed(0)
dat &lt;- gamSim(5,n=200,scale=2)

b&lt;-gam(y ~ x0 + s(x1) + s(x2) + s(x3),data=dat)
anova(b)
b1&lt;-gam(y ~ x0 + s(x1) + s(x2),data=dat)
anova(b,b1,test="F")
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

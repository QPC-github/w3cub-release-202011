
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>formula.gam - R - W3cubDocs</title>
  
  <meta name="description" content=" Description of gam formula (see Details), and how to extract it from a fitted gam object. ">
  <meta name="keywords" content="formula, gam, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/mgcv/html/formula.gam.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>formula.gam</code> GAM formula</h2> <h3>Description</h3> <p> Description of <code><a href="gam">gam</a></code> formula (see Details), and how to extract it from a fitted <code>gam</code> object. </p> <h3>Usage</h3> <pre data-language="r">
## S3 method for class 'gam'
formula(x,...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p> fitted model objects of class <code>gam</code> (see <code><a href="gamobject">gamObject</a></code>) as produced by <code>gam()</code>.</p> </td>
</tr> <tr valign="top">
<td><code>...</code></td> <td> <p>un-used in this case</p> </td>
</tr> </table> <h3>Details</h3> <p><code><a href="gam">gam</a></code> will accept a formula or, with some families, a list of formulae. Other <code>mgcv</code> modelling functions will not accept a list. The list form provides a mechanism for specifying several linear predictors, and allows these to share terms: see below. </p> <p>The formulae supplied to <code><a href="gam">gam</a></code> are exactly like those supplied to <code><a href="../../stats/html/glm">glm</a></code> except that smooth terms, <code><a href="s">s</a></code>, <code><a href="te">te</a></code>, <code><a href="te">ti</a></code> and <code><a href="t2">t2</a></code> can be added to the right hand side (and <code>.</code> is not supported in <code>gam</code> formulae). </p> <p>Smooth terms are specified by expressions of the form: <br> <code>s(x1,x2,...,k=12,fx=FALSE,bs="tp",by=z,id=1)</code><br> where <code>x1</code>, <code>x2</code>, etc. are the covariates which the smooth is a function of, and <code>k</code> is the dimension of the basis used to represent the smooth term. If <code>k</code> is not specified then basis specific defaults are used. Note that these defaults are essentially arbitrary, and it is important to check that they are not so small that they cause oversmoothing (too large just slows down computation). Sometimes the modelling context suggests sensible values for <code>k</code>, but if not informal checking is easy: see <code><a href="choose.k">choose.k</a></code> and <code><a href="gam.check">gam.check</a></code>. </p> <p><code>fx</code> is used to indicate whether or not this term should be unpenalized, and therefore have a fixed number of degrees of freedom set by <code>k</code> (almost always <code>k-1</code>). <code>bs</code> indicates the basis to use for the smooth: the built in options are described in <code><a href="smooth.terms">smooth.terms</a></code>, and user defined smooths can be added (see <code><a href="smooth.construct">user.defined.smooth</a></code>). If <code>bs</code> is not supplied then the default <code>"tp"</code> (<code><a href="smooth.construct.tp.smooth.spec">tprs</a></code>) basis is used. <code>by</code> can be used to specify a variable by which the smooth should be multiplied. For example <code>gam(y~s(x,by=z))</code> would specify a model <i>E(y)=f(x)z</i> where <i>f(.)</i> is a smooth function. The <code>by</code> option is particularly useful for models in which different functions of the same variable are required for each level of a factor and for ‘varying coefficient models’: see <code><a href="gam.models">gam.models</a></code>. <code>id</code> is used to give smooths identities: smooths with the same identity have the same basis, penalty and smoothing parameter (but different coefficients, so they are different functions). </p> <p>An alternative for specifying smooths of more than one covariate is e.g.: <br> <code>te(x,z,bs=c("tp","tp"),m=c(2,3),k=c(5,10))</code><br> which would specify a tensor product smooth of the two covariates <code>x</code> and <code>z</code> constructed from marginal t.p.r.s. bases of dimension 5 and 10 with marginal penalties of order 2 and 3. Any combination of basis types is possible, as is any number of covariates. <code><a href="te">te</a></code> provides further information. <code><a href="te">ti</a></code> terms are a variant designed to be used as interaction terms when the main effects (and any lower order interactions) are present. <code><a href="t2">t2</a></code> produces tensor product smooths that are the natural low rank analogue of smoothing spline anova models. </p> <p><code>s</code>, <code>te</code>, <code>ti</code> and <code>t2</code> terms accept an <code>sp</code> argument of supplied smoothing parameters: positive values are taken as fixed values to be used, negative to indicate that the parameter should be estimated. If <code>sp</code> is supplied then it over-rides whatever is in the <code>sp</code> argument to <code>gam</code>, if it is not supplied then it defaults to all negative, but does not over-ride the <code>sp</code> argument to <code>gam</code>. </p> <p>Formulae can involve nested or “overlapping” terms such as <br> <code>y~s(x)+s(z)+s(x,z)</code> or <code>y~s(x,z)+s(z,v)</code><br> but nested models should really be set up using <code><a href="te">ti</a></code> terms: see <code><a href="gam.side">gam.side</a></code> for further details and examples. </p> <p>Smooth terms in a <code>gam</code> formula will accept matrix arguments as covariates (and corresponding <code>by</code> variable), in which case a ‘summation convention’ is invoked. Consider the example of <code>s(X,Z,by=L)</code> where <code>X</code>, <code>Z</code> and <code>L</code> are n by m matrices. Let <code>F</code> be the n by m matrix that results from evaluating the smooth at the values in <code>X</code> and <code>Z</code>. Then the contribution to the linear predictor from the term will be <code>rowSums(F*L)</code> (note the element-wise multiplication). This convention allows the linear predictor of the GAM to depend on (a discrete approximation to) any linear functional of a smooth: see <code><a href="linear.functional.terms">linear.functional.terms</a></code> for more information and examples (including functional linear models/signal regression). </p> <p>Note that <code>gam</code> allows any term in the model formula to be penalized (possibly by multiple penalties), via the <code>paraPen</code> argument. See <code><a href="gam.models">gam.models</a></code> for details and example code. </p> <p>When several formulae are provided in a list, then they can be used to specify multiple linear predictors for families for which this makes sense (e.g. <code><a href="mvn">mvn</a></code>). The first formula in the list must include a response variable, but later formulae need not (depending on the requirements of the family). Let the linear predictors be indexed, 1 to d where d is the number of linear predictors, and the indexing is in the order in which the formulae appear in the list. It is possible to supply extra formulae specifying that several linear predictors should share some terms. To do this a formula is supplied in which the response is replaced by numbers specifying the indices of the linear predictors which will shre the terms specified on the r.h.s. For example <code>1+3~s(x)+z-1</code> specifies that linear predictors 1 and 3 will share the terms <code>s(x)</code> and <code>z</code> (but we don't want an extra intercept, as this would usually be unidentifiable). Note that it is possible that a linear predictor only includes shared terms: it must still have its own formula, but the r.h.s. would simply be <code>-1</code> (e.g. <code>y ~ -1</code> or <code>~ -1</code>). </p> <h3>Value</h3> <p> Returns the model formula, <code>x$formula</code>. Provided so that <code>anova</code> methods print an appropriate description of the model. </p> <h3>WARNING</h3> <p>A <code>gam</code> formula should not refer to variables using e.g. <code>dat[["x"]]</code>. </p> <h3>Author(s)</h3> <p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a></p> <h3>See Also</h3> <p><code><a href="gam">gam</a></code></p>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Mgcv - R - W3cubDocs</title>
  
  <meta name="description" content="mgcv provides functions for generalized additive modelling (gam and bam) and generalized additive mixed modelling (gamm, and random.effects). The &hellip;">
  <meta name="keywords" content="mgcv, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/mgcv/html/mgcv-package.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>mgcv-package</code> Mixed GAM Computation Vehicle with GCV/AIC/REML smoothness estimation and GAMMs by REML/PQL </h2> <h3>Description</h3> <p><code>mgcv</code> provides functions for generalized additive modelling (<code><a href="gam">gam</a></code> and <code><a href="bam">bam</a></code>) and generalized additive mixed modelling (<code><a href="gamm">gamm</a></code>, and <code><a href="random.effects">random.effects</a></code>). The term GAM is taken to include any model dependent on unknown smooth functions of predictors and estimated by quadratically penalized (possibly quasi-) likelihood maximization. Available distributions are covered in <code><a href="family.mgcv">family.mgcv</a></code> and available smooths in <code><a href="smooth.terms">smooth.terms</a></code>. </p> <p>Particular features of the package are facilities for automatic smoothness selection (Wood, 2004, 2011), and the provision of a variety of smooths of more than one variable. User defined smooths can be added. A Bayesian approach to confidence/credible interval calculation is provided. Linear functionals of smooths, penalization of parametric model terms and linkage of smoothing parameters are all supported. Lower level routines for generalized ridge regression and penalized linearly constrained least squares are also available. In addition to the main modelling functions, <code><a href="jagam">jagam</a></code> provided facilities to ease the set up of models for use with JAGS, while <code><a href="ginla">ginla</a></code> provides marginal inference via a version of Integrated Nested Laplace Approximation. </p> <h3>Details</h3> <p><code>mgcv</code> provides generalized additive modelling functions <code><a href="gam">gam</a></code>, <code><a href="predict.gam">predict.gam</a></code> and <code><a href="plot.gam">plot.gam</a></code>, which are very similar in use to the S functions of the same name designed by Trevor Hastie (with some extensions). However the underlying representation and estimation of the models is based on a penalized regression spline approach, with automatic smoothness selection. A number of other functions such as <code><a href="summary.gam">summary.gam</a></code> and <code><a href="anova.gam">anova.gam</a></code> are also provided, for extracting information from a fitted <code><a href="gamobject">gamObject</a></code>. </p> <p>Use of <code><a href="gam">gam</a></code> is much like use of <code><a href="../../stats/html/glm">glm</a></code>, except that within a <code>gam</code> model formula, isotropic smooths of any number of predictors can be specified using <code><a href="s">s</a></code> terms, while scale invariant smooths of any number of predictors can be specified using <code><a href="te">te</a></code>, <code><a href="te">ti</a></code> or <code><a href="t2">t2</a></code> terms. <code><a href="smooth.terms">smooth.terms</a></code> provides an overview of the built in smooth classes, and <code><a href="random.effects">random.effects</a></code> should be refered to for an overview of random effects terms (see also <code><a href="smooth.construct.mrf.smooth.spec">mrf</a></code> for Markov random fields). Estimation is by penalized likelihood or quasi-likelihood maximization, with smoothness selection by GCV, GACV, gAIC/UBRE or (RE)ML. See <code><a href="gam">gam</a></code>, <code><a href="gam.models">gam.models</a></code>, <code><a href="linear.functional.terms">linear.functional.terms</a></code> and <code><a href="gam.selection">gam.selection</a></code> for some discussion of model specification and selection. For detailed control of fitting see <code><a href="gam.convergence">gam.convergence</a></code>, <code><a href="gam">gam</a></code> arguments <code>method</code> and <code>optimizer</code> and <code><a href="gam.control">gam.control</a></code>. For checking and visualization see <code><a href="gam.check">gam.check</a></code>, <code><a href="choose.k">choose.k</a></code>, <code><a href="vis.gam">vis.gam</a></code> and <code><a href="plot.gam">plot.gam</a></code>. While a number of types of smoother are built into the package, it is also extendable with user defined smooths, see <code><a href="smooth.construct">smooth.construct</a></code>, for example. </p> <p>A Bayesian approach to smooth modelling is used to derive standard errors on predictions, and hence credible intervals (see Marra and Wood, 2012). The Bayesian covariance matrix for the model coefficients is returned in <code>Vp</code> of the <code><a href="gamobject">gamObject</a></code>. See <code><a href="predict.gam">predict.gam</a></code> for examples of how this can be used to obtain credible regions for any quantity derived from the fitted model, either directly, or by direct simulation from the posterior distribution of the model coefficients. Approximate p-values can also be obtained for testing individual smooth terms for equality to the zero function, using similar ideas (see Wood, 2013a,b). Frequentist approximations can be used for hypothesis testing based model comparison. See <code><a href="anova.gam">anova.gam</a></code> and <code><a href="summary.gam">summary.gam</a></code> for more on hypothesis testing. </p> <p>For large datasets (that is large n) see <code><a href="bam">bam</a></code> which is a version of <code><a href="gam">gam</a></code> with a much reduced memory footprint. </p> <p>The package also provides a generalized additive mixed modelling function, <code><a href="gamm">gamm</a></code>, based on a PQL approach and <code>lme</code> from the <code>nlme</code> library (for an <code>lme4</code> based version, see package <code>gamm4</code>). <code>gamm</code> is particularly useful for modelling correlated data (i.e. where a simple independence model for the residual variation is inappropriate). In addition, low level routine <code><a href="magic">magic</a></code> can fit models to data with a known correlation structure. </p> <p>Some underlying GAM fitting methods are available as low level fitting functions: see <code><a href="magic">magic</a></code>. But there is little functionality that can not be more conventiently accessed via <code><a href="gam">gam</a></code> . Penalized weighted least squares with linear equality and inequality constraints is provided by <code><a href="pcls">pcls</a></code>. </p> <p>For a complete list of functions type <code>library(help=mgcv)</code>. See also <code><a href="mgcv-faq">mgcv.FAQ</a></code>. </p> <h3>Author(s)</h3> <p>Simon Wood &lt;simon.wood@r-project.org&gt; </p> <p>with contributions and/or help from Natalya Pya, Thomas Kneib, Kurt Hornik, Mike Lonergan, Henric Nilsson, Fabian Scheipl and Brian Ripley. </p> <p>Polish translation - Lukasz Daniel; German translation - Chris Leick, Detlef Steuer; French Translation - Philippe Grosjean </p> <p>Maintainer: Simon Wood &lt;simon.wood@r-project.org&gt; </p> <p>Part funded by EPSRC: EP/K005251/1 </p> <h3>References</h3> <p>These provide details for the underlying mgcv methods, and fuller references to the large literature on which the methods are based. </p> <p>Wood, S.N., N. Pya and B. Saefken (2016), Smoothing parameter and model selection for general smooth models (with discussion). Journal of the American Statistical Association 111, 1548-1575 doi: <a href="https://doi.org/10.1080/01621459.2016.1180986">10.1080/01621459.2016.1180986</a> </p> <p>Wood, S.N. (2011) Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. Journal of the Royal Statistical Society (B) 73(1):3-36 </p> <p>Wood, S.N. (2004) Stable and efficient multiple smoothing parameter estimation for generalized additive models. J. Amer. Statist. Ass. 99:673-686. </p> <p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for Generalized Additive Model Components. Scandinavian Journal of Statistics, 39(1), 53-74. </p> <p>Wood, S.N. (2013a) A simple test for random effects in regression models. Biometrika 100:1005-1010 </p> <p>Wood, S.N. (2013b) On p-values for smooth components of an extended generalized additive model. Biometrika 100:221-228 </p> <p>Wood, S.N. (2017) <em>Generalized Additive Models: an introduction with R (2nd edition)</em>, CRC </p> <p>Development of mgcv version 1.8 was part funded by EPSRC grants EP/K005251/1 and EP/I000917/1. </p> <h3>Examples</h3> <pre data-language="r">
## see examples for gam and gamm
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

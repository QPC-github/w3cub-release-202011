
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Compute the Ellipsoid Hull or Spanning Ellipsoid of a Point Set - R - W3cubDocs</title>
  
  <meta name="description" content="Compute the “ellipsoid hull” or “spanning ellipsoid”, i.e. the ellipsoid of minimal volume (‘area’ in 2D) such that all given points lie just inside &hellip;">
  <meta name="keywords" content="compute, ellipsoid, hull, or, spanning, point, set, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/cluster/html/ellipsoidhull.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>ellipsoidhull</code> Compute the Ellipsoid Hull or Spanning Ellipsoid of a Point Set</h2> <h3>Description</h3> <p>Compute the “ellipsoid hull” or “spanning ellipsoid”, i.e. the ellipsoid of minimal volume (‘area’ in 2D) such that all given points lie just inside or on the boundary of the ellipsoid. </p> <h3>Usage</h3> <pre data-language="r">
ellipsoidhull(x, tol=0.01, maxit=5000,
              ret.wt = FALSE, ret.sqdist = FALSE, ret.pr = FALSE)
## S3 method for class 'ellipsoid'
print(x, digits = max(1, getOption("digits") - 2), ...)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>the <i>n</i> <i>p</i>-dimensional points asnumeric <i>n x p</i> matrix.</p> </td>
</tr> <tr valign="top">
<td><code>tol</code></td> <td> <p>convergence tolerance for Titterington's algorithm. Setting this to much smaller values may drastically increase the number of iterations needed, and you may want to increas <code>maxit</code> as well.</p> </td>
</tr> <tr valign="top">
<td><code>maxit</code></td> <td> <p>integer giving the maximal number of iteration steps for the algorithm.</p> </td>
</tr> <tr valign="top">
<td><code>ret.wt, ret.sqdist, ret.pr</code></td> <td> <p>logicals indicating if additional information should be returned, <code>ret.wt</code> specifying the <em>weights</em>, <code>ret.sqdist</code> the <em><b>sq</b>uared <b>dist</b>ances</em> and <code>ret.pr</code> the final <b>pr</b>obabilities in the algorithms.</p> </td>
</tr> <tr valign="top">
<td><code>digits,...</code></td> <td> <p>the usual arguments to <code><a href="../../base/html/print">print</a></code> methods.</p> </td>
</tr> </table> <h3>Details</h3> <p>The “spanning ellipsoid” algorithm is said to stem from Titterington(1976), in Pison et al (1999) who use it for <code><a href="clusplot.default">clusplot.default</a></code>.<br> The problem can be seen as a special case of the “Min.Vol.” ellipsoid of which a more more flexible and general implementation is <code><a href="../../mass/html/cov.rob">cov.mve</a></code> in the <code>MASS</code> package. </p> <h3>Value</h3> <p>an object of class <code>"ellipsoid"</code>, basically a <code><a href="../../base/html/list">list</a></code> with several components, comprising at least </p> <table summary="R valueblock"> <tr valign="top">
<td><code>cov</code></td> <td> <p><i>p x p</i> <em>covariance</em> matrix description the ellipsoid.</p> </td>
</tr> <tr valign="top">
<td><code>loc</code></td> <td> <p><i>p</i>-dimensional location of the ellipsoid center.</p> </td>
</tr> <tr valign="top">
<td><code>d2</code></td> <td> <p>average squared radius. Further, <i>d2 = t^2</i>, where <i>t</i> is “the value of a t-statistic on the ellipse boundary” (from <code><a href="../../ellipse/html/ellipse">ellipse</a></code> in the <span class="pkg">ellipse</span> package), and hence, more usefully, <code>d2 = qchisq(alpha, df = p)</code>, where <code>alpha</code> is the confidence level for p-variate normally distributed data with location and covariance <code>loc</code> and <code>cov</code> to lie inside the ellipsoid.</p> </td>
</tr> <tr valign="top">
<td><code>wt</code></td> <td> <p>the vector of weights iff <code>ret.wt</code> was true.</p> </td>
</tr> <tr valign="top">
<td><code>sqdist</code></td> <td> <p>the vector of squared distances iff <code>ret.sqdist</code> was true.</p> </td>
</tr> <tr valign="top">
<td><code>prob</code></td> <td> <p>the vector of algorithm probabilities iff <code>ret.pr</code> was true.</p> </td>
</tr> <tr valign="top">
<td><code>it</code></td> <td> <p>number of iterations used.</p> </td>
</tr> <tr valign="top">
<td><code>tol, maxit</code></td> <td> <p>just the input argument, see above.</p> </td>
</tr> <tr valign="top">
<td><code>eps</code></td> <td> <p>the achieved tolerance which is the maximal squared radius minus <i>p</i>.</p> </td>
</tr> <tr valign="top">
<td><code>ierr</code></td> <td> <p>error code as from the algorithm; <code>0</code> means <em>ok</em>.</p> </td>
</tr> <tr valign="top">
<td><code>conv</code></td> <td> <p>logical indicating if the converged. This is defined as <code>it &lt; maxit &amp;&amp; ierr == 0</code>.</p> </td>
</tr> </table> <h3>Author(s)</h3> <p>Martin Maechler did the present class implementation; Rousseeuw et al did the underlying original code.</p> <h3>References</h3> <p>Pison, G., Struyf, A. and Rousseeuw, P.J. (1999) Displaying a Clustering with CLUSPLOT, <em>Computational Statistics and Data Analysis</em>, <b>30</b>, 381–392.<br> </p> <p>D.M. Titterington (1976) Algorithms for computing D-optimal design on finite design spaces. In <em>Proc.\ of the 1976 Conf.\ on Information Science and Systems</em>, 213–216; John Hopkins University. </p> <h3>See Also</h3> <p><code><a href="predict.ellipsoid">predict.ellipsoid</a></code> which is also the <code><a href="../../stats/html/predict">predict</a></code> method for <code>ellipsoid</code> objects. <code><a href="volume.ellipsoid">volume.ellipsoid</a></code> for an example of ‘manual’ <code>ellipsoid</code> object construction;<br> further <code><a href="../../ellipse/html/ellipse">ellipse</a></code> from package <span class="pkg">ellipse</span> and <code><a href="../../sfsmisc/html/ellipsepoints">ellipsePoints</a></code> from package <span class="pkg">sfsmisc</span>. </p> <p><code><a href="../../grdevices/html/chull">chull</a></code> for the convex hull, <code><a href="clusplot.partition">clusplot</a></code> which makes use of this; <code><a href="../../mass/html/cov.rob">cov.mve</a></code>. </p> <h3>Examples</h3> <pre data-language="r">
x &lt;- rnorm(100)
xy &lt;- unname(cbind(x, rnorm(100) + 2*x + 10))
exy. &lt;- ellipsoidhull(xy)
exy. # &gt;&gt; calling print.ellipsoid()

plot(xy, main = "ellipsoidhull(&lt;Gauss data&gt;) -- 'spanning points'")
lines(predict(exy.), col="blue")
points(rbind(exy.$loc), col = "red", cex = 3, pch = 13)

exy &lt;- ellipsoidhull(xy, tol = 1e-7, ret.wt = TRUE, ret.sq = TRUE)
str(exy) # had small 'tol', hence many iterations
(ii &lt;- which(zapsmall(exy $ wt) &gt; 1e-6))
## --&gt; only about 4 to 6  "spanning ellipsoid" points
round(exy$wt[ii],3); sum(exy$wt[ii]) # weights summing to 1
points(xy[ii,], pch = 21, cex = 2,
       col="blue", bg = adjustcolor("blue",0.25))
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Dpill - R - W3cubDocs</title>
  
  <meta name="description" content="Use direct plug-in methodology to select the bandwidth of a local linear Gaussian kernel regression estimate, as described by Ruppert, Sheather and &hellip;">
  <meta name="keywords" content="dpill, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/kernsmooth/html/dpill.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>dpill</code>  Select a Bandwidth for Local Linear Regression </h2> <h3>Description</h3> <p>Use direct plug-in methodology to select the bandwidth of a local linear Gaussian kernel regression estimate, as described by Ruppert, Sheather and Wand (1995). </p> <h3>Usage</h3> <pre data-language="r">
dpill(x, y, blockmax = 5, divisor = 20, trim = 0.01, proptrun = 0.05, 
      gridsize = 401L, range.x, truncate = TRUE)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>numeric vector of x data. Missing values are not accepted. </p> </td>
</tr> <tr valign="top">
<td><code>y</code></td> <td> <p>numeric vector of y data. This must be same length as <code>x</code>, and missing values are not accepted. </p> </td>
</tr> <tr valign="top">
<td><code>blockmax</code></td> <td> <p>the maximum number of blocks of the data for construction of an initial parametric estimate. </p> </td>
</tr> <tr valign="top">
<td><code>divisor</code></td> <td> <p>the value that the sample size is divided by to determine a lower limit on the number of blocks of the data for construction of an initial parametric estimate. </p> </td>
</tr> <tr valign="top">
<td><code>trim</code></td> <td> <p>the proportion of the sample trimmed from each end in the <code>x</code> direction before application of the plug-in methodology. </p> </td>
</tr> <tr valign="top">
<td><code>proptrun</code></td> <td> <p>the proportion of the range of <code>x</code> at each end truncated in the functional estimates. </p> </td>
</tr> <tr valign="top">
<td><code>gridsize</code></td> <td> <p>number of equally-spaced grid points over which the function is to be estimated. </p> </td>
</tr> <tr valign="top">
<td><code>range.x</code></td> <td> <p>vector containing the minimum and maximum values of <code>x</code> at which to compute the estimate. For density estimation the default is the minimum and maximum data values with 5% of the range added to each end. For regression estimation the default is the minimum and maximum data values. </p> </td>
</tr> <tr valign="top">
<td><code>truncate</code></td> <td> <p>logical flag: if <code>TRUE</code>, data with <code>x</code> values outside the range specified by <code>range.x</code> are ignored. </p> </td>
</tr>
</table> <h3>Details</h3> <p>The direct plug-in approach, where unknown functionals that appear in expressions for the asymptotically optimal bandwidths are replaced by kernel estimates, is used. The kernel is the standard normal density. Least squares quartic fits over blocks of data are used to obtain an initial estimate. Mallow's <i>Cp</i> is used to select the number of blocks. </p> <h3>Value</h3> <p>the selected bandwidth. </p> <h3>Warning</h3> <p>If there are severe irregularities (i.e. outliers, sparse regions) in the <code>x</code> values then the local polynomial smooths required for the bandwidth selection algorithm may become degenerate and the function will crash. Outliers in the <code>y</code> direction may lead to deterioration of the quality of the selected bandwidth. </p> <h3>References</h3> <p>Ruppert, D., Sheather, S. J. and Wand, M. P. (1995). An effective bandwidth selector for local least squares regression. <em>Journal of the American Statistical Association</em>, <b>90</b>, 1257–1270. </p> <p>Wand, M. P. and Jones, M. C. (1995). <em>Kernel Smoothing.</em> Chapman and Hall, London. </p> <h3>See Also</h3> <p><code><a href="../../stats/html/ksmooth">ksmooth</a></code>, <code><a href="locpoly">locpoly</a></code>. </p> <h3>Examples</h3> <pre data-language="r">
data(geyser, package = "MASS")
x &lt;- geyser$duration
y &lt;- geyser$waiting
plot(x, y)
h &lt;- dpill(x, y)
fit &lt;- locpoly(x, y, bandwidth = h)
lines(fit)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Estimate Functions Using Local Polynomials - R - W3cubDocs</title>
  
  <meta name="description" content="Estimates a probability density function, regression function or their derivatives using local polynomials. A fast binned implementation over an &hellip;">
  <meta name="keywords" content="estimate, functions, using, local, polynomials, r">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/r/library/kernsmooth/html/locpoly.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-c2f2e7d1236e299f399a2d9bf4342fa70a8839fbe6eb79130546d6bf383b99636ffdf29c557090085d7c4ac34eeb5426851b42d2f4ec63cf218916cbd19aa876.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/r.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/r/" class="_nav-link" title="" style="margin-left:0;">R</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h2>
<code>locpoly</code>  Estimate Functions Using Local Polynomials </h2> <h3>Description</h3> <p>Estimates a probability density function, regression function or their derivatives using local polynomials. A fast binned implementation over an equally-spaced grid is used. </p> <h3>Usage</h3> <pre data-language="r">
locpoly(x, y, drv = 0L, degree, kernel = "normal", 
        bandwidth, gridsize = 401L, bwdisc = 25, 
        range.x, binned = FALSE, truncate = TRUE)
</pre> <h3>Arguments</h3> <table summary="R argblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>numeric vector of x data. Missing values are not accepted. </p> </td>
</tr> <tr valign="top">
<td><code>bandwidth</code></td> <td> <p>the kernel bandwidth smoothing parameter. It may be a single number or an array having length <code>gridsize</code>, representing a bandwidth that varies according to the location of estimation. </p> </td>
</tr> <tr valign="top">
<td><code>y</code></td> <td> <p>vector of y data. This must be same length as <code>x</code>, and missing values are not accepted. </p> </td>
</tr> <tr valign="top">
<td><code>drv</code></td> <td> <p>order of derivative to be estimated. </p> </td>
</tr> <tr valign="top">
<td><code>degree</code></td> <td> <p>degree of local polynomial used. Its value must be greater than or equal to the value of <code>drv</code>. The default value is of <code>degree</code> is <code>drv</code> + 1. </p> </td>
</tr> <tr valign="top">
<td><code>kernel</code></td> <td> <p><code>"normal"</code> - the Gaussian density function. Currently ignored. </p> </td>
</tr> <tr valign="top">
<td><code>gridsize</code></td> <td> <p>number of equally-spaced grid points over which the function is to be estimated. </p> </td>
</tr> <tr valign="top">
<td><code>bwdisc</code></td> <td> <p>number of logarithmically-equally-spaced bandwidths on which <code>bandwidth</code> is discretised, to speed up computation. </p> </td>
</tr> <tr valign="top">
<td><code>range.x</code></td> <td> <p>vector containing the minimum and maximum values of <code>x</code> at which to compute the estimate. </p> </td>
</tr> <tr valign="top">
<td><code>binned</code></td> <td> <p>logical flag: if <code>TRUE</code>, then <code>x</code> and <code>y</code> are taken to be grid counts rather than raw data. </p> </td>
</tr> <tr valign="top">
<td><code>truncate</code></td> <td> <p>logical flag: if <code>TRUE</code>, data with <code>x</code> values outside the range specified by <code>range.x</code> are ignored. </p> </td>
</tr>
</table> <h3>Value</h3> <p>if <code>y</code> is specified, a local polynomial regression estimate of E[Y|X] (or its derivative) is computed. If <code>y</code> is missing, a local polynomial estimate of the density of <code>x</code> (or its derivative) is computed. </p> <p>a list containing the following components: </p> <table summary="R valueblock"> <tr valign="top">
<td><code>x</code></td> <td> <p>vector of sorted x values at which the estimate was computed. </p> </td>
</tr> <tr valign="top">
<td><code>y</code></td> <td> <p>vector of smoothed estimates for either the density or the regression at the corresponding <code>x</code>. </p> </td>
</tr>
</table> <h3>Details</h3> <p>Local polynomial fitting with a kernel weight is used to estimate either a density, regression function or their derivatives. In the case of density estimation, the data are binned and the local fitting procedure is applied to the bin counts. In either case, binned approximations over an equally-spaced grid is used for fast computation. The bandwidth may be either scalar or a vector of length <code>gridsize</code>. </p> <h3>References</h3> <p>Wand, M. P. and Jones, M. C. (1995). <em>Kernel Smoothing.</em> Chapman and Hall, London. </p> <h3>See Also</h3> <p><code><a href="bkde">bkde</a></code>, <code><a href="../../stats/html/density">density</a></code>, <code><a href="dpill">dpill</a></code>, <code><a href="../../stats/html/ksmooth">ksmooth</a></code>, <code><a href="../../stats/html/loess">loess</a></code>, <code><a href="../../stats/html/smooth">smooth</a></code>, <code><a href="../../stats/html/supsmu">supsmu</a></code>. </p> <h3>Examples</h3> <pre data-language="r">
data(geyser, package = "MASS")
# local linear density estimate
x &lt;- geyser$duration
est &lt;- locpoly(x, bandwidth = 0.25)
plot(est, type = "l")

# local linear regression estimate
y &lt;- geyser$waiting
plot(x, y)
fit &lt;- locpoly(x, y, bandwidth = 0.25)
lines(fit)
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Copyright (©) 1999–2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

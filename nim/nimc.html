
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Nim Compiler - Nim - W3cubDocs</title>
  
  <meta name="description" content="&#34;Look at you, hacker. A pathetic creature of meat and bone, panting and sweating as you run through my corridors. How can you challenge a &hellip;">
  <meta name="keywords" content="nim, compiler, user, guide">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/nim/nimc.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/nim.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/nim/" class="_nav-link" title="" style="margin-left:0;">Nim</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1 class="title">Nim Compiler User Guide</h1>  
<blockquote><p>"Look at you, hacker. A pathetic creature of meat and bone, panting and sweating as you run through my corridors. How can you challenge a perfect, immortal machine?"</p></blockquote> <h2 id="introduction">Introduction</h2>
<p>This document describes the usage of the <em>Nim compiler</em> on the different supported platforms. It is not a definition of the Nim programming language (therefore is the <a href="manual">manual</a>).</p> <p>Nim is free software; it is licensed under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a>.</p> <h2 id="compiler-usage">Compiler Usage</h2> <h3 id="compiler-usage-command-line-switches">Command line switches</h3>
<p>Basic command line switches are:</p> <p>Usage:</p> <pre data-language="nim">nim command [options] [projectfile] [arguments]</pre> <dl>
<dt>Command:</dt> <dd><table frame="void">
<tr>
<th align="left">compile, c</th>
<td align="left">compile project with default code generator (C)</td> </tr> <tr>
<th align="left">doc</th>
<td align="left">generate the documentation for inputfile</td> </tr> </table></dd> <dt>Arguments:</dt> <dd>arguments are passed to the program being run (if --run option is selected)</dd> <dt>Options:</dt> <dd><table frame="void">
<tr>
<th align="left">-p, --path:PATH</th>
<td align="left">add path to search paths</td> </tr> <tr>
<th align="left">-d, --define:SYMBOL(:VAL)</th>
<td align="left">define a conditional symbol (Optionally: Define the value for that symbol, see: "compile time define pragmas")</td> </tr> <tr>
<th align="left">-u, --undef:SYMBOL</th>
<td align="left">undefine a conditional symbol</td> </tr> <tr>
<th align="left">-f, --forceBuild</th>
<td align="left">force rebuilding of all modules</td> </tr> <tr>
<th align="left">--stackTrace:on|off</th>
<td align="left">turn stack tracing on|off</td> </tr> <tr>
<th align="left">--lineTrace:on|off</th>
<td align="left">turn line tracing on|off</td> </tr> <tr>
<th align="left">--threads:on|off</th>
<td align="left">turn support for multi-threading on|off</td> </tr> <tr>
<th align="left">-x, --checks:on|off</th>
<td align="left">turn all runtime checks on|off</td> </tr> <tr>
<th align="left">--objChecks:on|off</th>
<td align="left">turn obj conversion checks on|off</td> </tr> <tr>
<th align="left">--fieldChecks:on|off</th>
<td align="left">turn case variant field checks on|off</td> </tr> <tr>
<th align="left">--rangeChecks:on|off</th>
<td align="left">turn range checks on|off</td> </tr> <tr>
<th align="left">--boundChecks:on|off</th>
<td align="left">turn bound checks on|off</td> </tr> <tr>
<th align="left">--overflowChecks:on|off</th>
<td align="left">turn int over-/underflow checks on|off</td> </tr> <tr>
<th align="left">-a, --assertions:on|off</th>
<td align="left">turn assertions on|off</td> </tr> <tr>
<th align="left">--floatChecks:on|off</th>
<td align="left">turn all floating point (NaN/Inf) checks on|off</td> </tr> <tr>
<th align="left">--nanChecks:on|off</th>
<td align="left">turn NaN checks on|off</td> </tr> <tr>
<th align="left">--infChecks:on|off</th>
<td align="left">turn Inf checks on|off</td> </tr> <tr>
<th align="left">--nilChecks:on|off</th>
<td align="left">turn nil checks on|off</td> </tr> <tr>
<th align="left">--opt:none|speed|size</th>
<td align="left">optimize not at all or for speed|size Note: use -d:release for a release build!</td> </tr> <tr>
<th align="left">--debugger:native|endb</th>
<td align="left">use native debugger (gdb) | ENDB (experimental)</td> </tr> <tr>
<th align="left">--app:console|gui|lib|staticlib</th>
<td align="left">generate a console app|GUI app|DLL|static library</td> </tr> <tr>
<th align="left">-r, --run</th>
<td align="left">run the compiled program with given arguments</td> </tr> <tr>
<th align="left">--fullhelp</th>
<td align="left">show all command line switches</td> </tr> <tr>
<th align="left">-h, --help</th>
<td align="left">show this help</td> </tr> </table></dd> </dl> <p>Note, single letter options that take an argument require a colon. E.g. -p:PATH. </p> <hr> <p>Advanced command line switches are:</p> <dl>
<dt>Advanced commands:</dt> <dd><table frame="void">
<tr>
<th align="left">compileToC, cc</th>
<td align="left">compile project with C code generator</td> </tr> <tr>
<th align="left">compileToCpp, cpp</th>
<td align="left">compile project to C++ code</td> </tr> <tr>
<th align="left">compileToOC, objc</th>
<td align="left">compile project to Objective C code</td> </tr> <tr>
<th align="left">js</th>
<td align="left">compile project to Javascript</td> </tr> <tr>
<th align="left">e</th>
<td align="left">run a Nimscript file</td> </tr> <tr>
<th align="left">rst2html</th>
<td align="left">convert a reStructuredText file to HTML</td> </tr> <tr>
<th align="left">rst2tex</th>
<td align="left">convert a reStructuredText file to TeX</td> </tr> <tr>
<th align="left">jsondoc</th>
<td align="left">extract the documentation to a json file</td> </tr> <tr>
<th align="left">ctags</th>
<td align="left">create a tags file</td> </tr> <tr>
<th align="left">buildIndex</th>
<td align="left">build an index for the whole documentation</td> </tr> <tr>
<th align="left">run</th>
<td align="left">run the project (with Tiny C backend; buggy!)</td> </tr> <tr>
<th align="left">genDepend</th>
<td align="left">generate a DOT file containing the module dependency graph</td> </tr> <tr>
<th align="left">dump</th>
<td align="left">dump all defined conditionals and search paths</td> </tr> <tr>
<th align="left">check</th>
<td align="left">checks the project for syntax and semantic</td> </tr> </table></dd> <dt>Advanced options:</dt> <dd><table frame="void">
<tr>
<th align="left">-o:FILE, --out:FILE</th>
<td align="left">set the output filename</td> </tr> <tr>
<th align="left">--stdout</th>
<td align="left">output to stdout</td> </tr> <tr>
<th align="left">--colors:on|off</th>
<td align="left">turn compiler messages coloring on|off</td> </tr> <tr>
<th align="left">--listFullPaths</th>
<td align="left">list full paths in messages</td> </tr> <tr>
<th align="left">-w:on|off|list, --warnings:on|off|list</th>
<td align="left">turn all warnings on|off or list all available</td> </tr> <tr>
<th align="left">--warning[X]:on|off</th>
<td align="left">turn specific warning X on|off</td> </tr> <tr>
<th align="left">--hints:on|off|list</th>
<td align="left">turn all hints on|off or list all available</td> </tr> <tr>
<th align="left">--hint[X]:on|off</th>
<td align="left">turn specific hint X on|off</td> </tr> <tr>
<th align="left">--lib:PATH</th>
<td align="left">set the system library path</td> </tr> <tr>
<th align="left">--import:PATH</th>
<td align="left">add an automatically imported module</td> </tr> <tr>
<th align="left">--include:PATH</th>
<td align="left">add an automatically included module</td> </tr> <tr>
<th align="left">--nimcache:PATH</th>
<td align="left">set the path used for generated files</td> </tr> <tr>
<th align="left">--header:FILE</th>
<td align="left">the compiler should produce a .h file (FILE is optional)</td> </tr> <tr>
<th align="left">-c, --compileOnly</th>
<td align="left">compile Nim files only; do not assemble or link</td> </tr> <tr>
<th align="left">--noLinking</th>
<td align="left">compile Nim and generated files but do not link</td> </tr> <tr>
<th align="left">--noMain</th>
<td align="left">do not generate a main procedure</td> </tr> <tr>
<th align="left">--genScript</th>
<td align="left">generate a compile script (in the 'nimcache' subdirectory named 'compile_$$project$$scriptext'), implies --compileOnly</td> </tr> <tr>
<th align="left">--genDeps</th>
<td align="left">generate a '.deps' file containing the dependencies</td> </tr> <tr>
<th align="left">--os:SYMBOL</th>
<td align="left">set the target operating system (cross-compilation)</td> </tr> <tr>
<th align="left">--cpu:SYMBOL</th>
<td align="left">set the target processor (cross-compilation)</td> </tr> <tr>
<th align="left">--debuginfo</th>
<td align="left">enables debug information</td> </tr> <tr>
<th align="left">-t, --passC:OPTION</th>
<td align="left">pass an option to the C compiler</td> </tr> <tr>
<th align="left">-l, --passL:OPTION</th>
<td align="left">pass an option to the linker</td> </tr> <tr>
<th align="left">--cincludes:DIR</th>
<td align="left">modify the C compiler header search path</td> </tr> <tr>
<th align="left">--clibdir:DIR</th>
<td align="left">modify the linker library search path</td> </tr> <tr>
<th align="left">--clib:LIBNAME</th>
<td align="left">link an additional C library (you should omit platform-specific extensions)</td> </tr> <tr>
<th align="left">--genMapping</th>
<td align="left">generate a mapping file containing (Nim, mangled) identifier pairs</td> </tr> <tr>
<th align="left">--project</th>
<td align="left">document the whole project (doc2)</td> </tr> <tr>
<th align="left">--docSeeSrcUrl:url</th>
<td align="left">activate 'see source' for doc and doc2 commands (see doc.item.seesrc in config/nimdoc.cfg)</td> </tr> <tr>
<th align="left">--lineDir:on|off</th>
<td align="left">generation of #line directive on|off</td> </tr> <tr>
<th align="left">--embedsrc</th>
<td align="left">embeds the original source code as comments in the generated output</td> </tr> <tr>
<th align="left">--threadanalysis:on|off</th>
<td align="left">turn thread analysis on|off</td> </tr> <tr>
<th align="left">--tlsEmulation:on|off</th>
<td align="left">turn thread local storage emulation on|off</td> </tr> <tr>
<th align="left">--taintMode:on|off</th>
<td align="left">turn taint mode on|off</td> </tr> <tr>
<th align="left">--implicitStatic:on|off</th>
<td align="left">turn implicit compile time evaluation on|off</td> </tr> <tr>
<th align="left">--patterns:on|off</th>
<td align="left">turn pattern matching on|off</td> </tr> <tr>
<th align="left">--memTracker:on|off</th>
<td align="left">turn memory tracker on|off</td> </tr> <tr>
<th align="left">--hotCodeReloading:on|off</th>
<td align="left">turn support for hot code reloading on|off</td> </tr> <tr>
<th align="left">--excessiveStackTrace:on|off</th>
<td align="left">stack traces use full file paths</td> </tr> <tr>
<th align="left">--oldNewlines:on|off</th>
<td align="left">turn on|off the old behaviour of "n"</td> </tr> <tr>
<th align="left">--laxStrings:on|off</th>
<td align="left">when turned on, accessing the zero terminator in strings is allowed; only for backwards compatibility</td> </tr> <tr>
<th align="left">--nilseqs:on|off</th>
<td align="left">allow 'nil' for strings/seqs for backwards compatibility</td> </tr> <tr>
<th align="left">--skipCfg</th>
<td align="left">do not read the general configuration file</td> </tr> <tr>
<th align="left">--skipUserCfg</th>
<td align="left">do not read the user's configuration file</td> </tr> <tr>
<th align="left">--skipParentCfg</th>
<td align="left">do not read the parent dirs' configuration files</td> </tr> <tr>
<th align="left">--skipProjCfg</th>
<td align="left">do not read the project's configuration file</td> </tr> <tr>
<th align="left">--gc:refc|v2|markAndSweep|boehm|go|none|regions</th>
<td align="left">select the GC to use; default is 'refc'</td> </tr> <tr>
<th align="left">--index:on|off</th>
<td align="left">turn index file generation on|off</td> </tr> <tr>
<th align="left">--putenv:key=value</th>
<td align="left">set an environment variable</td> </tr> <tr>
<th align="left">--NimblePath:PATH</th>
<td align="left">add a path for Nimble support</td> </tr> <tr>
<th align="left">--noNimblePath</th>
<td align="left">deactivate the Nimble path</td> </tr> <tr>
<th align="left">--noCppExceptions</th>
<td align="left">use default exception handling with C++ backend</td> </tr> <tr>
<th align="left">--cppCompileToNamespace:namespace</th>
<td align="left">use the provided namespace for the generated C++ code, if no namespace is provided "Nim" will be used</td> </tr> <tr>
<th align="left">--excludePath:PATH</th>
<td align="left">exclude a path from the list of search paths</td> </tr> <tr>
<th align="left">--dynlibOverride:SYMBOL</th>
<td align="left">marks SYMBOL so that dynlib:SYMBOL has no effect and can be statically linked instead; symbol matching is fuzzy so that --dynlibOverride:lua matches dynlib: "liblua.so.3"</td> </tr> <tr>
<th align="left">--dynlibOverrideAll</th>
<td align="left">makes the dynlib pragma have no effect</td> </tr> <tr>
<th align="left">--listCmd</th>
<td align="left">list the commands used to execute external programs</td> </tr> <tr>
<th align="left">--parallelBuild:0|1|...</th>
<td align="left">perform a parallel build value = number of processors (0 for auto-detect)</td> </tr> <tr>
<th align="left">--verbosity:0|1|2|3</th>
<td align="left">set Nim's verbosity level (1 is default)</td> </tr> <tr>
<th align="left">--experimental:$1</th>
<td align="left">enable experimental language feature</td> </tr> <tr>
<th align="left">-v, --version</th>
<td align="left">show detailed version information</td> </tr> </table></dd> </dl> <h3 id="compiler-usage-list-of-warnings">List of warnings</h3>
<p>Each warning can be activated individually with <code>--warning[NAME]:on|off</code> or in a <code>push</code> pragma.</p> <table>
<tr>
<th>Name</th>
<th>Description</th>
</tr> <tr>
<td>CannotOpenFile</td>
<td>Some file not essential for the compiler's working could not be opened.</td>
</tr> <tr>
<td>OctalEscape</td>
<td>The code contains an unsupported octal sequence.</td>
</tr> <tr>
<td>Deprecated</td>
<td>The code uses a deprecated symbol.</td>
</tr> <tr>
<td>ConfigDeprecated</td>
<td>The project makes use of a deprecated config file.</td>
</tr> <tr>
<td>SmallLshouldNotBeUsed</td>
<td>The letter 'l' should not be used as an identifier.</td>
</tr> <tr>
<td>EachIdentIsTuple</td>
<td>The code contains a confusing <code>var</code> declaration.</td>
</tr> <tr>
<td>ShadowIdent</td>
<td>A local variable shadows another local variable of an outer scope.</td>
</tr> <tr>
<td>User</td>
<td>Some user defined warning.</td>
</tr> </table> <h3 id="compiler-usage-list-of-hints">List of hints</h3>
<p>Each hint can be activated individually with <code>--hint[NAME]:on|off</code> or in a <code>push</code> pragma.</p> <table>
<tr>
<th>Name</th>
<th>Description</th>
</tr> <tr>
<td>CC</td>
<td>Shows when the C compiler is called.</td>
</tr> <tr>
<td>CodeBegin</td>
<td></td>
</tr> <tr>
<td>CodeEnd</td>
<td></td>
</tr> <tr>
<td>CondTrue</td>
<td></td>
</tr> <tr>
<td>Conf</td>
<td>A config file was loaded.</td>
</tr> <tr>
<td>ConvToBaseNotNeeded</td>
<td></td>
</tr> <tr>
<td>ConvFromXtoItselfNotNeeded</td>
<td></td>
</tr> <tr>
<td>Dependency</td>
<td></td>
</tr> <tr>
<td>Exec</td>
<td>Program is executed.</td>
</tr> <tr>
<td>ExprAlwaysX</td>
<td></td>
</tr> <tr>
<td>ExtendedContext</td>
<td></td>
</tr> <tr>
<td>GCStats</td>
<td>Dumps statistics about the Garbage Collector.</td>
</tr> <tr>
<td>GlobalVar</td>
<td>Shows global variables declarations.</td>
</tr> <tr>
<td>LineTooLong</td>
<td>Line exceeds the maximum length.</td>
</tr> <tr>
<td>Link</td>
<td>Linking phase.</td>
</tr> <tr>
<td>Name</td>
<td></td>
</tr> <tr>
<td>Path</td>
<td>Search paths modifications.</td>
</tr> <tr>
<td>Pattern</td>
<td></td>
</tr> <tr>
<td>Performance</td>
<td></td>
</tr> <tr>
<td>Processing</td>
<td>Artifact being compiled.</td>
</tr> <tr>
<td>QuitCalled</td>
<td></td>
</tr> <tr>
<td>Source</td>
<td>The source line that triggered a diagnostic message.</td>
</tr> <tr>
<td>StackTrace</td>
<td></td>
</tr> <tr>
<td>Success, SuccessX</td>
<td>Successful compilation of a library or a binary.</td>
</tr> <tr>
<td>User</td>
<td></td>
</tr> <tr>
<td>UserRaw</td>
<td></td>
</tr> <tr>
<td>XDeclaredButNotUsed</td>
<td>Unused symbols in the code.</td>
</tr> </table> <h3 id="compiler-usage-verbosity-levels">Verbosity levels</h3>
<table>
<tr>
<th>Level</th>
<th>Description</th>
</tr> <tr>
<td>0</td>
<td>Minimal output level for the compiler.</td>
</tr> <tr>
<td>1</td>
<td>Displays compilation of all the compiled files, including those imported by other modules or through the <a href="#compile-pragma">compile pragma</a>. This is the default level.</td>
</tr> <tr>
<td>2</td>
<td>Displays compilation statistics, enumerates the dynamic libraries that will be loaded by the final binary and dumps to standard output the result of applying <a href="filters">a filter to the source code</a> if any filter was used during compilation.</td>
</tr> <tr>
<td>3</td>
<td>In addition to the previous levels dumps a debug stack trace for compiler developers.</td>
</tr> </table> <h3 id="compiler-usage-compile-time-symbols">Compile time symbols</h3>
<p>Through the <code>-d:x</code> or <code>--define:x</code> switch you can define compile time symbols for conditional compilation. The defined switches can be checked in source code with the <a href="manual#when-statement">when statement</a> and <a href="system#defined">defined proc</a>. The typical use of this switch is to enable builds in release mode (<code>-d:release</code>) where certain safety checks are omitted for better performance. Another common use is the <code>-d:ssl</code> switch to activate SSL sockets.</p> <p>Additionally, you may pass a value along with the symbol: <code>-d:x=y</code> which may be used in conjunction with the <a href="manual#implementation-specific-pragmas-compile-time-define-pragmas">compile time define pragmas</a> to override symbols during build time.</p> <p>Compile time symbols are completely <strong>case insensitive</strong> and underscores are ignored too. <code>--define:FOO</code> and <code>--define:foo</code> are identical.</p> <h3 id="compiler-usage-configuration-files">Configuration files</h3>
<p><strong>Note:</strong> The <em>project file name</em> is the name of the <code>.nim</code> file that is passed as a command line argument to the compiler.</p> <p>The <code>nim</code> executable processes configuration files in the following directories (in this order; later files overwrite previous settings):</p> <ol class="simple">
<li>
<code>$nim/config/nim.cfg</code>, <code>/etc/nim/nim.cfg</code> (UNIX) or <code>%NIM%/config/nim.cfg</code> (Windows). This file can be skipped with the <code>--skipCfg</code> command line option.</li> <li>If environment variable <code>XDG_CONFIG_HOME</code> is defined, <code>$XDG_CONFIG_HOME/nim/nim.cfg</code> or <code>~/.config/nim/nim.cfg</code> (POSIX) or <code>%APPDATA%/nim/nim.cfg</code> (Windows). This file can be skipped with the <code>--skipUserCfg</code> command line option.</li> <li>
<code>$parentDir/nim.cfg</code> where <code>$parentDir</code> stands for any parent directory of the project file's path. These files can be skipped with the <code>--skipParentCfg</code> command line option.</li> <li>
<code>$projectDir/nim.cfg</code> where <code>$projectDir</code> stands for the project file's path. This file can be skipped with the <code>--skipProjCfg</code> command line option.</li> <li>A project can also have a project specific configuration file named <code>$project.nim.cfg</code> that resides in the same directory as <code>$project.nim</code>. This file can be skipped with the <code>--skipProjCfg</code> command line option.</li> </ol> <p>Command line settings have priority over configuration file settings.</p> <p>The default build of a project is a <span id="debug-build_1">debug build</span>. To compile a <span id="release-build_1">release build</span> define the <code>release</code> symbol:</p>
<pre data-language="nim">nim c -d:release myproject.nim</pre> <h3 id="compiler-usage-search-path-handling">Search path handling</h3>
<p>Nim has the concept of a global search path (PATH) that is queried to determine where to find imported modules or include files. If multiple files are found an ambiguity error is produced.</p> <p><code>nim dump</code> shows the contents of the PATH.</p> <p>However before the PATH is used the current directory is checked for the file's existence. So if PATH contains <code>$lib</code> and <code>$lib/bar</code> and the directory structure looks like this:</p>
<pre data-language="nim">$lib/x.nim
$lib/bar/x.nim
foo/x.nim
foo/main.nim
other.nim</pre> <p>And <code>main</code> imports <code>x</code>, <code>foo/x</code> is imported. If <code>other</code> imports <code>x</code> then both <code>$lib/x.nim</code> and <code>$lib/bar/x.nim</code> match and so the compiler should reject it. Currently however this check is not implemented and instead the first matching file is used.</p> <h3 id="compiler-usage-generated-c-code-directory">Generated C code directory</h3>
<p>The generated files that Nim produces all go into a subdirectory called <code>nimcache</code>. Its full path is</p> <ul class="simple">
<li>
<code>$XDG_CACHE_HOME/nim/$projectname(_r|_d)</code> or <code>~/.cache/nim/$projectname(_r|_d)</code> on Posix</li> <li>
<code>$HOME/nimcache/$projectname(_r|_d)</code> on Windows.</li> </ul> <p>The <code>_r</code> suffix is used for release builds, <code>_d</code> is for debug builds.</p> <p>This makes it easy to delete all generated files. Files generated in this directory follow a naming logic which you can read about in the <a href="backends#nimcache-naming-logic">Nim Backend Integration document</a>.</p> <p>The <code>--nimcache</code> <a href="nimc#command-line-switches">compiler switch</a> can be used to to change the <code>nimcache</code> directory.</p> <p>However, the generated C code is not platform independent. C code generated for Linux does not compile on Windows, for instance. The comment on top of the C file lists the OS, CPU and CC the file has been compiled for.</p> <h2 id="compiler-selection">Compiler Selection</h2>
<p>To change the compiler from the default compiler (at the command line):</p>
<pre data-language="nim">nim c --cc:llvm_gcc --compile_only myfile.nim</pre> <p>This uses the configuration defined in <code>config\nim.cfg</code> for <code>lvm_gcc</code>.</p> <p>If nimcache already contains compiled code from a different compiler for the same project, add the <code>-f</code> flag to force all files to be recompiled.</p> <p>The default compiler is defined at the top of <code>config\nim.cfg</code>. Changing this setting affects the compiler used by <code>koch</code> to (re)build Nim.</p> <h2 id="cross-compilation">Cross compilation</h2>
<p>To cross compile, use for example:</p>
<pre data-language="nim">nim c --cpu:i386 --os:linux --compileOnly --genScript myproject.nim</pre> <p>Then move the C code and the compile script <code>compile_myproject.sh</code> to your Linux i386 machine and run the script.</p> <p>Another way is to make Nim invoke a cross compiler toolchain:</p>
<pre data-language="nim">nim c --cpu:arm --os:linux myproject.nim</pre> <p>For cross compilation, the compiler invokes a C compiler named like <code>$cpu.$os.$cc</code> (for example arm.linux.gcc) and the configuration system is used to provide meaningful defaults. For example for <code>ARM</code> your configuration file should contain something like:</p>
<pre data-language="nim">arm.linux.gcc.path = "/usr/bin"
arm.linux.gcc.exe = "arm-linux-gcc"
arm.linux.gcc.linkerexe = "arm-linux-gcc"</pre> <h2 id="cross-compilation-for-nintendo-switch">Cross compilation for Nintendo Switch</h2>
<p>Simply add --os:nintendoswitch to your usual <code>nim c</code> or <code>nim cpp</code> command and set the <code>passC</code> and <code>passL</code> command line switches to something like:</p> <pre class="listing" data-language="nim">nim c ... --passC="-I$DEVKITPRO/libnx/include" ...
--passL="-specs=$DEVKITPRO/libnx/switch.specs -L$DEVKITPRO/libnx/lib -lnx"</pre>
<p>or setup a nim.cfg file like so:</p> <pre class="listing" data-language="nim">#nim.cfg
--passC="-I$DEVKITPRO/libnx/include"
--passL="-specs=$DEVKITPRO/libnx/switch.specs -L$DEVKITPRO/libnx/lib -lnx"</pre>
<p>The DevkitPro setup must be the same as the default with their new installer <a href="https://github.com/devkitPro/pacman/releases">here for Mac/Linux</a> or <a href="https://github.com/devkitPro/installer/releases">here for Windows</a>.</p> <p>For example, with the above mentioned config:</p>
<pre data-language="nim">nim c --os:nintendoswitch switchhomebrew.nim</pre> <p>This will generate a file called <code>switchhomebrew.elf</code> which can then be turned into an nro file with the <code>elf2nro</code> tool in the DevkitPro release. Examples can be found at <a href="https://github.com/jyapayne/nim-libnx.git">the nim-libnx github repo</a>.</p> <p>There are a few things that don't work because the DevkitPro libraries don't support them. They are:</p> <ol class="simple">
<li>Waiting for a subprocess to finish. A subprocess can be started, but right now it can't be waited on, which sort of makes subprocesses a bit hard to use</li> <li>Dynamic calls. DevkitPro libraries have no dlopen/dlclose functions.</li> <li>Command line parameters. It doesn't make sense to have these for a console anyways, so no big deal here.</li> <li>mqueue. Sadly there are no mqueue headers.</li> <li>ucontext. No headers for these either. No coroutines for now :(</li> <li>nl_types. No headers for this.</li> </ol> <h2 id="dll-generation">DLL generation</h2>
<p>Nim supports the generation of DLLs. However, there must be only one instance of the GC per process/address space. This instance is contained in <code>nimrtl.dll</code>. This means that every generated Nim DLL depends on <code>nimrtl.dll</code>. To generate the "nimrtl.dll" file, use the command:</p>
<pre data-language="nim">nim c -d:release lib/nimrtl.nim</pre> <p>To link against <code>nimrtl.dll</code> use the command:</p>
<pre data-language="nim">nim c -d:useNimRtl myprog.nim</pre> <p><strong>Note</strong>: Currently the creation of <code>nimrtl.dll</code> with thread support has never been tested and is unlikely to work!</p> <h2 id="additional-compilation-switches">Additional compilation switches</h2>
<p>The standard library supports a growing number of <code>useX</code> conditional defines affecting how some features are implemented. This section tries to give a complete list.</p> <table>
<tr>
<th>Define</th>
<th>Effect</th>
</tr> <tr>
<td><code>release</code></td>
<td>Turns off runtime checks and turns on the optimizer.</td>
</tr> <tr>
<td><code>useWinAnsi</code></td>
<td>Modules like <code>os</code> and <code>osproc</code> use the Ansi versions of the Windows API. The default build uses the Unicode version.</td>
</tr> <tr>
<td><code>useFork</code></td>
<td>Makes <code>osproc</code> use <code>fork</code> instead of <code>posix_spawn</code>.</td>
</tr> <tr>
<td><code>useNimRtl</code></td>
<td>Compile and link against <code>nimrtl.dll</code>.</td>
</tr> <tr>
<td><code>useMalloc</code></td>
<td>Makes Nim use C's <span id="malloc_1">malloc</span> instead of Nim's own memory manager, ableit prefixing each allocation with its size to support clearing memory on reallocation. This only works with <code>gc:none</code>.</td>
</tr> <tr>
<td><code>useRealtimeGC</code></td>
<td>Enables support of Nim's GC for <em>soft</em> realtime systems. See the documentation of the <a href="gc">gc</a> for further information.</td>
</tr> <tr>
<td><code>nodejs</code></td>
<td>The JS target is actually <code>node.js</code>.</td>
</tr> <tr>
<td><code>ssl</code></td>
<td>Enables OpenSSL support for the sockets module.</td>
</tr> <tr>
<td><code>memProfiler</code></td>
<td>Enables memory profiling for the native GC.</td>
</tr> <tr>
<td><code>uClibc</code></td>
<td>Use uClibc instead of libc. (Relevant for Unix-like OSes)</td>
</tr> <tr>
<td><code>checkAbi</code></td>
<td>When using types from C headers, add checks that compare what's in the Nim file with what's in the C header (requires a C compiler with _Static_assert support, like any C11 compiler)</td>
</tr> <tr>
<td><code>tempDir</code></td>
<td>This symbol takes a string as its value, like <code>--define:tempDir:/some/temp/path</code> to override the temporary directory returned by <code>os.getTempDir()</code>. The value <strong>should</strong> end with a directory separator character. (Relevant for the Android platform)</td>
</tr> <tr>
<td><code>useShPath</code></td>
<td>This symbol takes a string as its value, like <code>--define:useShPath:/opt/sh/bin/sh</code> to override the path for the <code>sh</code> binary, in cases where it is not located in the default location <code>/bin/sh</code>.</td>
</tr> <tr>
<td><code>noSignalHandler</code></td>
<td>Disable the crash handler from <code>system.nim</code>.</td>
</tr> </table> <h2 id="additional-features">Additional Features</h2>
<p>This section describes Nim's additional features that are not listed in the Nim manual. Some of the features here only make sense for the C code generator and are subject to change.</p> <h3 id="additional-features-linedir-option">LineDir option</h3>
<p>The <code>lineDir</code> option can be turned on or off. If turned on the generated C code contains <code>#line</code> directives. This may be helpful for debugging with GDB.</p> <h3 id="additional-features-stacktrace-option">StackTrace option</h3>
<p>If the <code>stackTrace</code> option is turned on, the generated C contains code to ensure that proper stack traces are given if the program crashes or an uncaught exception is raised.</p> <h3 id="additional-features-linetrace-option">LineTrace option</h3>
<p>The <code>lineTrace</code> option implies the <code>stackTrace</code> option. If turned on, the generated C contains code to ensure that proper stack traces with line number information are given if the program crashes or an uncaught exception is raised.</p> <h3 id="additional-features-hot-code-reloading">Hot code reloading</h3>
<p><strong>Note:</strong> At the moment hot code reloading is supported only in JavaScript projects.</p> <p>The <span id="hotcodereloading_1">hotCodeReloading</span> option enables special compilation mode where changes in the code can be applied automatically to a running program. The code reloading happens at the granularity of an individual module. When a module is reloaded, Nim will preserve the state of all global variables which are initialized with a standard variable declaration in the code. All other top level code will be executed repeatedly on each reload. If you want to prevent this behavior, you can guard a block of code with the <code>once</code> construct:</p> <pre class="listing" data-language="nim">var settings = initTable[string, string]()

once:
  myInit()
  
  for k, v in loadSettings():
    settings[k] = v</pre>
<p>If you want to reset the state of a global variable on each reload, just re-assign a value anywhere within the top-level code:</p> <pre class="listing" data-language="nim">var lastReload: Time

lastReload = now()
resetProgramState()</pre>
<p><strong>Known limitations:</strong> In the JavaScript target, global variables using the <code>codegenDecl</code> pragma will be re-initialized on each reload. Please guard the initialization with a <em>once</em> block to work-around this.</p> <p><strong>Usage in JavaScript projects:</strong></p> <p>Once your code is compiled for hot reloading, you can use a framework such as <em>LiveReload &lt;http://livereload.com/&gt;</em> or <em>BrowserSync &lt;https://browsersync.io/&gt;</em> to implement the actual reloading behavior in your project.</p> <h2 id="dynliboverride">DynlibOverride</h2>
<p>By default Nim's <code>dynlib</code> pragma causes the compiler to generate <code>GetProcAddress</code> (or their Unix counterparts) calls to bind to a DLL. With the <code>dynlibOverride</code> command line switch this can be prevented and then via <code>--passL</code> the static library can be linked against. For instance, to link statically against Lua this command might work on Linux:</p>
<pre data-language="nim">nim c --dynlibOverride:lua --passL:liblua.lib program.nim</pre> <h2 id="backend-language-options">Backend language options</h2>
<p>The typical compiler usage involves using the <code>compile</code> or <code>c</code> command to transform a <code>.nim</code> file into one or more <code>.c</code> files which are then compiled with the platform's C compiler into a static binary. However there are other commands to compile to C++, Objective-C or Javascript. More details can be read in the <a href="backends">Nim Backend Integration document</a>.</p> <h2 id="nim-documentation-tools">Nim documentation tools</h2>
<p>Nim provides the <span id="doc_1">doc</span> and <span id="doc2_1">doc2</span> commands to generate HTML documentation from <code>.nim</code> source files. Only exported symbols will appear in the output. For more details <a href="docgen">see the docgen documentation</a>.</p> <h2 id="nim-idetools-integration">Nim idetools integration</h2>
<p>Nim provides language integration with external IDEs through the idetools command. See the documentation of <a href="idetools">idetools</a> for further information.</p> <h2 id="nim-for-embedded-systems">Nim for embedded systems</h2>
<p>The standard library can be avoided to a point where C code generation for 16bit micro controllers is feasible. Use the <span id="standalone_1">standalone</span> target (<code>--os:standalone</code>) for a bare bones standard library that lacks any OS features.</p> <p>To make the compiler output code for a 16bit target use the <code>--cpu:avr</code> target.</p> <p>For example, to generate code for an <span id="avr_1">AVR</span> processor use this command:</p>
<pre data-language="nim">nim c --cpu:avr --os:standalone --genScript x.nim</pre> <p>For the <code>standalone</code> target one needs to provide a file <code>panicoverride.nim</code>. See <code>tests/manyloc/standalone/panicoverride.nim</code> for an example implementation. Additionally, users should specify the amount of heap space to use with the <code>-d:StandaloneHeapSize=&lt;size&gt;</code> command line switch. Note that the total heap size will be <code>&lt;size&gt; * sizeof(float64)</code>.</p> <h2 id="nim-for-realtime-systems">Nim for realtime systems</h2>
<p>See the documentation of Nim's soft realtime <a href="gc">GC</a> for further information.</p> <h2 id="signal-handling-in-nim">Signal handling in Nim</h2>
<p>The Nim programming language has no concept of Posix's signal handling mechanisms. However, the standard library offers some rudimentary support for signal handling, in particular, segmentation faults are turned into fatal errors that produce a stack trace. This can be disabled with the <code>-d:noSignalHandler</code> switch.</p> <h2 id="optimizing-for-nim">Optimizing for Nim</h2>
<p>Nim has no separate optimizer, but the C code that is produced is very efficient. Most C compilers have excellent optimizers, so usually it is not needed to optimize one's code. Nim has been designed to encourage efficient code: The most readable code in Nim is often the most efficient too.</p> <p>However, sometimes one has to optimize. Do it in the following order:</p> <ol class="simple">
<li>switch off the embedded debugger (it is <strong>slow</strong>!)</li> <li>turn on the optimizer and turn off runtime checks</li> <li>profile your code to find where the bottlenecks are</li> <li>try to find a better algorithm</li> <li>do low-level optimizations</li> </ol> <p>This section can only help you with the last item.</p> <h3 id="optimizing-for-nim-optimizing-string-handling">Optimizing string handling</h3>
<p>String assignments are sometimes expensive in Nim: They are required to copy the whole string. However, the compiler is often smart enough to not copy strings. Due to the argument passing semantics, strings are never copied when passed to subroutines. The compiler does not copy strings that are a result from a procedure call, because the callee returns a new string anyway. Thus it is efficient to do:</p> <pre class="listing" data-language="nim">var s = procA() # assignment will not copy the string; procA allocates a new
                # string already</pre>
<p>However it is not efficient to do:</p> <pre class="listing" data-language="nim">var s = varA    # assignment has to copy the whole string into a new buffer!</pre>
<p>For <code>let</code> symbols a copy is not always necessary:</p> <pre class="listing" data-language="nim">let s = varA    # may only copy a pointer if it safe to do so</pre>
<p>If you know what you're doing, you can also mark single string (or sequence) objects as <span id="shallow_1">shallow</span>:</p> <pre class="listing" data-language="nim">var s = "abc"
shallow(s) # mark 's' as shallow string
var x = s  # now might not copy the string!</pre>
<p>Usage of <code>shallow</code> is always safe once you know the string won't be modified anymore, similar to Ruby's <span id="freeze_1">freeze</span>.</p> <p>The compiler optimizes string case statements: A hashing scheme is used for them if several different string constants are used. So code like this is reasonably efficient:</p> <pre class="listing" data-language="nim">case normalize(k.key)
of "name": c.name = v
of "displayname": c.displayName = v
of "version": c.version = v
of "os": c.oses = split(v, {';'})
of "cpu": c.cpus = split(v, {';'})
of "authors": c.authors = split(v, {';'})
of "description": c.description = v
of "app":
  case normalize(v)
  of "console": c.app = appConsole
  of "gui": c.app = appGUI
  else: quit(errorStr(p, "expected: console or gui"))
of "license": c.license = UnixToNativePath(k.value)
else: quit(errorStr(p, "unknown variable: " &amp; k.key))</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © 2006–2018 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/nimc.html" class="_attribution-link">https://nim-lang.org/docs/nimc.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>states.etcd_mod - SaltStack - W3cubDocs</title>
  
  <meta name="description" content=" New in version 2015.8.0. ">
  <meta name="keywords" content="salt, states, etcd, mod, saltstack">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/saltstack/ref/states/all/salt.states.etcd_mod.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/saltstack.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/saltstack/" class="_nav-link" title="" style="margin-left:0;">SaltStack</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>salt.states.etcd_mod</h1> <div class="section" id="manage-etcd-keys"> <h2>Manage etcd Keys</h2> <div class="versionadded"> <p><span class="versionmodified">New in version 2015.8.0.</span></p> </div> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body"> <tbody valign="top"> <tr class="field-odd field">
<th class="field-name">depends:</th>
<td class="field-body">
<ul class="first last simple"> <li>python-etcd</li> </ul> </td> </tr> </tbody> </table> <p>This state module supports setting and removing keys from etcd.</p> <div class="section" id="configuration"> <h3>Configuration</h3> <p>To work with an etcd server you must configure an etcd profile. The etcd config can be set in either the Salt Minion configuration file or in pillar:</p> <pre class="highlight-yaml notranslate" data-language="yaml">my_etd_config:
  etcd.host: 127.0.0.1
  etcd.port: 4001</pre> <p>It is technically possible to configure etcd without using a profile, but this is not considered to be a best practice, especially when multiple etcd servers or clusters are available.</p> <pre class="highlight-yaml notranslate" data-language="yaml">etcd.host: 127.0.0.1
etcd.port: 4001</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>The etcd configuration can also be set in the Salt Master config file, but in order to use any etcd configurations defined in the Salt Master config, the <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/configuration/master.html#std:conf_master-pillar_opts"><code class="xref std std-conf_master docutils literal notranslate"><span class="pre">pillar_opts</span></code></a> must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> <p class="last">Be aware that setting <code class="docutils literal notranslate"><span class="pre">pillar_opts</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> has security implications as this makes all master configuration settings available in all minion's pillars.</p> </div> <p>Etcd profile configuration can be overridden using following arguments: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>, <code class="docutils literal notranslate"><span class="pre">ca</span></code>, <code class="docutils literal notranslate"><span class="pre">client_key</span></code> and <code class="docutils literal notranslate"><span class="pre">client_cert</span></code>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">my-value:
  etcd.set:
    - name: /path/to/key
    - value: value
    - host: 127.0.0.1
    - port: 2379
    - username: user
    - password: pass</pre> </div> <div class="section" id="available-functions"> <h3>Available Functions</h3> <ul> <li>
<p class="first"><code class="docutils literal notranslate"><span class="pre">set</span></code></p> <p>This will set a value to a key in etcd. Changes will be returned if the key has been created or the value of the key has been updated. This means you can watch these states for changes.</p> <pre class="highlight-yaml notranslate" data-language="yaml">/foo/bar/baz:
  etcd.set:
    - value: foo
    - profile: my_etcd_config</pre> </li> <li>
<p class="first"><code class="docutils literal notranslate"><span class="pre">wait_set</span></code></p> <p>Performs the same functionality as <code class="docutils literal notranslate"><span class="pre">set</span></code> but only if a watch requisite is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">/some/file.txt:
  file.managed:
    - source: salt://file.txt

/foo/bar/baz:
  etcd.wait_set:
    - value: foo
    - profile: my_etcd_config
    - watch:
      - file: /some/file.txt</pre> </li> <li>
<p class="first"><code class="docutils literal notranslate"><span class="pre">rm</span></code></p> <p>This will delete a key from etcd. If the key exists then changes will be returned and thus you can watch for changes on the state, if the key does not exist then no changes will occur.</p> <pre class="highlight-yaml notranslate" data-language="yaml">/foo/bar/baz:
  etcd.rm:
    - profile: my_etcd_config</pre> </li> <li>
<p class="first"><code class="docutils literal notranslate"><span class="pre">wait_rm</span></code></p> <p>Performs the same functionality as <code class="docutils literal notranslate"><span class="pre">rm</span></code> but only if a watch requisite is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">/some/file.txt:
  file.managed:
    - source: salt://file.txt

/foo/bar/baz:
  etcd.wait_rm:
    - profile: my_etcd_config
    - watch:
      - file: /some/file.txt</pre> </li> </ul> <dl class="function"> <h3 id="salt.states.etcd_mod.directory"> salt.states.etcd_mod.directory(name, profile=None, **kwargs)</h3> <dd>
<p>Create a directory in etcd.</p> <dl class="docutils"> <dt>name</dt> <dd>The etcd directory name, for example: <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>.</dd> <dt>profile</dt> <dd>
<p class="first">Optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Sets the etcd profile to use which has been defined in the Salt Master config.</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="nt">my_etd_config</span><span class="p">:</span>
  <span class="nt">etcd.host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
  <span class="nt">etcd.port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4001</span>
</pre></div> </div> </dd> </dl> </dd>
</dl> <dl class="function"> <h3 id="salt.states.etcd_mod.mod_watch"> salt.states.etcd_mod.mod_watch(name, **kwargs)</h3> <dd>
<p>The etcd watcher, called to invoke the watch command. When called, execute a etcd function based on a watch call requisite.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>This state exists to support special handling of the <code class="docutils literal notranslate"><span class="pre">watch</span></code> <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/states/requisites.html#requisites"><span class="std std-ref">requisite</span></a>. It should not be called directly.</p> <p class="last">Parameters for this function should be set by the state being triggered.</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.states.etcd_mod.rm"> salt.states.etcd_mod.rm(name, recurse=False, profile=None, **kwargs)</h3> <dd>
<p>Deletes a key from etcd</p> <dl class="docutils"> <dt>name</dt> <dd>The etcd key name to remove, for example <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>.</dd> <dt>recurse</dt> <dd>Optional, defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. If <code class="docutils literal notranslate"><span class="pre">True</span></code> performs a recursive delete.</dd> <dt>profile</dt> <dd>
<p class="first">Optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Sets the etcd profile to use which has been defined in the Salt Master config.</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="nt">my_etd_config</span><span class="p">:</span>
  <span class="nt">etcd.host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
  <span class="nt">etcd.port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4001</span>
</pre></div> </div> </dd> </dl> </dd>
</dl> <dl class="function"> <h3 id="salt.states.etcd_mod.set_"> salt.states.etcd_mod.set_(name, value, profile=None, **kwargs)</h3> <dd>
<p>Set a key in etcd</p> <dl class="docutils"> <dt>name</dt> <dd>The etcd key name, for example: <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>.</dd> <dt>value</dt> <dd>The value the key should contain.</dd> <dt>profile</dt> <dd>
<p class="first">Optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Sets the etcd profile to use which has been defined in the Salt Master config.</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="nt">my_etd_config</span><span class="p">:</span>
  <span class="nt">etcd.host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
  <span class="nt">etcd.port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4001</span>
</pre></div> </div> </dd> </dl> </dd>
</dl> <dl class="function"> <h3 id="salt.states.etcd_mod.wait_rm"> salt.states.etcd_mod.wait_rm(name, recurse=False, profile=None, **kwargs)</h3> <dd>
<p>Deletes a key from etcd only if the watch statement calls it. This function is also aliased as <code class="docutils literal notranslate"><span class="pre">wait_rm</span></code>.</p> <dl class="docutils"> <dt>name</dt> <dd>The etcd key name to remove, for example <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>.</dd> <dt>recurse</dt> <dd>Optional, defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. If <code class="docutils literal notranslate"><span class="pre">True</span></code> performs a recursive delete, see: <a class="reference external" href="https://python-etcd.readthedocs.io/en/latest/#delete-a-key">https://python-etcd.readthedocs.io/en/latest/#delete-a-key</a>.</dd> <dt>profile</dt> <dd>
<p class="first">Optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Sets the etcd profile to use which has been defined in the Salt Master config.</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="nt">my_etd_config</span><span class="p">:</span>
  <span class="nt">etcd.host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
  <span class="nt">etcd.port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4001</span>
</pre></div> </div> </dd> </dl> </dd>
</dl> <dl class="function"> <h3 id="salt.states.etcd_mod.wait_set"> salt.states.etcd_mod.wait_set(name, value, profile=None, **kwargs)</h3> <dd>
<p>Set a key in etcd only if the watch statement calls it. This function is also aliased as <code class="docutils literal notranslate"><span class="pre">wait_set</span></code>.</p> <dl class="docutils"> <dt>name</dt> <dd>The etcd key name, for example: <code class="docutils literal notranslate"><span class="pre">/foo/bar/baz</span></code>.</dd> <dt>value</dt> <dd>The value the key should contain.</dd> <dt>profile</dt> <dd>
<p class="first">The etcd profile to use that has been configured on the Salt Master, this is optional and defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="nt">my_etd_config</span><span class="p">:</span>
  <span class="nt">etcd.host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
  <span class="nt">etcd.port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4001</span>
</pre></div> </div> </dd> </dl> </dd>
</dl> </div> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2019 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltstack.com/en/latest/ref/states/all/salt.states.etcd_mod.html" class="_attribution-link">https://docs.saltstack.com/en/latest/ref/states/all/salt.states.etcd_mod.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>pillar.makostack - SaltStack - W3cubDocs</title>
  
  <meta name="description" content=" Simple and flexible YAML ext_pillar which can read pillar from within pillar. ">
  <meta name="keywords" content="salt, pillar, makostack, module, saltstack">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/saltstack/ref/pillar/all/salt.pillar.makostack.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/saltstack.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/saltstack/" class="_nav-link" title="" style="margin-left:0;">SaltStack</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>salt.pillar.makostack module</h1> <p>Simple and flexible YAML ext_pillar which can read pillar from within pillar.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2016.3.0.</span></p> </div> <p>This custom saltstack <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> is a direct ripoff of the 'stack' ext_pillar, simply ported to use mako instead of jinja2 for templating.</p> <p>It supports the following features:</p> <ul class="simple"> <li>multiple config files that are mako templates with support for <code class="docutils literal notranslate"><span class="pre">pillar</span></code>, <code class="docutils literal notranslate"><span class="pre">__grains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__salt__</span></code>, <code class="docutils literal notranslate"><span class="pre">__opts__</span></code> objects.</li> <li>a config file renders as an ordered list of files. Unless absolute, the paths of these files are relative to the current config file - if absolute, they will be treated literally.</li> <li>this list of files are read in order as mako templates with support for <code class="docutils literal notranslate"><span class="pre">stack</span></code>, <code class="docutils literal notranslate"><span class="pre">pillar</span></code>, <code class="docutils literal notranslate"><span class="pre">__grains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__salt__</span></code>, <code class="docutils literal notranslate"><span class="pre">__opts__</span></code> objects.</li> <li>all these rendered files are then parsed as <code class="docutils literal notranslate"><span class="pre">yaml</span></code>.</li> <li>then all yaml dicts are merged in order, with support for the following. merging strategies: <code class="docutils literal notranslate"><span class="pre">merge-first</span></code>, <code class="docutils literal notranslate"><span class="pre">merge-last</span></code>, <code class="docutils literal notranslate"><span class="pre">remove</span></code>, and <code class="docutils literal notranslate"><span class="pre">overwrite</span></code>.</li> <li>stack config files can be matched based on <code class="docutils literal notranslate"><span class="pre">pillar</span></code>, <code class="docutils literal notranslate"><span class="pre">grains</span></code>, or <code class="docutils literal notranslate"><span class="pre">opts</span></code> values, which make it possible to support kind of self-contained environments.</li> </ul> <div class="section" id="configuration-in-salt"> <h2>Configuration in Salt</h2> <p>Like any other external pillar, its configuration takes place through the <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> key in the master config file.</p> <p>However, you can configure MakoStack in 3 different ways:</p> <div class="section" id="single-config-file"> <h3>Single config file</h3> <p>This is the simplest option, you just need to set the path to your single MakoStack config file like below:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">ext_pillar</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">makostack</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack</span><span class="o">.</span><span class="n">cfg</span>
</pre></div> </div> </div> <div class="section" id="list-of-config-files"> <h3>List of config files</h3> <p>You can also provide a list of config files:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">ext_pillar</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">makostack</span><span class="p">:</span>
      <span class="o">-</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack1</span><span class="o">.</span><span class="n">cfg</span>
      <span class="o">-</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack2</span><span class="o">.</span><span class="n">cfg</span>
</pre></div> </div> </div> <div class="section" id="select-config-files-through-grains-pillar-opts-matching"> <h3>Select config files through grains|pillar|opts matching</h3> <p>You can also opt for a much more flexible configuration: MakoStack allows one to select the config files for the current minion based on matching values from either grains, or pillar, or opts objects.</p> <p>Here is an example of such a configuration, which should speak by itself:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">ext_pillar</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">makostack</span><span class="p">:</span>
      <span class="n">pillar</span><span class="p">:</span><span class="n">environment</span><span class="p">:</span>
        <span class="n">dev</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">stack</span><span class="o">.</span><span class="n">cfg</span>
        <span class="n">prod</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">stack</span><span class="o">.</span><span class="n">cfg</span>
      <span class="n">grains</span><span class="p">:</span><span class="n">custom</span><span class="p">:</span><span class="n">grain</span><span class="p">:</span>
        <span class="n">value</span><span class="p">:</span>
          <span class="o">-</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack1</span><span class="o">.</span><span class="n">cfg</span>
          <span class="o">-</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack2</span><span class="o">.</span><span class="n">cfg</span>
      <span class="n">opts</span><span class="p">:</span><span class="n">custom</span><span class="p">:</span><span class="n">opt</span><span class="p">:</span>
        <span class="n">value</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">stack0</span><span class="o">.</span><span class="n">cfg</span>
</pre></div> </div> </div> <div class="section" id="grafting-data-from-files-to-arbitrary-namespaces"> <h3>Grafting data from files to arbitrary namespaces</h3> <p>An extended syntax for config files permits defining "graft points" on a per-config-file basis. As an example, if the file foo.cfg would produce the following:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">foo</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bar</span>
  <span class="o">-</span> <span class="n">baz</span>
</pre></div> </div> <p>and you specified the cfg file as /path/to/foo.cfg:yummy:fur, the following would actually end up in pillar after all merging was complete:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">yummy</span><span class="p">:</span>
  <span class="n">fur</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">bar</span>
      <span class="o">-</span> <span class="n">baz</span>
</pre></div> </div> </div> </div> <div class="section" id="makostack-configuration-files"> <h2>MakoStack configuration files</h2> <p>The config files that are referenced in the above <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> configuration are mako templates which must render as a simple ordered list of <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files that will then be merged to build pillar data.</p> <p>Unless an absolute path name is specified, the path of these <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files is assumed to be relative to the directory containing the MakoStack config file. If a path begins with '/', however, it will be treated literally and can be anywhere on the filesystem.</p> <p>The following variables are available in mako templating of makostack configuration files:</p> <ul class="simple"> <li>
<code class="docutils literal notranslate"><span class="pre">pillar</span></code>: the pillar data (as passed by Salt to our <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> function)</li> <li>
<code class="docutils literal notranslate"><span class="pre">minion_id</span></code>: the minion id ;-)</li> <li>
<code class="docutils literal notranslate"><span class="pre">__opts__</span></code>: a dictionary of mostly Salt configuration options</li> <li>
<code class="docutils literal notranslate"><span class="pre">__grains__</span></code>: a dictionary of the grains of the minion making this pillar call</li> <li>
<code class="docutils literal notranslate"><span class="pre">__salt__</span></code>: a dictionary of Salt module functions, useful so you don't have to duplicate functions that already exist (note: runs on the master)</li> </ul> <p>So you can use all the power of mako to build your list of <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files that will be merged in pillar data.</p> <p>For example, you could have a MakoStack config file which looks like:</p> <div class="code mako highlight-default notranslate">
<div class="highlight"><pre>$ cat /path/to/stack/config.cfg
core.yml
osarchs/%{ __grains__['osarch'] }}.yml
oscodenames/%{ __grains__['oscodename'] }.yml
% for role in pillar.get('roles', []):
roles/%{ role }.yml
% endfor
minions/%{ minion_id }.yml
</pre></div> </div> <p>And the whole directory structure could look like:</p> <div class="code highlight-default notranslate">
<div class="highlight"><pre>$ tree /path/to/stack/
/path/to/stack/
├── config.cfg
├── core.yml
├── osarchs/
│   ├── amd64.yml
│   └── armhf.yml
├── oscodenames/
│   ├── wheezy.yml
│   └── jessie.yml
├── roles/
│   ├── web.yml
│   └── db.yml
└── minions/
    ├── test-1-dev.yml
    └── test-2-dev.yml
</pre></div> </div> </div> <div class="section" id="overall-process"> <h2>Overall process</h2> <p>In the above MakoStack configuration, given that test-1-dev minion is an amd64 platform running Debian Jessie, and which pillar <code class="docutils literal notranslate"><span class="pre">roles</span></code> is <code class="docutils literal notranslate"><span class="pre">["db"]</span></code>, the following <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files would be merged in order:</p> <ul class="simple"> <li><code class="docutils literal notranslate"><span class="pre">core.yml</span></code></li> <li><code class="docutils literal notranslate"><span class="pre">osarchs/amd64.yml</span></code></li> <li><code class="docutils literal notranslate"><span class="pre">oscodenames/jessie.yml</span></code></li> <li><code class="docutils literal notranslate"><span class="pre">roles/db.yml</span></code></li> <li><code class="docutils literal notranslate"><span class="pre">minions/test-1-dev.yml</span></code></li> </ul> <p>Before merging, every files above will be preprocessed as mako templates. The following variables are available in mako templating of <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files:</p> <ul class="simple"> <li>
<code class="docutils literal notranslate"><span class="pre">stack</span></code>: the MakoStack pillar data object that has currently been merged (data from previous <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files in MakoStack configuration)</li> <li>
<code class="docutils literal notranslate"><span class="pre">pillar</span></code>: the pillar data (as passed by Salt to our <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> function)</li> <li>
<code class="docutils literal notranslate"><span class="pre">minion_id</span></code>: the minion id ;-)</li> <li>
<code class="docutils literal notranslate"><span class="pre">__opts__</span></code>: a dictionary of mostly Salt configuration options</li> <li>
<code class="docutils literal notranslate"><span class="pre">__grains__</span></code>: a dictionary of the grains of the minion making this pillar call</li> <li>
<code class="docutils literal notranslate"><span class="pre">__salt__</span></code>: a dictionary of Salt module functions, useful so you don't have to duplicate functions that already exist (note: runs on the master)</li> </ul> <p>So you can use all the power of mako to build your pillar data, and even use other pillar values that has already been merged by MakoStack (from previous <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files in MakoStack configuration) through the <code class="docutils literal notranslate"><span class="pre">stack</span></code> variable.</p> <p>Once a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> file has been preprocessed by mako, we obtain a Python dict - let's call it <code class="docutils literal notranslate"><span class="pre">yml_data</span></code> - then, MakoStack will merge this <code class="docutils literal notranslate"><span class="pre">yml_data</span></code> dict in the main <code class="docutils literal notranslate"><span class="pre">stack</span></code> dict (which contains already merged MakoStack pillar data). By default, MakoStack will deeply merge <code class="docutils literal notranslate"><span class="pre">yml_data</span></code> in <code class="docutils literal notranslate"><span class="pre">stack</span></code> (similarly to the <code class="docutils literal notranslate"><span class="pre">recurse</span></code> salt <code class="docutils literal notranslate"><span class="pre">pillar_source_merging_strategy</span></code>), but 3 merging strategies are currently available for you to choose (see next section).</p> <p>Once every <code class="docutils literal notranslate"><span class="pre">yaml</span></code> files have been processed, the <code class="docutils literal notranslate"><span class="pre">stack</span></code> dict will contain your whole own pillar data, merged in order by MakoStack. So MakoStack <code class="docutils literal notranslate"><span class="pre">ext_pillar</span></code> returns the <code class="docutils literal notranslate"><span class="pre">stack</span></code> dict, the contents of which Salt takes care to merge in with all of the other pillars and finally return the whole pillar to the minion.</p> </div> <div class="section" id="merging-strategies"> <h2>Merging strategies</h2> <p>The way the data from a new <code class="docutils literal notranslate"><span class="pre">yaml_data</span></code> dict is merged with the existing <code class="docutils literal notranslate"><span class="pre">stack</span></code> data can be controlled by specifying a merging strategy. Right now this strategy can either be <code class="docutils literal notranslate"><span class="pre">merge-last</span></code> (the default), <code class="docutils literal notranslate"><span class="pre">merge-first</span></code>, <code class="docutils literal notranslate"><span class="pre">remove</span></code>, or <code class="docutils literal notranslate"><span class="pre">overwrite</span></code>.</p> <p>Note that scalar values like strings, integers, booleans, etc. are always evaluated using the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> strategy (other strategies don't make sense in that case).</p> <p>The merging strategy can be set by including a dict in the form of:</p> <div class="code yaml highlight-default notranslate">
<div class="highlight"><pre><span class="n">__</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">merging</span> <span class="n">strategy</span><span class="o">&gt;</span>
</pre></div> </div> <p>as the first item of the dict or list. This allows fine grained control over the merging process.</p> <div class="section" id="merge-last-default-strategy"> <h3>
<code class="docutils literal notranslate"><span class="pre">merge-last</span></code> (default) strategy</h3> <p>If the <code class="docutils literal notranslate"><span class="pre">merge-last</span></code> strategy is selected (the default), then content of dict or list variables is merged recursively with previous definitions of this variable (similarly to the <code class="docutils literal notranslate"><span class="pre">recurse</span></code> salt <code class="docutils literal notranslate"><span class="pre">pillar_source_merging_strategy</span></code>). This allows for extending previously defined data.</p> </div> <div class="section" id="merge-first-strategy"> <h3>
<code class="docutils literal notranslate"><span class="pre">merge-first</span></code> strategy</h3> <p>If the <code class="docutils literal notranslate"><span class="pre">merge-first</span></code> strategy is selected, then the content of dict or list variables are swapped between the <code class="docutils literal notranslate"><span class="pre">yaml_data</span></code> and <code class="docutils literal notranslate"><span class="pre">stack</span></code> objects before being merged recursively with the <code class="docutils literal notranslate"><span class="pre">merge-last</span></code> previous strategy.</p> </div> <div class="section" id="remove-strategy"> <h3>
<code class="docutils literal notranslate"><span class="pre">remove</span></code> strategy</h3> <p>If the <code class="docutils literal notranslate"><span class="pre">remove</span></code> strategy is selected, then content of dict or list variables in <code class="docutils literal notranslate"><span class="pre">stack</span></code> are removed only if the corresponding item is present in the <code class="docutils literal notranslate"><span class="pre">yaml_data</span></code> dict. This allows for removing items from previously defined data.</p> </div> <div class="section" id="overwrite-strategy"> <h3>
<code class="docutils literal notranslate"><span class="pre">overwrite</span></code> strategy</h3> <p>If the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> strategy is selected, then the content of dict or list variables in <code class="docutils literal notranslate"><span class="pre">stack</span></code> is overwritten by the content of <code class="docutils literal notranslate"><span class="pre">yaml_data</span></code> dict. So this allows one to overwrite variables from previous definitions.</p> </div> </div> <div class="section" id="merging-examples"> <h2>Merging examples</h2> <p>Let's go through small examples that should clarify what's going on when a <code class="docutils literal notranslate"><span class="pre">yaml_data</span></code> dict is merged in the <code class="docutils literal notranslate"><span class="pre">stack</span></code> dict.</p> <p>When you don't specify any strategy, the default <code class="docutils literal notranslate"><span class="pre">merge-last</span></code> strategy is selected:</p> <table border="1" class="docutils"> <colgroup> <col width="31%"> <col width="33%"> <col width="36%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head"><code class="docutils literal notranslate"><span class="pre">stack</span></code></th> <th class="head"><code class="docutils literal notranslate"><span class="pre">yaml_data</span></code></th> <th class="head">
<code class="docutils literal notranslate"><span class="pre">stack</span></code> (after merge)</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> </tr> </tbody> </table> <p>Then you can select a custom merging strategy using the <code class="docutils literal notranslate"><span class="pre">__</span></code> key in a dict:</p> <table border="1" class="docutils"> <colgroup> <col width="31%"> <col width="33%"> <col width="36%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head"><code class="docutils literal notranslate"><span class="pre">stack</span></code></th> <th class="head"><code class="docutils literal notranslate"><span class="pre">yaml_data</span></code></th> <th class="head">
<code class="docutils literal notranslate"><span class="pre">stack</span></code> (after merge)</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">__</span><span class="p">:</span> <span class="n">merge</span><span class="o">-</span><span class="n">last</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> </tr> <tr class="row-odd">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">__</span><span class="p">:</span> <span class="n">merge</span><span class="o">-</span><span class="n">first</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> </tr> <tr class="row-even">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">__</span><span class="p">:</span> <span class="n">remove</span>
  <span class="n">tom</span><span class="p">:</span>
  <span class="n">mat</span><span class="p">:</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> </tr> <tr class="row-odd">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">500</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">sysadmin</span>
  <span class="n">root</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">0</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">__</span><span class="p">:</span> <span class="n">overwrite</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="n">tom</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="n">roles</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">developer</span>
  <span class="n">mat</span><span class="p">:</span>
    <span class="n">uid</span><span class="p">:</span> <span class="mi">1001</span>
</pre></div> </div> </td> </tr> </tbody> </table> <p>You can also select a custom merging strategy using a <code class="docutils literal notranslate"><span class="pre">__</span></code> object in a list:</p> <table border="1" class="docutils"> <colgroup> <col width="24%"> <col width="38%"> <col width="38%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head"><code class="docutils literal notranslate"><span class="pre">stack</span></code></th> <th class="head"><code class="docutils literal notranslate"><span class="pre">yaml_data</span></code></th> <th class="head">
<code class="docutils literal notranslate"><span class="pre">stack</span></code> (after merge)</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">__</span><span class="p">:</span> <span class="n">merge</span><span class="o">-</span><span class="n">last</span>
  <span class="o">-</span> <span class="n">mat</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
  <span class="o">-</span> <span class="n">mat</span>
</pre></div> </div> </td> </tr> <tr class="row-odd">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">__</span><span class="p">:</span> <span class="n">merge</span><span class="o">-</span><span class="n">first</span>
  <span class="o">-</span> <span class="n">mat</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">mat</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> </tr> <tr class="row-even">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">__</span><span class="p">:</span> <span class="n">remove</span>
  <span class="o">-</span> <span class="n">mat</span>
  <span class="o">-</span> <span class="n">tom</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> </tr> <tr class="row-odd">
<td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">tom</span>
  <span class="o">-</span> <span class="n">root</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">__</span><span class="p">:</span> <span class="n">overwrite</span>
  <span class="o">-</span> <span class="n">mat</span>
</pre></div> </div> </td> <td>
<div class="code yaml first last highlight-default notranslate">
<div class="highlight"><pre><span class="n">users</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">mat</span>
</pre></div> </div> </td> </tr> </tbody> </table> <dl class="function"> <h3 id="salt.pillar.makostack.ext_pillar"> salt.pillar.makostack.ext_pillar(minion_id, pillar, *args, **kwargs)</h3> 
</dl> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2019 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltstack.com/en/latest/ref/pillar/all/salt.pillar.makostack.html" class="_attribution-link">https://docs.saltstack.com/en/latest/ref/pillar/all/salt.pillar.makostack.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

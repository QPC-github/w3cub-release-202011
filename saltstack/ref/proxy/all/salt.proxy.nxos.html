
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>proxy.nxos - SaltStack - W3cubDocs</title>
  
  <meta name="description" content=" Proxy Minion for Cisco NX OS Switches ">
  <meta name="keywords" content="salt, proxy, nxos, module, saltstack">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/saltstack/ref/proxy/all/salt.proxy.nxos.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/saltstack.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/saltstack/" class="_nav-link" title="" style="margin-left:0;">SaltStack</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>salt.proxy.nxos module</h1> <p>Proxy Minion for Cisco NX OS Switches</p> <p>The Cisco NX OS Proxy Minion uses the built in SSHConnection module in <code class="xref py py-mod docutils literal notranslate"><span class="pre">salt.utils.vt_helper</span></code></p> <p>To configure the proxy minion:</p> <pre class="highlight-yaml notranslate" data-language="yaml">proxy:
  proxytype: nxos
  host: 192.168.187.100
  username: admin
  password: admin
  prompt_name: switch
  ssh_args: '-o PubkeyAuthentication=no'
  key_accept: True</pre> <dl class="docutils"> <dt>proxytype</dt> <dd>(REQUIRED) Use this proxy minion <cite>nxos</cite>
</dd> <dt>host</dt> <dd>(REQUIRED) ip address or hostname to connect to</dd> <dt>username</dt> <dd>(REQUIRED) username to login with</dd> <dt>password</dt> <dd>(REQUIRED) password to use to login with</dd> <dt>prompt_name</dt> <dd>(REQUIRED, this or <cite>prompt_regex</cite> below, but not both) The name in the prompt on the switch. Recommended to use your device's hostname.</dd> <dt>prompt_regex</dt> <dd>
<p class="first">(REQUIRED, this or <cite>prompt_name</cite> above, but not both) A regular expression that matches the prompt on the switch and any other possible prompt at which you need the proxy minion to continue sending input. This feature was specifically developed for situations where the switch may ask for confirmation. <cite>prompt_name</cite> above would not match these, and so the session would timeout.</p> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">dc01-switch-01#.*|\(y\/n\)\?.*</pre> <p>This should match</p> <pre class="highlight-shell notranslate" data-language="shell">dc01-switch-01#</pre> <p>or</p> <pre class="highlight-shell notranslate" data-language="shell">Flash complete.  Reboot this switch (y/n)? [n]</pre> <p>If neither <cite>prompt_name</cite> nor <cite>prompt_regex</cite> is specified the prompt will be defaulted to</p> <pre class="highlight-shell notranslate" data-language="shell">.+#$</pre> <p class="last">which should match any number of characters followed by a <cite>#</cite> at the end of the line. This may be far too liberal for most installations.</p> </dd> <dt>ssh_args</dt> <dd>Any extra args to use to connect to the switch.</dd> <dt>key_accept</dt> <dd>Whether or not to accept a the host key of the switch on initial login. Defaults to False.</dd> </dl> <p>The functions from the proxy minion can be run from the salt commandline using the <a class="reference internal" href="../../modules/all/salt.modules.nxos#module-salt.modules.nxos" title="salt.modules.nxos"><code class="xref py py-mod docutils literal notranslate"><span class="pre">salt.modules.nxos</span></code></a> execution module.</p> <dl class="function"> <h3 id="salt.proxy.nxos.add_config"> salt.proxy.nxos.add_config(lines)</h3> <dd>
<p>Add one or more config lines to the switch running config</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd add_config 'snmp-server community TESTSTRINGHERE group network-operator'</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">For more than one config added per command, lines should be a list.</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.check_password"> salt.proxy.nxos.check_password(username, password, encrypted=False)</h3> <dd>
<p>Check if passed password is the one assigned to user</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.check_role"> salt.proxy.nxos.check_role(username, role)</h3> <dd>
<p>Check if user is assigned a specific role on switch</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd check_role username=admin role=network-admin</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.delete_config"> salt.proxy.nxos.delete_config(lines)</h3> <dd>
<p>Delete one or more config lines to the switch running config</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd delete_config 'snmp-server community TESTSTRINGHERE group network-operator'</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">For more than one config deleted per command, lines should be a list.</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.find"> salt.proxy.nxos.find(pattern)</h3> <dd>
<p>Find all instances where the pattern is in the running command</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd find '^snmp-server.*$'</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This uses the <cite>re.MULTILINE</cite> regex format for python, and runs the regex against the whole show_run output.</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.get_roles"> salt.proxy.nxos.get_roles(username)</h3> <dd>
<p>Get roles that the username is assigned from switch</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.get_user"> salt.proxy.nxos.get_user(username)</h3> <dd>
<p>Get username line from switch</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.grains"> salt.proxy.nxos.grains()</h3> <dd>
<p>Get grains for proxy minion</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.grains_refresh"> salt.proxy.nxos.grains_refresh()</h3> <dd>
<p>Refresh the grains from the proxy device.</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.init"> salt.proxy.nxos.init(opts=None)</h3> <dd>
<p>Required. Can be used to initialize the server connection.</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.initialized"> salt.proxy.nxos.initialized()</h3> 
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.ping"> salt.proxy.nxos.ping()</h3> <dd>
<p>Ping the device on the other end of the connection</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.remove_user"> salt.proxy.nxos.remove_user(username)</h3> <dd>
<p>Remove user from switch</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd remove_user username=daniel</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.replace"> salt.proxy.nxos.replace(old_value, new_value, full_match=False)</h3> <dd>
<p>Replace string or full line matches in switch's running config</p> <p>If full_match is set to True, then the whole line will need to be matched as part of the old value.</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd replace 'TESTSTRINGHERE' 'NEWTESTSTRINGHERE'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.sendline"> salt.proxy.nxos.sendline(command)</h3> <dd>
<p>Run command through switch's cli</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.set_password"> salt.proxy.nxos.set_password(username, password, encrypted=False, role=None, crypt_salt=None, algorithm='sha256')</h3> <dd>
<p>Set users password on switch</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd set_password admin TestPass
salt '*' nxos.cmd set_password admin \
    password='$5$2fWwO2vK$s7.Hr3YltMNHuhywQQ3nfOd.gAPHgs3SOBYYdGT3E.A' \
    encrypted=True</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.set_role"> salt.proxy.nxos.set_role(username, role)</h3> <dd>
<p>Assign role to username</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd set_role username=daniel role=vdc-admin</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.show_run"> salt.proxy.nxos.show_run()</h3> <dd>
<p>Shortcut to run <cite>show run</cite> on switch</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd show_run</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.show_ver"> salt.proxy.nxos.show_ver()</h3> <dd>
<p>Shortcut to run <cite>show ver</cite> on switch</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd show_ver</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.shutdown"> salt.proxy.nxos.shutdown(opts)</h3> <dd>
<p>Disconnect</p> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.system_info"> salt.proxy.nxos.system_info()</h3> <dd>
<p>Return system information for grains of the NX OS proxy minion</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.system_info</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.proxy.nxos.unset_role"> salt.proxy.nxos.unset_role(username, role)</h3> <dd>
<p>Remove role from username</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nxos.cmd unset_role username=daniel role=vdc-admin</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2019 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltstack.com/en/latest/ref/proxy/all/salt.proxy.nxos.html" class="_attribution-link">https://docs.saltstack.com/en/latest/ref/proxy/all/salt.proxy.nxos.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>modules.file - SaltStack - W3cubDocs</title>
  
  <meta name="description" content=" Manage information about regular files, directories, and special files on the minion, set&#47;read user, group, mode, and data ">
  <meta name="keywords" content="salt, modules, file, saltstack">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/saltstack/ref/modules/all/salt.modules.file.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/saltstack.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/saltstack/" class="_nav-link" title="" style="margin-left:0;">SaltStack</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>salt.modules.file</h1> <p>Manage information about regular files, directories, and special files on the minion, set/read user, group, mode, and data</p> <dl class="function"> <h3 id="salt.modules.file.access"> salt.modules.file.access(path, mode)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Test whether the Salt process has the specified access to the file. One of the following modes must be specified:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.access /path/to/file f
salt '*' file.access /path/to/file x</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.append"> salt.modules.file.append(path, *args, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.9.5.</span></p> </div> <p>Append text to the end of a file</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt><cite>*args</cite></dt> <dd>strings to append to file</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.append /etc/motd \
        "With all thine offerings thou shalt offer salt." \
        "Salt is what makes things taste bad when it isn't in them."</pre> <div class="admonition-attention admonition"> <p class="first admonition-title">Attention</p> <p>If you need to pass a string to append and that string contains an equal sign, you <strong>must</strong> include the argument name, args. For example:</p> <div class="last highlight-bash notranslate">
<div class="highlight"><pre>salt <span class="s1">'*'</span> file.append /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s1">'cheese=spam'</span>

salt <span class="s1">'*'</span> file.append /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s2">"['cheese=spam','spam=cheese']"</span>
</pre></div> </div> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.apply_template_on_contents"> salt.modules.file.apply_template_on_contents(contents, template, context, defaults, saltenv)</h3> <dd>
<p>Return the contents after applying the templating engine</p> <dl class="docutils"> <dt>contents</dt> <dd>template string</dd> <dt>template</dt> <dd>template format</dd> <dt>context</dt> <dd>Overrides default context variables passed to the template.</dd> <dt>defaults</dt> <dd>Default context passed to the template.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.apply_template_on_contents \
    contents='This is a {{ template }} string.' \
    template=jinja \
    "context={}" "defaults={'template': 'cool'}" \
    saltenv=base</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.basename"> salt.modules.file.basename(path)</h3> <dd>
<p>Returns the final component of a pathname</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>This can be useful at the CLI but is frequently useful when scripting.</p> <pre class="highlight-jinja notranslate" data-language="jinja">{%- set filename = salt['file.basename'](source_file) %}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.basename 'test/test.config'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.blockreplace"> salt.modules.file.blockreplace(path, marker_start='#-- start managed zone --', marker_end='#-- end managed zone --', content='', append_if_not_found=False, prepend_if_not_found=False, backup='.bak', dry_run=False, show_changes=True, append_newline=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Replace content of a text block in a file, delimited by line markers</p> <p>A block of content delimited by comments can help you manage several lines entries without worrying about old entries removal.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This function will store two copies of the file in-memory (the original version and the edited version) in order to detect changes and only edit the targeted file if necessary.</p> </div> <dl class="docutils"> <dt>path</dt> <dd>Filesystem path to the file to be edited</dd> <dt>marker_start</dt> <dd>The line content identifying a line as the start of the content block. Note that the whole line containing this marker will be considered, so whitespace or extra content before or after the marker is included in final output</dd> <dt>marker_end</dt> <dd>The line content identifying the end of the content block. As of versions 2017.7.5 and 2018.3.1, everything up to the text matching the marker will be replaced, so it's important to ensure that your marker includes the beginning of the text you wish to replace.</dd> <dt>content</dt> <dd>The content to be used between the two lines identified by marker_start and marker_stop.</dd> <dt>append_if_not_found <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>If markers are not found and set to <code class="docutils literal notranslate"><span class="pre">True</span></code> then, the markers and content will be appended to the file.</dd> <dt>prepend_if_not_found <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>If markers are not found and set to <code class="docutils literal notranslate"><span class="pre">True</span></code> then, the markers and content will be prepended to the file.</dd> <dt>backup</dt> <dd>The file extension to use for a backup of the file if any edit is made. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to skip making a backup.</dd> <dt>dry_run <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not make any edits to the file and simply return the changes that <em>would</em> be made.</dd> <dt>show_changes <span class="classifier-delimiter">:</span> <span class="classifier">True</span>
</dt> <dd>Controls how changes are presented. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function will return a unified diff of the changes made. If False, then it will return a boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if any changes were made, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>).</dd> <dt>append_newline <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<p class="first">Controls whether or not a newline is appended to the content block. If the value of this argument is <code class="docutils literal notranslate"><span class="pre">True</span></code> then a newline will be added to the content block. If it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then a newline will <em>not</em> be added to the content block. If it is <code class="docutils literal notranslate"><span class="pre">None</span></code> then a newline will only be added to the content block if it does not already end in a newline.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2016.3.4.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2017.7.5,2018.3.1: </span>New behavior added when value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p> </div> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 2019.2.0: </span>The default value of this argument will change to <code class="docutils literal notranslate"><span class="pre">None</span></code> to match the behavior of the <a class="reference internal" href="../../states/all/salt.states.file#salt.states.file.blockreplace" title="salt.states.file.blockreplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">file.blockreplace</span> <span class="pre">state</span></code></a></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.blockreplace /etc/hosts '#-- start managed zone foobar : DO NOT EDIT --' \
'#-- end managed zone foobar --' $'10.0.1.1 foo.foobar\n10.0.1.2 bar.foobar' True</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.chattr"> salt.modules.file.chattr(*files, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> <p>Change the attributes of files. This function accepts one or more files and the following options:</p> <dl class="docutils"> <dt>operator</dt> <dd>Can be wither <code class="docutils literal notranslate"><span class="pre">add</span></code> or <code class="docutils literal notranslate"><span class="pre">remove</span></code>. Determines whether attributes should be added or removed from files</dd> <dt>attributes</dt> <dd>One or more of the following characters: <code class="docutils literal notranslate"><span class="pre">aAcCdDeijPsStTu</span></code>, representing attributes to add to/remove from files</dd> <dt>version</dt> <dd>a version number to assign to the file(s)</dd> <dt>flags</dt> <dd>One or more of the following characters: <code class="docutils literal notranslate"><span class="pre">RVf</span></code>, representing flags to assign to chattr (recurse, verbose, suppress most errors)</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.chattr foo1.txt foo2.txt operator=add attributes=ai
salt '*' file.chattr foo3.txt operator=remove attributes=i version=2</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.check_file_meta"> salt.modules.file.check_file_meta(name, sfn, source, source_sum, user, group, mode, attrs, saltenv, contents=None)</h3> <dd>
<p>Check for the changes in the file metadata.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.check_file_meta /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' root, root, '755' base</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Supported hash types include sha512, sha384, sha256, sha224, sha1, and md5.</p> </div> <dl class="docutils"> <dt>name</dt> <dd>Path to file destination</dd> <dt>sfn</dt> <dd>Template-processed source file contents</dd> <dt>source</dt> <dd>URL to file source</dd> <dt>source_sum</dt> <dd>
<p class="first">File checksum information as a dictionary</p> <div class="last highlight-yaml notranslate">
<div class="highlight"><pre><span class="p p-Indicator">{</span><span class="nt">hash_type</span><span class="p">:</span> <span class="nv">md5</span><span class="p p-Indicator">,</span><span class="nt"> hsum</span><span class="p">:</span> <span class="nv">&lt;md5sum&gt;</span><span class="p p-Indicator">}</span>
</pre></div> </div> </dd> <dt>user</dt> <dd>Destination file user owner</dd> <dt>group</dt> <dd>Destination file group owner</dd> <dt>mode</dt> <dd>Destination file permissions mode</dd> <dt>attrs</dt> <dd>
<p class="first">Destination file attributes</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> <dt>saltenv</dt> <dd>Salt environment used to resolve source files</dd> <dt>contents</dt> <dd>File contents</dd> </dl> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.check_hash"> salt.modules.file.check_hash(path, file_hash)</h3> <dd>
<p>Check if a file matches the given hash string</p> <p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the hash matches, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> <dl class="docutils"> <dt>path</dt> <dd>Path to a file local to the minion.</dd> <dt>hash</dt> <dd>
<p class="first">The hash to check against the file specified in the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument.</p> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2016.11.4.</span></p> </div> <p class="last">For this and newer versions the hash can be specified without an accompanying hash type (e.g. <code class="docutils literal notranslate"><span class="pre">e138491e9d5b97023cea823fe17bac22</span></code>), but for earlier releases it is necessary to also specify the hash type in the format <code class="docutils literal notranslate"><span class="pre">&lt;hash_type&gt;=&lt;hash_value&gt;</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">md5=e138491e9d5b97023cea823fe17bac22</span></code>).</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.check_hash /etc/fstab e138491e9d5b97023cea823fe17bac22
salt '*' file.check_hash /etc/fstab md5=e138491e9d5b97023cea823fe17bac22</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.check_managed"> salt.modules.file.check_managed(name, source, source_hash, source_hash_name, user, group, mode, attrs, template, context, defaults, saltenv, contents=None, skip_verify=False, **kwargs)</h3> <dd>
<p>Check to see what changes need to be made for a file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.check_managed /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' root, root, '755' jinja True None None base</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.check_managed_changes"> salt.modules.file.check_managed_changes(name, source, source_hash, source_hash_name, user, group, mode, attrs, template, context, defaults, saltenv, contents=None, skip_verify=False, keep_mode=False, **kwargs)</h3> <dd>
<p>Return a dictionary of what changes need to be made for a file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.check_managed_changes /etc/httpd/conf.d/httpd.conf salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' root, root, '755' jinja True None None base</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.check_perms"> salt.modules.file.check_perms(name, ret, user, group, mode, attrs=None, follow_symlinks=False)</h3> <dd>
<p>Check the permissions on files, modify attributes and chown if needed. File attributes are only verified if lsattr(1) is installed.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.check_perms /etc/sudoers '{}' root root 400 ai</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2014.1.3: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.chgrp"> salt.modules.file.chgrp(path, group)</h3> <dd>
<p>Change the group of a file</p> <dl class="docutils"> <dt>path</dt> <dd>path to the file or directory</dd> <dt>group</dt> <dd>group owner</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.chgrp /etc/passwd root</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.chown"> salt.modules.file.chown(path, user, group)</h3> <dd>
<p>Chown a file, pass the file the desired user and group</p> <dl class="docutils"> <dt>path</dt> <dd>path to the file or directory</dd> <dt>user</dt> <dd>user owner</dd> <dt>group</dt> <dd>group owner</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.chown /etc/passwd root root</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.comment"> salt.modules.file.comment(path, regex, char='#', backup='.bak')</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.replace" title="salt.modules.file.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> instead.</p> </div> <p>Comment out specified lines in a file</p> <dl class="docutils"> <dt>path</dt> <dd>The full path to the file to be edited</dd> <dt>regex</dt> <dd>A regular expression used to find the lines that are to be commented; this pattern will be wrapped in parenthesis and will move any preceding/trailing <code class="docutils literal notranslate"><span class="pre">^</span></code> or <code class="docutils literal notranslate"><span class="pre">$</span></code> characters outside the parenthesis (e.g., the pattern <code class="docutils literal notranslate"><span class="pre">^foo$</span></code> will be rewritten as <code class="docutils literal notranslate"><span class="pre">^(foo)$</span></code>)</dd> <dt>char <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">#</span></code></span>
</dt> <dd>The character to be inserted at the beginning of a line in order to comment it out</dd> <dt>backup <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">.bak</span></code></span>
</dt> <dd>
<p class="first">The file will be backed up before edit with this file extension</p> <div class="last admonition warning"> <p class="first admonition-title">Warning</p> <p class="last">This backup will be overwritten each time <code class="docutils literal notranslate"><span class="pre">sed</span></code> / <code class="docutils literal notranslate"><span class="pre">comment</span></code> / <code class="docutils literal notranslate"><span class="pre">uncomment</span></code> is called. Meaning the backup will only be useful after the first invocation.</p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.comment /etc/modules pcspkr</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.comment_line"> salt.modules.file.comment_line(path, regex, char='#', cmnt=True, backup='.bak')</h3> <dd>
<p>Comment or Uncomment a line in a text file.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body"> <tbody valign="top"> <tr class="field-odd field">
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>path</strong> -- string The full path to the text file.</li> <li>
<strong>regex</strong> -- string A regex expression that begins with <code class="docutils literal notranslate"><span class="pre">^</span></code> that will find the line you wish to comment. Can be as simple as <code class="docutils literal notranslate"><span class="pre">^color</span> <span class="pre">=</span></code>
</li> <li>
<strong>char</strong> -- string The character used to comment a line in the type of file you're referencing. Default is <code class="docutils literal notranslate"><span class="pre">#</span></code>
</li> <li>
<strong>cmnt</strong> -- boolean True to comment the line. False to uncomment the line. Default is True.</li> <li>
<strong>backup</strong> -- string The file extension to give the backup file. Default is <code class="docutils literal notranslate"><span class="pre">.bak</span></code> Set to False/None to not keep a backup.</li> </ul> </td> </tr> <tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last">boolean Returns True if successful, False if not</p> </td> </tr> </tbody> </table> <p>CLI Example:</p> <p>The following example will comment out the <code class="docutils literal notranslate"><span class="pre">pcspkr</span></code> line in the <code class="docutils literal notranslate"><span class="pre">/etc/modules</span></code> file using the default <code class="docutils literal notranslate"><span class="pre">#</span></code> character and create a backup file named <code class="docutils literal notranslate"><span class="pre">modules.bak</span></code></p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.comment_line '/etc/modules' '^pcspkr'</pre> <p>CLI Example:</p> <p>The following example will uncomment the <code class="docutils literal notranslate"><span class="pre">log_level</span></code> setting in <code class="docutils literal notranslate"><span class="pre">minion</span></code> config file if it is set to either <code class="docutils literal notranslate"><span class="pre">warning</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code>, or <code class="docutils literal notranslate"><span class="pre">debug</span></code> using the <code class="docutils literal notranslate"><span class="pre">#</span></code> character and create a backup file named <code class="docutils literal notranslate"><span class="pre">minion.bk</span></code></p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.comment_line 'C:\salt\conf\minion' '^log_level: (warning|info|debug)' '#' False '.bk'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.contains"> salt.modules.file.contains(path, text)</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.search" title="salt.modules.file.search"><code class="xref py py-func docutils literal notranslate"><span class="pre">search()</span></code></a> instead.</p> </div> <p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the file at <code class="docutils literal notranslate"><span class="pre">path</span></code> contains <code class="docutils literal notranslate"><span class="pre">text</span></code></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.contains /etc/crontab 'mymaintenance.sh'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.contains_glob"> salt.modules.file.contains_glob(path, glob_expr)</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.search" title="salt.modules.file.search"><code class="xref py py-func docutils literal notranslate"><span class="pre">search()</span></code></a> instead.</p> </div> <p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the given glob matches a string in the named file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.contains_glob /etc/foobar '*cheese*'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.contains_regex"> salt.modules.file.contains_regex(path, regex, lchar='')</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.search" title="salt.modules.file.search"><code class="xref py py-func docutils literal notranslate"><span class="pre">search()</span></code></a> instead.</p> </div> <p>Return True if the given regular expression matches on any line in the text of a given file.</p> <p>If the lchar argument (leading char) is specified, it will strip <cite>lchar</cite> from the left side of each line before trying to match</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.contains_regex /etc/crontab</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.copy"> salt.modules.file.copy(src, dst, recurse=False, remove_existing=False)</h3> <dd>
<p>Copy a file or directory from source to dst</p> <p>In order to copy a directory, the recurse flag is required, and will by default overwrite files in the destination with the same path, and retain all other existing files. (similar to cp -r on unix)</p> <p>remove_existing will remove all files in the target directory, and then copy files from the source.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The copy function accepts paths that are local to the Salt minion. This function does not support salt://, http://, or the other additional file paths that are supported by <a class="reference internal" href="../../states/all/salt.states.file#salt.states.file.managed" title="salt.states.file.managed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">states.file.managed</span></code></a> and <a class="reference internal" href="../../states/all/salt.states.file#salt.states.file.recurse" title="salt.states.file.recurse"><code class="xref py py-mod docutils literal notranslate"><span class="pre">states.file.recurse</span></code></a>.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.copy /path/to/src /path/to/dst
salt '*' file.copy /path/to/src_dir /path/to/dst_dir recurse=True
salt '*' file.copy /path/to/src_dir /path/to/dst_dir recurse=True remove_existing=True</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.delete_backup"> salt.modules.file.delete_backup(path, backup_id)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Delete a previous version of a file that was backed up using Salt's <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/states/backup_mode.html#file-state-backups"><span class="std std-ref">file state backup</span></a> system.</p> <dl class="docutils"> <dt>path</dt> <dd>The path on the minion to check for backups</dd> <dt>backup_id</dt> <dd>The numeric id for the backup you wish to delete, as found using <a class="reference internal" href="#salt.modules.file.list_backups" title="salt.modules.file.list_backups"><code class="xref py py-mod docutils literal notranslate"><span class="pre">file.list_backups</span></code></a>
</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.delete_backup /var/cache/salt/minion/file_backup/home/foo/bar/baz.txt 0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.directory_exists"> salt.modules.file.directory_exists(path)</h3> <dd>
<p>Tests to see if path is a valid directory. Returns True/False.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.directory_exists /etc</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.dirname"> salt.modules.file.dirname(path)</h3> <dd>
<p>Returns the directory component of a pathname</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>This can be useful at the CLI but is frequently useful when scripting.</p> <pre class="highlight-jinja notranslate" data-language="jinja">{%- from salt['file.dirname'](tpldir) + '/vars.jinja' import parent_vars %}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.dirname 'test/path/filename.config'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.diskusage"> salt.modules.file.diskusage(path)</h3> <dd>
<p>Recursively calculate disk usage of path and return it in bytes</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.diskusage /path/to/check</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.extract_hash"> salt.modules.file.extract_hash(hash_fn, hash_type='sha256', file_name='', source='', source_hash_name=None)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified">Changed in version 2016.3.5: </span>Prior to this version, only the <code class="docutils literal notranslate"><span class="pre">file_name</span></code> argument was considered for filename matches in the hash file. This would be problematic for cases in which the user was relying on a remote checksum file that they do not control, and they wished to use a different name for that file on the minion from the filename on the remote server (and in the checksum file). For example, managing <code class="docutils literal notranslate"><span class="pre">/tmp/myfile.tar.gz</span></code> when the remote file was at <code class="docutils literal notranslate"><span class="pre">https://mydomain.tld/different_name.tar.gz</span></code>. The <a class="reference internal" href="../../states/all/salt.states.file#salt.states.file.managed" title="salt.states.file.managed"><code class="xref py py-func docutils literal notranslate"><span class="pre">file.managed</span></code></a> state now also passes this function the source URI as well as the <code class="docutils literal notranslate"><span class="pre">source_hash_name</span></code> (if specified). In cases where <code class="docutils literal notranslate"><span class="pre">source_hash_name</span></code> is specified, it takes precedence over both the <code class="docutils literal notranslate"><span class="pre">file_name</span></code> and <code class="docutils literal notranslate"><span class="pre">source</span></code>. When it is not specified, <code class="docutils literal notranslate"><span class="pre">file_name</span></code> takes precedence over <code class="docutils literal notranslate"><span class="pre">source</span></code>. This allows for better capability for matching hashes.</p> </div> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2016.11.0: </span>File name and source URI matches are no longer disregarded when <code class="docutils literal notranslate"><span class="pre">source_hash_name</span></code> is specified. They will be used as fallback matches if there is no match to the <code class="docutils literal notranslate"><span class="pre">source_hash_name</span></code> value.</p> </div> <p>This routine is called from the <a class="reference internal" href="../../states/all/salt.states.file#salt.states.file.managed" title="salt.states.file.managed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">file.managed</span></code></a> state to pull a hash from a remote file. Regular expressions are used line by line on the <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> file, to find a potential candidate of the indicated hash type. This avoids many problems of arbitrary file layout rules. It specifically permits pulling hash codes from debian <code class="docutils literal notranslate"><span class="pre">*.dsc</span></code> files.</p> <p>If no exact match of a hash and filename are found, then the first hash found (if any) will be returned. If no hashes at all are found, then <code class="docutils literal notranslate"><span class="pre">None</span></code> will be returned.</p> <p>For example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">openerp_7.0-latest-1.tar.gz:
  file.managed:
    - name: /tmp/openerp_7.0-20121227-075624-1_all.deb
    - source: http://nightly.openerp.com/7.0/nightly/deb/openerp_7.0-20121227-075624-1.tar.gz
    - source_hash: http://nightly.openerp.com/7.0/nightly/deb/openerp_7.0-20121227-075624-1.dsc</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.extract_hash /path/to/hash/file sha512 /etc/foo</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.file_exists"> salt.modules.file.file_exists(path)</h3> <dd>
<p>Tests to see if path is a valid file. Returns True/False.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.file_exists /etc/passwd</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.find"> salt.modules.file.find(path, *args, **kwargs)</h3> <dd>
<p>Approximate the Unix <code class="docutils literal notranslate"><span class="pre">find(1)</span></code> command and return a list of paths that meet the specified criteria.</p> <p>The options include match criteria:</p> <pre class="highlight-text notranslate" data-language="text">name    = path-glob                 # case sensitive
iname   = path-glob                 # case insensitive
regex   = path-regex                # case sensitive
iregex  = path-regex                # case insensitive
type    = file-types                # match any listed type
user    = users                     # match any listed user
group   = groups                    # match any listed group
size    = [+-]number[size-unit]     # default unit = byte
mtime   = interval                  # modified since date
grep    = regex                     # search file contents</pre> <p>and/or actions:</p> <pre class="highlight-text notranslate" data-language="text">delete [= file-types]               # default type = 'f'
exec    = command [arg ...]         # where {} is replaced by pathname
print  [= print-opts]</pre> <p>and/or depth criteria:</p> <pre class="highlight-text notranslate" data-language="text">maxdepth = maximum depth to transverse in path
mindepth = minimum depth to transverse before checking files or directories</pre> <p>The default action is <code class="docutils literal notranslate"><span class="pre">print=path</span></code></p> <p><code class="docutils literal notranslate"><span class="pre">path-glob</span></code>:</p> <pre class="highlight-text notranslate" data-language="text">*                = match zero or more chars
?                = match any char
[abc]            = match a, b, or c
[!abc] or [^abc] = match anything except a, b, and c
[x-y]            = match chars x through y
[!x-y] or [^x-y] = match anything except chars x through y
{a,b,c}          = match a or b or c</pre> <p><code class="docutils literal notranslate"><span class="pre">path-regex</span></code>: a Python Regex (regular expression) pattern to match pathnames</p> <p><code class="docutils literal notranslate"><span class="pre">file-types</span></code>: a string of one or more of the following:</p> <pre class="highlight-text notranslate" data-language="text">a: all file types
b: block device
c: character device
d: directory
p: FIFO (named pipe)
f: plain file
l: symlink
s: socket</pre> <p><code class="docutils literal notranslate"><span class="pre">users</span></code>: a space and/or comma separated list of user names and/or uids</p> <p><code class="docutils literal notranslate"><span class="pre">groups</span></code>: a space and/or comma separated list of group names and/or gids</p> <p><code class="docutils literal notranslate"><span class="pre">size-unit</span></code>:</p> <pre class="highlight-text notranslate" data-language="text">b: bytes
k: kilobytes
m: megabytes
g: gigabytes
t: terabytes</pre> <p>interval:</p> <pre class="highlight-text notranslate" data-language="text">[&lt;num&gt;w] [&lt;num&gt;d] [&lt;num&gt;h] [&lt;num&gt;m] [&lt;num&gt;s]

where:
    w: week
    d: day
    h: hour
    m: minute
    s: second</pre> <p>print-opts: a comma and/or space separated list of one or more of the following:</p> <pre class="highlight-text notranslate" data-language="text">group: group name
md5:   MD5 digest of file contents
mode:  file permissions (as integer)
mtime: last modification time (as time_t)
name:  file basename
path:  file absolute path
size:  file size in bytes
type:  file type
user:  user name</pre> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.find / type=f name=\*.bak size=+10m
salt '*' file.find /var mtime=+30d size=+10m print=path,size,mtime
salt '*' file.find /var/log name=\*.[0-9] mtime=+30d size=+10m delete</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_devmm"> salt.modules.file.get_devmm(name)</h3> <dd>
<p>Get major/minor info from a device</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_devmm /dev/chr</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_diff"> salt.modules.file.get_diff(file1, file2, saltenv='base', show_filenames=True, show_changes=True, template=False, source_hash_file1=None, source_hash_file2=None)</h3> <dd>
<p>Return unified diff of two files</p> <dl class="docutils"> <dt>file1</dt> <dd>
<p class="first">The first file to feed into the diff utility</p> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 2018.3.0: </span>Can now be either a local or remote file. In earlier releases, thuis had to be a file local to the minion.</p> </div> </dd> <dt>file2</dt> <dd>
<p class="first">The second file to feed into the diff utility</p> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 2018.3.0: </span>Can now be either a local or remote file. In earlier releases, this had to be a file on the salt fileserver (i.e. <code class="docutils literal notranslate"><span class="pre">salt://somefile.txt</span></code>)</p> </div> </dd> <dt>show_filenames <span class="classifier-delimiter">:</span> <span class="classifier">True</span>
</dt> <dd>Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to hide the filenames in the top two lines of the diff.</dd> <dt>show_changes <span class="classifier-delimiter">:</span> <span class="classifier">True</span>
</dt> <dd>If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, and there are differences, then instead of a diff a simple message stating that show_changes is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned.</dd> <dt>template <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<p class="first">Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if two templates are being compared. This is not useful except for within states, with the <code class="docutils literal notranslate"><span class="pre">obfuscate_templates</span></code> option set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> <dt>source_hash_file1</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">file1</span></code> is an http(s)/ftp URL and the file exists in the minion's file cache, this option can be passed to keep the minion from re-downloading the archive if the cached copy matches the specified hash.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> <dt>source_hash_file2</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">file2</span></code> is an http(s)/ftp URL and the file exists in the minion's file cache, this option can be passed to keep the minion from re-downloading the archive if the cached copy matches the specified hash.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_diff /home/fred/.vimrc salt://users/fred/.vimrc
salt '*' file.get_diff /tmp/foo.txt /tmp/bar.txt</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_gid"> salt.modules.file.get_gid(path, follow_symlinks=True)</h3> <dd>
<p>Return the id of the group that owns a given file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to get the gid</dd> <dt>follow_symlinks</dt> <dd>indicated if symlinks should be followed</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_gid /etc/passwd</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 0.16.4: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_group"> salt.modules.file.get_group(path, follow_symlinks=True)</h3> <dd>
<p>Return the group that owns a given file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to get the group</dd> <dt>follow_symlinks</dt> <dd>indicated if symlinks should be followed</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_group /etc/passwd</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 0.16.4: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_hash"> salt.modules.file.get_hash(path, form='sha256', chunk_size=65536)</h3> <dd>
<p>Get the hash sum of a file</p> <dl class="docutils"> <dt>This is better than <code class="docutils literal notranslate"><span class="pre">get_sum</span></code> for the following reasons:</dt> <dd>
<ul class="first last simple"> <li>It does not read the entire file into memory.</li> <li>
<dl class="first docutils"> <dt>It does not return a string on error. The returned value of</dt> <dd>
<code class="docutils literal notranslate"><span class="pre">get_sum</span></code> cannot really be trusted since it is vulnerable to collisions: <code class="docutils literal notranslate"><span class="pre">get_sum(...,</span> <span class="pre">'xyz')</span> <span class="pre">==</span> <span class="pre">'Hash</span> <span class="pre">xyz</span> <span class="pre">not</span> <span class="pre">supported'</span></code>
</dd> </dl> </li> </ul> </dd> <dt>path</dt> <dd>path to the file or directory</dd> <dt>form</dt> <dd>desired sum format</dd> <dt>chunk_size</dt> <dd>amount to sum at once</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_hash /etc/shadow</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_managed"> salt.modules.file.get_managed(name, template, source, source_hash, source_hash_name, user, group, mode, attrs, saltenv, context, defaults, skip_verify=False, **kwargs)</h3> <dd>
<p>Return the managed file data for file.managed</p> <dl class="docutils"> <dt>name</dt> <dd>location where the file lives on the server</dd> <dt>template</dt> <dd>template format</dd> <dt>source</dt> <dd>managed source file</dd> <dt>source_hash</dt> <dd>hash of the source file</dd> <dt>source_hash_name</dt> <dd>
<p class="first">When <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> refers to a remote file, this specifies the filename to look for in that file.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2016.3.5.</span></p> </div> </dd> <dt>user</dt> <dd>Owner of file</dd> <dt>group</dt> <dd>Group owner of file</dd> <dt>mode</dt> <dd>Permissions of file</dd> <dt>attrs</dt> <dd>
<p class="first">Attributes of file</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> <dt>context</dt> <dd>Variables to add to the template context</dd> <dt>defaults</dt> <dd>Default values of for context_dict</dd> <dt>skip_verify</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, hash verification of remote file sources (<code class="docutils literal notranslate"><span class="pre">http://</span></code>, <code class="docutils literal notranslate"><span class="pre">https://</span></code>, <code class="docutils literal notranslate"><span class="pre">ftp://</span></code>) will be skipped, and the <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> argument will be ignored.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2016.3.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_managed /etc/httpd/conf.d/httpd.conf jinja salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' None root root '755' base None None</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_mode"> salt.modules.file.get_mode(path, follow_symlinks=True)</h3> <dd>
<p>Return the mode of a file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to get the mode</dd> <dt>follow_symlinks</dt> <dd>indicated if symlinks should be followed</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_mode /etc/passwd</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2014.1.0: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_selinux_context"> salt.modules.file.get_selinux_context(path)</h3> <dd>
<p>Get an SELinux context from a given path</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_selinux_context /etc/hosts</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_source_sum"> salt.modules.file.get_source_sum(file_name='', source='', source_hash=None, source_hash_name=None, saltenv='base')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2016.11.0.</span></p> </div> <p>Used by <a class="reference internal" href="#salt.modules.file.get_managed" title="salt.modules.file.get_managed"><code class="xref py py-func docutils literal notranslate"><span class="pre">file.get_managed</span></code></a> to obtain the hash and hash type from the parameters specified below.</p> <dl class="docutils"> <dt>file_name</dt> <dd>Optional file name being managed, for matching with <a class="reference internal" href="#salt.modules.file.extract_hash" title="salt.modules.file.extract_hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">file.extract_hash</span></code></a>.</dd> <dt>source</dt> <dd>Source file, as used in <a class="reference internal" href="../../states/all/salt.states.file#module-salt.states.file" title="salt.states.file"><code class="xref py py-mod docutils literal notranslate"><span class="pre">file</span></code></a> and other states. If <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> refers to a file containing hashes, then this filename will be used to match a filename in that file. If the <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> is a hash expression, then this argument will be ignored.</dd> <dt>source_hash</dt> <dd>Hash file/expression, as used in <a class="reference internal" href="../../states/all/salt.states.file#module-salt.states.file" title="salt.states.file"><code class="xref py py-mod docutils literal notranslate"><span class="pre">file</span></code></a> and other states. If this value refers to a remote URL or absolute path to a local file, it will be cached and <a class="reference internal" href="#salt.modules.file.extract_hash" title="salt.modules.file.extract_hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">file.extract_hash</span></code></a> will be used to obtain a hash from it.</dd> <dt>source_hash_name</dt> <dd>Specific file name to look for when <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> refers to a remote file, used to disambiguate ambiguous matches.</dd> <dt>saltenv <span class="classifier-delimiter">:</span> <span class="classifier">base</span>
</dt> <dd>Salt fileserver environment from which to retrieve the source_hash. This value will only be used when <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> refers to a file on the Salt fileserver (i.e. one beginning with <code class="docutils literal notranslate"><span class="pre">salt://</span></code>).</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_source_sum /tmp/foo.tar.gz source=http://mydomain.tld/foo.tar.gz source_hash=499ae16dcae71eeb7c3a30c75ea7a1a6
salt '*' file.get_source_sum /tmp/foo.tar.gz source=http://mydomain.tld/foo.tar.gz source_hash=https://mydomain.tld/hashes.md5
salt '*' file.get_source_sum /tmp/foo.tar.gz source=http://mydomain.tld/foo.tar.gz source_hash=https://mydomain.tld/hashes.md5 source_hash_name=./dir2/foo.tar.gz</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_sum"> salt.modules.file.get_sum(path, form='sha256')</h3> <dd>
<p>Return the checksum for the given file. The following checksum algorithms are supported:</p> <ul class="simple"> <li>md5</li> <li>sha1</li> <li>sha224</li> <li>sha256 <strong>(default)</strong>
</li> <li>sha384</li> <li>sha512</li> </ul> <dl class="docutils"> <dt>path</dt> <dd>path to the file or directory</dd> <dt>form</dt> <dd>desired sum format</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_sum /etc/passwd sha512</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_uid"> salt.modules.file.get_uid(path, follow_symlinks=True)</h3> <dd>
<p>Return the id of the user that owns a given file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to get the uid</dd> <dt>follow_symlinks</dt> <dd>indicated if symlinks should be followed</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_uid /etc/passwd</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 0.16.4: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.get_user"> salt.modules.file.get_user(path, follow_symlinks=True)</h3> <dd>
<p>Return the user that owns a given file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to get the user</dd> <dt>follow_symlinks</dt> <dd>indicated if symlinks should be followed</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.get_user /etc/passwd</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 0.16.4: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.gid_to_group"> salt.modules.file.gid_to_group(gid)</h3> <dd>
<p>Convert the group id to the group name on this system</p> <dl class="docutils"> <dt>gid</dt> <dd>gid to convert to a group name</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.gid_to_group 0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.grep"> salt.modules.file.grep(path, pattern, *opts)</h3> <dd>
<p>Grep for a string in the specified file</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This function's return value is slated for refinement in future versions of Salt</p> </div> <dl class="docutils"> <dt>path</dt> <dd>
<p class="first">Path to the file to be searched</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">Globbing is supported (i.e. <code class="docutils literal notranslate"><span class="pre">/var/log/foo/*.log</span></code>, but if globbing is being used then the path should be quoted to keep the shell from attempting to expand the glob expression.</p> </div> </dd> <dt>pattern</dt> <dd>Pattern to match. For example: <code class="docutils literal notranslate"><span class="pre">test</span></code>, or <code class="docutils literal notranslate"><span class="pre">a[0-5]</span></code>
</dd> <dt>opts</dt> <dd>
<p class="first">Additional command-line flags to pass to the grep command. For example: <code class="docutils literal notranslate"><span class="pre">-v</span></code>, or <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">-B2</span></code></p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">The options should come after a double-dash (as shown in the examples below) to keep Salt's own argument parser from interpreting them.</p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.grep /etc/passwd nobody
salt '*' file.grep /etc/sysconfig/network-scripts/ifcfg-eth0 ipaddr -- -i
salt '*' file.grep /etc/sysconfig/network-scripts/ifcfg-eth0 ipaddr -- -i -B2
salt '*' file.grep "/etc/sysconfig/network-scripts/*" ipaddr -- -i -l</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.group_to_gid"> salt.modules.file.group_to_gid(group)</h3> <dd>
<p>Convert the group to the gid on this system</p> <dl class="docutils"> <dt>group</dt> <dd>group to convert to its gid</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.group_to_gid root</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.is_blkdev"> salt.modules.file.is_blkdev(name)</h3> <dd>
<p>Check if a file exists and is a block device.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.is_blkdev /dev/blk</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.is_chrdev"> salt.modules.file.is_chrdev(name)</h3> <dd>
<p>Check if a file exists and is a character device.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.is_chrdev /dev/chr</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.is_fifo"> salt.modules.file.is_fifo(name)</h3> <dd>
<p>Check if a file exists and is a FIFO.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.is_fifo /dev/fifo</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.is_link"> salt.modules.file.is_link(path)</h3> <dd>
<p>Check if the path is a symbolic link</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.is_link /path/to/link</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.join"> salt.modules.file.join(*args)</h3> <dd>
<p>Return a normalized file system path for the underlying OS</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p>This can be useful at the CLI but is frequently useful when scripting combining path variables:</p> <pre class="highlight-jinja notranslate" data-language="jinja">{% set www_root = '/var' %}
{% set app_dir = 'myapp' %}

myapp_config:
  file:
    - managed
    - name: {{ salt['file.join'](www_root, app_dir, 'config.yaml') }}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.join '/' 'usr' 'local' 'bin'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.lchown"> salt.modules.file.lchown(path, user, group)</h3> <dd>
<p>Chown a file, pass the file the desired user and group without following symlinks.</p> <dl class="docutils"> <dt>path</dt> <dd>path to the file or directory</dd> <dt>user</dt> <dd>user owner</dd> <dt>group</dt> <dd>group owner</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.chown /etc/passwd root root</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.line"> salt.modules.file.line(path, content=None, match=None, mode=None, location=None, before=None, after=None, show_changes=True, backup=False, quiet=False, indent=True)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2015.8.0.</span></p> </div> <p>Edit a line in the configuration file. The <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">content</span></code> arguments are required, as well as passing in one of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> options.</p> <dl class="docutils"> <dt>path</dt> <dd>Filesystem path to the file to be edited.</dd> <dt>content</dt> <dd>Content of the line. Allowed to be empty if mode=delete.</dd> <dt>match</dt> <dd>
<p class="first">Match the target line for an action by a fragment of a string or regular expression.</p> <p class="last">If neither <code class="docutils literal notranslate"><span class="pre">before</span></code> nor <code class="docutils literal notranslate"><span class="pre">after</span></code> are provided, and <code class="docutils literal notranslate"><span class="pre">match</span></code> is also <code class="docutils literal notranslate"><span class="pre">None</span></code>, match becomes the <code class="docutils literal notranslate"><span class="pre">content</span></code> value.</p> </dd> <dt>mode</dt> <dd>
<p class="first">Defines how to edit a line. One of the following options is required:</p> <ul class="simple"> <li>
<dl class="first docutils"> <dt>ensure</dt> <dd>If line does not exist, it will be added. This is based on the <code class="docutils literal notranslate"><span class="pre">content</span></code> argument.</dd> </dl> </li> <li>
<dl class="first docutils"> <dt>replace</dt> <dd>If line already exists, it will be replaced.</dd> </dl> </li> <li>
<dl class="first docutils"> <dt>delete</dt> <dd>Delete the line, once found.</dd> </dl> </li> <li>
<dl class="first docutils"> <dt>insert</dt> <dd>Insert a line.</dd> </dl> </li> </ul> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">If <code class="docutils literal notranslate"><span class="pre">mode=insert</span></code> is used, at least one of the following options must also be defined: <code class="docutils literal notranslate"><span class="pre">location</span></code>, <code class="docutils literal notranslate"><span class="pre">before</span></code>, or <code class="docutils literal notranslate"><span class="pre">after</span></code>. If <code class="docutils literal notranslate"><span class="pre">location</span></code> is used, it takes precedence over the other two options.</p> </div> </dd> <dt>location</dt> <dd>
<p class="first">Defines where to place content in the line. Note this option is only used when <code class="docutils literal notranslate"><span class="pre">mode=insert</span></code> is specified. If a location is passed in, it takes precedence over both the <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> kwargs. Valid locations are:</p> <ul class="last simple"> <li>
<dl class="first docutils"> <dt>start</dt> <dd>Place the content at the beginning of the file.</dd> </dl> </li> <li>
<dl class="first docutils"> <dt>end</dt> <dd>Place the content at the end of the file.</dd> </dl> </li> </ul> </dd> <dt>before</dt> <dd>Regular expression or an exact case-sensitive fragment of the string. This option is only used when either the <code class="docutils literal notranslate"><span class="pre">ensure</span></code> or <code class="docutils literal notranslate"><span class="pre">insert</span></code> mode is defined.</dd> <dt>after</dt> <dd>Regular expression or an exact case-sensitive fragment of the string. This option is only used when either the <code class="docutils literal notranslate"><span class="pre">ensure</span></code> or <code class="docutils literal notranslate"><span class="pre">insert</span></code> mode is defined.</dd> <dt>show_changes</dt> <dd>
<p class="first">Output a unified diff of the old file and the new file. If <code class="docutils literal notranslate"><span class="pre">False</span></code> return a boolean if any changes were made. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code></p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">Using this option will store two copies of the file in-memory (the original version and the edited version) in order to generate the diff.</p> </div> </dd> <dt>backup</dt> <dd>Create a backup of the original file with the extension: "Year-Month-Day-Hour-Minutes-Seconds".</dd> <dt>quiet</dt> <dd>Do not raise any exceptions. E.g. ignore the fact that the file that is tried to be edited does not exist and nothing really happened.</dd> <dt>indent</dt> <dd>Keep indentation with the previous line. This option is not considered when the <code class="docutils literal notranslate"><span class="pre">delete</span></code> mode is specified.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.line /etc/nsswitch.conf "networks:        files dns" after="hosts:.*?" mode='ensure'</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>If an equal sign (<code class="docutils literal notranslate"><span class="pre">=</span></code>) appears in an argument to a Salt command, it is interpreted as a keyword argument in the format of <code class="docutils literal notranslate"><span class="pre">key=val</span></code>. That processing can be bypassed in order to pass an equal sign through to the remote shell command by manually specifying the kwarg:</p> <div class="last highlight-bash notranslate">
<div class="highlight"><pre>salt <span class="s1">'*'</span> file.line /path/to/file <span class="nv">content</span><span class="o">=</span><span class="s2">"CREATEMAIL_SPOOL=no"</span> <span class="nv">match</span><span class="o">=</span><span class="s2">"CREATE_MAIL_SPOOL=yes"</span> <span class="nv">mode</span><span class="o">=</span><span class="s2">"replace"</span>
</pre></div> </div> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.link"> salt.modules.file.link(src, path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Create a hard link to a file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.link /path/to/file /path/to/link</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.list_backups"> salt.modules.file.list_backups(path, limit=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Lists the previous versions of a file backed up using Salt's <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/states/backup_mode.html#file-state-backups"><span class="std std-ref">file state backup</span></a> system.</p> <dl class="docutils"> <dt>path</dt> <dd>The path on the minion to check for backups</dd> <dt>limit</dt> <dd>Limit the number of results to the most recent N backups</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.list_backups /foo/bar/baz.txt</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.list_backups_dir"> salt.modules.file.list_backups_dir(path, limit=None)</h3> <dd>
<p>Lists the previous versions of a directory backed up using Salt's <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/states/backup_mode.html#file-state-backups"><span class="std std-ref">file state backup</span></a> system.</p> <dl class="docutils"> <dt>path</dt> <dd>The directory on the minion to check for backups</dd> <dt>limit</dt> <dd>Limit the number of results to the most recent N backups</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.list_backups_dir /foo/bar/baz/</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.lsattr"> salt.modules.file.lsattr(path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2018.3.1: </span>If <code class="docutils literal notranslate"><span class="pre">lsattr</span></code> is not installed on the system, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p> </div> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2018.3.4: </span>If on <code class="docutils literal notranslate"><span class="pre">AIX</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned even if in filesystem as lsattr on <code class="docutils literal notranslate"><span class="pre">AIX</span></code> is not the same thing as the linux version.</p> </div> <p>Obtain the modifiable attributes of the given file. If path is to a directory, an empty list is returned.</p> <dl class="docutils"> <dt>path</dt> <dd>path to file to obtain attributes of. File/directory must exist.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.lsattr foo1.txt</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.lstat"> salt.modules.file.lstat(path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Returns the lstat attributes for the given file or dir. Does not support symbolic links.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.lstat /path/to/file</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.makedirs_"> salt.modules.file.makedirs_(path, user=None, group=None, mode=None)</h3> <dd>
<p>Ensure that the directory containing this path is available.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The path must end with a trailing slash otherwise the directory/directories will be created up to the parent directory. For example if path is <code class="docutils literal notranslate"><span class="pre">/opt/code</span></code>, then it would be treated as <code class="docutils literal notranslate"><span class="pre">/opt/</span></code> but if the path ends with a trailing slash like <code class="docutils literal notranslate"><span class="pre">/opt/code/</span></code>, then it would be treated as <code class="docutils literal notranslate"><span class="pre">/opt/code/</span></code>.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.makedirs /opt/code/</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.makedirs_perms"> salt.modules.file.makedirs_perms(name, user=None, group=None, mode='0755')</h3> <dd>
<p>Taken and modified from os.makedirs to set user, group and mode for each directory created.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.makedirs_perms /opt/code</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.manage_file"> salt.modules.file.manage_file(name, sfn, ret, source, source_sum, user, group, mode, attrs, saltenv, backup, makedirs=False, template=None, show_changes=True, contents=None, dir_mode=None, follow_symlinks=True, skip_verify=False, keep_mode=False, encoding=None, encoding_errors='strict', **kwargs)</h3> <dd>
<p>Checks the destination against what was retrieved with get_managed and makes the appropriate modifications (if necessary).</p> <dl class="docutils"> <dt>name</dt> <dd>location to place the file</dd> <dt>sfn</dt> <dd>
<p class="first">location of cached file on the minion</p> <p>This is the path to the file stored on the minion. This file is placed on the minion using cp.cache_file. If the hash sum of that file matches the source_sum, we do not transfer the file to the minion again.</p> <p class="last">This file is then grabbed and if it has template set, it renders the file to be placed into the correct place on the system using salt.files.utils.copyfile()</p> </dd> <dt>ret</dt> <dd>The initial state return data structure. Pass in <code class="docutils literal notranslate"><span class="pre">None</span></code> to use the default structure.</dd> <dt>source</dt> <dd>file reference on the master</dd> <dt>source_sum</dt> <dd>sum hash for source</dd> <dt>user</dt> <dd>user owner</dd> <dt>group</dt> <dd>group owner</dd> <dt>backup</dt> <dd>backup_mode</dd> <dt>attrs</dt> <dd>
<p class="first">attributes to be set on file: '' means remove all of them</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2018.3.0.</span></p> </div> </dd> <dt>makedirs</dt> <dd>make directories if they do not exist</dd> <dt>template</dt> <dd>format of templating</dd> <dt>show_changes</dt> <dd>Include diff in state return</dd> <dt>contents:</dt> <dd>contents to be placed in the file</dd> <dt>dir_mode</dt> <dd>mode for directories created with makedirs</dd> <dt>skip_verify <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, hash verification of remote file sources (<code class="docutils literal notranslate"><span class="pre">http://</span></code>, <code class="docutils literal notranslate"><span class="pre">https://</span></code>, <code class="docutils literal notranslate"><span class="pre">ftp://</span></code>) will be skipped, and the <code class="docutils literal notranslate"><span class="pre">source_hash</span></code> argument will be ignored.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2016.3.0.</span></p> </div> </dd> <dt>keep_mode <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and the <code class="docutils literal notranslate"><span class="pre">source</span></code> is a file from the Salt fileserver (or a local file on the minion), the mode of the destination file will be set to the mode of the source file.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p>keep_mode does not work with salt-ssh.</p> <p class="last">As a consequence of how the files are transferred to the minion, and the inability to connect back to the master with salt-ssh, salt is unable to stat the file as it exists on the fileserver and thus cannot mirror the mode on the salt-ssh minion</p> </div> </dd> <dt>encoding</dt> <dd>
<p class="first">If specified, then the specified encoding will be used. Otherwise, the file will be encoded using the system locale (usually UTF-8). See <a class="reference external" href="https://docs.python.org/3/library/codecs.html#standard-encodings">https://docs.python.org/3/library/codecs.html#standard-encodings</a> for the list of available encodings.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2017.7.0.</span></p> </div> </dd> <dt>encoding_errors <span class="classifier-delimiter">:</span> <span class="classifier">'strict'</span>
</dt> <dd>
<p class="first">Default is <code class="docutils literal notranslate"><span class="pre">`'strict'`</span></code>. See <a class="reference external" href="https://docs.python.org/2/library/codecs.html#codec-base-classes">https://docs.python.org/2/library/codecs.html#codec-base-classes</a> for the error handling schemes.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2017.7.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.manage_file /etc/httpd/conf.d/httpd.conf '' '{}' salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' root root '755' '' base ''</pre> <div class="versionchanged"> <p><span class="versionmodified">Changed in version 2014.7.0: </span><code class="docutils literal notranslate"><span class="pre">follow_symlinks</span></code> option added</p> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.mkdir"> salt.modules.file.mkdir(dir_path, user=None, group=None, mode=None)</h3> <dd>
<p>Ensure that a directory is available.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.mkdir /opt/jetty/context</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.mknod"> salt.modules.file.mknod(name, ntype, major=0, minor=0, user=None, group=None, mode='0600')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Create a block device, character device, or fifo pipe. Identical to the gnu mknod.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.mknod /dev/chr c 180 31
salt '*' file.mknod /dev/blk b 8 999
salt '*' file.nknod /dev/fifo p</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.mknod_blkdev"> salt.modules.file.mknod_blkdev(name, major, minor, user=None, group=None, mode='0660')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Create a block device.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.mknod_blkdev /dev/blk 8 999</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.mknod_chrdev"> salt.modules.file.mknod_chrdev(name, major, minor, user=None, group=None, mode='0660')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Create a character device.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.mknod_chrdev /dev/chr 180 31</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.mknod_fifo"> salt.modules.file.mknod_fifo(name, user=None, group=None, mode='0660')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Create a FIFO pipe.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.mknod_fifo /dev/fifo</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.move"> salt.modules.file.move(src, dst)</h3> <dd>
<p>Move a file or directory</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.move /path/to/src /path/to/dst</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.normpath"> salt.modules.file.normpath(path)</h3> <dd>
<p>Returns Normalize path, eliminating double slashes, etc.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2015.5.0.</span></p> </div> <p>This can be useful at the CLI but is frequently useful when scripting.</p> <pre class="highlight-jinja notranslate" data-language="jinja">{%- from salt['file.normpath'](tpldir + '/../vars.jinja') import parent_vars %}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.normpath 'a/b/c/..'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.open_files"> salt.modules.file.open_files(by_pid=False)</h3> <dd>
<p>Return a list of all physical open files on the system.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.open_files
salt '*' file.open_files by_pid=True</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.pardir"> salt.modules.file.pardir()</h3> <dd>
<p>Return the relative parent directory path symbol for underlying OS</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p>This can be useful when constructing Salt Formulas.</p> <pre class="highlight-jinja notranslate" data-language="jinja">{% set pardir = salt['file.pardir']() %}
{% set final_path = salt['file.join']('subdir', pardir, 'confdir') %}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.pardir</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.patch"> salt.modules.file.patch(originalfile, patchfile, options='', dry_run=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.10.4.</span></p> </div> <p>Apply a patch to a file or directory.</p> <p>Equivalent to:</p> <pre class="highlight-bash notranslate" data-language="bash">patch &lt;options&gt; -i &lt;patchfile&gt; &lt;originalfile&gt;</pre> <p>Or, when a directory is patched:</p> <pre class="highlight-bash notranslate" data-language="bash">patch &lt;options&gt; -i &lt;patchfile&gt; -d &lt;originalfile&gt; -p0</pre> <dl class="docutils"> <dt>originalfile</dt> <dd>The full path to the file or directory to be patched</dd> <dt>patchfile</dt> <dd>A patch file to apply to <code class="docutils literal notranslate"><span class="pre">originalfile</span></code>
</dd> <dt>options</dt> <dd>Options to pass to patch.</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.patch /opt/file.txt /tmp/file.txt.patch</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.path_exists_glob"> salt.modules.file.path_exists_glob(path)</h3> <dd>
<p>Tests to see if path after expansion is a valid path (file or directory). Expansion allows usage of ? * and character ranges []. Tilde expansion is not supported. Returns True/False.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.path_exists_glob /etc/pam*/pass*</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.prepend"> salt.modules.file.prepend(path, *args, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p>Prepend text to the beginning of a file</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt><cite>*args</cite></dt> <dd>strings to prepend to the file</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.prepend /etc/motd \
        "With all thine offerings thou shalt offer salt." \
        "Salt is what makes things taste bad when it isn't in them."</pre> <div class="admonition-attention admonition"> <p class="first admonition-title">Attention</p> <p>If you need to pass a string to append and that string contains an equal sign, you <strong>must</strong> include the argument name, args. For example:</p> <div class="last highlight-bash notranslate">
<div class="highlight"><pre>salt <span class="s1">'*'</span> file.prepend /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s1">'cheese=spam'</span>

salt <span class="s1">'*'</span> file.prepend /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s2">"['cheese=spam','spam=cheese']"</span>
</pre></div> </div> </div> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.psed"> salt.modules.file.psed(path, before, after, limit='', backup='.bak', flags='gMS', escape_all=False, multi=False)</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.replace" title="salt.modules.file.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> instead.</p> </div> <p>Make a simple edit to a file (pure Python version)</p> <p>Equivalent to:</p> <pre class="highlight-bash notranslate" data-language="bash">sed &lt;backup&gt; &lt;options&gt; "/&lt;limit&gt;/ s/&lt;before&gt;/&lt;after&gt;/&lt;flags&gt; &lt;file&gt;"</pre> <dl class="docutils"> <dt>path</dt> <dd>The full path to the file to be edited</dd> <dt>before</dt> <dd>A pattern to find in order to replace with <code class="docutils literal notranslate"><span class="pre">after</span></code>
</dd> <dt>after</dt> <dd>Text that will replace <code class="docutils literal notranslate"><span class="pre">before</span></code>
</dd> <dt>limit <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">''</span></code></span>
</dt> <dd>An initial pattern to search for before searching for <code class="docutils literal notranslate"><span class="pre">before</span></code>
</dd> <dt>backup <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">.bak</span></code></span>
</dt> <dd>The file will be backed up before edit with this file extension; <strong>WARNING:</strong> each time <code class="docutils literal notranslate"><span class="pre">sed</span></code>/<code class="docutils literal notranslate"><span class="pre">comment</span></code>/<code class="docutils literal notranslate"><span class="pre">uncomment</span></code> is called will overwrite this backup</dd> <dt>flags <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">gMS</span></code></span>
</dt> <dd>
<dl class="first last docutils"> <dt>Flags to modify the search. Valid values are:</dt> <dd>
<ul class="first last simple"> <li>
<code class="docutils literal notranslate"><span class="pre">g</span></code>: Replace all occurrences of the pattern, not just the first.</li> <li>
<code class="docutils literal notranslate"><span class="pre">I</span></code>: Ignore case.</li> <li>
<code class="docutils literal notranslate"><span class="pre">L</span></code>: Make <code class="docutils literal notranslate"><span class="pre">\w</span></code>, <code class="docutils literal notranslate"><span class="pre">\W</span></code>, <code class="docutils literal notranslate"><span class="pre">\b</span></code>, <code class="docutils literal notranslate"><span class="pre">\B</span></code>, <code class="docutils literal notranslate"><span class="pre">\s</span></code> and <code class="docutils literal notranslate"><span class="pre">\S</span></code> dependent on the locale.</li> <li>
<code class="docutils literal notranslate"><span class="pre">M</span></code>: Treat multiple lines as a single line.</li> <li>
<code class="docutils literal notranslate"><span class="pre">S</span></code>: Make <cite>.</cite> match all characters, including newlines.</li> <li>
<code class="docutils literal notranslate"><span class="pre">U</span></code>: Make <code class="docutils literal notranslate"><span class="pre">\w</span></code>, <code class="docutils literal notranslate"><span class="pre">\W</span></code>, <code class="docutils literal notranslate"><span class="pre">\b</span></code>, <code class="docutils literal notranslate"><span class="pre">\B</span></code>, <code class="docutils literal notranslate"><span class="pre">\d</span></code>, <code class="docutils literal notranslate"><span class="pre">\D</span></code>, <code class="docutils literal notranslate"><span class="pre">\s</span></code> and <code class="docutils literal notranslate"><span class="pre">\S</span></code> dependent on Unicode.</li> <li>
<code class="docutils literal notranslate"><span class="pre">X</span></code>: Verbose (whitespace is ignored).</li> </ul> </dd> </dl> </dd> <dt>multi: <code class="docutils literal notranslate"><span class="pre">False</span></code>
</dt> <dd>If True, treat the entire file as a single line</dd> </dl> <p>Forward slashes and single quotes will be escaped automatically in the <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> patterns.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.sed /etc/httpd/httpd.conf 'LogLevel warn' 'LogLevel info'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.read"> salt.modules.file.read(path, binary=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2017.7.0.</span></p> </div> <p>Return the content of the file.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.read /path/to/file</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.readdir"> salt.modules.file.readdir(path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Return a list containing the contents of a directory</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.readdir /path/to/dir/</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.readlink"> salt.modules.file.readlink(path, canonicalize=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Return the path that a symlink points to If canonicalize is set to True, then it return the final target</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.readlink /path/to/link</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.remove"> salt.modules.file.remove(path)</h3> <dd>
<p>Remove the named file. If a directory is supplied, it will be recursively deleted.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.remove /tmp/foo</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.rename"> salt.modules.file.rename(src, dst)</h3> <dd>
<p>Rename a file or directory</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.rename /path/to/src /path/to/dst</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.replace"> salt.modules.file.replace(path, pattern, repl, count=0, flags=8, bufsize=1, append_if_not_found=False, prepend_if_not_found=False, not_found_content=None, backup='.bak', dry_run=False, search_only=False, show_changes=True, ignore_if_missing=False, preserve_inode=True, backslash_literal=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Replace occurrences of a pattern in a file. If <code class="docutils literal notranslate"><span class="pre">show_changes</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then a diff of what changed will be returned, otherwise a <code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned when changes are made, and <code class="docutils literal notranslate"><span class="pre">False</span></code> when no changes are made.</p> <p>This is a pure Python implementation that wraps Python's <a class="reference external" href="https://docs.python.org/3/library/re.html#re.sub" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sub()</span></code></a>.</p> <dl class="docutils"> <dt>path</dt> <dd>Filesystem path to the file to be edited. If a symlink is specified, it will be resolved to its target.</dd> <dt>pattern</dt> <dd>A regular expression, to be matched using Python's <a class="reference external" href="https://docs.python.org/3/library/re.html#re.search" title="(in Python v3.7)"><code class="xref py py-func docutils literal notranslate"><span class="pre">search()</span></code></a>.</dd> <dt>repl</dt> <dd>The replacement text</dd> <dt>count <span class="classifier-delimiter">:</span> <span class="classifier">0</span>
</dt> <dd>Maximum number of pattern occurrences to be replaced. If count is a positive integer <code class="docutils literal notranslate"><span class="pre">n</span></code>, only <code class="docutils literal notranslate"><span class="pre">n</span></code> occurrences will be replaced, otherwise all occurrences will be replaced.</dd> <dt>flags (list or int)</dt> <dd>A list of flags defined in the <code class="docutils literal notranslate"><span class="pre">re</span></code> module documentation from the Python standard library. Each list item should be a string that will correlate to the human-friendly flag name. E.g., <code class="docutils literal notranslate"><span class="pre">['IGNORECASE',</span>
<span class="pre">'MULTILINE']</span></code>. Optionally, <code class="docutils literal notranslate"><span class="pre">flags</span></code> may be an int, with a value corresponding to the XOR (<code class="docutils literal notranslate"><span class="pre">|</span></code>) of all the desired flags. Defaults to 8 (which supports 'MULTILINE').</dd> <dt>bufsize (int or str)</dt> <dd>How much of the file to buffer into memory at once. The default value <code class="docutils literal notranslate"><span class="pre">1</span></code> processes one line at a time. The special value <code class="docutils literal notranslate"><span class="pre">file</span></code> may be specified which will read the entire file into memory before processing.</dd> <dt>append_if_not_found <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p class="last">If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, and pattern is not found, then the content will be appended to the file.</p> </dd> <dt>prepend_if_not_found <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p class="last">If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> and pattern is not found, then the content will be prepended to the file.</p> </dd> <dt>not_found_content</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p class="last">Content to use for append/prepend if not found. If None (default), uses <code class="docutils literal notranslate"><span class="pre">repl</span></code>. Useful when <code class="docutils literal notranslate"><span class="pre">repl</span></code> uses references to group in pattern.</p> </dd> <dt>backup <span class="classifier-delimiter">:</span> <span class="classifier">.bak</span>
</dt> <dd>The file extension to use for a backup of the file before editing. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to skip making a backup.</dd> <dt>dry_run <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, no changes will be made to the file, the function will just return the changes that would have been made (or a <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code> value if <code class="docutils literal notranslate"><span class="pre">show_changes</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>).</dd> <dt>search_only <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>If set to true, this no changes will be performed on the file, and this function will simply return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the pattern was matched, and <code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</dd> <dt>show_changes <span class="classifier-delimiter">:</span> <span class="classifier">True</span>
</dt> <dd>
<p class="first">If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a diff of changes made. Otherwise, return <code class="docutils literal notranslate"><span class="pre">True</span></code> if changes were made, and <code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">Using this option will store two copies of the file in memory (the original version and the edited version) in order to generate the diff. This may not normally be a concern, but could impact performance if used with large files.</p> </div> </dd> <dt>ignore_if_missing <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2015.8.0.</span></p> </div> <p class="last">If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function will simply return <code class="docutils literal notranslate"><span class="pre">False</span></code> if the file doesn't exist. Otherwise, an error will be thrown.</p> </dd> <dt>preserve_inode <span class="classifier-delimiter">:</span> <span class="classifier">True</span>
</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2015.8.0.</span></p> </div> <p class="last">Preserve the inode of the file, so that any hard links continue to share the inode with the original filename. This works by <em>copying</em> the file, reading from the copy, and writing to the file at the original inode. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the file will be <em>moved</em> rather than copied, and a new file will be written to a new inode, but using the original filename. Hard links will then share an inode with the backup, instead (if using <code class="docutils literal notranslate"><span class="pre">backup</span></code> to create a backup copy).</p> </dd> <dt>backslash_literal <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<div class="first versionadded"> <p><span class="versionmodified">New in version 2016.11.7.</span></p> </div> <p class="last">Interpret backslashes as literal backslashes for the repl and not escape characters. This will help when using append/prepend so that the backslashes are not interpreted for the repl on the second run of the state.</p> </dd> </dl> <p>If an equal sign (<code class="docutils literal notranslate"><span class="pre">=</span></code>) appears in an argument to a Salt command it is interpreted as a keyword argument in the format <code class="docutils literal notranslate"><span class="pre">key=val</span></code>. That processing can be bypassed in order to pass an equal sign through to the remote shell command by manually specifying the kwarg:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.replace /path/to/file pattern='=' repl=':'
salt '*' file.replace /path/to/file pattern="bind-address\s*=" repl='bind-address:'</pre> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.replace /etc/httpd/httpd.conf pattern='LogLevel warn' repl='LogLevel info'
salt '*' file.replace /some/file pattern='before' repl='after' flags='[MULTILINE, IGNORECASE]'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.restore_backup"> salt.modules.file.restore_backup(path, backup_id)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Restore a previous version of a file that was backed up using Salt's <a class="reference internal" href="https://docs.saltstack.com/en/latest/ref/states/backup_mode.html#file-state-backups"><span class="std std-ref">file state backup</span></a> system.</p> <dl class="docutils"> <dt>path</dt> <dd>The path on the minion to check for backups</dd> <dt>backup_id</dt> <dd>The numeric id for the backup you wish to restore, as found using <a class="reference internal" href="#salt.modules.file.list_backups" title="salt.modules.file.list_backups"><code class="xref py py-mod docutils literal notranslate"><span class="pre">file.list_backups</span></code></a>
</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.restore_backup /foo/bar/baz.txt 0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.restorecon"> salt.modules.file.restorecon(path, recursive=False)</h3> <dd>
<p>Reset the SELinux context on a given path</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.restorecon /home/user/.ssh/authorized_keys</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.rmdir"> salt.modules.file.rmdir(path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Remove the specified directory. Fails if a directory is not empty.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.rmdir /tmp/foo/</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.search"> salt.modules.file.search(path, pattern, flags=8, bufsize=1, ignore_if_missing=False, multiline=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> <p>Search for occurrences of a pattern in a file</p> <p>Except for multiline, params are identical to <a class="reference internal" href="#salt.modules.file.replace" title="salt.modules.file.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a>.</p> <dl class="docutils"> <dt>multiline</dt> <dd>
<p class="first">If true, inserts 'MULTILINE' into <code class="docutils literal notranslate"><span class="pre">flags</span></code> and sets <code class="docutils literal notranslate"><span class="pre">bufsize</span></code> to 'file'.</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 2015.8.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.search /etc/crontab 'mymaintenance.sh'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.sed"> salt.modules.file.sed(path, before, after, limit='', backup='.bak', options='-r -e', flags='g', escape_all=False, negate_match=False)</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.replace" title="salt.modules.file.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> instead.</p> </div> <p>Make a simple edit to a file</p> <p>Equivalent to:</p> <pre class="highlight-bash notranslate" data-language="bash">sed &lt;backup&gt; &lt;options&gt; "/&lt;limit&gt;/ s/&lt;before&gt;/&lt;after&gt;/&lt;flags&gt; &lt;file&gt;"</pre> <dl class="docutils"> <dt>path</dt> <dd>The full path to the file to be edited</dd> <dt>before</dt> <dd>A pattern to find in order to replace with <code class="docutils literal notranslate"><span class="pre">after</span></code>
</dd> <dt>after</dt> <dd>Text that will replace <code class="docutils literal notranslate"><span class="pre">before</span></code>
</dd> <dt>limit <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">''</span></code></span>
</dt> <dd>An initial pattern to search for before searching for <code class="docutils literal notranslate"><span class="pre">before</span></code>
</dd> <dt>backup <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">.bak</span></code></span>
</dt> <dd>The file will be backed up before edit with this file extension; <strong>WARNING:</strong> each time <code class="docutils literal notranslate"><span class="pre">sed</span></code>/<code class="docutils literal notranslate"><span class="pre">comment</span></code>/<code class="docutils literal notranslate"><span class="pre">uncomment</span></code> is called will overwrite this backup</dd> <dt>options <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">-e</span></code></span>
</dt> <dd>Options to pass to sed</dd> <dt>flags <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">g</span></code></span>
</dt> <dd>Flags to modify the sed search; e.g., <code class="docutils literal notranslate"><span class="pre">i</span></code> for case-insensitive pattern matching</dd> <dt>negate_match <span class="classifier-delimiter">:</span> <span class="classifier">False</span>
</dt> <dd>
<p class="first">Negate the search command (<code class="docutils literal notranslate"><span class="pre">!</span></code>)</p> <div class="last versionadded"> <p><span class="versionmodified">New in version 0.17.0.</span></p> </div> </dd> </dl> <p>Forward slashes and single quotes will be escaped automatically in the <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> patterns.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.sed /etc/httpd/httpd.conf 'LogLevel warn' 'LogLevel info'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.sed_contains"> salt.modules.file.sed_contains(path, text, limit='', flags='g')</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.search" title="salt.modules.file.search"><code class="xref py py-func docutils literal notranslate"><span class="pre">search()</span></code></a> instead.</p> </div> <p>Return True if the file at <code class="docutils literal notranslate"><span class="pre">path</span></code> contains <code class="docutils literal notranslate"><span class="pre">text</span></code>. Utilizes sed to perform the search (line-wise search).</p> <p>Note: the <code class="docutils literal notranslate"><span class="pre">p</span></code> flag will be added to any flags you pass in.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.contains /etc/crontab 'mymaintenance.sh'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.seek_read"> salt.modules.file.seek_read(path, size, offset)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Seek to a position on a file and read it</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt>seek</dt> <dd>amount to read at once</dd> <dt>offset</dt> <dd>offset to start into the file</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.seek_read /path/to/file 4096 0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.seek_write"> salt.modules.file.seek_write(path, data, offset)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Seek to a position on a file and write to it</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt>data</dt> <dd>data to write to file</dd> <dt>offset</dt> <dd>position in file to start writing</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.seek_write /path/to/file 'some data' 4096</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.set_mode"> salt.modules.file.set_mode(path, mode)</h3> <dd>
<p>Set the mode of a file</p> <dl class="docutils"> <dt>path</dt> <dd>file or directory of which to set the mode</dd> <dt>mode</dt> <dd>mode to set the path to</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.set_mode /etc/passwd 0644</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.set_selinux_context"> salt.modules.file.set_selinux_context(path, user=None, role=None, type=None, range=None)</h3> <dd>
<p>Set a specific SELinux label on a given path</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.set_selinux_context path &lt;user&gt; &lt;role&gt; &lt;type&gt; &lt;range&gt;
salt '*' file.set_selinux_context /etc/yum.repos.d/epel.repo system_u object_r system_conf_t s0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.source_list"> salt.modules.file.source_list(source, source_hash, saltenv)</h3> <dd>
<p>Check the source list and return the source to use</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.source_list salt://http/httpd.conf '{hash_type: 'md5', 'hsum': &lt;md5sum&gt;}' base</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.stats"> salt.modules.file.stats(path, hash_type=None, follow_symlinks=True)</h3> <dd>
<p>Return a dict containing the stats for a given file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.stats /etc/passwd</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.statvfs"> salt.modules.file.statvfs(path)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Perform a statvfs call against the filesystem that the file resides on</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.statvfs /path/to/file</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.symlink"> salt.modules.file.symlink(src, path)</h3> <dd>
<p>Create a symbolic link (symlink, soft link) to a file</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.symlink /path/to/file /path/to/link</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.touch"> salt.modules.file.touch(name, atime=None, mtime=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 0.9.5.</span></p> </div> <p>Just like the <code class="docutils literal notranslate"><span class="pre">touch</span></code> command, create a file if it doesn't exist or simply update the atime and mtime if it already does.</p> <dl class="docutils"> <dt>atime:</dt> <dd>Access time in Unix epoch time</dd> <dt>mtime:</dt> <dd>Last modification in Unix epoch time</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.touch /var/log/emptyfile</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.truncate"> salt.modules.file.truncate(path, length)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.1.0.</span></p> </div> <p>Seek to a position on a file and delete everything after that point</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt>length</dt> <dd>offset into file to truncate</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.truncate /path/to/file 512</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.uid_to_user"> salt.modules.file.uid_to_user(uid)</h3> <dd>
<p>Convert a uid to a user name</p> <dl class="docutils"> <dt>uid</dt> <dd>uid to convert to a username</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.uid_to_user 0</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.uncomment"> salt.modules.file.uncomment(path, regex, char='#', backup='.bak')</h3> <dd>
<div class="deprecated"> <p><span class="versionmodified">Deprecated since version 0.17.0: </span>Use <a class="reference internal" href="#salt.modules.file.replace" title="salt.modules.file.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> instead.</p> </div> <p>Uncomment specified commented lines in a file</p> <dl class="docutils"> <dt>path</dt> <dd>The full path to the file to be edited</dd> <dt>regex</dt> <dd>A regular expression used to find the lines that are to be uncommented. This regex should not include the comment character. A leading <code class="docutils literal notranslate"><span class="pre">^</span></code> character will be stripped for convenience (for easily switching between comment() and uncomment()).</dd> <dt>char <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">#</span></code></span>
</dt> <dd>The character to remove in order to uncomment a line</dd> <dt>backup <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">.bak</span></code></span>
</dt> <dd>The file will be backed up before edit with this file extension; <strong>WARNING:</strong> each time <code class="docutils literal notranslate"><span class="pre">sed</span></code>/<code class="docutils literal notranslate"><span class="pre">comment</span></code>/<code class="docutils literal notranslate"><span class="pre">uncomment</span></code> is called will overwrite this backup</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.uncomment /etc/hosts.deny 'ALL: PARANOID'</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.user_to_uid"> salt.modules.file.user_to_uid(user)</h3> <dd>
<p>Convert user name to a uid</p> <dl class="docutils"> <dt>user</dt> <dd>user name to convert to its uid</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.user_to_uid root</pre> </dd>
</dl> <dl class="function"> <h3 id="salt.modules.file.write"> salt.modules.file.write(path, *args, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified">New in version 2014.7.0.</span></p> </div> <p>Write text to a file, overwriting any existing contents.</p> <dl class="docutils"> <dt>path</dt> <dd>path to file</dd> <dt><cite>*args</cite></dt> <dd>strings to write to the file</dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' file.write /etc/motd \
        "With all thine offerings thou shalt offer salt."</pre> <div class="admonition-attention admonition"> <p class="first admonition-title">Attention</p> <p>If you need to pass a string to append and that string contains an equal sign, you <strong>must</strong> include the argument name, args. For example:</p> <div class="last highlight-bash notranslate">
<div class="highlight"><pre>salt <span class="s1">'*'</span> file.write /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s1">'cheese=spam'</span>

salt <span class="s1">'*'</span> file.write /etc/motd <span class="nv">args</span><span class="o">=</span><span class="s2">"['cheese=spam','spam=cheese']"</span>
</pre></div> </div> </div> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2019 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltstack.com/en/latest/ref/modules/all/salt.modules.file.html" class="_attribution-link">https://docs.saltstack.com/en/latest/ref/modules/all/salt.modules.file.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

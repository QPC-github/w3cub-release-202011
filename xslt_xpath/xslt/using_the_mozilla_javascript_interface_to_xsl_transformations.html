
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Using the Mozilla JavaScript Interface to XSL Transformations - XSLT &#38; XPath - W3cubDocs</title>
  
  <meta name="description" content=" This document describes the JavaScript interface in Mozilla 1.2 and up to the XSLT Processing Engine (TransforMiiX). ">
  <meta name="keywords" content="using, mozilla, javascript, interface, xsl, transformations, xslt, &#38;, xpath, xslt_xpath">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/xslt_xpath/xslt/using_the_mozilla_javascript_interface_to_xsl_transformations.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/xslt_xpath.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/xslt_xpath/" class="_nav-link" title="" style="margin-left:0;">XSLT & XPath</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<h1>Using the Mozilla JavaScript interface to XSL Transformations</h1>
<p>This document describes the JavaScript interface in Mozilla 1.2 and up to the XSLT Processing Engine (TransforMiiX).</p> <h2 id="Creating_an_XSLTProcessor" name="Creating_an_XSLTProcessor">Creating an XSLTProcessor</h2> <p>To start, you need to create an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> object:</p>  <pre data-language="js">var processor = new XSLTProcessor();
</pre>  <h2 id="Specifying_the_stylesheet" name="Specifying_the_stylesheet">Specifying the stylesheet</h2> <p>Before you can use it, you must import a stylesheet with the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/importStylesheet"><code>XSLTProcessor.importStylesheet()</code></a> method. It has a single parameter, which is the DOM Node of the XSLT stylesheet to import.</p> <div class="blockIndicator note">
<strong>Note:</strong> The import is live, meaning that if you alter the stylesheet DOM after importing it, this will be reflected in the processing. Rather than modifying the DOM it is recommended to use stylesheet parameters which are usually easier and can give better performance.</div> <pre data-language="js">var testTransform = document.implementation.createDocument("", "test", null);
// just an example to get a transform into a script as a DOM
// XMLDocument.load is asynchronous, so all processing happens in the 
// onload handler
testTransform.addEventListener("load", onload, false);
testTransform.load("test-transform.xml");
function onload() {
  processor.importStylesheet(testTransform);
}
</pre> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/importStylesheet"><code>XSLTProcessor.importStylesheet()</code></a> requires one argument, a DOM Node. If that node is a document node, you can pass in a full XSL Transform or a <a href="http://www.w3.org/TR/xslt#result-element-stylesheet">literal result element transform</a>, otherwise it must be an <code>xsl:stylesheet</code> or <code>xsl:transform</code> element.</p> <h2 id="Transforming_the_document" name="Transforming_the_document">Transforming the document</h2> <p>You can use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToDocument"><code>XSLTProcessor.transformToDocument()</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> methods to transform a document using the imported XSLT stylesheet.</p> <h4 id="transformToDocument" name="transformToDocument">transformToDocument</h4> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToDocument"><code>XSLTProcessor.transformToDocument()</code></a> takes one argument, the source node to transform, and returns a new <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document"><code>Document</code></a> with the results of the transformation:</p> <pre data-language="js">var newDocument = processor.transformToDocument(domToBeTransformed);
</pre> <p>The resultant object depends on the <a href="http://www.w3.org/TR/xslt#output">output method</a> of the stylesheet:</p> <ul> <li>
<strong>html</strong> - <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLDocument"><code>HTMLDocument</code></a>
</li> <li>
<strong>xml</strong> - <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLDocument"><code>XMLDocument</code></a>
</li> <li>
<strong>text</strong> - <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLDocument"><code>XMLDocument</code></a> with a single root element <code>&lt;transformiix:result&gt;</code> with the text as a child</li> </ul> <h4 id="transformToFragment" name="transformToFragment">transformToFragment</h4> <p>You can also use <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> which will return a <a href="https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment"><code>DocumentFragment</code></a> node. This is handy because appending a fragment to another node transparently appends all the children of that fragment, and the fragment itself is not merged. Fragments are therefore useful for moving nodes around and storing them without the overhead of a full document object.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> takes two arguments: the source document to be transformed (as above) and the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document"><code>Document</code></a> object that will own the fragment (all fragments must be owned by a document).</p> <pre data-language="js">var ownerDocument = document.implementation.createDocument("", "test", null);
var newFragment = processor.transformToFragment(domToBeTransformed, ownerDocument);
</pre> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> will only produce HTML DOM objects if the owner document is itself an <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLDocument"><code>HTMLDocument</code></a>, or if the output method of the stylesheet is HTML. It will <strong>not</strong> produce an HTML DOM objects if only the toplevel element of the result is <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/html"><code>&lt;html&gt;</code></a> as <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> is rarely used to create this element. If you want to override this, you can set the output method normally in the standard way.</p> <h4 id="transforming_HTML" name="transforming_HTML">transforming HTML</h4> <p>Unfortunately it is currently not supported to transform HTML nodes using XSLT. Some things work if you use lower case node-names in patterns and expressions, and treat the nodes as if they are in the null namespace, however this is not very well tested so it might not work in all situations. It is also possible that this will change in a future release.</p> <p>Transforming XHTML should work as expected though.</p> <h2 id="Setting_parameters" name="Setting_parameters">Setting parameters</h2> <p>You can control <a href="http://www.w3.org/TR/xslt#variables">parameters for the stylesheet</a> using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/setParameter"><code>XSLTProcessor.setParameter()</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/getParameter"><code>XSLTProcessor.getParameter()</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/removeParameter"><code>XSLTProcessor.removeParameter()</code></a> methods. These all take a namespace URI and a local name as the first two parameters, with <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/setParameter"><code>XSLTProcessor.setParameter()</code></a> taking a third - the value of the parameter to be set. See <a href="http://developer.mozilla.org/en/The_XSLT/JavaScript_Interface_in_Gecko:Setting_Parameters">The XSLT/JavaScript Interface in Gecko</a> for an example.</p> <h2 id="Resetting" name="Resetting">Resetting</h2> <p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> object also implements a <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/reset"><code>XSLTProcessor.reset()</code></a> method, which can be used to remove all stylesheets and parameters then put the processor back into its initial state. This method is implemented in <a href="https://developer.mozilla.org/en/Gecko">Mozilla</a> 1.3 and later.</p> <h2 id="Resources" name="Resources">Resources</h2> <p>The following reflect the interface of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> object:</p> <ul> <li><a href="https://dxr.mozilla.org/mozilla-central/source/dom/xslt/nsIXSLTProcessor.idl" rel="custom">nsIXSLTProcessor.idl</a></li> <li><a href="https://dxr.mozilla.org/mozilla-central/source/dom/webidl/XSLTProcessor.webidl" rel="custom">XSLTProcessor.webidl</a></li> </ul> <h2 id="Using_XSLTProcessor_from_XPCOM_components">Using XSLTProcessor from XPCOM components</h2> <p>Instantiating an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> from an XPCOM component requires a different syntax as the constructor is not defined inside components.</p> <p>Instead of this:</p> <pre data-language="js">var processor = new XSLTProcessor();
</pre> <p>Do this:</p> <pre data-language="js">var processor = Components.classes["@mozilla.org/document-transformer;1?type=xslt"]
                          .createInstance(Components.interfaces.nsIXSLTProcessor);
</pre> <h2 id="See_also" name="See_also">See also</h2> <ul> <li><a href="https://developer.mozilla.org/en/The_XSLT//JavaScript_Interface_in_Gecko">The XSLT JavaScript Interface in Gecko</a></li> <li>
<a href="https://developer.mozilla.org/en/DOM/document.load">document.load()</a> regarding the loading of XML documents (as used above)</li> </ul> <div class="originaldocinfo"> <h2 id="Original_Document_Information" name="Original_Document_Information">Original Document Information</h2> <ul> <li>Author(s): <a class="link-mailto" href="mailto:mike@theoretic.com">Mike Hearn</a>
</li> <li>Last Updated Date: December 21, 2005</li> <li>Copyright Information: Copyright (C) Mike Hearn</li> </ul> </div> <div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/XSLT/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations%24edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2020 Mozilla and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/XSLT/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/XSLT/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>XSLT JS Interface in Gecko.JavaScript XSLT Bindings - XSLT &#38; XPath - W3cubDocs</title>
  
  <meta name="description" content="JavaScript can run XSLT transformations through the XSLTProcessor object. Once instantiated, an XSLTProcessor has an XSLTProcessor.importStylesheet &hellip;">
  <meta name="keywords" content="xslt, js, interface, gecko, javascript, bindings, &#38;, xpath, xslt_xpath">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/xslt_xpath/xslt/xslt_js_interface_in_gecko/javascript_xslt_bindings.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/xslt_xpath.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/xslt_xpath/" class="_nav-link" title="" style="margin-left:0;">XSLT & XPath</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _mdn">
				
				
<h1>XSLT JS interface in Gecko.JavaScript XSLT Bindings</h1>
<h2 id="JavaScript.2FXSLT_Bindings" name="JavaScript.2FXSLT_Bindings">JavaScript/XSLT Bindings</h2> <p>JavaScript can run XSLT transformations through the <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> object. Once instantiated, an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> has an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/importStylesheet"><code>XSLTProcessor.importStylesheet()</code></a> method that takes as an argument the XSLT stylesheet to be used in the transformation. The stylesheet has to be passed in as an XML document, which means that the .xsl file has to be loaded by the page before calling <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/importStylesheet"><code>XSLTProcessor.importStylesheet()</code></a>. This can be done via <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLDocument/load"><code>XMLDocument.load()</code></a>.</p> <p><small><strong>Figure 1 : Instantiating an <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a></strong></small></p> <pre data-language="js">  var xsltProcessor = new XSLTProcessor();

  // Load the xsl file using synchronous (third param is set to false) XMLHttpRequest
  var myXMLHTTPRequest = new XMLHttpRequest();
  myXMLHTTPRequest.open("GET", "example.xsl", false);
  myXMLHTTPRequest.send(null);

  var xslRef = myXMLHTTPRequest.responseXML;

  // Finally import the .xsl
  xsltProcessor.importStylesheet(xslRef);
</pre> <p>For the actual transformation, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> requires an XML document, which is used in conjunction with the imported XSL file to produce the final result. The XML document can be a separate XML file loaded as shown in figure 1, or it can be part of the existing page. To process part of a page's DOM, it is necessary to first create an XML document in memory. Assuming that the DOM to be processed is contained by an element with the id <code>example</code>, that DOM can be "cloned" using the in-memory XML document's <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/importNode"><code>Document.importNode()</code></a> method. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/importNode"><code>Document.importNode()</code></a> allows transferring a DOM fragment between documents, in this case from an HTML document to an XML document. The first parameter references the DOM node to clone. By making the second parameter "true", it will clone all descendants as well (a deep clone). The cloned DOM can then be easily inserted into the XML document using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild"><code>Node.appendChild()</code></a>, as shown in figure 2.</p> <p><small><strong>Figure 2 : Creating an XML document based on part of a document's DOM</strong></small></p> <pre data-language="js">  // create a new XML document in memory
  var xmlRef = document.implementation.createDocument("", "", null);

  // we want to move a part of the DOM from an HTML document to an XML document.
  // importNode is used to clone the nodes we want to process via XSLT - true makes it do a deep clone
  var myNode = document.getElementById("example");
  var clonedNode = xmlRef.importNode(myNode, true);

  // add the cloned DOM into the XML document
  xmlRef.appendChild(clonedNode);
</pre> <p>Once the stylesheet has been imported, <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor"><code>XSLTProcessor</code></a> has to perform two methods for the actual transformation, namely <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToDocument"><code>XSLTProcessor.transformToDocument()</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a>. <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToDocument"><code>XSLTProcessor.transformToDocument()</code></a> returns a full XML document while <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> returns a document fragment that can be easily added to an existing document. Both take in the XML document as the first parameter that will be transformed. <a href="https://developer.mozilla.org/en-US/docs/Web/API/XSLTProcessor/transformToFragment"><code>XSLTProcessor.transformToFragment()</code></a> requires a second parameter, namely the document object that will own the generated fragment. If the generated fragment will be inserted into the current HTML document, passing in document is enough.</p> <p><small><strong>Figure 2.1 : Creating an XML document From a String 'XML Soup'</strong></small></p> <p>While you can use IE <code>loadXML</code> method to load a string containing XML you have to perform some tweaking and tuning to do the same in Mozilla. You must use the DomParser.no to create any document, as this is handled by the DomParser.</p> <pre data-language="js">var parser = new DOMParser();
var doc = parser.parseFromString(aStr, "text/xml");
</pre> <p><small><strong>Figure 3 : Performing the transformation</strong></small></p> <pre data-language="js">  var fragment = xsltProcessor.transformToFragment(xmlRef, document);
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/XSLT/XSLT_JS_interface_in_Gecko/JavaScript_XSLT_Bindings%24edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2020 Mozilla and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/XSLT/XSLT_JS_interface_in_Gecko/JavaScript_XSLT_Bindings" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/XSLT/XSLT_JS_interface_in_Gecko/JavaScript_XSLT_Bindings</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

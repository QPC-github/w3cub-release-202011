
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Data Fetching - Astro - W3cubDocs</title>
  
  <meta name="description" content=" .astro files can fetch remote data at build time to help generate your pages. ">
  <meta name="keywords" content="data, fetching, astro">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/astro/guides/data-fetching/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/astro.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/astro/" class="_nav-link" title="" style="margin-left:0;">Astro</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1 class="content-title astro-NDOP6O4T" id="overview">Data Fetching</h1> <p><code>.astro</code> files can fetch remote data at build time to help generate your pages.</p>
<div class="heading-wrapper level-h2" tabindex="-1"><h2 id="fetch-in-astro">
<code>fetch()</code> in Astro</h2></div>
<p>All <a href="../../core-concepts/astro-components/index">Astro components</a> have access to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/fetch">global <code>fetch()</code> function</a> in their component script to make HTTP requests to APIs. This fetch call will be executed at build time, and the data will be available to the component template for generating dynamic HTML.</p>
<p>ðŸ’¡ Take advantage of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await#top_level_await"><strong>top-level await</strong></a> inside of your Astro component script.</p>
<p>ðŸ’¡ Pass fetched data to both Astro and framework components, as props.</p>  <div class="_pre-heading"><span class="title">src/components/User.astro</span></div> <pre class="astro-code" data-language="astro">---
import Contact from '../components/Contact.jsx';
import Location from '../components/Location.astro';

const response = await fetch('https://randomuser.me/api/');
const data = await response.json();
const randomUser = data.results[0];
---
&lt;!-- Data fetched at build can be rendered in HTML --&gt;
&lt;h1&gt;User&lt;/h1&gt;
&lt;h2&gt;{randomUser.name.first} {randomUser.name.last}&lt;/h2&gt;

&lt;!-- Data fetched at build can be passed to components as props --&gt;
&lt;Contact client:load email={randomUser.email} /&gt;
&lt;Location city={randomUser.location.city} /&gt;</pre> <aside class="content note astro-J4JMU3BW" aria-label="Note"> <p class="title astro-J4JMU3BW" aria-hidden="true">  Note </p> <section class="astro-J4JMU3BW"> <p>Remember, all data in Astro components is fetched when a component is rendered.</p>
<p>Your deployed Astro site will fetch data <strong>once, at build time</strong>. In dev, you will see data fetches on component refreshes. If you need to re-fetch data multiple times client-side, use a <a href="../../core-concepts/framework-components/index">framework component</a> or a <a href="../../core-concepts/astro-components/index#client-side-scripts">client-side script</a> in an Astro component.</p> </section> </aside> <div class="heading-wrapper level-h2" tabindex="-1"><h2 id="fetch-in-framework-components">
<code>fetch()</code> in Framework Components</h2></div>
<p>The <code>fetch()</code> function is also globally available to any <a href="../../core-concepts/framework-components/index">framework components</a>:</p>  <div class="_pre-heading"><span class="title">src/components/Movies.tsx</span></div> <pre class="astro-code" data-language="tsx">import type { FunctionalComponent } from 'preact';
import { h } from 'preact';

const data = await fetch('https://example.com/movies.json').then((response) =&gt;
  response.json()
);

// Components that are build-time rendered also log to the CLI.
// When rendered with a client:* directive, they also log to the browser console.
console.log(data);

const Movies: FunctionalComponent = () =&gt; {
// Output the result to the page
  return &lt;div&gt;{JSON.stringify(data)}&lt;/div&gt;;
};

export default Movies;</pre> <div class="heading-wrapper level-h2" tabindex="-1"><h2 id="graphql-queries">GraphQL queries</h2></div>
<p>Astro can also use <code>fetch()</code> to query a GraphQL server with any valid GraphQL query.</p>  <div class="_pre-heading"><span class="title">src/components/Weather.astro</span></div> <pre class="astro-code" data-language="astro">---
const response = await fetch("https://graphql-weather-api.herokuapp.com",
  {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({
      query: `
        query getWeather($name:String!) {
            getCityByName(name: $name){
              name
              country
              weather {
                summary {
                    description
                }
              }
            }
          }
        `,
      variables: {
          name: "Toronto",
      },
    }),
  });

const json = await response.json();
const weather = json.data;
---
&lt;h1&gt;Fetching Weather at build time&lt;/h1&gt;
&lt;h2&gt;{weather.getCityByName.name}, {weather.getCityByName.country}&lt;/h2&gt;
&lt;p&gt;Weather: {weather.getCityByName.weather.summary.description}&lt;/p&gt;</pre> <div class="heading-wrapper level-h2" tabindex="-1"><h2 id="fetch-from-a-headless-cms">Fetch from a Headless CMS</h2></div>
<p>Fetch remote content from your favorite CMS like Storyblok or WordPress!</p>
<p>Astro components can fetch data from your CMS and then render it as your page content. Using <a href="../../core-concepts/routing/index#dynamic-routes">dynamic routes</a>, components can even generate pages based on your CMS content.</p>
<p>Here are some examples of what this data fetching looks like in Astro, with links to full tutorials below.</p>
<div class="heading-wrapper level-h3" tabindex="-1"><h3 id="example-storyblok-api">Example: Storyblok API</h3></div>  <div class="_pre-heading"><span class="title">src/pages/index.astro</span></div> <pre class="astro-code" data-language="astro">---
// Fetch a list of your Storyblok page links using @storyblok/js
import BaseLayout from '../layouts/BaseLayout.astro';
import { storyblokInit, apiPlugin } from "@storyblok/js";

const { storyblokApi } = storyblokInit({
  accessToken: "MY_STORYBLOK_ACCESS_TOKEN",
  use: [apiPlugin],
});

const { data } = await storyblokApi.get('cdn/links');
const links = Object.values(data.links);
---
&lt;BaseLayout&gt;
  &lt;h1&gt;Astro + Storyblok&lt;/h1&gt;
  &lt;ul&gt;
    {links.map(link =&gt; (
      &lt;li&gt;&lt;a href={link.slug}&gt;{link.name}&lt;/a&gt;&lt;/li&gt;
    ))}
  &lt;/ul&gt;
&lt;/BaseLayout&gt;</pre> <p>See the full tutorial <a href="https://www.storyblok.com/tp/add-a-headless-cms-to-astro-in-5-minutes">Add a Headless CMS to Astro in 5 Minutes</a> to add Storyblok to your Astro project!</p>
<div class="heading-wrapper level-h3" tabindex="-1"><h3 id="example-wordpress--graphql">Example: WordPress + GraphQL</h3></div>  <div class="_pre-heading"><span class="title">src/pages/about.astro</span></div> <pre class="astro-code" data-language="astro">---
// Fetch your about page content from the WordPress API

import BaseLayout from '../../layouts/BaseLayout.astro';

const slug = 'about';
const response = await fetch(import.meta.env.WORDPRESS_API_URL, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: `
    {
      page(id:"${slug}", idType:URI) {
        title 
        content 
      }
    }
  `
});
const data = await response.json();
---
&lt;BaseLayout&gt;
  &lt;h1&gt;{data.title}&lt;/h1&gt;
  &lt;article set:html={data.content} /&gt;
&lt;/BaseLayout&gt;</pre> <p>See the full tutorial <a href="https://blog.openreplay.com/building-an-astro-website-with-wordpress-as-a-headless-cms">Building an Astro Website with WordPress as a Headless CMS</a> to add WordPress to your Astro Project!</p>
<div class="heading-wrapper level-h3" tabindex="-1"><h3 id="example-crystallize">Example: Crystallize</h3></div>  <div class="_pre-heading"><span class="title">src/pages/index.astro</span></div> <pre class="astro-code" data-language="astro">---
// Fetch your catalogue paths from Crystallize GraphQL API

import BaseLayout from '../../layouts/BaseLayout.astro';
import { createClient } from '@crystallize/js-api-client';

const apiClient = createClient({
    tenantIdentifier: 'furniture'
});

const query = `
  query getCataloguePaths{
    catalogue(language: "en", path: "/shop") {
      name
      children {
        name
        path
      }
    }
  }
`
const { data: { catalogue } } = await apiClient.catalogueApi(query)
---
&lt;BaseLayout&gt;
  &lt;h1&gt;{catalogue.name}&lt;/h1&gt;
  &lt;nav&gt;
    &lt;ul&gt;
      {catalogue.children.map(child =&gt; (
        &lt;li&gt;&lt;a href={child.path}&gt;{child.name}&lt;/a&gt;&lt;/li&gt;
      ))}
    &lt;/ul&gt;
  &lt;/nav&gt;
&lt;/BaseLayout&gt;</pre>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/guides/data-fetching/" class="_attribution-link">https://docs.astro.build/en/guides/data-fetching/</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

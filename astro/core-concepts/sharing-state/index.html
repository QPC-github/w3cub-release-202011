
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Sharing State - Astro - W3cubDocs</title>
  
  <meta name="description" content="When building an Astro website with islands architecture &#47; partial hydration, you may have run into this problem&#58; I want to share state &hellip;">
  <meta name="keywords" content="sharing, state, astro">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/astro/core-concepts/sharing-state/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/astro.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/astro/" class="_nav-link" title="" style="margin-left:0;">Astro</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1 class="content-title astro-NDOP6O4T" id="overview">Sharing State</h1> <p>When building an Astro website with <a href="../../concepts/islands/index">islands architecture / partial hydration</a>, you may have run into this problem: <strong>I want to share state between my components.</strong></p>
<p>UI frameworks like React or Vue may encourage <a href="https://reactjs.org/docs/context.html">‚Äúcontext‚Äù providers</a> for other components to consume. But when <a href="../framework-components/index#hydrating-interactive-components">partially hydrating components</a> within Astro or Markdown, you can‚Äôt use these context wrappers.</p>
<p>Astro recommends a different solution for shared client-side storage: <a href="https://github.com/nanostores/nanostores"><strong>Nano Stores</strong></a>.</p>
<div class="heading-wrapper level-h2" tabindex="-1"><h2 id="why-nano-stores">Why Nano Stores?</h2></div>
<p>The <a href="https://github.com/nanostores/nanostores">Nano Stores</a> library allows you to author stores that any component can interact with. We recommend Nano Stores because:</p>
<ul> <li>
<strong>They‚Äôre lightweight.</strong> Nano Stores ship the bare minimum JS you‚Äôll need (less than 1 KB) with zero dependencies.</li> <li>
<strong>They‚Äôre framework-agnostic.</strong> This means sharing state between frameworks will be seamless! Astro is built on flexibility, so we love solutions that offer a similar developer experience no matter your preference.</li> </ul>
<p>Still, there are a number of alternatives you can explore. These include:</p>
<ul> <li><a href="https://svelte.dev/tutorial/writable-stores">Svelte‚Äôs built-in stores</a></li> <li>
<a href="https://www.solidjs.com/docs/latest">Solid signals</a> outside of a component context</li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events">Sending custom browser events</a> between components</li> </ul>
<aside class="content note astro-J4JMU3BW" aria-label="FAQ"> <p class="title astro-J4JMU3BW" aria-hidden="true">  FAQ </p> <section class="astro-J4JMU3BW"> <details><summary><strong>üôã Can I use Nano Stores in <code>.astro</code> files or other server-side components?</strong></summary><p>Nano Stores <em>can</em> be imported, written to, and read from in server-side components, <strong>but we don‚Äôt recommend it!</strong> This is due to a few restrictions:</p>
<ul> <li>Writing to a store from a <code>.astro</code> file or <a href="../framework-components/index#hydrating-interactive-components">non-hydrated component</a> will <em>not</em> affect the value received by <a href="../../reference/directives-reference/index#client-directives">client-side components</a>.</li> <li>You cannot pass a Nano Store as a ‚Äúprop‚Äù to client-side components.</li> <li>You cannot subscribe to store changes from a <code>.astro</code> file, since Astro components do not re-render.</li> </ul>
<p>If you understand these restrictions and still find a use case, you can give Nano Stores a try! Just remember that Nano Stores are built for reactivity to changes on the <strong>client</strong> specifically.</p></details><details><summary><strong>üôã How do Svelte stores compare to Nano Stores?</strong></summary><p><strong>Nano Stores and <a href="https://svelte.dev/tutorial/writable-stores">Svelte stores</a> are very similar!</strong> In fact, <a href="https://github.com/nanostores/nanostores#svelte">nanostores allow you to use the same <code>$</code> shortcut</a> for subscriptions that you might use with Svelte stores.</p>
<p>If you want to avoid third-party libraries, <a href="https://svelte.dev/tutorial/writable-stores">Svelte stores</a> are a great cross-island communication tool on their own. Still, you might prefer Nano Stores if a) you like their add-ons for <a href="https://github.com/nanostores/nanostores#maps">‚Äúobjects‚Äù</a> and <a href="https://github.com/nanostores/nanostores#lazy-stores">async state</a>, or b) you want to communicate between Svelte and other UI frameworks like Preact or Vue.</p></details><details><summary><strong>üôã How do Solid signals compare to Nano Stores?</strong></summary><p>If you‚Äôve used Solid for a while, you may have tried moving <a href="https://www.solidjs.com/docs/latest#createsignal">signals</a> or <a href="https://www.solidjs.com/docs/latest#createstore">stores</a> outside of your components. This is a great way to share state between Solid islands! Try exporting signals from a shared file:</p>  <div class="_pre-heading"><span class="title">sharedStore.js</span></div> <pre class="astro-code" data-language="js">import { createSignal } from 'solid-js';

export const sharedCount = createSignal(0);</pre> <p>‚Ä¶and all components importing <code>sharedCount</code> will share the same state. Though this works well, you might prefer Nano Stores if a) you like their add-ons for <a href="https://github.com/nanostores/nanostores#maps">‚Äúobjects‚Äù</a> and <a href="https://github.com/nanostores/nanostores#lazy-stores">async state</a>, or b) you want to communicate between Solid and other UI frameworks like Preact or Vue.</p></details> </section> </aside> <div class="heading-wrapper level-h2" tabindex="-1"><h2 id="installing-nano-stores">Installing Nano Stores</h2></div>
<p>To get started, install Nano Stores alongside their helper package for your favorite UI framework:</p>
<astro-island uid="ZhTVP4" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"ui-frameworks"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="37-tab.preact"><astro-slot name="tab.preact">Preact</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="37-tab.react"><astro-slot name="tab.react">React</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="37-tab.solid"><astro-slot name="tab.solid">Solid</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="37-tab.svelte"><astro-slot name="tab.svelte">Svelte</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="37-tab.vue"><astro-slot name="tab.vue">Vue</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="37-tab.preact" class="_tabpanel_8folw_27"><astro-slot name="panel.preact">   <pre class="astro-code" data-language="shell">npm i nanostores @nanostores/preact</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="37-tab.react" class="_tabpanel_8folw_27"><astro-slot name="panel.react">   <pre class="astro-code" data-language="shell">npm i nanostores @nanostores/react</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="37-tab.solid" class="_tabpanel_8folw_27"><astro-slot name="panel.solid">   <pre class="astro-code" data-language="shell">npm i nanostores @nanostores/solid</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="37-tab.vue" class="_tabpanel_8folw_27"><astro-slot name="panel.vue">   <pre class="astro-code" data-language="shell">npm i nanostores @nanostores/vue</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="37-tab.svelte" class="_tabpanel_8folw_27"><astro-slot name="panel.svelte">   <pre class="astro-code" data-language="shell">npm i nanostores</pre> <aside class="content note astro-J4JMU3BW" aria-label="Note"> <p class="title astro-J4JMU3BW" aria-hidden="true">  Note </p> <section class="astro-J4JMU3BW"> <p>No helper package here! Nano Stores can be used like standard Svelte stores.</p> </section> </aside> </astro-slot></div>
</div></astro-island><p>You can jump into the <a href="https://github.com/nanostores/nanostores#guide">Nano Stores usage guide</a> from here, or follow along with our example below!</p>
<div class="heading-wrapper level-h2" tabindex="-1"><h2 id="usage-example---ecommerce-cart-flyout">Usage example - ecommerce cart flyout</h2></div>
<p>Let‚Äôs say we‚Äôre building a simple ecommerce interface with three interactive elements:</p>
<ul> <li>An ‚Äúadd to cart‚Äù submission form</li> <li>A cart flyout to display those added items</li> <li>A cart flyout toggle</li> </ul>
<p><em><a href="https://github.com/withastro/astro/tree/main/examples/with-nanostores"><strong>Try the completed example</strong></a> on your machine or online via Stackblitz.</em></p>
<p>Your base Astro file may look like this:</p>  <div class="_pre-heading"><span class="title">src/pages/index.astro</span></div> <pre class="astro-code" data-language="astro">---
import CartFlyoutToggle from '../components/CartFlyoutToggle';
import CartFlyout from '../components/CartFlyout';
import AddToCartForm from '../components/AddToCartForm';
---

&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;...&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;nav&gt;
      &lt;a href="/"&gt;Astro storefront&lt;/a&gt;
      &lt;CartFlyoutToggle client:load /&gt;
    &lt;/nav&gt;
  &lt;/header&gt;
  &lt;main&gt;
    &lt;AddToCartForm client:load&gt;
    &lt;!-- ... --&gt;
    &lt;/AddToCartForm&gt;
  &lt;/main&gt;
  &lt;CartFlyout client:load /&gt;
&lt;/body&gt;
&lt;/html&gt;</pre> <div class="heading-wrapper level-h3" tabindex="-1"><h3 id="using-atoms">Using ‚Äúatoms‚Äù</h3></div>
<p>Let‚Äôs start by opening our <code>CartFlyout</code> whenever <code>CartFlyoutToggle</code> is clicked.</p>
<p>First, create a new JS or TS file to contain our store. We‚Äôll use an <a href="https://github.com/nanostores/nanostores#atoms">‚Äúatom‚Äù</a> for this:</p>  <div class="_pre-heading"><span class="title">src/cartStore.js</span></div> <pre class="astro-code" data-language="js">import { atom } from 'nanostores';

export const isCartOpen = atom(false);</pre> <p>Now, we can import this store into any file that needs to read or write. We‚Äôll start by wiring up our <code>CartFlyoutToggle</code>:</p>
<astro-island uid="Z2vxbpC" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"ui-frameworks"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="38-tab.preact"><astro-slot name="tab.preact">Preact</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="38-tab.react"><astro-slot name="tab.react">React</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="38-tab.solid"><astro-slot name="tab.solid">Solid</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="38-tab.svelte"><astro-slot name="tab.svelte">Svelte</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="38-tab.vue"><astro-slot name="tab.vue">Vue</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="38-tab.preact" class="_tabpanel_8folw_27"><astro-slot name="panel.preact">  <div class="_pre-heading"><span class="title">src/components/CartFlyoutToggle.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/preact';
import { isCartOpen } from '../cartStore';

export default function CartButton() {
  // read the store value with the `useStore` hook
  const $isCartOpen = useStore(isCartOpen);
  // write to the imported store using `.set`
  return (
    &lt;button onClick={() =&gt; isCartOpen.set(!$isCartOpen)}&gt;Cart&lt;/button&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="38-tab.react" class="_tabpanel_8folw_27"><astro-slot name="panel.react">  <div class="_pre-heading"><span class="title">src/components/CartFlyoutToggle.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/react';
import { isCartOpen } from '../cartStore';

export default function CartButton() {
  // read the store value with the `useStore` hook
  const $isCartOpen = useStore(isCartOpen);
  // write to the imported store using `.set`
  return (
    &lt;button onClick={() =&gt; isCartOpen.set(!$isCartOpen)}&gt;Cart&lt;/button&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="38-tab.solid" class="_tabpanel_8folw_27"><astro-slot name="panel.solid">  <div class="_pre-heading"><span class="title">src/components/CartFlyoutToggle.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/solid';
import { isCartOpen } from '../cartStore';

export default function CartButton() {
  // read the store value with the `useStore` hook
  const $isCartOpen = useStore(isCartOpen);
  // write to the imported store using `.set`
  return (
    &lt;button onClick={() =&gt; isCartOpen.set(!$isCartOpen)}&gt;Cart&lt;/button&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="38-tab.svelte" class="_tabpanel_8folw_27"><astro-slot name="panel.svelte">  <div class="_pre-heading"><span class="title">src/components/CartFlyoutToggle.svelte</span></div> <pre class="astro-code" data-language="svelte">&lt;script&gt;
  import { isCartOpen } from '../cartStore';
&lt;/script&gt;

&lt;!--use "$" to read the store value--&gt;
&lt;button on:click={() =&gt; isCartOpen.set(!$isCartOpen)}&gt;Cart&lt;/button&gt;</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="38-tab.vue" class="_tabpanel_8folw_27"><astro-slot name="panel.vue">  <div class="_pre-heading"><span class="title">src/components/CartFlyoutToggle.vue</span></div> <pre class="astro-code" data-language="vue">&lt;template&gt;
  &lt;!--write to the imported store using `.set`--&gt;
  &lt;button @click="isCartOpen.set(!$isCartOpen)"&gt;Cart&lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import { isCartOpen } from '../cartStore';
  import { useStore } from '@nanostores/vue';
  
  // read the store value with the `useStore` hook
  const $isCartOpen = useStore(isCartOpen);
&lt;/script&gt;</pre> </astro-slot></div>
</div></astro-island><p>Then, we can read <code>isCartOpen</code> from our <code>CartFlyout</code> component:</p>
<astro-island uid="Z7yn5C" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"ui-frameworks"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="39-tab.preact"><astro-slot name="tab.preact">Preact</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="39-tab.react"><astro-slot name="tab.react">React</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="39-tab.solid"><astro-slot name="tab.solid">Solid</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="39-tab.svelte"><astro-slot name="tab.svelte">Svelte</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="39-tab.vue"><astro-slot name="tab.vue">Vue</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="39-tab.preact" class="_tabpanel_8folw_27"><astro-slot name="panel.preact">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/preact';
import { isCartOpen } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);

  return $isCartOpen ? &lt;aside&gt;...&lt;/aside&gt; : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="39-tab.react" class="_tabpanel_8folw_27"><astro-slot name="panel.react">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/react';
import { isCartOpen } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);

  return $isCartOpen ? &lt;aside&gt;...&lt;/aside&gt; : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="39-tab.solid" class="_tabpanel_8folw_27"><astro-slot name="panel.solid">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/solid';
import { isCartOpen } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);

  return $isCartOpen ? &lt;aside&gt;...&lt;/aside&gt; : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="39-tab.svelte" class="_tabpanel_8folw_27"><astro-slot name="panel.svelte">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.svelte</span></div> <pre class="astro-code" data-language="svelte">&lt;script&gt;
  import { isCartOpen } from '../cartStore';
&lt;/script&gt;

{#if $isCartOpen}
&lt;aside&gt;...&lt;/aside&gt;
{/if}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="39-tab.vue" class="_tabpanel_8folw_27"><astro-slot name="panel.vue">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.vue</span></div> <pre class="astro-code" data-language="vue">&lt;template&gt;
  &lt;aside v-if="$isCartOpen"&gt;...&lt;/aside&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import { isCartOpen } from '../cartStore';
  import { useStore } from '@nanostores/vue';

  const $isCartOpen = useStore(isCartOpen);
&lt;/script&gt;</pre> </astro-slot></div>
</div></astro-island><div class="heading-wrapper level-h3" tabindex="-1"><h3 id="using-maps">Using ‚Äúmaps‚Äù</h3></div>
<aside class="content tip astro-J4JMU3BW" aria-label="Tip"> <p class="title astro-J4JMU3BW" aria-hidden="true">  Tip </p> <section class="astro-J4JMU3BW"> <p><strong><a href="https://github.com/nanostores/nanostores#maps">Maps</a> are a great choice for objects you write to regularly!</strong> Alongside the standard <code>get()</code> and <code>set()</code> helpers an <code>atom</code> provides, you‚Äôll also have a <code>.setKey()</code> function to efficiently update individual object keys.</p> </section> </aside> <p>Now, let‚Äôs keep track of the items inside your cart. To avoid duplicates and keep track of ‚Äúquantity,‚Äù we can store your cart as an object with the item‚Äôs ID as a key. We‚Äôll use a <a href="https://github.com/nanostores/nanostores#maps">Map</a> for this.</p>
<p>Let‚Äôs add a <code>cartItem</code> store to our <code>cartStore.js</code> from earlier. You can also switch to a TypeScript file to define the shape if you‚Äôre so inclined.</p>
<astro-island uid="2k3oFH" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"js-ts"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="35-tab.js"><astro-slot name="tab.js">JavaScript</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="35-tab.ts"><astro-slot name="tab.ts">TypeScript</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="35-tab.js" class="_tabpanel_8folw_27"><astro-slot name="panel.js">  <div class="_pre-heading"><span class="title">src/cartStore.js</span></div> <pre class="astro-code" data-language="js">import { atom, map } from 'nanostores';

export const isCartOpen = atom(false);

/**
 * @typedef {Object} CartItem
 * @property {string} id
 * @property {string} name
 * @property {string} imageSrc
 * @property {number} quantity
 */

/** @type {import('nanostores').MapStore&lt;Record&lt;string, CartItem&gt;&gt;} */
export const cartItems = map({});</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="35-tab.ts" class="_tabpanel_8folw_27"><astro-slot name="panel.ts">  <div class="_pre-heading"><span class="title">src/cartStore.ts</span></div> <pre class="astro-code" data-language="ts">import { atom, map } from 'nanostores';

export const isCartOpen = atom(false);

export type CartItem = {
  id: string;
  name: string;
  imageSrc: string;
  quantity: number;
}

export const cartItems = map&lt;Record&lt;string, CartItem&gt;&gt;({});</pre> </astro-slot></div>
</div></astro-island><p>Now, let‚Äôs export an <code>addCartItem</code> helper for our components to use.</p>
<ul> <li>
<strong>If that item doesn‚Äôt exist in your cart</strong>, add the item with a starting quantity of 1.</li> <li>
<strong>If that item <em>does</em> already exist</strong>, bump the quantity by 1.</li> </ul>
<astro-island uid="2fxgxG" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"js-ts"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="36-tab.js"><astro-slot name="tab.js">JavaScript</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="36-tab.ts"><astro-slot name="tab.ts">TypeScript</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="36-tab.js" class="_tabpanel_8folw_27"><astro-slot name="panel.js">  <div class="_pre-heading"><span class="title">src/cartStore.js</span></div> <pre class="astro-code" data-language="js">...
export function addCartItem({ id, name, imageSrc }) {
  const existingEntry = cartItems.get()[id];
  if (existingEntry) {
    cartItems.setKey(id, {
      ...existingEntry,
      quantity: existingEntry.quantity + 1,
    })
  } else {
    cartItems.setKey(
      id,
      { id, name, imageSrc, quantity: 1 }
    );
  }
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="36-tab.ts" class="_tabpanel_8folw_27"><astro-slot name="panel.ts">  <div class="_pre-heading"><span class="title">src/cartStore.ts</span></div> <pre class="astro-code" data-language="ts">...
type ItemDisplayInfo = Pick&lt;CartItem, 'id' | 'name' | 'imageSrc'&gt;;
export function addCartItem({ id, name, imageSrc }: ItemDisplayInfo) {
  const existingEntry = cartItems.get()[id];
  if (existingEntry) {
    cartItems.setKey(id, {
      ...existingEntry,
      quantity: existingEntry.quantity + 1,
    });
  } else {
    cartItems.setKey(
      id,
      { id, name, imageSrc, quantity: 1 }
    );
  }
}</pre> </astro-slot></div>
</div></astro-island><aside class="content note astro-J4JMU3BW" aria-label="Note"> <p class="title astro-J4JMU3BW" aria-hidden="true">  Note </p> <section class="astro-J4JMU3BW"> <details><summary><strong>üôã Why use <code>.get()</code> here instead of a <code>useStore</code> helper?</strong></summary><p>You may have noticed we‚Äôre calling <code>cartItems.get()</code> here, instead of grabbing that <code>useStore</code> helper from our React / Preact / Solid / Vue examples. This is because <strong>useStore is meant to trigger component re-renders.</strong> In other words, <code>useStore</code> should be used whenever the store value is being rendered to the UI. Since we‚Äôre reading the value when an <strong>event</strong> is triggered (<code>addToCart</code> in this case), and we aren‚Äôt trying to render that value, we don‚Äôt need <code>useStore</code> here.</p></details> </section> </aside> <p>With our store in place, we can call this function inside our <code>AddToCartForm</code> whenever that form is submitted. We‚Äôll also open the cart flyout so you can see a full cart summary.</p>
<astro-island uid="Zjd3X9" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"ui-frameworks"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="40-tab.preact"><astro-slot name="tab.preact">Preact</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="40-tab.react"><astro-slot name="tab.react">React</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="40-tab.solid"><astro-slot name="tab.solid">Solid</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="40-tab.svelte"><astro-slot name="tab.svelte">Svelte</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="40-tab.vue"><astro-slot name="tab.vue">Vue</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="40-tab.preact" class="_tabpanel_8folw_27"><astro-slot name="panel.preact">  <div class="_pre-heading"><span class="title">src/components/AddToCartForm.jsx</span></div> <pre class="astro-code" data-language="jsx">import { addCartItem, isCartOpen } from '../cartStore';

export default function AddToCartForm({ children }) {
  // we'll hardcode the item info for simplicity!
  const hardcodedItemInfo = {
    id: 'astronaut-figurine',
    name: 'Astronaut Figurine',
    imageSrc: '/images/astronaut-figurine.png',
  }

  function addToCart(e) {
    e.preventDefault();
    isCartOpen.set(true);
    addCartItem(hardcodedItemInfo);
  }

  return (
    &lt;form onSubmit={addToCart}&gt;
      {children}
    &lt;/form&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="40-tab.react" class="_tabpanel_8folw_27"><astro-slot name="panel.react">  <div class="_pre-heading"><span class="title">src/components/AddToCartForm.jsx</span></div> <pre class="astro-code" data-language="jsx">import { addCartItem, isCartOpen } from '../cartStore';

export default function AddToCartForm({ children }) {
  // we'll hardcode the item info for simplicity!
  const hardcodedItemInfo = {
    id: 'astronaut-figurine',
    name: 'Astronaut Figurine',
    imageSrc: '/images/astronaut-figurine.png',
  }

  function addToCart(e) {
    e.preventDefault();
    isCartOpen.set(true);
    addCartItem(hardcodedItemInfo);
  }

  return (
    &lt;form onSubmit={addToCart}&gt;
      {children}
    &lt;/form&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="40-tab.solid" class="_tabpanel_8folw_27"><astro-slot name="panel.solid">  <div class="_pre-heading"><span class="title">src/components/AddToCartForm.jsx</span></div> <pre class="astro-code" data-language="jsx">import { addCartItem, isCartOpen } from '../cartStore';

export default function AddToCartForm({ children }) {
  // we'll hardcode the item info for simplicity!
  const hardcodedItemInfo = {
    id: 'astronaut-figurine',
    name: 'Astronaut Figurine',
    imageSrc: '/images/astronaut-figurine.png',
  }

  function addToCart(e) {
    e.preventDefault();
    isCartOpen.set(true);
    addCartItem(hardcodedItemInfo);
  }

  return (
    &lt;form onSubmit={addToCart}&gt;
      {children}
    &lt;/form&gt;
  )
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="40-tab.svelte" class="_tabpanel_8folw_27"><astro-slot name="panel.svelte">  <div class="_pre-heading"><span class="title">src/components/AddToCartForm.svelte</span></div> <pre class="astro-code" data-language="svelte">&lt;form on:submit|preventDefault={addToCart}&gt;
  &lt;slot&gt;&lt;/slot&gt;
&lt;/form&gt;

&lt;script&gt;
  import { addCartItem, isCartOpen } from '../cartStore';

  // we'll hardcode the item info for simplicity!
  const hardcodedItemInfo = {
    id: 'astronaut-figurine',
    name: 'Astronaut Figurine',
    imageSrc: '/images/astronaut-figurine.png',
  }

  function addToCart() {
    isCartOpen.set(true);
    addCartItem(hardcodedItemInfo);
  }
&lt;/script&gt;</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="40-tab.vue" class="_tabpanel_8folw_27"><astro-slot name="panel.vue">  <div class="_pre-heading"><span class="title">src/components/AddToCartForm.vue</span></div> <pre class="astro-code" data-language="vue">&lt;template&gt;
  &lt;form @submit="addToCart"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/form&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import { addCartItem, isCartOpen } from '../cartStore';

  // we'll hardcode the item info for simplicity!
  const hardcodedItemInfo = {
    id: 'astronaut-figurine',
    name: 'Astronaut Figurine',
    imageSrc: '/images/astronaut-figurine.png',
  }

  function addToCart(e) {
    e.preventDefault();
    isCartOpen.set(true);
    addCartItem(hardcodedItemInfo);
  }
&lt;/script&gt;</pre> </astro-slot></div>
</div></astro-island><p>Finally, we‚Äôll render those cart items inside our <code>CartFlyout</code>:</p>
<astro-island uid="2i9mDb" component-url="/Tabs.72f9ffc0.js" component-export="default" renderer-url="/client.df501bbd.js" props='{"sharedStore":[0,"ui-frameworks"]}' ssr="" client="visible" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_8folw_1">
<div class="_tab-scroll-overflow_8folw_6"><div class="_tablist_8folw_31 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_8folw_6" id="41-tab.preact"><astro-slot name="tab.preact">Preact</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="41-tab.react"><astro-slot name="tab.react">React</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="41-tab.solid"><astro-slot name="tab.solid">Solid</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="41-tab.svelte"><astro-slot name="tab.svelte">Svelte</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_8folw_6" id="41-tab.vue"><astro-slot name="tab.vue">Vue</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="41-tab.preact" class="_tabpanel_8folw_27"><astro-slot name="panel.preact">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/preact';
import { isCartOpen, cartItems } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);
  const $cartItems = useStore(cartItems);

  return $isCartOpen ? (
    &lt;aside&gt;
      {Object.values($cartItems).length ? (
        &lt;ul&gt;
          {Object.values($cartItems).map(cartItem =&gt; (
            &lt;li&gt;
              &lt;img src={cartItem.imageSrc} alt={cartItem.name} /&gt;
              &lt;h3&gt;{cartItem.name}&lt;/h3&gt;
              &lt;p&gt;Quantity: {cartItem.quantity}&lt;/p&gt;
            &lt;/li&gt;
          ))}
        &lt;/ul&gt;
      ) : &lt;p&gt;Your cart is empty!&lt;/p&gt;}
    &lt;/aside&gt;
  ) : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="41-tab.react" class="_tabpanel_8folw_27"><astro-slot name="panel.react">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/react';
import { isCartOpen, cartItems } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);
  const $cartItems = useStore(cartItems);

  return $isCartOpen ? (
    &lt;aside&gt;
      {Object.values($cartItems).length ? (
        &lt;ul&gt;
          {Object.values($cartItems).map(cartItem =&gt; (
            &lt;li&gt;
              &lt;img src={cartItem.imageSrc} alt={cartItem.name} /&gt;
              &lt;h3&gt;{cartItem.name}&lt;/h3&gt;
              &lt;p&gt;Quantity: {cartItem.quantity}&lt;/p&gt;
            &lt;/li&gt;
          ))}
        &lt;/ul&gt;
      ) : &lt;p&gt;Your cart is empty!&lt;/p&gt;}
    &lt;/aside&gt;
  ) : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="41-tab.solid" class="_tabpanel_8folw_27"><astro-slot name="panel.solid">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.jsx</span></div> <pre class="astro-code" data-language="jsx">import { useStore } from '@nanostores/solid';
import { isCartOpen, cartItems } from '../cartStore';

export default function CartFlyout() {
  const $isCartOpen = useStore(isCartOpen);
  const $cartItems = useStore(cartItems);

  return $isCartOpen ? (
    &lt;aside&gt;
      {Object.values($cartItems).length ? (
        &lt;ul&gt;
          {Object.values($cartItems).map(cartItem =&gt; (
            &lt;li&gt;
              &lt;img src={cartItem.imageSrc} alt={cartItem.name} /&gt;
              &lt;h3&gt;{cartItem.name}&lt;/h3&gt;
              &lt;p&gt;Quantity: {cartItem.quantity}&lt;/p&gt;
            &lt;/li&gt;
          ))}
        &lt;/ul&gt;
      ) : &lt;p&gt;Your cart is empty!&lt;/p&gt;}
    &lt;/aside&gt;
  ) : null;
}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="41-tab.svelte" class="_tabpanel_8folw_27"><astro-slot name="panel.svelte">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.svelte</span></div> <pre class="astro-code" data-language="svelte">&lt;script&gt;
  import { isCartOpen, cartItems } from '../cartStore';
&lt;/script&gt;

{#if $isCartOpen}
  {#if Object.values($cartItems).length}
    &lt;aside&gt;
      {#each Object.values($cartItems) as cartItem}
      &lt;li&gt;
        &lt;img src={cartItem.imageSrc} alt={cartItem.name} /&gt;
        &lt;h3&gt;{cartItem.name}&lt;/h3&gt;
        &lt;p&gt;Quantity: {cartItem.quantity}&lt;/p&gt;
      &lt;/li&gt;
      {/each}
    &lt;/aside&gt;
  {#else}
    &lt;p&gt;Your cart is empty!&lt;/p&gt;
  {/if}
{/if}</pre> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="41-tab.vue" class="_tabpanel_8folw_27"><astro-slot name="panel.vue">  <div class="_pre-heading"><span class="title">src/components/CartFlyout.vue</span></div> <pre class="astro-code" data-language="vue">&lt;template&gt;
  &lt;aside v-if="$isCartOpen"&gt;
    &lt;ul v-if="Object.values($cartItems).length"&gt;
      &lt;li v-for="cartItem in Object.values($cartItems)" v-bind:key="cartItem.name"&gt;
        &lt;img :src=cartItem.imageSrc :alt=cartItem.name /&gt;
        &lt;h3&gt;{{cartItem.name}}&lt;/h3&gt;
        &lt;p&gt;Quantity: {{cartItem.quantity}}&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
    &lt;p v-else&gt;Your cart is empty!&lt;/p&gt;
  &lt;/aside&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import { cartItems, isCartOpen } from '../cartStore';
  import { useStore } from '@nanostores/vue';

  const $isCartOpen = useStore(isCartOpen);
  const $cartItems = useStore(cartItems);
&lt;/script&gt;</pre> </astro-slot></div>
</div></astro-island><p>Now, you should have a fully interactive ecommerce example with the smallest JS bundle in the galaxy üöÄ</p>
<p><a href="https://github.com/withastro/astro/tree/main/examples/with-nanostores"><strong>Try the completed example</strong></a> on your machine or online via Stackblitz!</p>
<div class="_attribution">
  <p class="_attribution-p">
    ¬© 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/core-concepts/sharing-state/" class="_attribution-link">https://docs.astro.build/en/core-concepts/sharing-state/</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

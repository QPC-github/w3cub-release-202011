
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Knife Bootstrap - Chef 12 - W3cubDocs</title>
  
  <meta name="description" content="A node is any physical, virtual, or cloud machine that is configured to be maintained by a chef-client. A bootstrap is a process that installs the &hellip;">
  <meta name="keywords" content="knife, bootstrap, chef, chef~12">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/chef~12/12-13/knife_bootstrap.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/chef~12.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/chef~12/" class="_nav-link" title="" style="margin-left:0;">Chef 12</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx_simple">
				
				
<h1 id="knife-bootstrap">knife bootstrap</h1> <p>A node is any physical, virtual, or cloud machine that is configured to be maintained by a chef-client. A bootstrap is a process that installs the chef-client on a target system so that it can run as a chef-client and communicate with a Chef server. There are two ways to do this:</p> <ul class="simple"> <li>Use the <code class="docutils literal">knife bootstrap</code> subcommand to <a class="reference internal" href="install_bootstrap">bootstrap a node using the omnibus installer</a>
</li> <li>Use an unattended install to bootstrap a node from itself, without using SSH or WinRM</li> </ul> <p>Use the <code class="docutils literal">knife bootstrap</code> subcommand to run a bootstrap operation that installs the chef-client on the target system. The bootstrap operation must specify the IP address or FQDN of the target system.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Starting with chef-client 12.0, use the <a class="reference internal" href="knife_ssl_fetch">knife ssl_fetch</a> command to pull down the SSL certificates from the on-premises Chef server and add them to the <code class="docutils literal">/trusted_certs_dir</code> on the workstation. This certificates is used during a knife bootstrap operation.</p> </div> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">To bootstrap the chef-client on Microsoft Windows machines, the knife-windows plugins is required, which includes the necessary bootstrap scripts that are used to do the actual installation.</p> </div>  <h2 id="syntax">Syntax</h2> <p>This subcommand has the following syntax:</p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap FQDN_or_IP_ADDRESS (options)</pre>   <h2 id="options">Options</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Review the list of <a class="reference internal" href="knife_common_options">common options</a> available to this (and all) knife subcommands and plugins.</p> </div> <p>This subcommand has the following options:</p> <dl class="docutils"> <dt>
<code class="docutils literal">-A</code>, <code class="docutils literal">--forward-agent</code>
</dt> <dd>Enable SSH agent forwarding.</dd> <dt><code class="docutils literal">--bootstrap-curl-options OPTIONS</code></dt> <dd>Arbitrary options to be added to the bootstrap command when using cURL. This option may not be used in the same command with <code class="docutils literal">--bootstrap-install-command</code>.</dd> <dt><code class="docutils literal">--bootstrap-install-command COMMAND</code></dt> <dd>Execute a custom installation command sequence for the chef-client. This option may not be used in the same command with <code class="docutils literal">--bootstrap-curl-options</code>, <code class="docutils literal">--bootstrap-install-sh</code>, or <code class="docutils literal">--bootstrap-wget-options</code>.</dd> <dt><code class="docutils literal">--bootstrap-install-sh URL</code></dt> <dd>Fetch and execute an installation script at the specified URL. This option may not be used in the same command with <code class="docutils literal">--bootstrap-install-command</code>.</dd> <dt><code class="docutils literal">--bootstrap-no-proxy NO_PROXY_URL_or_IP</code></dt> <dd>
<p class="first">A URL or IP address that specifies a location that should not be proxied.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">This option is used internally by Chef to help verify bootstrap operations during testing and should never be used during an actual bootstrap operation.</p> </div> </dd> <dt><code class="docutils literal">--bootstrap-proxy PROXY_URL</code></dt> <dd>The proxy server for the node that is the target of a bootstrap operation.</dd> <dt><code class="docutils literal">--bootstrap-vault-file VAULT_FILE</code></dt> <dd>The path to a JSON file that contains a list of vaults and items to be updated.</dd> <dt><code class="docutils literal">--bootstrap-vault-item VAULT_ITEM</code></dt> <dd>A single vault and item to update as <code class="docutils literal">vault:item</code>.</dd> <dt><code class="docutils literal">--bootstrap-vault-json VAULT_JSON</code></dt> <dd>
<p class="first">A JSON string that contains a list of vaults and items to be updated.</p> <p>For example:</p> <pre class="last highlight-none" data-language="none">--bootstrap-vault-json '{ "vault1": ["item1", "item2"], "vault2": "item2" }'</pre> </dd> <dt><code class="docutils literal">--bootstrap-version VERSION</code></dt> <dd>The version of the chef-client to install.</dd> <dt><code class="docutils literal">--bootstrap-wget-options OPTIONS</code></dt> <dd>Arbitrary options to be added to the bootstrap command when using GNU Wget. This option may not be used in the same command with <code class="docutils literal">--bootstrap-install-command</code>.</dd> <dt>
<code class="docutils literal">-E ENVIRONMENT</code>, <code class="docutils literal">--environment ENVIRONMENT</code>
</dt> <dd>The name of the environment. When this option is added to a command, the command will run only against the named environment.</dd> <dt>
<code class="docutils literal">-G GATEWAY</code>, <code class="docutils literal">--ssh-gateway GATEWAY</code>
</dt> <dd>The SSH tunnel or gateway that is used to run a bootstrap action on a machine that is not accessible from the workstation.</dd> <dt><code class="docutils literal">--hint HINT_NAME[=HINT_FILE]</code></dt> <dd>
<p class="first">An Ohai hint to be set on the target node.</p> <p>Ohai hints are used to tell Ohai something about the system that it is running on that it would not be able to discover itself. An Ohai hint exists if a JSON file exists in the hint directory with the same name as the hint. For example, calling <code class="docutils literal">hint?('antarctica')</code> in an Ohai plugin would return an empty hash if the file <code class="docutils literal">antarctica.json</code> existed in the hints directory, and return nil if the file does not exist.</p> <p>If the hint file contains JSON content, it will be returned as a hash from the call to <code class="docutils literal">hint?</code>.</p> <pre class="highlight-javascript" data-language="javascript">{
  "snow": true,
  "penguins": "many"
}</pre> <pre class="highlight-ruby" data-language="ruby">antarctica_hint = hint?('antarctica')
if antarctica_hint['snow']
  "There are #{antarctica_hint['penguins']} penguins here."
else
  'There is no snow here, and penguins like snow.'
end</pre> <p>The default directory in which hint files are located is <code class="docutils literal">/etc/chef/ohai/hints/</code>. Use the <code class="docutils literal">Ohai::Config[:hints_path]</code> setting in the client.rb file to customize this location.</p> <p class="last"><code class="docutils literal">HINT_FILE</code> is the name of the JSON file. <code class="docutils literal">HINT_NAME</code> is the name of a hint in a JSON file. Use multiple <code class="docutils literal">--hint</code> options to specify multiple hints.</p> </dd> <dt>
<code class="docutils literal">-i IDENTITY_FILE</code>, <code class="docutils literal">--ssh-identity-file IDENTITY_FILE</code>
</dt> <dd>The SSH identity file used for authentication. Key-based authentication is recommended.</dd> <dt>
<code class="docutils literal">-j JSON_ATTRIBS</code>, <code class="docutils literal">--json-attributes JSON_ATTRIBS</code>
</dt> <dd>A JSON string that is added to the first run of a chef-client.</dd> <dt>
<code class="docutils literal">-N NAME</code>, <code class="docutils literal">--node-name NAME</code>
</dt> <dd>
<p class="first">The name of the node.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">This option is required for a validatorless bootstrap (as of chef-client version 12.4).</p> </div> </dd> <dt><code class="docutils literal">--[no-]fips</code></dt> <dd>Allows OpenSSL to enforce FIPS-validated security during the chef-client run.</dd> <dt><code class="docutils literal">--[no-]host-key-verify</code></dt> <dd>Use <code class="docutils literal">--no-host-key-verify</code> to disable host key verification. Default setting: <code class="docutils literal">--host-key-verify</code>.</dd> <dt><code class="docutils literal">--[no-]node-verify-api-cert</code></dt> <dd>Verify the SSL certificate on the Chef server. When <code class="docutils literal">true</code>, the chef-client always verifies the SSL certificate. When <code class="docutils literal">false</code>, the chef-client uses the value of <code class="docutils literal">ssl_verify_mode</code> to determine if the SSL certificate requires verification. If this option is not specified, the setting for <code class="docutils literal">verify_api_cert</code> in the configuration file is applied.</dd> <dt><code class="docutils literal">--node-ssl-verify-mode PEER_OR_NONE</code></dt> <dd>
<p class="first">Set the verify mode for HTTPS requests.</p> <p>Use <code class="docutils literal">none</code> to do no validation of SSL certificates.</p> <p class="last">Use <code class="docutils literal">peer</code> to do validation of all SSL certificates, including the Chef server connections, S3 connections, and any HTTPS <strong>remote_file</strong> resource URLs used in the chef-client run. This is the recommended setting.</p> </dd> <dt>
<code class="docutils literal">-p PORT</code>, <code class="docutils literal">--ssh-port PORT</code>
</dt> <dd>The SSH port.</dd> <dt>
<code class="docutils literal">-P PASSWORD</code>, <code class="docutils literal">--ssh-password PASSWORD</code>
</dt> <dd>The SSH password. This can be used to pass the password directly on the command line. If this option is not specified (and a password is required) knife prompts for the password.</dd> <dt><code class="docutils literal">--prerelease</code></dt> <dd>Install pre-release gems.</dd> <dt>
<code class="docutils literal">-r RUN_LIST</code>, <code class="docutils literal">--run-list RUN_LIST</code>
</dt> <dd>A comma-separated list of roles and/or recipes to be applied.</dd> <dt><code class="docutils literal">--secret SECRET</code></dt> <dd>The encryption key that is used for values contained within a data bag item.</dd> <dt><code class="docutils literal">--secret-file FILE</code></dt> <dd>The path to the file that contains the encryption key.</dd> <dt><code class="docutils literal">--sudo</code></dt> <dd>Execute a bootstrap operation with sudo.</dd> <dt><code class="docutils literal">--sudo-preserve-home</code></dt> <dd>Use to preserve the non-root user’s <code class="docutils literal">HOME</code> environment.</dd> <dt>
<code class="docutils literal">-t TEMPLATE</code>, <code class="docutils literal">--bootstrap-template TEMPLATE</code>
</dt> <dd>The bootstrap template to use. This may be the name of a bootstrap template—<code class="docutils literal">chef-full</code>, for example—or it may be the full path to an Embedded Ruby (ERB) template that defines a custom bootstrap. Default value: <code class="docutils literal">chef-full</code>, which installs the chef-client using the omnibus installer on all supported platforms.</dd> <dt><code class="docutils literal">--use-sudo-password</code></dt> <dd>Perform a bootstrap operation with sudo; specify the password with the <code class="docutils literal">-P</code> (or <code class="docutils literal">--ssh-password</code>) option.</dd> <dt><code class="docutils literal">-V -V</code></dt> <dd>Run the initial chef-client run at the <code class="docutils literal">debug</code> log-level (e.g. <code class="docutils literal">chef-client -l debug</code>).</dd> <dt>
<code class="docutils literal">-x USERNAME</code>, <code class="docutils literal">--ssh-user USERNAME</code>
</dt> <dd>The SSH user name.</dd> </dl> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">See <a class="reference internal" href="config_rb_knife_optional_settings">knife.rb</a> for more information about how to add certain knife options as settings in the knife.rb file.</p> </div>  <h3 id="validatorless-bootstrap">Validatorless Bootstrap</h3> <p>The ORGANIZATION-validator.pem is typically added to the .chef directory on the workstation. When a node is bootstrapped from that workstation, the ORGANIZATION-validator.pem is used to authenticate the newly-created node to the Chef server during the initial chef-client run. Starting with chef-client version 12.1, it is possible to bootstrap a node using the USER.pem file instead of the ORGANIZATION-validator.pem file. This is known as a “validatorless bootstrap”.</p> <p>To create a node via the USER.pem file, simply delete the ORGANIZATION-validator.pem file on the workstation. For example:</p> <pre class="highlight-bash" data-language="bash">$ rm -f /home/lamont/.chef/myorg-validator.pem</pre> <p>and then make the following changes in the knife.rb file:</p> <ul class="simple"> <li>Remove the <code class="docutils literal">validation_client_name</code> setting</li> <li>Edit the <code class="docutils literal">validation_key</code> setting to be something that isn’t a path to an existent ORGANIZATION-validator.pem file. For example: <code class="docutils literal">/nonexist</code>.</li> </ul> <p>As long as a USER.pem is also present on the workstation from which the validatorless bootstrap operation will be initiated, the bootstrap operation will run and will use the USER.pem file instead of the ORGANIZATION-validator.pem file.</p> <p>When running a validatorless <code class="docutils literal">knife bootstrap</code> operation, the output is similar to:</p> <pre class="highlight-bash" data-language="bash">desktop% knife bootstrap 10.1.1.1 -N foo01.acme.org \
  -E dev -r 'role[base]' -j '{ "foo": "bar" }' \
  --ssh-user vagrant --sudo
Node foo01.acme.org exists, overwrite it? (Y/N)
Client foo01.acme.org exists, overwrite it? (Y/N)
Creating new client for foo01.acme.org
Creating new node for foo01.acme.org
Connecting to 10.1.1.1
10.1.1.1 Starting first Chef Client run...
[....etc...]</pre>  <h4 id="knife-bootstrap-options">
<code class="docutils literal">knife bootstrap</code> Options</h4> <p>Use the following options with a validatorless bootstrap to specify items that are stored in chef-vault:</p> <dl class="docutils"> <dt><code class="docutils literal">--bootstrap-vault-file VAULT_FILE</code></dt> <dd>The path to a JSON file that contains a list of vaults and items to be updated.</dd> <dt><code class="docutils literal">--bootstrap-vault-item VAULT_ITEM</code></dt> <dd>A single vault and item to update as <code class="docutils literal">vault:item</code>.</dd> <dt><code class="docutils literal">--bootstrap-vault-json VAULT_JSON</code></dt> <dd>
<p class="first">A JSON string that contains a list of vaults and items to be updated.</p> <p>For example:</p> <pre class="last highlight-none" data-language="none">--bootstrap-vault-json '{ "vault1": ["item1", "item2"], "vault2": "item2" }'</pre> </dd> </dl>    <h3 id="fips-mode">FIPS Mode</h3> <p>Federal Information Processing Standards (FIPS) is a United States government computer security standard that specifies security requirements for cryptography. The current version of the standard is FIPS 140-2. The chef-client can be configured to allow OpenSSL to enforce FIPS-validated security during a chef-client run. This will disable cryptography that is explicitly disallowed in FIPS-validated software, including certain ciphers and hashing algorithms. Any attempt to use any disallowed cryptography will cause the chef-client to throw an exception during a chef-client run.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Chef uses MD5 hashes to uniquely identify files that are stored on the Chef server. MD5 is used only to generate a unique hash identifier and is not used for any cryptographic purpose.</p> </div> <p>Notes about FIPS:</p> <ul class="simple"> <li>May be enabled for nodes running on Microsoft Windows and Enterprise Linux platforms</li> <li>Should only be enabled for environments that require FIPS 140-2 compliance</li> <li>May not be enabled for any version of the chef-client earlier than 12.8</li> </ul> <p><strong>Bootstrap a node using FIPS</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 12.34.56.789 -P vanilla -x root -r 'recipe[apt],recipe[xfs],recipe[vim]' --fips</pre> <p>which shows something similar to:</p> <pre class="highlight-none" data-language="none">OpenSSL FIPS 140 mode enabled
...
12.34.56.789 Chef Client finished, 12/12 resources updated in 78.942455583 seconds</pre>    <h2 id="custom-templates">Custom Templates</h2> <p>The <code class="docutils literal">chef-full</code> distribution uses the omnibus installer. For most bootstrap operations, regardless of the platform on which the target node is running, using the <code class="docutils literal">chef-full</code> distribution is the best approach for installing the chef-client on a target node. In some situations, using another supported distribution is necessary. And in some situations, a custom template may be required.</p> <p>For example, the default bootstrap operation relies on an Internet connection to get the distribution to the target node. If a target node cannot access the Internet, then a custom template can be used to define a specific location for the distribution so that the target node may access it during the bootstrap operation.</p> <p>For example, a bootstrap template file named “sea_power”:</p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 123.456.7.8 -x username -P password --sudo --bootstrap-template "sea_power"</pre> <p>The following examples show how a bootstrap template file can be customized for various platforms.</p>  <h3 id="template-locations">Template Locations</h3> <p>A custom bootstrap template file must be located in a <code class="docutils literal">bootstrap/</code> directory, which is typically located within the <code class="docutils literal">~/.chef/</code> directory on the local workstation.</p> <p>Use the <code class="docutils literal">--bootstrap-template</code> option with the <code class="docutils literal">knife bootstrap</code> subcommand to specify the name of the bootstrap template file. This location is configurable when the following setting is added to the knife.rb file:</p> <table class="docutils"> <colgroup> <col width="40%"> <col width="60%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Setting</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal">knife[:bootstrap_template]</code></td> <td>The path to a template file to be used during a bootstrap operation.</td> </tr> </tbody> </table>   <h3 id="ubuntu-14-04">Ubuntu 14.04</h3> <p>The following example shows how to modify the default script for Ubuntu 14.04. First, copy the bootstrap template from the default location. If the chef-client is installed from a RubyGems, the full path can be found in the gem contents. For example:</p> <pre class="highlight-bash" data-language="bash">$ gem contents chef | grep ubuntu12.04-gems
/Users/grantmc/.rvm/gems/ruby-2.0/gems/chef-12.0.2/lib/chef/knife/bootstrap/ubuntu14.04-gems.erb</pre> <p>Copy the template to the chef-repo in the <code class="docutils literal">.chef/bootstrap</code> directory:</p> <pre class="highlight-bash" data-language="bash">$ cp /Users/grantmc/.rvm/gems/ruby-2.0/gems/chef-12.0.2/
   lib/chef/knife/bootstrap/ubuntu14.04-gems.erb ~/chef-repo/.chef/
   bootstrap/ubuntu14.04-gems-mine.erb</pre> <p>Modify the template with any editor, then specify it using the <code class="docutils literal">--bootstrap-template</code> option as part of the the <code class="docutils literal">knife bootstrap</code> operation, or with any of the knife plug-ins that support cloud computing.</p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 192.168.1.100 -r 'role[webserver]' -bootstrap-template ubuntu14.04-gems-mine</pre> <p>Alternatively, an example bootstrap template can be found in the git source for the chef-repo: <a class="reference external" href="https://github.com/chef/chef/tree/master/lib/chef/knife/bootstrap">https://github.com/chef/chef/tree/master/lib/chef/knife/bootstrap</a>. Copy the template to <code class="docutils literal">~/.chef-repo/.chef/bootstrap/ubuntu14.04-apt.erb</code> and modify the template appropriately.</p>   <h3 id="debian-and-apt">Debian and Apt</h3> <p>The following example shows how to use the <code class="docutils literal">knife bootstrap</code> subcommand to create a client configuration file (/etc/chef/client.rb) that uses Hosted Chef as the Chef server. The configuration file will look something like:</p> <pre class="highlight-ruby" data-language="ruby">log_level        :info
log_location     STDOUT
chef_server_url  'https://api.opscode.com/organizations/NAME'
validation_client_name 'ORGNAME-validator'</pre> <p>The <code class="docutils literal">knife bootstrap</code> subcommand will look in three locations for the template that is used during the bootstrap operation. The locations are:</p> <ol class="arabic simple"> <li>A bootstrap directory in the installed knife library; the actual location may vary, depending how the chef-client is installed</li> <li>A bootstrap directory in the <code class="docutils literal">$PWD/.chef</code>, e.g. in <code class="docutils literal">~/chef-repo/.chef</code>
</li> <li>A bootstrap directory in the users <code class="docutils literal">$HOME/.chef</code>
</li> </ol> <p>If, in the example above, the second location was used, then create the <code class="docutils literal">.chef/bootstrap/</code> directory in the chef-repo, and then create the Embedded Ruby (ERB) template file by running commands similar to the following:</p> <pre class="highlight-bash" data-language="bash">mkdir ~/.chef/bootstrap
vi ~/.chef/bootstrap/debian6.0-apt.erb</pre> <p>When finished creating the directory and the Embedded Ruby (ERB) template file, edit the template to run the SSH commands. Then set up the validation certificate and the client configuration file.</p> <p>Finally, run the chef-client on the node using a <code class="docutils literal">knife bootstrap</code> command that specifies a run-list (the <code class="docutils literal">-r</code> option). The bootstrap template can be called using a command similar to the following:</p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap mynode.example.com -r 'role[webserver]','role[production]' --bootstrap-template debian6.0-apt</pre>   <h3 id="microsoft-windows">Microsoft Windows</h3> <p>The following example shows how to modify the default script for Microsoft Windows and Windows PowerShell:</p> <pre class="highlight-bash" data-language="bash">@setlocal

&lt;%= "SETX HTTP_PROXY \"#{knife_config[:bootstrap_proxy]}\"" if knife_config[:bootstrap_proxy] %&gt;
@mkdir &lt;%= bootstrap_directory %&gt;

&gt; &lt;%= bootstrap_directory %&gt;\wget.ps1 (
 &lt;%= win_wget_ps %&gt;
)

:install
@rem Install Chef using chef-client MSI installer

&lt;% url="http://reposerver.example.com/chef-client-12.0.2.windows.msi" -%&gt;
@set "REMOTE_SOURCE_MSI_URL=&lt;%= url %&gt;"
@set "LOCAL_DESTINATION_MSI_PATH=&lt;%= local_download_path %&gt;"

@powershell -ExecutionPolicy Unrestricted -NoProfile -NonInteractive "&amp; '&lt;%= bootstrap_directory %&gt;\wget.ps1' '%REMOTE_SOURCE_MSI_URL%' '%LOCAL_DESTINATION_MSI_PATH%'"

@REM Replace install_chef from knife-windows Gem with one that has extra flags to turn on Chef service feature -- only available in Chef &gt;= 12.0.x
@REM &lt;%= install_chef %&gt;
@echo Installing Chef Client 12.0.2 with msiexec
@msiexec /q /i "%LOCAL_DESTINATION_MSI_PATH%" ADDLOCAL="ChefClientFeature,ChefServiceFeature"
@endlocal

@echo Writing validation key...

&gt; &lt;%= bootstrap_directory %&gt;\validation.pem (
 &lt;%= validation_key %&gt;
)

@echo Validation key written.

&lt;% if @config[:encrypted_data_bag_secret] -%&gt;
&gt; &lt;%= bootstrap_directory %&gt;\encrypted_data_bag_secret (
 &lt;%= encrypted_data_bag_secret %&gt;
)
&lt;% end -%&gt;

&gt; &lt;%= bootstrap_directory %&gt;\client.rb (
 &lt;%= config_content %&gt;
)

&gt; &lt;%= bootstrap_directory %&gt;\first-boot.json (
 &lt;%= run_list %&gt;
)

&lt;%= start_chef %&gt;</pre>    <h2 id="examples">Examples</h2> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Bootstrap a node</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 12.34.56.789 -P vanilla -x root -r 'recipe[apt],recipe[xfs],recipe[vim]'</pre> <p>which shows something similar to:</p> <pre class="highlight-none" data-language="none">...
12.34.56.789 Chef Client finished, 12/12 resources updated in 78.942455583 seconds</pre> <p>Use <code class="docutils literal">knife node show</code> to verify:</p> <pre class="highlight-bash" data-language="bash">$ knife node show debian-wheezy.int.domain.org</pre> <p>which returns something similar to:</p> <pre class="highlight-none" data-language="none">Node Name:   debian-wheezy.int.domain.org
Environment: _default
FQDN:        debian-wheezy.int.domain.org
IP:          12.34.56.789
Run List:    recipe[apt], recipe[xfs], recipe[vim]
Roles:
Recipes:     apt, xfs, vim, apt::default, xfs::default, vim::default
Platform:    debian 7.4
Tags:</pre> <p><strong>Use an SSH password</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 192.168.1.1 -x username -P PASSWORD --sudo</pre> <p><strong>Use a file that contains a private key</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap 192.168.1.1 -x username -i ~/.ssh/id_rsa --sudo</pre> <p><strong>Fetch and execute an installation script from a URL</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap --bootstrap-install-sh http://mycustomserver.com/custom_install_chef_script.sh</pre> <p><strong>Specify options when using cURL</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap --bootstrap-curl-options "--proxy http://myproxy.com:8080"</pre> <p><strong>Specify options when using GNU Wget</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap --bootstrap-wget-options "-e use_proxy=yes -e http://myproxy.com:8080"</pre> <p><strong>Specify a custom installation command sequence</strong></p> <pre class="highlight-bash" data-language="bash">$ knife bootstrap --bootstrap-install-command "curl -l http://mycustomserver.com/custom_install_chef_script.sh | sudo bash -s --"</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef™ Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs-archive.chef.io/release/12-13/knife_bootstrap.html" class="_attribution-link">https://docs-archive.chef.io/release/12-13/knife_bootstrap.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Registry_key - Chef 12 - W3cubDocs</title>
  
  <meta name="description" content=" Use the registry_key resource to create and delete registry keys in Microsoft Windows. ">
  <meta name="keywords" content="registry, key, chef, chef~12">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/chef~12/12-13/resource_registry_key.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/chef~12.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/chef~12/" class="_nav-link" title="" style="margin-left:0;">Chef 12</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx_simple">
				
				
<h1 id="registry-key">registry_key</h1> <p>Use the <strong>registry_key</strong> resource to create and delete registry keys in Microsoft Windows.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p>64-bit versions of Microsoft Windows have a 32-bit compatibility layer in the registry that reflects and redirects certain keys (and their values) into specific locations (or logical views) of the registry hive.</p> <p>The chef-client can access any reflected or redirected registry key. The machine architecture of the system on which the chef-client is running is used as the default (non-redirected) location. Access to the <code class="docutils literal">SysWow64</code> location is redirected must be specified. Typically, this is only necessary to ensure compatibility with 32-bit applications that are running on a 64-bit operating system.</p> <p>32-bit versions of the chef-client (12.8 and earlier) and 64-bit versions of the chef-client (12.9 and later) generally behave the same in this situation, with one exception: it is only possible to read and write from a redirected registry location using chef-client version 12.9 (and later).</p> <p class="last">For more information, see: <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa384235(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/aa384235(v=vs.85).aspx</a>.</p> </div>  <h2 id="syntax">Syntax</h2> <p>A <strong>registry_key</strong> resource block creates and deletes registry keys in Microsoft Windows:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKEY_LOCAL_MACHINE\\...\\System" do
  values [{
    :name =&gt; "NewRegistryKeyValue",
    :type =&gt; :multi_string,
    :data =&gt; ['foo\0bar\0\0']
  }]
  action :create
end</pre> <p>Use multiple registry key entries with key values that are based on node attributes:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\name_of_registry_key' do
  values [{:name =&gt; 'key_name', :type =&gt; :string, :data =&gt; 'C:\Windows\System32\file_name.bmp'},
          {:name =&gt; 'key_name', :type =&gt; :string, :data =&gt; node['node_name']['attribute']['value']},
          {:name =&gt; 'key_name', :type =&gt; :string, :data =&gt; node['node_name']['attribute']['value']}
         ]
  action :create
end</pre> <p>The full syntax for all of the properties that are available to the <strong>registry_key</strong> resource is:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'name' do
  architecture               Symbol
  key                        String # defaults to 'name' if not specified
  notifies                   # see description
  provider                   Chef::Provider::Windows::Registry
  recursive                  TrueClass, FalseClass
  subscribes                 # see description
  values                     Hash, Array
  action                     Symbol # defaults to :create if not specified
end</pre> <p>where</p> <ul> <li>
<p class="first"><code class="docutils literal">registry_key</code> is the resource</p> </li> <li>
<p class="first"><code class="docutils literal">name</code> is the name of the resource block</p> </li> <li>
<p class="first"><code class="docutils literal">values</code> is a hash that contains at least one registry key to be created or deleted. Each registry key in the hash is grouped by brackets in which the <code class="docutils literal">:name</code>, <code class="docutils literal">:type</code>, and <code class="docutils literal">:data</code> values for that registry key are specified.</p> </li> <li>
<p class="first"><code class="docutils literal">:type</code> represents the values available for registry keys in Microsoft Windows. Use <code class="docutils literal">:binary</code> for REG_BINARY, <code class="docutils literal">:string</code> for REG_SZ, <code class="docutils literal">:multi_string</code> for REG_MULTI_SZ, <code class="docutils literal">:expand_string</code> for REG_EXPAND_SZ, <code class="docutils literal">:dword</code> for REG_DWORD, <code class="docutils literal">:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code class="docutils literal">:qword</code> for REG_QWORD.</p> <div class="admonition warning"> <p class="first admonition-title">Warning</p> <p class="last"><code class="docutils literal">:multi_string</code> must be an array, even if there is only a single string.</p> </div> </li> <li>
<p class="first"><code class="docutils literal">:action</code> identifies the steps the chef-client will take to bring the node into the desired state</p> </li> <li>
<p class="first"><code class="docutils literal">architecture</code>, <code class="docutils literal">key</code>, <code class="docutils literal">provider</code>, <code class="docutils literal">recursive</code> and <code class="docutils literal">values</code> are properties of this resource, with the Ruby type shown. See “Properties” section below for more information about all of the properties that may be used with this resource.</p> </li> </ul>  <h3 id="registry-key-path-separators">Registry Key Path Separators</h3> <p>A Microsoft Windows registry key can be used as a string in Ruby code, such as when a registry key is used as the name of a recipe. In Ruby, when a registry key is enclosed in a double-quoted string (<code class="docutils literal">" "</code>), the same backslash character (<code class="docutils literal">\</code>) that is used to define the registry key path separator is also used in Ruby to define an escape character. Therefore, the registry key path separators must be escaped when they are enclosed in a double-quoted string. For example, the following registry key:</p> <pre class="highlight-ruby" data-language="ruby">HKCU\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Themes</pre> <p>may be encloused in a single-quoted string with a single backslash:</p> <pre class="highlight-ruby" data-language="ruby">'HKCU\SOFTWARE\path\to\key\Themes'</pre> <p>or may be enclosed in a double-quoted string with an extra backslash as an escape character:</p> <pre class="highlight-ruby" data-language="ruby">"HKCU\\SOFTWARE\\path\\to\\key\\Themes"</pre>   <h3 id="recipe-dsl-methods">Recipe DSL Methods</h3> <p>Six methods are present in the Recipe DSL to help verify the registry during a chef-client run on the Microsoft Windows platform—<code class="docutils literal">registry_data_exists?</code>, <code class="docutils literal">registry_get_subkeys</code>, <code class="docutils literal">registry_get_values</code>, <code class="docutils literal">registry_has_subkeys?</code>, <code class="docutils literal">registry_key_exists?</code>, and <code class="docutils literal">registry_value_exists?</code>—these helpers ensure the <strong>powershell_script</strong> resource is idempotent.</p> <p>The recommended order in which registry key-specific methods should be used within a recipe is: <code class="docutils literal">key_exists?</code>, <code class="docutils literal">value_exists?</code>, <code class="docutils literal">data_exists?</code>, <code class="docutils literal">get_values</code>, <code class="docutils literal">has_subkeys?</code>, and then <code class="docutils literal">get_subkeys</code>.</p>  <h4 id="registry-data-exists">registry_data_exists?</h4> <p>Use the <code class="docutils literal">registry_data_exists?</code> method to find out if a Microsoft Windows registry key contains the specified data of the specified type under the value.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_data_exists?</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">registry_data_exists?(
  KEY_PATH,
  { :name =&gt; 'NAME', :type =&gt; TYPE, :data =&gt; DATA },
  ARCHITECTURE
)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key value. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">{ :name =&gt; 'NAME', :type =&gt; TYPE, :data =&gt; DATA }</code> is a hash that contains the expected name, type, and data of the registry key value</li> <li>
<code class="docutils literal">:type</code> represents the values available for registry keys in Microsoft Windows. Use <code class="docutils literal">:binary</code> for REG_BINARY, <code class="docutils literal">:string</code> for REG_SZ, <code class="docutils literal">:multi_string</code> for REG_MULTI_SZ, <code class="docutils literal">:expand_string</code> for REG_EXPAND_SZ, <code class="docutils literal">:dword</code> for REG_DWORD, <code class="docutils literal">:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code class="docutils literal">:qword</code> for REG_QWORD.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This method will return <code class="docutils literal">true</code> or <code class="docutils literal">false</code>.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>   <h4 id="registry-get-subkeys">registry_get_subkeys</h4> <p>Use the <code class="docutils literal">registry_get_subkeys</code> method to get a list of registry key values that are present for a Microsoft Windows registry key.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_get_subkeys</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">subkey_array = registry_get_subkeys(KEY_PATH, ARCHITECTURE)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This returns an array of registry key values.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>   <h4 id="registry-get-values">registry_get_values</h4> <p>Use the <code class="docutils literal">registry_get_values</code> method to get the registry key values (name, type, and data) for a Microsoft Windows registry key.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_get_values</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">subkey_array = registry_get_values(KEY_PATH, ARCHITECTURE)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This returns an array of registry key values.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>   <h4 id="registry-has-subkeys">registry_has_subkeys?</h4> <p>Use the <code class="docutils literal">registry_has_subkeys?</code> method to find out if a Microsoft Windows registry key has one (or more) values.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_has_subkeys?</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">registry_has_subkeys?(KEY_PATH, ARCHITECTURE)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This method will return <code class="docutils literal">true</code> or <code class="docutils literal">false</code>.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>   <h4 id="registry-key-exists">registry_key_exists?</h4> <p>Use the <code class="docutils literal">registry_key_exists?</code> method to find out if a Microsoft Windows registry key exists at the specified path.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_key_exists?</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">registry_key_exists?(KEY_PATH, ARCHITECTURE)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This method will return <code class="docutils literal">true</code> or <code class="docutils literal">false</code>. (Any registry key values that are associated with this registry key are ignored.)</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>   <h4 id="registry-value-exists">registry_value_exists?</h4> <p>Use the <code class="docutils literal">registry_value_exists?</code> method to find out if a registry key value exists. Use <code class="docutils literal">registry_data_exists?</code> to test for the type and data of a registry key value.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">This method can be used in recipes and from within the <code class="docutils literal">not_if</code> and <code class="docutils literal">only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> <p>The syntax for the <code class="docutils literal">registry_value_exists?</code> method is as follows:</p> <pre class="highlight-ruby" data-language="ruby">registry_value_exists?(
  KEY_PATH,
  { :name =&gt; 'NAME' },
  ARCHITECTURE
)</pre> <p>where:</p> <ul class="simple"> <li>
<code class="docutils literal">KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</li> <li>
<code class="docutils literal">{ :name =&gt; 'NAME' }</code> is a hash that contains the name of the registry key value; if either <code class="docutils literal">:type</code> or <code class="docutils literal">:value</code> are specified in the hash, they are ignored</li> <li>
<code class="docutils literal">:type</code> represents the values available for registry keys in Microsoft Windows. Use <code class="docutils literal">:binary</code> for REG_BINARY, <code class="docutils literal">:string</code> for REG_SZ, <code class="docutils literal">:multi_string</code> for REG_MULTI_SZ, <code class="docutils literal">:expand_string</code> for REG_EXPAND_SZ, <code class="docutils literal">:dword</code> for REG_DWORD, <code class="docutils literal">:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code class="docutils literal">:qword</code> for REG_QWORD.</li> <li>
<code class="docutils literal">ARCHITECTURE</code> is one of the following values: <code class="docutils literal">:x86_64</code>, <code class="docutils literal">:i386</code>, or <code class="docutils literal">:machine</code>. In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</li> </ul> <p>This method will return <code class="docutils literal">true</code> or <code class="docutils literal">false</code>.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div>     <h2 id="actions">Actions</h2> <p>This resource has the following actions:</p> <dl class="docutils"> <dt><code class="docutils literal">:create</code></dt> <dd>Default. Create a registry key. If a registry key already exists (but does not match), update that registry key to match.</dd> <dt><code class="docutils literal">:create_if_missing</code></dt> <dd>Create a registry key if it does not exist. Also, create a registry key value if it does not exist.</dd> <dt><code class="docutils literal">:delete</code></dt> <dd>Delete the specified values for a registry key.</dd> <dt><code class="docutils literal">:delete_key</code></dt> <dd>Delete the specified registry key and all of its subkeys.</dd> <dt><code class="docutils literal">:nothing</code></dt> <dd>Define this resource block to do nothing until notified by another resource to take action. When this resource is notified, this resource block is either run immediately or it is queued up to be run at the end of the chef-client run.</dd> </dl> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Be careful when using the <code class="docutils literal">:delete_key</code> action with the <code class="docutils literal">recursive</code> attribute. This will delete the registry key, all of its values and all of the names, types, and data associated with them. This cannot be undone by the chef-client.</p> </div>   <h2 id="properties">Properties</h2> <p>This resource has the following properties:</p> <dl class="docutils"> <dt><code class="docutils literal">architecture</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Symbol</p> <p>The architecture of the node for which keys are to be created or deleted. Possible values: <code class="docutils literal">:i386</code> (for nodes with a 32-bit registry), <code class="docutils literal">:x86_64</code> (for nodes with a 64-bit registry), and <code class="docutils literal">:machine</code> (to have the chef-client determine the architecture during the chef-client run). Default value: <code class="docutils literal">:machine</code>.</p> <p>In order to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows, the <code class="docutils literal">architecture</code> property must be set to <code class="docutils literal">:i386</code>. The <code class="docutils literal">:x86_64</code> value can be used to force writing to a 64-bit registry location, but this value is less useful than the default (<code class="docutils literal">:machine</code>) because the chef-client returns an exception if <code class="docutils literal">:x86_64</code> is used and the machine turns out to be a 32-bit machine (whereas with <code class="docutils literal">:machine</code>, the chef-client is able to access the registry key on the 32-bit machine).</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">The <code class="docutils literal">ARCHITECTURE</code> attribute should only specify <code class="docutils literal">:x86_64</code> or <code class="docutils literal">:i386</code> when it is necessary to write 32-bit (<code class="docutils literal">:i386</code>) or 64-bit (<code class="docutils literal">:x86_64</code>) values on a 64-bit machine. <code class="docutils literal">ARCHITECTURE</code> will default to <code class="docutils literal">:machine</code> unless a specific value is given.</p> </div> </dd> <dt><code class="docutils literal">ignore_failure</code></dt> <dd>
<p class="first"><strong>Ruby Types:</strong> TrueClass, FalseClass</p> <p class="last">Continue running a recipe if a resource fails for any reason. Default value: <code class="docutils literal">false</code>.</p> </dd> <dt><code class="docutils literal">key</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> String</p> <p class="last">The path to the location in which a registry key is to be created or from which a registry key is to be deleted. Default value: the <code class="docutils literal">name</code> of the resource block See “Syntax” section above for more information. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code class="docutils literal">HKLM\SECURITY</code> and <code class="docutils literal">HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code class="docutils literal">HKEY_LOCAL_MACHINE</code>, <code class="docutils literal">HKLM</code>, <code class="docutils literal">HKEY_CURRENT_CONFIG</code>, <code class="docutils literal">HKCC</code>, <code class="docutils literal">HKEY_CLASSES_ROOT</code>, <code class="docutils literal">HKCR</code>, <code class="docutils literal">HKEY_USERS</code>, <code class="docutils literal">HKU</code>, <code class="docutils literal">HKEY_CURRENT_USER</code>, and <code class="docutils literal">HKCU</code>.</p> </dd> <dt><code class="docutils literal">notifies</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Symbol, ‘Chef::Resource[String]’</p> <p>A resource may notify another resource to take action when its state changes. Specify a <code class="docutils literal">'resource[name]'</code>, the <code class="docutils literal">:action</code> that resource should take, and then the <code class="docutils literal">:timer</code> for that action. A resource may notifiy more than one resource; use a <code class="docutils literal">notifies</code> statement for each resource to be notified.</p> <p>A timer specifies the point during the chef-client run at which a notification is run. The following timers are available:</p> <dl class="docutils"> <dt><code class="docutils literal">:before</code></dt> <dd>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</dd> <dt><code class="docutils literal">:delayed</code></dt> <dd>Default. Specifies that a notification should be queued up, and then executed at the very end of the chef-client run.</dd> <dt>
<code class="docutils literal">:immediate</code>, <code class="docutils literal">:immediately</code>
</dt> <dd>Specifies that a notification should be run immediately, per resource notified.</dd> </dl> <p>The syntax for <code class="docutils literal">notifies</code> is:</p> <pre class="last highlight-ruby" data-language="ruby">notifies :action, 'resource[name]', :timer</pre> </dd> <dt><code class="docutils literal">provider</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Chef Class</p> <p class="last">Optional. Explicitly specifies a provider.</p> </dd> <dt><code class="docutils literal">recursive</code></dt> <dd>
<p class="first"><strong>Ruby Types:</strong> TrueClass, FalseClass</p> <p>When creating a key, this value specifies that the required keys for the specified path are to be created. When using the <code class="docutils literal">:delete_key</code> action in a recipe, and if the registry key has subkeys, then set the value for this property to <code class="docutils literal">true</code>.</p> <div class="last admonition note"> <p class="first admonition-title">Note</p> <p class="last">Be careful when using the <code class="docutils literal">:delete_key</code> action with the <code class="docutils literal">recursive</code> attribute. This will delete the registry key, all of its values and all of the names, types, and data associated with them. This cannot be undone by the chef-client.</p> </div> </dd> <dt><code class="docutils literal">retries</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Integer</p> <p class="last">The number of times to catch exceptions and retry the resource. Default value: <code class="docutils literal">0</code>.</p> </dd> <dt><code class="docutils literal">retry_delay</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Integer</p> <p class="last">The retry delay (in seconds). Default value: <code class="docutils literal">2</code>.</p> </dd> <dt><code class="docutils literal">subscribes</code></dt> <dd>
<p class="first"><strong>Ruby Type:</strong> Symbol, ‘Chef::Resource[String]’</p> <p>A resource may listen to another resource, and then take action if the state of the resource being listened to changes. Specify a <code class="docutils literal">'resource[name]'</code>, the <code class="docutils literal">:action</code> to be taken, and then the <code class="docutils literal">:timer</code> for that action.</p> <p>A timer specifies the point during the chef-client run at which a notification is run. The following timers are available:</p> <dl class="docutils"> <dt><code class="docutils literal">:before</code></dt> <dd>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</dd> <dt><code class="docutils literal">:delayed</code></dt> <dd>Default. Specifies that a notification should be queued up, and then executed at the very end of the chef-client run.</dd> <dt>
<code class="docutils literal">:immediate</code>, <code class="docutils literal">:immediately</code>
</dt> <dd>Specifies that a notification should be run immediately, per resource notified.</dd> </dl> <p>The syntax for <code class="docutils literal">subscribes</code> is:</p> <pre class="last highlight-ruby" data-language="ruby">subscribes :action, 'resource[name]', :timer</pre> </dd> <dt><code class="docutils literal">values</code></dt> <dd>
<p class="first"><strong>Ruby Types:</strong> Hash, Array</p> <p>An array of hashes, where each Hash contains the values that are to be set under a registry key. Each Hash must contain <code class="docutils literal">:name</code>, <code class="docutils literal">:type</code>, and <code class="docutils literal">:data</code> (and must contain no other key values).</p> <p><code class="docutils literal">:type</code> represents the values available for registry keys in Microsoft Windows. Use <code class="docutils literal">:binary</code> for REG_BINARY, <code class="docutils literal">:string</code> for REG_SZ, <code class="docutils literal">:multi_string</code> for REG_MULTI_SZ, <code class="docutils literal">:expand_string</code> for REG_EXPAND_SZ, <code class="docutils literal">:dword</code> for REG_DWORD, <code class="docutils literal">:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code class="docutils literal">:qword</code> for REG_QWORD.</p> <div class="last admonition warning"> <p class="first admonition-title">Warning</p> <p class="last"><code class="docutils literal">:multi_string</code> must be an array, even if there is only a single string.</p> </div> </dd> </dl>   <h2 id="examples">Examples</h2> <p>The following examples demonstrate various approaches for using resources in recipes. If you want to see examples of how Chef uses resources in recipes, take a closer look at the cookbooks that Chef authors and maintains: <a class="reference external" href="https://github.com/chef-cookbooks">https://github.com/chef-cookbooks</a>.</p> <p><strong>Create a registry key</strong></p> <p>Use a double-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKEY_LOCAL_MACHINE\\path-to-key\\Policies\\System" do
  values [{
    :name =&gt; 'EnableLUA',
    :type =&gt; :dword,
    :data =&gt; 0
  }]
  action :create
end</pre> <p>or a single-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'HKEY_LOCAL_MACHINE\path-to-key\Policies\System' do
  values [{
    :name =&gt; 'EnableLUA',
    :type =&gt; :dword,
    :data =&gt; 0
  }]
  action :create
end</pre> <p><strong>Delete a registry key value</strong></p> <p>Use a double-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKEY_LOCAL_MACHINE\\SOFTWARE\\path\\to\\key\\AU" do
  values [{
    :name =&gt; 'NoAutoRebootWithLoggedOnUsers',
    :type =&gt; :dword,
    :data =&gt; ''
    }]
  action :delete
end</pre> <p>or a single-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'HKEY_LOCAL_MACHINE\SOFTWARE\path\to\key\AU' do
  values [{
    :name =&gt; 'NoAutoRebootWithLoggedOnUsers',
    :type =&gt; :dword,
    :data =&gt; ''
    }]
  action :delete
end</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">If <code class="docutils literal">:data</code> is not specified, you get an error: <code class="docutils literal">Missing data key in RegistryKey values hash</code></p> </div> <p><strong>Delete a registry key and its subkeys, recursively</strong></p> <p>Use a double-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKCU\\SOFTWARE\\Policies\\path\\to\\key\\Themes" do
  recursive true
  action :delete_key
end</pre> <p>or a single-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'HKCU\SOFTWARE\Policies\path\to\key\Themes' do
  recursive true
  action :delete_key
end</pre> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Be careful when using the <code class="docutils literal">:delete_key</code> action with the <code class="docutils literal">recursive</code> attribute. This will delete the registry key, all of its values and all of the names, types, and data associated with them. This cannot be undone by the chef-client.</p> </div> <p><strong>Use re-directed keys</strong></p> <p>In 64-bit versions of Microsoft Windows, <code class="docutils literal">HKEY_LOCAL_MACHINE\SOFTWARE\Example</code> is a re-directed key. In the following examples, because <code class="docutils literal">HKEY_LOCAL_MACHINE\SOFTWARE\Example</code> is a 32-bit key, the output will be “Found 32-bit key” if they are run on a version of Microsoft Windows that is 64-bit:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKEY_LOCAL_MACHINE\\SOFTWARE\\Example" do
  architecture :i386
  recursive true
  action :create
end</pre> <p>or:</p> <pre class="highlight-ruby" data-language="ruby">registry_key "HKEY_LOCAL_MACHINE\\SOFTWARE\\Example" do
  architecture :x86_64
  recursive true
  action :delete_key
end</pre> <p>or:</p> <pre class="highlight-ruby" data-language="ruby">ruby_block 'check 32-bit' do
  block do
    puts 'Found 32-bit key'
  end
  only_if {
    registry_key_exists?("HKEY_LOCAL_MACHINE\SOFTWARE\\Example",
    :i386)
  }
end</pre> <p>or:</p> <pre class="highlight-ruby" data-language="ruby">ruby_block 'check 64-bit' do
  block do
    puts 'Found 64-bit key'
  end
  only_if {
    registry_key_exists?("HKEY_LOCAL_MACHINE\\SOFTWARE\\Example",
    :x86_64)
  }
end</pre> <p><strong>Set proxy settings to be the same as those used by the chef-client</strong></p> <p>Use a double-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">proxy = URI.parse(Chef::Config[:http_proxy])
registry_key "HKCU\Software\Microsoft\path\to\key\Internet Settings" do
  values [{:name =&gt; 'ProxyEnable', :type =&gt; :reg_dword, :data =&gt; 1},
          {:name =&gt; 'ProxyServer', :data =&gt; "#{proxy.host}:#{proxy.port}"},
          {:name =&gt; 'ProxyOverride', :type =&gt; :reg_string, :data =&gt; &lt;local&gt;},
         ]
  action :create
end</pre> <p>or a single-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">proxy = URI.parse(Chef::Config[:http_proxy])
registry_key 'HKCU\Software\Microsoft\path\to\key\Internet Settings' do
  values [{:name =&gt; 'ProxyEnable', :type =&gt; :reg_dword, :data =&gt; 1},
          {:name =&gt; 'ProxyServer', :data =&gt; "#{proxy.host}:#{proxy.port}"},
          {:name =&gt; 'ProxyOverride', :type =&gt; :reg_string, :data =&gt; &lt;local&gt;},
         ]
  action :create
end</pre> <p><strong>Set the name of a registry key to “(Default)”</strong></p> <p>Use a double-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'Set (Default) value' do
  action :create
  key "HKLM\\Software\\Test\\Key\\Path"
  values [
    {:name =&gt; '', :type =&gt; :string, :data =&gt; 'test'},
  ]
end</pre> <p>or a single-quoted string:</p> <pre class="highlight-ruby" data-language="ruby">registry_key 'Set (Default) value' do
  action :create
  key 'HKLM\Software\Test\Key\Path'
  values [
    {:name =&gt; '', :type =&gt; :string, :data =&gt; 'test'},
  ]
end</pre> <p>where <code class="docutils literal">:name =&gt; ''</code> contains an empty string, which will set the name of the registry key to <code class="docutils literal">(Default)</code>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef™ Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs-archive.chef.io/release/12-13/resource_registry_key.html" class="_attribution-link">https://docs-archive.chef.io/release/12-13/resource_registry_key.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

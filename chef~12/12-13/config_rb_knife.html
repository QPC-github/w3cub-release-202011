
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>knife.rb - Chef 12 - W3cubDocs</title>
  
  <meta name="description" content=" A knife.rb file is used to specify the chef-repo-specific configuration details for knife. ">
  <meta name="keywords" content="knife, rb, chef, chef~12">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/chef~12/12-13/config_rb_knife.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/chef~12.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/chef~12/" class="_nav-link" title="" style="margin-left:0;">Chef 12</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx_simple">
				
				
<h1 id="knife-rb">knife.rb</h1> <p>A knife.rb file is used to specify the chef-repo-specific configuration details for knife.</p> <p>A knife.rb file:</p> <ul class="simple"> <li>Is loaded every time this executable is run</li> <li>Is not created by default</li> <li>Is located by default at <code class="docutils literal">~/chef-repo/.chef/knife.rb</code> (UNIX and Linux platforms) or <code class="docutils literal">c:\Users\username\.chef</code> (Microsoft Windows platform, starting with Chef development kit version 0.7.0); use the <code class="docutils literal">--config</code> option from the command line to change this location</li> <li>Will override the default configuration when a knife.rb file exists at the default path or the path specified by the <code class="docutils literal">--config</code> option</li> </ul> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">When running Microsoft Windows, the knife.rb file is located at <code class="docutils literal">%HOMEDRIVE%:%HOMEPATH%\chef-repo\.chef</code> (e.g. <code class="docutils literal">c:\Users\&lt;username&gt;\chef-repo\.chef</code>). If this path needs to be scripted, use <code class="docutils literal">%USERPROFILE%\chef-repo\.chef</code>.</p> </div>  <h2 id="settings">Settings</h2> <p>This configuration file has the following settings:</p> <dl class="docutils"> <dt><code class="docutils literal">bootstrap_template</code></dt> <dd>The path to a template file to be used during a bootstrap operation.</dd> <dt><code class="docutils literal">chef_server_url</code></dt> <dd>
<p class="first">The URL for the Chef server. For example:</p> <pre class="last highlight-ruby" data-language="ruby">chef_server_url 'https://localhost/organizations/ORG_NAME'</pre> </dd> <dt><code class="docutils literal">chef_zero.enabled</code></dt> <dd>
<p class="first">Enable chef-zero. This setting requires <code class="docutils literal">local_mode</code> to be set to <code class="docutils literal">true</code>. Default value: <code class="docutils literal">false</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">chef_zero.enabled true</pre> </dd> <dt><code class="docutils literal">chef_zero[:port]</code></dt> <dd>
<p class="first">The port on which chef-zero is to listen. Default value: <code class="docutils literal">8889</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">chef_zero[:port] 8889</pre> </dd> <dt><code class="docutils literal">client_key</code></dt> <dd>
<p class="first">The location of the file that contains the client key. Default value: <code class="docutils literal">/etc/chef/client.pem</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">client_key '/etc/chef/client.pem'</pre> </dd> <dt><code class="docutils literal">cookbook_copyright</code></dt> <dd>The name of the copyright holder. This option places a copyright notice that contains the name of the copyright holder in each of the pre-created files. If this option is not specified, a copyright name of “COMPANY_NAME” is used instead; it can easily be modified later.</dd> <dt><code class="docutils literal">cookbook_email</code></dt> <dd>The email address for the individual who maintains the cookbook. This option places an email address in each of the pre-created files. If not specified, an email name of “YOUR_EMAIL” is used instead; this can easily be modified later.</dd> <dt><code class="docutils literal">cookbook_license</code></dt> <dd>The type of license under which a cookbook is distributed: <code class="docutils literal">apachev2</code>, <code class="docutils literal">gplv2</code>, <code class="docutils literal">gplv3</code>, <code class="docutils literal">mit</code>, or <code class="docutils literal">none</code> (default). This option places the appropriate license notice in the pre-created files: <code class="docutils literal">Apache v2.0</code> (for <code class="docutils literal">apachev2</code>), <code class="docutils literal">GPL v2</code> (for <code class="docutils literal">gplv2</code>), <code class="docutils literal">GPL v3</code> (for <code class="docutils literal">gplv3</code>), <code class="docutils literal">MIT</code> (for <code class="docutils literal">mit</code>), or <code class="docutils literal">license 'Proprietary - All Rights Reserved</code> (for <code class="docutils literal">none</code>). Be aware of the licenses for files inside of a cookbook and be sure to follow any restrictions they describe.</dd> <dt><code class="docutils literal">cookbook_path</code></dt> <dd>
<p class="first">The sub-directory for cookbooks on the chef-client. This value can be a string or an array of file system locations, processed in the specified order. The last cookbook is considered to override local modifications. For example:</p> <pre class="last highlight-ruby" data-language="ruby">cookbook_path [
  '/var/chef/cookbooks',
  '/var/chef/site-cookbooks'
]</pre> </dd> <dt><code class="docutils literal">data_bag_encrypt_version</code></dt> <dd>
<p class="first">The minimum required version of data bag encryption. Possible values: <code class="docutils literal">1</code> or <code class="docutils literal">2</code>. When all of the machines in an organization are running chef-client version 11.6 (or higher), it is recommended that this value be set to <code class="docutils literal">2</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">data_bag_encrypt_version 2</pre> </dd> <dt><code class="docutils literal">fips</code></dt> <dd>Allows OpenSSL to enforce FIPS-validated security during the chef-client run. Set to <code class="docutils literal">true</code> to enable FIPS-validated security.</dd> <dt><code class="docutils literal">local_mode</code></dt> <dd>
<p class="first">Run the chef-client in local mode. This allows all commands that work against the Chef server to also work against the local chef-repo. For example:</p> <pre class="last highlight-ruby" data-language="ruby">local_mode true</pre> </dd> <dt><code class="docutils literal">node_name</code></dt> <dd>
<p class="first">The name of the node. This may be a username with permission to authenticate to the Chef server or it may be the name of the machine from which knife is run. For example:</p> <pre class="highlight-ruby" data-language="ruby">node_name 'user_name'</pre> <p>or:</p> <pre class="last highlight-ruby" data-language="ruby">node_name 'machine_name'</pre> </dd> <dt><code class="docutils literal">no_proxy</code></dt> <dd>
<p class="first">A comma-separated list of URLs that do not need a proxy. Default value: <code class="docutils literal">nil</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">no_proxy 'localhost, 10.*, *.example.com, *.dev.example.com'</pre> </dd> <dt><code class="docutils literal">ssh_timeout</code></dt> <dd>The amount of time (in seconds) to wait for an SSH connection time out.</dd> <dt><code class="docutils literal">ssl_verify_mode</code></dt> <dd>
<p class="first">Set the verify mode for HTTPS requests.</p> <ul class="simple"> <li>Use <code class="docutils literal">:verify_none</code> to do no validation of SSL certificates.</li> <li>Use <code class="docutils literal">:verify_peer</code> to do validation of all SSL certificates, including the Chef server connections, S3 connections, and any HTTPS <strong>remote_file</strong> resource URLs used in the chef-client run. This is the recommended setting.</li> </ul> <p class="last">Depending on how OpenSSL is configured, the <code class="docutils literal">ssl_ca_path</code> may need to be specified. Default value: <code class="docutils literal">:verify_peer</code>.</p> </dd> <dt><code class="docutils literal">syntax_check_cache_path</code></dt> <dd>All files in a cookbook must contain valid Ruby syntax. Use this setting to specify the location in which knife caches information about files that have been checked for valid Ruby syntax.</dd> <dt><code class="docutils literal">tmux_split</code></dt> <dd>Split the Tmux window. Default value: <code class="docutils literal">false</code>.</dd> <dt><code class="docutils literal">validation_client_name</code></dt> <dd>
<p class="first">The name of the chef-validator key that is used by the chef-client to access the Chef server during the initial chef-client run. For example:</p> <pre class="last highlight-ruby" data-language="ruby">validation_client_name 'chef-validator'</pre> </dd> <dt><code class="docutils literal">validation_key</code></dt> <dd>
<p class="first">The location of the file that contains the key used when a chef-client is registered with a Chef server. A validation key is signed using the <code class="docutils literal">validation_client_name</code> for authentication. Default value: <code class="docutils literal">/etc/chef/validation.pem</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">validation_key '/etc/chef/validation.pem'</pre> </dd> <dt><code class="docutils literal">verify_api_cert</code></dt> <dd>Verify the SSL certificate on the Chef server. When <code class="docutils literal">true</code>, the chef-client always verifies the SSL certificate. When <code class="docutils literal">false</code>, the chef-client uses the value of <code class="docutils literal">ssl_verify_mode</code> to determine if the SSL certificate requires verification. Default value: <code class="docutils literal">false</code>.</dd> <dt><code class="docutils literal">versioned_cookbooks</code></dt> <dd>
<p class="first">Append cookbook versions to cookbooks. Set to <code class="docutils literal">false</code> to hide cookbook versions: <code class="docutils literal">cookbooks/apache</code>. Set to <code class="docutils literal">true</code> to show cookbook versions: <code class="docutils literal">cookbooks/apache-1.0.0</code> and/or <code class="docutils literal">cookbooks/apache-1.0.1</code>. When this setting is <code class="docutils literal">true</code>, <code class="docutils literal">knife download</code> downloads ALL cookbook versions, which can be useful if a full-fidelity backup of data on the Chef server is required. For example:</p> <pre class="last highlight-ruby" data-language="ruby">versioned_cookbooks true</pre> </dd> </dl>  <h3 id="proxy-settings">Proxy Settings</h3> <p>In certain situations the proxy used by the Chef server requires authentication. In this situation, three settings must be added to the configuration file. Which settings to add depends on the protocol used to access the Chef server: HTTP or HTTPS.</p> <p>If the Chef server is configured to use HTTP, add the following settings:</p> <dl class="docutils"> <dt><code class="docutils literal">http_proxy</code></dt> <dd>
<p class="first">The proxy server for HTTP connections. Default value: <code class="docutils literal">nil</code>. For example:</p> <pre class="last highlight-ruby" data-language="ruby">http_proxy 'http://proxy.vmware.com:3128'</pre> </dd> <dt><code class="docutils literal">http_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using an HTTP connection. Default value: <code class="docutils literal">nil</code>.</dd> <dt><code class="docutils literal">http_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using an HTTP connection. Default value: <code class="docutils literal">nil</code>.</dd> </dl> <p>If the Chef server is configured to use HTTPS (such as the hosted Chef server), add the following settings:</p> <dl class="docutils"> <dt><code class="docutils literal">https_proxy</code></dt> <dd>The proxy server for HTTPS connections. (The hosted Chef server uses an HTTPS connection.) Default value: <code class="docutils literal">nil</code>.</dd> <dt><code class="docutils literal">https_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using an HTTPS connection. Default value: <code class="docutils literal">nil</code>.</dd> <dt><code class="docutils literal">https_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using an HTTPS connection. Default value: <code class="docutils literal">nil</code>.</dd> </dl> <p>Use the following setting to specify URLs that do not need a proxy:</p> <dl class="docutils"> <dt><code class="docutils literal">no_proxy</code></dt> <dd>A comma-separated list of URLs that do not need a proxy. Default value: <code class="docutils literal">nil</code>.</dd> </dl>    <h2 id="optional-settings">Optional Settings</h2> <p>In addition to the default settings in a knife.rb file, there are other subcommand-specific settings that can be added. When a subcommand is run, knife will use:</p> <ol class="arabic simple"> <li>A value passed via the command-line</li> <li>A value contained in the knife.rb file</li> <li>The default value</li> </ol> <p>A value passed via the command line will override a value in the knife.rb file; a value in a knife.rb file will override a default value.</p> <p>Before adding any settings to the knife.rb file:</p> <ul class="simple"> <li>Verify the settings by reviewing the documentation for the knife subcommands and/or knife plugins</li> <li>Verify the use case(s) your organization has for adding them</li> </ul> <p>Also note that:</p> <ul class="simple"> <li>Custom plugins can be configured to use the same settings as the core knife subcommands</li> <li>Many of these settings are used by more than one subcommand and/or plugin</li> <li>Some of the settings are included only because knife checks for a value in the knife.rb file</li> </ul> <p>To add settings to the knife.rb file, use the following syntax:</p> <pre class="highlight-ruby" data-language="ruby">knife[:setting_name] = value</pre> <p>where <code class="docutils literal">value</code> may require quotation marks (‘ ‘) if that value is a string. For example:</p> <pre class="highlight-ruby" data-language="ruby">knife[:ssh_port] = 22
knife[:bootstrap_template] = 'ubuntu14.04-gems'
knife[:bootstrap_version] = ''
knife[:bootstrap_proxy] = ''</pre> <p>Some of the optional knife.rb settings are used often, such as the template file used in a bootstrap operation. The frequency of use of any option varies from organization to organization, so even though the following settings are often added to a knife.rb file, they may not be the right settings to add for every organization:</p> <dl class="docutils"> <dt><code class="docutils literal">knife[:bootstrap_proxy]</code></dt> <dd>The proxy server for the node that is the target of a bootstrap operation.</dd> <dt><code class="docutils literal">knife[:bootstrap_template]</code></dt> <dd>The path to a template file to be used during a bootstrap operation.</dd> <dt><code class="docutils literal">knife[:bootstrap_version]</code></dt> <dd>The version of the chef-client to install.</dd> <dt><code class="docutils literal">knife[:editor]</code></dt> <dd>The $EDITOR that is used for all interactive commands.</dd> <dt><code class="docutils literal">knife[:ssh_gateway]</code></dt> <dd>The SSH tunnel or gateway that is used to run a bootstrap action on a machine that is not accessible from the workstation. Adding this setting can be helpful when a user cannot SSH directly into a host.</dd> <dt><code class="docutils literal">knife[:ssh_port]</code></dt> <dd>The SSH port.</dd> </dl> <p>Other SSH-related settings that are sometimes helpful when added to the knife.rb file:</p> <dl class="docutils"> <dt><code class="docutils literal">knife[:forward_agent]</code></dt> <dd>Enable SSH agent forwarding.</dd> <dt><code class="docutils literal">knife[:ssh_attribute]</code></dt> <dd>The attribute used when opening an SSH connection.</dd> <dt><code class="docutils literal">knife[:ssh_password]</code></dt> <dd>The SSH password. This can be used to pass the password directly on the command line. If this option is not specified (and a password is required) knife prompts for the password.</dd> <dt><code class="docutils literal">knife[:ssh_user]</code></dt> <dd>The SSH user name.</dd> </dl> <p>Some organizations choose to have all data bags use the same secret and secret file, rather than have a unique secret and secret file for each data bag. To use the same secret and secret file for all data bags, add the following to knife.rb:</p> <dl class="docutils"> <dt><code class="docutils literal">knife[:secret]</code></dt> <dd>The encryption key that is used for values contained within a data bag item.</dd> <dt><code class="docutils literal">knife[:secret_file]</code></dt> <dd>The path to the file that contains the encryption key.</dd> </dl> <p>Some settings are better left to Ohai, which will get the value at the start of the chef-client run:</p> <dl class="docutils"> <dt><code class="docutils literal">knife[:server_name]</code></dt> <dd>Same as node_name. Recommended configuration is to allow Ohai to collect this value during each chef-client run.</dd> <dt><code class="docutils literal">node_name</code></dt> <dd>See the description above for this setting.</dd> </dl> <p>When working with chef-container, add the following setting:</p> <dl class="docutils"> <dt><code class="docutils literal">knife[:dockerfiles_path]</code></dt> <dd>The path to the directory in which Docker contexts are stored. Default value: <code class="docutils literal">/var/chef/dockerfiles</code>.</dd> </dl> <div class="admonition warning"> <p class="first admonition-title">Warning</p> <p class="last">Review the full list of <a class="reference internal" href="config_rb_knife_optional_settings">optional settings</a> that can be added to the knife.rb file. Many of these optional settings should not be added to the knife.rb file. The reasons for not adding them can vary. For example, using <code class="docutils literal">--yes</code> as a default in the knife.rb file will cause knife to always assume that “Y” is the response to any prompt, which may lead to undesirable outcomes. Other settings, such as <code class="docutils literal">--hide-healthy</code> (used only with the <code class="docutils literal">knife status</code> subcommand) or <code class="docutils literal">--bare-directories</code> (used only with the <code class="docutils literal">knife list</code> subcommand) probably aren’t used often enough (and in the same exact way) to justify adding them to the knife.rb file. In general, if the optional settings are not listed on <a class="reference internal" href="config_rb_knife">the main knife.rb topic</a>, then add settings only after careful consideration. Do not use optional settings in a production environment until after the setting’s performance has been validated in a safe testing environment.</p> </div>   <h2 id="many-users-same-repo">Many Users, Same Repo</h2> <p>It is possible for multiple users to access the Chef server using the same knife.rb file. (A user can even access multiple organizations if, for example, each instance of the chef-repo contained the same copy of the knife.rb file.) This can be done by adding the knife.rb file to the chef-repo, and then using environment variables to handle the user-specific credential details and/or sensitive values. For example:</p> <pre class="highlight-none" data-language="none">current_dir = File.dirname(__FILE__)
  user = ENV['OPSCODE_USER'] || ENV['USER']
  node_name                user
  client_key               "#{ENV['HOME']}/chef-repo/.chef/#{user}.pem"
  validation_client_name   "#{ENV['ORGNAME']}-validator"
  validation_key           "#{ENV['HOME']}/chef-repo/.chef/#{ENV['ORGNAME']}-validator.pem"
  chef_server_url          "https://api.opscode.com/organizations/#{ENV['ORGNAME']}"
  syntax_check_cache_path  "#{ENV['HOME']}/chef-repo/.chef/syntax_check_cache"
  cookbook_path            ["#{current_dir}/../cookbooks"]
  cookbook_copyright       "Your Company, Inc."
  cookbook_license         "apachev2"
  cookbook_email           "cookbooks@yourcompany.com"

  # Amazon AWS
  knife[:aws_access_key_id] = ENV['AWS_ACCESS_KEY_ID']
  knife[:aws_secret_access_key] = ENV['AWS_SECRET_ACCESS_KEY']

  # Rackspace Cloud
  knife[:rackspace_api_username] = ENV['RACKSPACE_USERNAME']
  knife[:rackspace_api_key] = ENV['RACKSPACE_API_KEY']</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef™ Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs-archive.chef.io/release/12-13/config_rb_knife.html" class="_attribution-link">https://docs-archive.chef.io/release/12-13/config_rb_knife.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Log Files - Chef 12 - W3cubDocs</title>
  
  <meta name="description" content="All logs generated by the Chef server can be found in &#47;var&#47;log&#47;opscode. Each service enabled on the system also has a sub-directory in &hellip;">
  <meta name="keywords" content="log, files, chef, chef~12">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/chef~12/server_12-8/server_logs.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/chef~12.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/chef~12/" class="_nav-link" title="" style="margin-left:0;">Chef 12</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx_simple">
				
				
<h1 id="log-files">Log Files</h1> <p>All logs generated by the Chef server can be found in <code class="docutils literal">/var/log/opscode</code>. Each service enabled on the system also has a sub-directory in which service-specific logs are located, typically found in <code class="docutils literal">/var/log/opscode/service_name</code>.</p>  <h2 id="view-log-files">View Log Files</h2> <p>The Chef server has built-in support for easily tailing the logs that are generated. To view all the logs being generated on the Chef server, enter the following command:</p> <pre class="highlight-bash" data-language="bash">$ chef-server-ctl tail</pre> <p>To view logs for a specific service:</p> <pre class="highlight-bash" data-language="bash">$ chef-server-ctl tail SERVICENAME</pre> <p>where <code class="docutils literal">SERVICENAME</code> should be replaced with name of the service for which log files will be viewed.</p> <p>Another way to view log files is to use the system utility tail:</p> <pre class="highlight-bash" data-language="bash">$ tail -50f /var/log/chef-server/opscode-chef/current</pre>  <h3 id="tail-log-files">tail Log Files</h3> <p>The <code class="docutils literal">tail</code> subcommand is used to follow all of the Chef server logs for all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <pre class="highlight-bash" data-language="bash">$ chef-server-ctl tail SERVICE_NAME</pre> <p>where <code class="docutils literal">SERVICE_NAME</code> represents the name of any service that is listed after running the <code class="docutils literal">service-list</code> subcommand.</p> <p>Another common approach to tailing the log files for a service is to use the system utility <code class="docutils literal">tail</code>. For example:</p> <pre class="highlight-bash" data-language="bash">$ tail -50f /var/log/opscode/opscode-chef/current</pre>    <h2 id="supervisor">Supervisor</h2> <p>Supervisor logs are created and managed directly by the service supervisor, and are automatically rotated when a the current log file reaches 1,000,000 bytes. 10 log files are kept. The latest supervisor log is always located in <code class="docutils literal">/var/log/chef-server/service_name/current</code> and rotated logs have a filename starting with <code class="docutils literal">@</code> followed by a precise <code class="docutils literal">tai64n</code> timestamp based on when the file was rotated.</p> <p>Supervisor logs are available for the following services:</p> <ul class="simple"> <li>bifrost</li> <li>bookshelf</li> <li>nginx</li> <li>opscode-erchef</li> <li>opscode-expander</li> <li>opscode-expander-reindexer</li> <li>opscode-solr4</li> <li>postgresql</li> <li>rabbitmq</li> <li>redis</li> </ul>  <h3 id="nginx-access">nginx, access</h3> <p>Nginx is an important entry point for data on the Chef server, which means that debugging efforts frequently start with analyzing the <strong>nginx</strong> service’s <code class="docutils literal">access.log</code> file. This log contains every HTTP request made to the front-end machine and can be very useful when investigating request rates and usage patterns. The following is an example log entry:</p> <pre class="highlight-none" data-language="none">175.185.9.6 - - [12/Jul/2013:15:56:54 +0000] "GET
/organizations/exampleorg/data/firewall/nova_api HTTP/1.1" 200
"0.850" 452 "-" "Chef Client/0.10.2 (ruby-1.8.7-p302; ohai-0.6.4;
x86_64-linux; +http://opscode.com)" "127.0.0.1:9460" "200"
"0.849" "0.10.2" "version=1.0" "some_node.example.com"
"2013-07-12T15:56:40Z" "2jmj7l5rSw0yVb/vlWAYkK/YBwk=" 985</pre> <p>where important fields in this log include:</p> <ul class="simple"> <li>The HTTP status code (<code class="docutils literal">200</code>)</li> <li>The IP address of the requesting client (<code class="docutils literal">175.185.9.6</code>)</li> <li>The timestamp (<code class="docutils literal">[12/Jul/2013:15:56:54 +0000]</code>)</li> <li>The total request time (<code class="docutils literal">"0.850"</code>)</li> <li>The request method (<code class="docutils literal">GET</code>)</li> <li>The request URL (<code class="docutils literal">/organizations/exampleorg/data/firewall/nova_api</code>)</li> </ul>   <h3 id="opscode-erchef-current">opscode-erchef, current</h3> <p>The <strong>opscode-erchef</strong> service’s <code class="docutils literal">current.log</code> file contains a history of stack traces from major application crashes.</p>   <h3 id="opscode-erchef-erchef">opscode-erchef, erchef</h3> <p>The <strong>opscode-erchef</strong> service’s <code class="docutils literal">erchef.log</code> file contains a history of API requests that have been processed by Erchef. These logs can be rotated quickly, therefore it is generally best to sort them by date, and then find the most recently updated log file:</p> <pre class="highlight-bash" data-language="bash">$ ls -lrt /var/log/opscode/opscode-erchef/erchef.log.*</pre> <p>The following is an example log entry:</p> <pre class="highlight-none" data-language="none">2013-08-06T08:54:32Z erchef@127.0.0.1 INFO org_name=srwjedoqqoypgmvafmoi; req_id=g3IAA2QAEGVyY2hlZkAx</pre> <p>where important fields in this log include:</p> <ul class="simple"> <li>The HTTP method (<code class="docutils literal">POST</code>)</li> <li>The HTTP path (<code class="docutils literal">/organizations/srwjedoqqoypgmvafmoi/environments</code>)</li> <li>The message (<code class="docutils literal">{created,&lt;&lt;"_default"&gt;&gt;}</code>)</li> <li>The organization name (<code class="docutils literal">org_name=srwjedoqqoypgmvafmoi</code>)</li> <li>The timestamp (<code class="docutils literal">2013-08-06T08:54:32Z</code>)</li> <li>The name of the user and/or chef-client which made the request (<code class="docutils literal">pivotal</code>)</li> </ul> <p>In addition, the log file may contain additional entries that detail the amounts of time spent interacting with other services:</p> <ul class="simple"> <li>
<code class="docutils literal">rdbms_time</code> (the time spent talking to the <strong>postgresql</strong> service)</li> <li>
<code class="docutils literal">req_time</code> (the request time)</li> <li>
<code class="docutils literal">solr_time</code> (the time spent talking to the <strong>opscode-solr</strong> service)</li> </ul>    <h2 id="application">Application</h2> <p>Application logs are created by the services directly, and may require log rotation policies to be applied based on organizational goals and the platform(s) on which the services are running.</p>  <h3 id="nginx">nginx</h3> <p>The <code class="docutils literal">nginx</code> service creates both supervisor and administrator logs. The administrator logs contain both access and error logs for each virtual host utilized by the Chef server. Each of the following logs require external log rotation.</p> <table class="docutils"> <colgroup> <col width="13%"> <col width="88%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Logs</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/access.log</code></td> <td>The Web UI and API HTTP access logs.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">/var/log/opscode/nginx/error.log</code></td> <td>The Web UI and API HTTP error logs.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-account.access.log</code></td> <td>The <code class="docutils literal">opscode-account</code> internal load-balancer access logs.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-account.error.log</code></td> <td>The <code class="docutils literal">opscode-account</code> internal load-balancer error logs.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-authz.access.log</code></td> <td>The <code class="docutils literal">opscode-authz</code> internal load-balancer access logs.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-authz.error.log</code></td> <td>The <code class="docutils literal">opscode-authz</code> internal load-balancer error logs.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-chef.access.log</code></td> <td>The <code class="docutils literal">opscode-chef</code> and <code class="docutils literal">opscode-erchef</code> internal load-balancer access logs.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">/var/log/opscode/nginx/internal-chef.error.log</code></td> <td>The <code class="docutils literal">opscode-chef</code> and <code class="docutils literal">opscode-erchef</code> internal load-balancer error logs.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/nagios.access.log</code></td> <td>The <code class="docutils literal">nagios</code> access logs.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">/var/log/opscode/nginx/nagios.error.log</code></td> <td>The <code class="docutils literal">nagios</code> error logs.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">/var/log/opscode/nginx/rewrite-port-80.log</code></td> <td>The rewrite logs for traffic that uses HTTP instead of HTTPS.</td> </tr> </tbody> </table> <p>To follow the logs for the service:</p> <pre class="highlight-bash" data-language="bash">$ chef-server-ctl tail nginx</pre>  <h4 id="read-log-files">Read Log Files</h4> <p>The <strong>nginx</strong> access log format is as follows:</p> <pre class="highlight-bash" data-language="bash">log_format opscode '$remote_addr - $remote_user [$time_local]  '
  '"$request" $status "$request_time" $body_bytes_sent '
  '"$http_referrer" "$http_user_agent" "$upstream_addr" '
  '"$upstream_status" "$upstream_response_time" "$http_x_chef_version" '
  '"$http_x_ops_sign" "$http_x_ops_userid" "$http_x_ops_timestamp" '
   '"$http_x_ops_content_hash" $request_length';</pre> <p>A sample log line:</p> <pre class="highlight-bash" data-language="bash">192.168.4.1 - - [17/Feb/2012:16:02:42 -0800]
  "GET /organizations/nginx/cookbooks HTTP/1.1" 200
  "0.346" 12 "-"
  "Chef Knife/0.10.4 (ruby-1.9.3-p0;
                      ohai-0.6.10;
                      x86_64-darwin11.2.0;
                      +http://opscode.com
                      )"
  "127.0.0.1:9460" "200" "0.339" "0.10.4"
  "version=1.0" "adam" "2012-02-18T00:02:42Z"
  "2jmj7l5rSw0yVb/vlWAYkK/YBwk=" 871</pre> <p>Field descriptions:</p> <table class="docutils"> <colgroup> <col width="13%"> <col width="88%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Field</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal">$remote_addr</code></td> <td>The IP address of the client who made this request.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$remote_user</code></td> <td>The HTTP basic auth user name of this request.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$time_local</code></td> <td>The local time of the request.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$request</code></td> <td>The HTTP request.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$status</code></td> <td>The HTTP status code.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$request_time</code></td> <td>The time it took to service the request.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$body_bytes_sent</code></td> <td>The number of bytes in the HTTP response body.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$http_referrer</code></td> <td>The HTTP referrer.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$http_user_agent</code></td> <td>The user agent of the requesting client.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$upstream_addr</code></td> <td>The upstream reverse proxy used to service this request.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$upstream_status</code></td> <td>The upstream reverse proxy response status code.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$upstream_response_time</code></td> <td>The upstream reverse proxy response time.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$http_x_chef_version</code></td> <td>The version of Chef used to make this request.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$http_x_ops_sign</code></td> <td>The version of the authentication protocol.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$http_x_ops_userid</code></td> <td>The client name that was used to sign this request.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$http_x_ops_timestamp</code></td> <td>The timestamp from when this request was signed.</td> </tr> <tr class="row-even">
<td><code class="docutils literal">$http_x_ops_content_hash</code></td> <td>The hash of the contents of this request.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal">$request_length</code></td> <td>The length of this request.</td> </tr> </tbody> </table>
<div class="_attribution">
  <p class="_attribution-p">
    © Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef™ Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs-archive.chef.io/release/server_12-8/server_logs.html" class="_attribution-link">https://docs-archive.chef.io/release/server_12-8/server_logs.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

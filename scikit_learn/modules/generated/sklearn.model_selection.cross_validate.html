
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>sklearn.model_selection.cross_validate() - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content=" Evaluate metric(s) by cross-validation and also record fit&#47;score times. ">
  <meta name="keywords" content="sklearn, model, selection, cross, validate, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/scikit_learn/modules/generated/sklearn.model_selection.cross_validate.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/scikit_learn.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="sklearn-model-selection-cross-validate">sklearn.model_selection.cross_validate</h1> <dl class="function"> <dt id="sklearn.model_selection.cross_validate">
<code>sklearn.model_selection.cross_validate(estimator, X, y=None, groups=None, scoring=None, cv=’warn’, n_jobs=None, verbose=0, fit_params=None, pre_dispatch=‘2*n_jobs’, return_train_score=’warn’, return_estimator=False, error_score=’raise-deprecating’)</code> <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/bac89c2/sklearn/model_selection/_validation.py#L41"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Evaluate metric(s) by cross-validation and also record fit/score times.</p> <p>Read more in the <a class="reference internal" href="../cross_validation#multimetric-cross-validation"><span class="std std-ref">User Guide</span></a>.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<dl class="first docutils"> <dt>
<code>estimator : estimator object implementing ‘fit’</code> </dt> <dd>
<p class="first last">The object to use to fit the data.</p> </dd> <dt>
<code>X : array-like</code> </dt> <dd>
<p class="first last">The data to fit. Can be for example a list, or an array.</p> </dd> <dt>
<code>y : array-like, optional, default: None</code> </dt> <dd>
<p class="first last">The target variable to try to predict in the case of supervised learning.</p> </dd> <dt>
<code>groups : array-like, with shape (n_samples,), optional</code> </dt> <dd>
<p class="first last">Group labels for the samples used while splitting the dataset into train/test set.</p> </dd> <dt>
<code>scoring : string, callable, list/tuple, dict or None, default: None</code> </dt> <dd>
<p class="first">A single string (see <a class="reference internal" href="../model_evaluation#scoring-parameter"><span class="std std-ref">The scoring parameter: defining model evaluation rules</span></a>) or a callable (see <a class="reference internal" href="../model_evaluation#scoring"><span class="std std-ref">Defining your scoring strategy from metric functions</span></a>) to evaluate the predictions on the test set.</p> <p>For evaluating multiple metrics, either give a list of (unique) strings or a dict with names as keys and callables as values.</p> <p>NOTE that when using custom scorers, each scorer should return a single value. Metric functions returning a list/array of values can be wrapped into multiple scorers that return one value each.</p> <p>See <a class="reference internal" href="../grid_search#multimetric-grid-search"><span class="std std-ref">Specifying multiple metrics for evaluation</span></a> for an example.</p> <p class="last">If None, the estimator’s default scorer (if available) is used.</p> </dd> <dt>
<code>cv : int, cross-validation generator or an iterable, optional</code> </dt> <dd>
<p class="first">Determines the cross-validation splitting strategy. Possible inputs for cv are:</p> <ul class="simple"> <li>None, to use the default 3-fold cross validation,</li> <li>integer, to specify the number of folds in a <code>(Stratified)KFold</code>,</li> <li>An object to be used as a cross-validation generator.</li> <li>An iterable yielding train, test splits.</li> </ul> <p>For integer/None inputs, if the estimator is a classifier and <code>y</code> is either binary or multiclass, <a class="reference internal" href="sklearn.model_selection.stratifiedkfold#sklearn.model_selection.StratifiedKFold" title="sklearn.model_selection.StratifiedKFold"><code>StratifiedKFold</code></a> is used. In all other cases, <a class="reference internal" href="sklearn.model_selection.kfold#sklearn.model_selection.KFold" title="sklearn.model_selection.KFold"><code>KFold</code></a> is used.</p> <p>Refer <a class="reference internal" href="../cross_validation#cross-validation"><span class="std std-ref">User Guide</span></a> for the various cross-validation strategies that can be used here.</p> <div class="last versionchanged"> <p><span class="versionmodified">Changed in version 0.20: </span><code>cv</code> default value if None will change from 3-fold to 5-fold in v0.22.</p> </div> </dd> <dt>
<code>n_jobs : int or None, optional (default=None)</code> </dt> <dd>
<p class="first last">The number of CPUs to use to do the computation. <code>None</code> means 1 unless in a <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#joblib.parallel_backend" title="(in joblib v0.12.6.dev0)"><code>joblib.parallel_backend</code></a> context. <code>-1</code> means using all processors. See <a class="reference internal" href="http://scikit-learn.org/stable/glossary.html#term-n-jobs"><span class="xref std std-term">Glossary</span></a> for more details.</p> </dd> <dt>
<code>verbose : integer, optional</code> </dt> <dd>
<p class="first last">The verbosity level.</p> </dd> <dt>
<code>fit_params : dict, optional</code> </dt> <dd>
<p class="first last">Parameters to pass to the fit method of the estimator.</p> </dd> <dt>
<code>pre_dispatch : int, or string, optional</code> </dt> <dd>
<p class="first">Controls the number of jobs that get dispatched during parallel execution. Reducing this number can be useful to avoid an explosion of memory consumption when more jobs get dispatched than CPUs can process. This parameter can be:</p>  <ul class="simple"> <li>None, in which case all the jobs are immediately created and spawned. Use this for lightweight and fast-running jobs, to avoid delays due to on-demand spawning of the jobs</li> <li>An int, giving the exact number of total jobs that are spawned</li> <li>A string, giving an expression as a function of n_jobs, as in ‘2*n_jobs’</li> </ul>  </dd> <dt>
<code>return_train_score : boolean, optional</code> </dt> <dd>
<p class="first">Whether to include train scores.</p> <p class="last">Current default is <code>'warn'</code>, which behaves as <code>True</code> in addition to raising a warning when a training score is looked up. That default will be changed to <code>False</code> in 0.21. Computing training scores is used to get insights on how different parameter settings impact the overfitting/underfitting trade-off. However computing the scores on the training set can be computationally expensive and is not strictly required to select the parameters that yield the best generalization performance.</p> </dd> <dt>
<code>return_estimator : boolean, default False</code> </dt> <dd>
<p class="first last">Whether to return the estimators fitted on each split.</p> </dd> <dt>
<code>error_score : ‘raise’ | ‘raise-deprecating’ or numeric</code> </dt> <dd>
<p class="first last">Value to assign to the score if an error occurs in estimator fitting. If set to ‘raise’, the error is raised. If set to ‘raise-deprecating’, a FutureWarning is printed before the error is raised. If a numeric value is given, FitFailedWarning is raised. This parameter does not affect the refit step, which will always raise the error. Default is ‘raise-deprecating’ but from version 0.22 it will change to np.nan.</p> </dd> </dl> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<dl class="first last docutils"> <dt>
<code>scores : dict of float arrays of shape=(n_splits,)</code> </dt> <dd>
<p class="first">Array of scores of the estimator for each run of the cross validation.</p> <p>A dict of arrays containing the score/time arrays for each scorer is returned. The possible keys for this <code>dict</code> are:</p>  <dl class="docutils"> <dt>
<code>test_score</code> </dt> <dd>
<p class="first last">The score array for test scores on each cv split.</p> </dd> <dt>
<code>train_score</code> </dt> <dd>
<p class="first last">The score array for train scores on each cv split. This is available only if <code>return_train_score</code> parameter is <code>True</code>.</p> </dd> <dt>
<code>fit_time</code> </dt> <dd>
<p class="first last">The time for fitting the estimator on the train set for each cv split.</p> </dd> <dt>
<code>score_time</code> </dt> <dd>
<p class="first last">The time for scoring the estimator on the test set for each cv split. (Note time for scoring on the train set is not included even if <code>return_train_score</code> is set to <code>True</code></p> </dd> <dt>
<code>estimator</code> </dt> <dd>
<p class="first last">The estimator objects for each cv split. This is available only if <code>return_estimator</code> parameter is set to <code>True</code>.</p> </dd> </dl>  </dd> </dl> </td> </tr>  </table> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <dl class="last docutils"> <dt>
 <a class="reference internal" href="sklearn.model_selection.cross_val_score#sklearn.model_selection.cross_val_score" title="sklearn.model_selection.cross_val_score"><code>sklearn.model_selection.cross_val_score</code></a>
</dt> <dd>Run cross-validation for single metric evaluation.</dd> <dt>
 <a class="reference internal" href="sklearn.model_selection.cross_val_predict#sklearn.model_selection.cross_val_predict" title="sklearn.model_selection.cross_val_predict"><code>sklearn.model_selection.cross_val_predict</code></a>
</dt> <dd>Get predictions from each split of cross-validation for diagnostic purposes.</dd> <dt>
 <a class="reference internal" href="sklearn.metrics.make_scorer#sklearn.metrics.make_scorer" title="sklearn.metrics.make_scorer"><code>sklearn.metrics.make_scorer</code></a>
</dt> <dd>Make a scorer from a performance metric or loss function.</dd> </dl> </div> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; from sklearn import datasets, linear_model
&gt;&gt;&gt; from sklearn.model_selection import cross_validate
&gt;&gt;&gt; from sklearn.metrics.scorer import make_scorer
&gt;&gt;&gt; from sklearn.metrics import confusion_matrix
&gt;&gt;&gt; from sklearn.svm import LinearSVC
&gt;&gt;&gt; diabetes = datasets.load_diabetes()
&gt;&gt;&gt; X = diabetes.data[:150]
&gt;&gt;&gt; y = diabetes.target[:150]
&gt;&gt;&gt; lasso = linear_model.Lasso()
</pre> <p>Single metric evaluation using <code>cross_validate</code></p> <pre data-language="python">&gt;&gt;&gt; cv_results = cross_validate(lasso, X, y, cv=3,
...                             return_train_score=False)
&gt;&gt;&gt; sorted(cv_results.keys())                         
['fit_time', 'score_time', 'test_score']
&gt;&gt;&gt; cv_results['test_score']    
array([0.33150734, 0.08022311, 0.03531764])
</pre> <p>Multiple metric evaluation using <code>cross_validate</code> (please refer the <code>scoring</code> parameter doc for more information)</p> <pre data-language="python">&gt;&gt;&gt; scores = cross_validate(lasso, X, y, cv=3,
...                         scoring=('r2', 'neg_mean_squared_error'),
...                         return_train_score=True)
&gt;&gt;&gt; print(scores['test_neg_mean_squared_error'])      
[-3635.5... -3573.3... -6114.7...]
&gt;&gt;&gt; print(scores['train_r2'])                         
[0.28010158 0.39088426 0.22784852]
</pre> </dd>
</dl> <div class="_attribution">
  <p class="_attribution-p">
    © 2007–2018 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html" class="_attribution-link">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

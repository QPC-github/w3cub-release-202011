
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Example&#58; Feature Agglomeration vs. Univariate Selection - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="feature, agglomeration, univariate, selection, example, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/scikit_learn/auto_examples/cluster/plot_feature_agglomeration_vs_univariate_selection.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/scikit_learn.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<div class="sphx-glr-download-link-note admonition note"> <p class="first admonition-title">Note</p> <p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-cluster-plot-feature-agglomeration-vs-univariate-selection-py"><span class="std std-ref">here</span></a> to download the full example code</p> </div>  <h1 id="sphx-glr-auto-examples-cluster-plot-feature-agglomeration-vs-univariate-selection-py">Feature agglomeration vs. univariate selection</h1> <p id="feature-agglomeration-vs-univariate-selection">This example compares 2 dimensionality reduction strategies:</p> <ul class="simple"> <li>univariate feature selection with Anova</li> <li>feature agglomeration with Ward hierarchical clustering</li> </ul> <p>Both methods are compared in a regression problem using a BayesianRidge as supervised estimator.</p> <img alt="../../_images/sphx_glr_plot_feature_agglomeration_vs_univariate_selection_001.png" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">________________________________________________________________________________
[Memory] Calling sklearn.cluster.hierarchical.ward_tree...
ward_tree(array([[-0.451933, ..., -0.675318],
       ...,
       [ 0.275706, ..., -1.085711]]),
&lt;1600x1600 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
        with 7840 stored elements in COOrdinate format&gt;, n_clusters=None)
________________________________________________________ward_tree - 0.2s, 0.0min
________________________________________________________________________________
[Memory] Calling sklearn.cluster.hierarchical.ward_tree...
ward_tree(array([[ 0.905206, ...,  0.161245],
       ...,
       [-0.849835, ..., -1.091621]]),
&lt;1600x1600 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
        with 7840 stored elements in COOrdinate format&gt;, n_clusters=None)
________________________________________________________ward_tree - 0.1s, 0.0min
________________________________________________________________________________
[Memory] Calling sklearn.cluster.hierarchical.ward_tree...
ward_tree(array([[ 0.905206, ..., -0.675318],
       ...,
       [-0.849835, ..., -1.085711]]),
&lt;1600x1600 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
        with 7840 stored elements in COOrdinate format&gt;, n_clusters=None)
________________________________________________________ward_tree - 0.2s, 0.0min
________________________________________________________________________________
[Memory] Calling sklearn.feature_selection.univariate_selection.f_regression...
f_regression(array([[-0.451933, ...,  0.275706],
       ...,
       [-0.675318, ..., -1.085711]]),
array([ 25.267703, ..., -25.026711]))
_____________________________________________________f_regression - 0.0s, 0.0min
________________________________________________________________________________
[Memory] Calling sklearn.feature_selection.univariate_selection.f_regression...
f_regression(array([[ 0.905206, ..., -0.849835],
       ...,
       [ 0.161245, ..., -1.091621]]),
array([ -27.447268, ..., -112.638768]))
_____________________________________________________f_regression - 0.0s, 0.0min
________________________________________________________________________________
[Memory] Calling sklearn.feature_selection.univariate_selection.f_regression...
f_regression(array([[ 0.905206, ..., -0.849835],
       ...,
       [-0.675318, ..., -1.085711]]),
array([-27.447268, ..., -25.026711]))
_____________________________________________________f_regression - 0.0s, 0.0min
</pre>  <pre data-language="python"># Author: Alexandre Gramfort &lt;alexandre.gramfort@inria.fr&gt;
# License: BSD 3 clause

print(__doc__)

import shutil
import tempfile

import numpy as np
import matplotlib.pyplot as plt
from scipy import linalg, ndimage

from sklearn.feature_extraction.image import grid_to_graph
from sklearn import feature_selection
from sklearn.cluster import FeatureAgglomeration
from sklearn.linear_model import BayesianRidge
from sklearn.pipeline import Pipeline
from sklearn.utils import Memory
from sklearn.model_selection import GridSearchCV
from sklearn.model_selection import KFold

# #############################################################################
# Generate data
n_samples = 200
size = 40  # image size
roi_size = 15
snr = 5.
np.random.seed(0)
mask = np.ones([size, size], dtype=np.bool)

coef = np.zeros((size, size))
coef[0:roi_size, 0:roi_size] = -1.
coef[-roi_size:, -roi_size:] = 1.

X = np.random.randn(n_samples, size ** 2)
for x in X:  # smooth data
    x[:] = ndimage.gaussian_filter(x.reshape(size, size), sigma=1.0).ravel()
X -= X.mean(axis=0)
X /= X.std(axis=0)

y = np.dot(X, coef.ravel())
noise = np.random.randn(y.shape[0])
noise_coef = (linalg.norm(y, 2) / np.exp(snr / 20.)) / linalg.norm(noise, 2)
y += noise_coef * noise  # add noise

# #############################################################################
# Compute the coefs of a Bayesian Ridge with GridSearch
cv = KFold(2)  # cross-validation generator for model selection
ridge = BayesianRidge()
cachedir = tempfile.mkdtemp()
mem = Memory(cachedir=cachedir, verbose=1)

# Ward agglomeration followed by BayesianRidge
connectivity = grid_to_graph(n_x=size, n_y=size)
ward = FeatureAgglomeration(n_clusters=10, connectivity=connectivity,
                            memory=mem)
clf = Pipeline([('ward', ward), ('ridge', ridge)])
# Select the optimal number of parcels with grid search
clf = GridSearchCV(clf, {'ward__n_clusters': [10, 20, 30]}, n_jobs=1, cv=cv)
clf.fit(X, y)  # set the best parameters
coef_ = clf.best_estimator_.steps[-1][1].coef_
coef_ = clf.best_estimator_.steps[0][1].inverse_transform(coef_)
coef_agglomeration_ = coef_.reshape(size, size)

# Anova univariate feature selection followed by BayesianRidge
f_regression = mem.cache(feature_selection.f_regression)  # caching function
anova = feature_selection.SelectPercentile(f_regression)
clf = Pipeline([('anova', anova), ('ridge', ridge)])
# Select the optimal percentage of features with grid search
clf = GridSearchCV(clf, {'anova__percentile': [5, 10, 20]}, cv=cv)
clf.fit(X, y)  # set the best parameters
coef_ = clf.best_estimator_.steps[-1][1].coef_
coef_ = clf.best_estimator_.steps[0][1].inverse_transform(coef_.reshape(1, -1))
coef_selection_ = coef_.reshape(size, size)

# #############################################################################
# Inverse the transformation to plot the results on an image
plt.close('all')
plt.figure(figsize=(7.3, 2.7))
plt.subplot(1, 3, 1)
plt.imshow(coef, interpolation="nearest", cmap=plt.cm.RdBu_r)
plt.title("True weights")
plt.subplot(1, 3, 2)
plt.imshow(coef_selection_, interpolation="nearest", cmap=plt.cm.RdBu_r)
plt.title("Feature Selection")
plt.subplot(1, 3, 3)
plt.imshow(coef_agglomeration_, interpolation="nearest", cmap=plt.cm.RdBu_r)
plt.title("Feature Agglomeration")
plt.subplots_adjust(0.04, 0.0, 0.98, 0.94, 0.16, 0.26)
plt.show()

# Attempt to remove the temporary cachedir, but don't worry if it fails
shutil.rmtree(cachedir, ignore_errors=True)
</pre> <p><strong>Total running time of the script:</strong> ( 0 minutes 2.154 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-cluster-plot-feature-agglomeration-vs-univariate-selection-py"> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_feature_agglomeration_vs_univariate_selection.py" download=""><code>Download Python source code: plot_feature_agglomeration_vs_univariate_selection.py</code></a>
</div> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_feature_agglomeration_vs_univariate_selection.ipynb" download=""><code>Download Jupyter notebook: plot_feature_agglomeration_vs_univariate_selection.ipynb</code></a>
</div> </div> <p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2007–2018 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/auto_examples/cluster/plot_feature_agglomeration_vs_univariate_selection.html" class="_attribution-link">http://scikit-learn.org/stable/auto_examples/cluster/plot_feature_agglomeration_vs_univariate_selection.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

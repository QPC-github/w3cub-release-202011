
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Example&#58; Label Propagation Digits - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="label, propagation, digits, demonstrating, performance, example, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/scikit_learn/auto_examples/semi_supervised/plot_label_propagation_digits.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/scikit_learn.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<div class="sphx-glr-download-link-note admonition note"> <p class="first admonition-title">Note</p> <p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-semi-supervised-plot-label-propagation-digits-py"><span class="std std-ref">here</span></a> to download the full example code</p> </div>  <h1 id="sphx-glr-auto-examples-semi-supervised-plot-label-propagation-digits-py">Label Propagation digits: Demonstrating performance</h1> <p id="label-propagation-digits-demonstrating-performance">This example demonstrates the power of semisupervised learning by training a Label Spreading model to classify handwritten digits with sets of very few labels.</p> <p>The handwritten digit dataset has 1797 total points. The model will be trained using all points, but only 30 will be labeled. Results in the form of a confusion matrix and a series of metrics over each class will be very good.</p> <p>At the end, the top 10 most uncertain predictions will be shown.</p> <img alt="../../_images/sphx_glr_plot_label_propagation_digits_001.png" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Label Spreading model: 30 labeled &amp; 300 unlabeled points (330 total)
              precision    recall  f1-score   support

           0       1.00      1.00      1.00        23
           1       0.58      0.50      0.54        28
           2       0.93      0.93      0.93        29
           3       0.00      0.00      0.00        28
           4       0.92      0.88      0.90        25
           5       0.96      0.76      0.85        33
           6       0.97      0.97      0.97        36
           7       0.89      1.00      0.94        34
           8       0.51      0.79      0.62        29
           9       0.51      0.80      0.62        35

   micro avg       0.77      0.77      0.77       300
   macro avg       0.73      0.76      0.74       300
weighted avg       0.73      0.77      0.74       300

Confusion matrix
[[23  0  0  0  0  0  0  0  0]
 [ 0 14  2  0  0  1  0 11  0]
 [ 0  0 27  0  0  0  2  0  0]
 [ 0  3  0 22  0  0  0  0  0]
 [ 0  0  0  0 25  0  0  0  8]
 [ 0  1  0  0  0 35  0  0  0]
 [ 0  0  0  0  0  0 34  0  0]
 [ 0  6  0  0  0  0  0 23  0]
 [ 0  0  0  2  1  0  2  2 28]]
</pre>  <pre data-language="python">print(__doc__)

# Authors: Clay Woolam &lt;clay@woolam.org&gt;
# License: BSD

import numpy as np
import matplotlib.pyplot as plt

from scipy import stats

from sklearn import datasets
from sklearn.semi_supervised import label_propagation

from sklearn.metrics import confusion_matrix, classification_report

digits = datasets.load_digits()
rng = np.random.RandomState(0)
indices = np.arange(len(digits.data))
rng.shuffle(indices)

X = digits.data[indices[:330]]
y = digits.target[indices[:330]]
images = digits.images[indices[:330]]

n_total_samples = len(y)
n_labeled_points = 30

indices = np.arange(n_total_samples)

unlabeled_set = indices[n_labeled_points:]

# #############################################################################
# Shuffle everything around
y_train = np.copy(y)
y_train[unlabeled_set] = -1

# #############################################################################
# Learn with LabelSpreading
lp_model = label_propagation.LabelSpreading(gamma=0.25, max_iter=5)
lp_model.fit(X, y_train)
predicted_labels = lp_model.transduction_[unlabeled_set]
true_labels = y[unlabeled_set]

cm = confusion_matrix(true_labels, predicted_labels, labels=lp_model.classes_)

print("Label Spreading model: %d labeled &amp; %d unlabeled points (%d total)" %
      (n_labeled_points, n_total_samples - n_labeled_points, n_total_samples))

print(classification_report(true_labels, predicted_labels))

print("Confusion matrix")
print(cm)

# #############################################################################
# Calculate uncertainty values for each transduced distribution
pred_entropies = stats.distributions.entropy(lp_model.label_distributions_.T)

# #############################################################################
# Pick the top 10 most uncertain labels
uncertainty_index = np.argsort(pred_entropies)[-10:]

# #############################################################################
# Plot
f = plt.figure(figsize=(7, 5))
for index, image_index in enumerate(uncertainty_index):
    image = images[image_index]

    sub = f.add_subplot(2, 5, index + 1)
    sub.imshow(image, cmap=plt.cm.gray_r)
    plt.xticks([])
    plt.yticks([])
    sub.set_title('predict: %i\ntrue: %i' % (
        lp_model.transduction_[image_index], y[image_index]))

f.suptitle('Learning with small amount of labeled data')
plt.show()
</pre> <p><strong>Total running time of the script:</strong> ( 0 minutes 0.277 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-semi-supervised-plot-label-propagation-digits-py"> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_label_propagation_digits.py" download=""><code>Download Python source code: plot_label_propagation_digits.py</code></a>
</div> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_label_propagation_digits.ipynb" download=""><code>Download Jupyter notebook: plot_label_propagation_digits.ipynb</code></a>
</div> </div> <p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2007–2018 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/auto_examples/semi_supervised/plot_label_propagation_digits.html" class="_attribution-link">http://scikit-learn.org/stable/auto_examples/semi_supervised/plot_label_propagation_digits.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

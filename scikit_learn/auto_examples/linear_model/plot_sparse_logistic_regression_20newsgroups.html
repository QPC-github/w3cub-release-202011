
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Example&#58; Multiclass Sparse Logisitic Regression on Newgroups20 - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="multiclass, sparse, logisitic, regression, on, newgroups, example, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/scikit_learn/auto_examples/linear_model/plot_sparse_logistic_regression_20newsgroups.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/scikit_learn.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<div class="sphx-glr-download-link-note admonition note"> <p class="first admonition-title">Note</p> <p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-linear-model-plot-sparse-logistic-regression-20newsgroups-py"><span class="std std-ref">here</span></a> to download the full example code</p> </div>  <h1 id="sphx-glr-auto-examples-linear-model-plot-sparse-logistic-regression-20newsgroups-py">Multiclass sparse logisitic regression on newgroups20</h1> <p id="multiclass-sparse-logisitic-regression-on-newgroups20">Comparison of multinomial logistic L1 vs one-versus-rest L1 logistic regression to classify documents from the newgroups20 dataset. Multinomial logistic regression yields more accurate results and is faster to train on the larger scale dataset.</p> <p>Here we use the l1 sparsity that trims the weights of not informative features to zero. This is good if the goal is to extract the strongly discriminative vocabulary of each class. If the goal is to get the best predictive accuracy, it is better to use the non sparsity-inducing l2 penalty instead.</p> <p>A more traditional (and possibly better) way to predict on a sparse subset of input features would be to use univariate feature selection followed by a traditional (l2-penalised) logistic regression model.</p> <img alt="../../_images/sphx_glr_plot_sparse_logistic_regression_20newsgroups_001.png" class="sphx-glr-single-img" src="data:image/png;base64,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"> <p class="sphx-glr-script-out">Out:</p> <pre data-language="none">Dataset 20newsgroup, train_samples=9000, n_features=130107, n_classes=20
[model=One versus Rest, solver=saga] Number of epochs: 1
[model=One versus Rest, solver=saga] Number of epochs: 3
Test accuracy for model ovr: 0.7410
% non-zero coefficients for model ovr, per class:
 [0.27054655 0.66330021 0.80395367 0.73247404 0.67713497 0.73477984
 0.40889422 0.48959702 1.01301237 0.56261385 0.60104376 0.332803
 0.7094161  0.85083816 0.56876263 0.65715142 0.64408525 0.81163965
 0.44271254 0.41120001]
Run time (3 epochs) for model ovr:3.41
[model=Multinomial, solver=saga] Number of epochs: 1
[model=Multinomial, solver=saga] Number of epochs: 3
[model=Multinomial, solver=saga] Number of epochs: 7
Test accuracy for model multinomial: 0.7450
% non-zero coefficients for model multinomial, per class:
 [0.13296748 0.11759552 0.13296748 0.13988486 0.1268187  0.16140561
 0.15218243 0.09069458 0.07762841 0.12143851 0.14910804 0.10837234
 0.18830655 0.1245129  0.168323   0.21828188 0.11605832 0.07839701
 0.06917383 0.15602543]
Run time (7 epochs) for model multinomial:5.79
Example run in 20.227 s
</pre>  <pre data-language="python">import time

import matplotlib.pyplot as plt
import numpy as np

from sklearn.datasets import fetch_20newsgroups_vectorized
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split

print(__doc__)
# Author: Arthur Mensch

t0 = time.clock()

# We use SAGA solver
solver = 'saga'

# Turn down for faster run time
n_samples = 10000

# Memorized fetch_rcv1 for faster access
dataset = fetch_20newsgroups_vectorized('all')
X = dataset.data
y = dataset.target
X = X[:n_samples]
y = y[:n_samples]

X_train, X_test, y_train, y_test = train_test_split(X, y,
                                                    random_state=42,
                                                    stratify=y,
                                                    test_size=0.1)
train_samples, n_features = X_train.shape
n_classes = np.unique(y).shape[0]

print('Dataset 20newsgroup, train_samples=%i, n_features=%i, n_classes=%i'
      % (train_samples, n_features, n_classes))

models = {'ovr': {'name': 'One versus Rest', 'iters': [1, 3]},
          'multinomial': {'name': 'Multinomial', 'iters': [1, 3, 7]}}

for model in models:
    # Add initial chance-level values for plotting purpose
    accuracies = [1 / n_classes]
    times = [0]
    densities = [1]

    model_params = models[model]

    # Small number of epochs for fast runtime
    for this_max_iter in model_params['iters']:
        print('[model=%s, solver=%s] Number of epochs: %s' %
              (model_params['name'], solver, this_max_iter))
        lr = LogisticRegression(solver=solver,
                                multi_class=model,
                                C=1,
                                penalty='l1',
                                fit_intercept=True,
                                max_iter=this_max_iter,
                                random_state=42,
                                )
        t1 = time.clock()
        lr.fit(X_train, y_train)
        train_time = time.clock() - t1

        y_pred = lr.predict(X_test)
        accuracy = np.sum(y_pred == y_test) / y_test.shape[0]
        density = np.mean(lr.coef_ != 0, axis=1) * 100
        accuracies.append(accuracy)
        densities.append(density)
        times.append(train_time)
    models[model]['times'] = times
    models[model]['densities'] = densities
    models[model]['accuracies'] = accuracies
    print('Test accuracy for model %s: %.4f' % (model, accuracies[-1]))
    print('%% non-zero coefficients for model %s, '
          'per class:\n %s' % (model, densities[-1]))
    print('Run time (%i epochs) for model %s:'
          '%.2f' % (model_params['iters'][-1], model, times[-1]))

fig = plt.figure()
ax = fig.add_subplot(111)

for model in models:
    name = models[model]['name']
    times = models[model]['times']
    accuracies = models[model]['accuracies']
    ax.plot(times, accuracies, marker='o',
            label='Model: %s' % name)
    ax.set_xlabel('Train time (s)')
    ax.set_ylabel('Test accuracy')
ax.legend()
fig.suptitle('Multinomial vs One-vs-Rest Logistic L1\n'
             'Dataset %s' % '20newsgroups')
fig.tight_layout()
fig.subplots_adjust(top=0.85)
run_time = time.clock() - t0
print('Example run in %.3f s' % run_time)
plt.show()
</pre> <p><strong>Total running time of the script:</strong> ( 0 minutes 12.132 seconds)</p> <div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-linear-model-plot-sparse-logistic-regression-20newsgroups-py"> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_sparse_logistic_regression_20newsgroups.py" download=""><code>Download Python source code: plot_sparse_logistic_regression_20newsgroups.py</code></a>
</div> <div class="sphx-glr-download docutils container"> <a class="reference download internal" href="http://scikit-learn.org/stable/_downloads/plot_sparse_logistic_regression_20newsgroups.ipynb" download=""><code>Download Jupyter notebook: plot_sparse_logistic_regression_20newsgroups.ipynb</code></a>
</div> </div> <p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2007–2018 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/auto_examples/linear_model/plot_sparse_logistic_regression_20newsgroups.html" class="_attribution-link">http://scikit-learn.org/stable/auto_examples/linear_model/plot_sparse_logistic_regression_20newsgroups.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Geolocation With GeoIP2 - Django 3.1 - W3cubDocs</title>
  
  <meta name="description" content=" The GeoIP2 object is a wrapper for the MaxMind geoip2 Python library. [1] ">
  <meta name="keywords" content="geolocation, with, geoip, django, django~3.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/django~3.1/ref/contrib/gis/geoip2.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/django~3.1.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/django~3.1/" class="_nav-link" title="" style="margin-left:0;">Django 3.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="geolocation-with-geoip2">Geolocation with GeoIP2</h1> <p id="s-module-django.contrib.gis.geoip2">The <a class="reference internal" href="#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code>GeoIP2</code></a> object is a wrapper for the <a class="reference external" href="https://geoip2.readthedocs.io/">MaxMind geoip2 Python library</a>. <a class="footnote-reference" href="#id6" id="id1">[1]</a></p> <p>In order to perform IP-based geolocation, the <a class="reference internal" href="#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code>GeoIP2</code></a> object requires the <a class="reference external" href="https://pypi.org/project/geoip2/">geoip2 Python library</a> and the GeoIP <code>Country</code> and/or <code>City</code> <a class="reference external" href="https://dev.maxmind.com/geoip/geoip2/geolite2/">datasets in binary format</a> (the CSV files will not work!). Grab the <code>GeoLite2-Country.mmdb.gz</code> and <code>GeoLite2-City.mmdb.gz</code> files and unzip them in a directory corresponding to the <a class="reference internal" href="#std:setting-GEOIP_PATH"><code>GEOIP_PATH</code></a> setting.</p> <p>Additionally, it is recommended to install the <a class="reference external" href="https://github.com/maxmind/libmaxminddb">libmaxminddb C library</a>, so that <code>geoip2</code> can leverage the C libraryâ€™s faster speed.</p>  <h2 id="example">Example</h2> <p id="s-example">Here is an example of its usage:</p> <pre data-language="python">&gt;&gt;&gt; from django.contrib.gis.geoip2 import GeoIP2
&gt;&gt;&gt; g = GeoIP2()
&gt;&gt;&gt; g.country('google.com')
{'country_code': 'US', 'country_name': 'United States'}
&gt;&gt;&gt; g.city('72.14.207.99')
{'city': 'Mountain View',
'continent_code': 'NA',
'continent_name': 'North America',
'country_code': 'US',
'country_name': 'United States',
'dma_code': 807,
'is_in_european_union': False,
'latitude': 37.419200897216797,
'longitude': -122.05740356445312,
'postal_code': '94043',
'region': 'CA',
'time_zone': 'America/Los_Angeles'}
&gt;&gt;&gt; g.lat_lon('salon.com')
(39.0437, -77.4875)
&gt;&gt;&gt; g.lon_lat('uh.edu')
(-95.4342, 29.834)
&gt;&gt;&gt; g.geos('24.124.1.80').wkt
'POINT (-97 38)'
</pre>   <h2 id="api-reference">API Reference</h2> <dl class="class" id="s-api-reference"> <dt id="django.contrib.gis.geoip2.GeoIP2">
<code>class GeoIP2(path=None, cache=0, country=None, city=None)</code> </dt> 
</dl> <p>The <code>GeoIP</code> object does not require any parameters to use the default settings. However, at the very least the <a class="reference internal" href="#std:setting-GEOIP_PATH"><code>GEOIP_PATH</code></a> setting should be set with the path of the location of your GeoIP datasets. The following initialization keywords may be used to customize any of the defaults.</p> <table class="docutils">  <thead valign="bottom"> <tr>
<th class="head">Keyword Arguments</th> <th class="head">Description</th> </tr> </thead>  <tr>
<td><code>path</code></td> <td>Base directory to where GeoIP data is located or the full path to where the city or country data files (<code>.mmdb</code>) are located. Assumes that both the city and country datasets are located in this directory; overrides the <a class="reference internal" href="#std:setting-GEOIP_PATH"><code>GEOIP_PATH</code></a> setting.</td> </tr> <tr>
<td><code>cache</code></td> <td>The cache settings when opening up the GeoIP datasets. May be an integer in (0, 1, 2, 4, 8) corresponding to the <code>MODE_AUTO</code>, <code>MODE_MMAP_EXT</code>, <code>MODE_MMAP</code>, and <code>GEOIP_INDEX_CACHE</code> <code>MODE_MEMORY</code> C API settings, respectively. Defaults to 0 (<code>MODE_AUTO</code>).</td> </tr> <tr>
<td><code>country</code></td> <td>The name of the GeoIP country data file. Defaults to <code>GeoLite2-Country.mmdb</code>. Setting this keyword overrides the <a class="reference internal" href="#std:setting-GEOIP_COUNTRY"><code>GEOIP_COUNTRY</code></a> setting.</td> </tr> <tr>
<td><code>city</code></td> <td>The name of the GeoIP city data file. Defaults to <code>GeoLite2-City.mmdb</code>. Setting this keyword overrides the <a class="reference internal" href="#std:setting-GEOIP_CITY"><code>GEOIP_CITY</code></a> setting.</td> </tr>  </table> <div class="versionchanged"> <span class="title">Changed in Django 3.0:</span> <p>Support for <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.9)"><code>pathlib.Path</code></a> <code>path</code> was added.</p> </div>   <h2 id="methods">Methods</h2>  <h3 id="instantiating">Instantiating</h3> <dl class="classmethod" id="s-methods"> <dt id="django.contrib.gis.geoip2.GeoIP2.open">
<code>classmethod GeoIP2.open(path, cache)</code> </dt> 
</dl> <p>This classmethod instantiates the GeoIP object from the given database path and given cache setting.</p>   <h3 id="querying">Querying</h3> <p id="s-querying">All the following querying routines may take either a string IP address or a fully qualified domain name (FQDN). For example, both <code>'205.186.163.125'</code> and <code>'djangoproject.com'</code> would be valid query parameters.</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.city">
<code>GeoIP2.city(query)</code> </dt> 
</dl> <p>Returns a dictionary of city information for the given query. Some of the values in the dictionary may be undefined (<code>None</code>).</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.country">
<code>GeoIP2.country(query)</code> </dt> 
</dl> <p>Returns a dictionary with the country code and country for the given query.</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.country_code">
<code>GeoIP2.country_code(query)</code> </dt> 
</dl> <p>Returns the country code corresponding to the query.</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.country_name">
<code>GeoIP2.country_name(query)</code> </dt> 
</dl> <p>Returns the country name corresponding to the query.</p>   <h3 id="coordinate-retrieval">Coordinate Retrieval</h3> <dl class="method" id="s-coordinate-retrieval"> <dt id="django.contrib.gis.geoip2.GeoIP2.coords">
<code>GeoIP2.coords(query)</code> </dt> 
</dl> <p>Returns a coordinate tuple of (longitude, latitude).</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.lon_lat">
<code>GeoIP2.lon_lat(query)</code> </dt> 
</dl> <p>Returns a coordinate tuple of (longitude, latitude).</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.lat_lon">
<code>GeoIP2.lat_lon(query)</code> </dt> 
</dl> <p>Returns a coordinate tuple of (latitude, longitude),</p> <dl class="method"> <dt id="django.contrib.gis.geoip2.GeoIP2.geos">
<code>GeoIP2.geos(query)</code> </dt> 
</dl> <p>Returns a <a class="reference internal" href="geos#django.contrib.gis.geos.Point" title="django.contrib.gis.geos.Point"><code>Point</code></a> object corresponding to the query.</p>    <h2 id="settings">Settings</h2>  <h3 id="std:setting-GEOIP_PATH"><code>GEOIP_PATH</code></h3> <p id="s-settings">A string or <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.9)"><code>pathlib.Path</code></a> specifying the directory where the GeoIP data files are located. This setting is <em>required</em> unless manually specified with <code>path</code> keyword when initializing the <a class="reference internal" href="#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code>GeoIP2</code></a> object.</p> <div class="versionchanged"> <span class="title">Changed in Django 3.0:</span> <p>Support for <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.9)"><code>pathlib.Path</code></a> was added.</p> </div>   <h3 id="std:setting-GEOIP_COUNTRY"><code>GEOIP_COUNTRY</code></h3> <p id="s-geoip-country">The basename to use for the GeoIP country data file. Defaults to <code>'GeoLite2-Country.mmdb'</code>.</p>   <h3 id="std:setting-GEOIP_CITY"><code>GEOIP_CITY</code></h3> <p id="s-geoip-city">The basename to use for the GeoIP city data file. Defaults to <code>'GeoLite2-City.mmdb'</code>.</p>    <h2 id="exceptions">Exceptions</h2> <dl class="exception" id="s-exceptions"> <dt id="django.contrib.gis.geoip2.GeoIP2Exception">
<code>exception GeoIP2Exception</code> </dt> <dd>
<p>The exception raised when an error occurs in a call to the underlying <code>geoip2</code> library.</p> </dd>
</dl> <h4 class="rubric">Footnotes</h4> <table class="docutils footnote" frame="void" id="id6" rules="none">   <tr>
<td class="label"><a class="fn-backref" href="#id1">[1]</a></td>
<td>GeoIP(R) is a registered trademark of MaxMind, Inc.</td>
</tr>  </table>
<div class="_attribution">
  <p class="_attribution-p">
    Â© Django Software Foundation and individual contributors<br>Licensed under the BSD License.<br>
    <a href="https://docs.djangoproject.com/en/3.1/ref/contrib/gis/geoip2/" class="_attribution-link">https://docs.djangoproject.com/en/3.1/ref/contrib/gis/geoip2/</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

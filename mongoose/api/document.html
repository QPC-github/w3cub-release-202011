
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Document - Mongoose - W3cubDocs</title>
  
  <meta name="description" content=" Don&#39;t run validation on this path or persist changes to this path. ">
  <meta name="keywords" content="document, mongoose">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/mongoose/api/document.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/mongoose.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/mongoose/" class="_nav-link" title="" style="margin-left:0;">Mongoose</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>Document</h1>

<div class="api-content">
<h3 id="document_Document-$ignore">Document.prototype.$ignore()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> the path to ignore </li></ul>
<div>
<p>Don't run validation on this path or persist changes to this path.</p> <h4>Example:</h4> <pre data-language="javascript">doc.foo = <span class="hljs-literal">null</span>;
doc.$ignore(<span class="hljs-string">'foo'</span>);
doc.save(); <span class="hljs-comment">// changes to foo will not be persisted and validators won't be run</span></pre> </div>
<h3 id="document_Document-$isDefault">Document.prototype.$isDefault()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[path] <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if a path is set to its default.</p> <h4>Example</h4> <pre data-language="javascript">MyModel = mongoose.model(<span class="hljs-string">'test'</span>, { name: { type: <span class="hljs-built_in">String</span>, <span class="hljs-keyword">default</span>: <span class="hljs-string">'Val '</span>} });
<span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> MyModel();
m.$isDefault(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// true</span></pre> </div>
<h3 id="document_Document-$isDeleted">Document.prototype.$isDeleted()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[val] <span class="method-type">«Boolean»</span> optional, overrides whether mongoose thinks the doc is deleted </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> whether mongoose thinks this doc is deleted. </li></ul>
<div>
<p>Getter/setter, determines whether the document was removed or not.</p> <h4>Example:</h4> <pre data-language="javascript">product.remove(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, product</span>) </span>{
  product.$isDeleted(); <span class="hljs-comment">// true</span>
  product.remove(); <span class="hljs-comment">// no-op, doesn't send anything to the db</span>

  product.$isDeleted(<span class="hljs-literal">false</span>);
  product.$isDeleted(); <span class="hljs-comment">// false</span>
  product.remove(); <span class="hljs-comment">// will execute a remove against the db</span>
})</pre> </div>
<h3 id="document_Document-$isEmpty">Document.prototype.$isEmpty()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if the given path is nullish or only contains empty objects. Useful for determining whether this subdoc will get stripped out by the <a href="../guide#minimize">minimize option</a>.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ nested: { foo: <span class="hljs-built_in">String</span> } });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> Model({});
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// true</span>
doc.nested.$isEmpty(); <span class="hljs-comment">// true</span>

doc.nested.foo = <span class="hljs-string">'bar'</span>;
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// false</span>
doc.nested.$isEmpty(); <span class="hljs-comment">// false</span></pre> </div>
<h3 id="document_Document-$locals">Document.prototype.$locals</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Empty object that you can use for storing properties on the document. This is handy for passing data to middleware without conflicting with Mongoose internals.</p> <h4>Example:</h4> <pre data-language="javascript">schema.pre(<span class="hljs-string">'save'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>() </span>{
  <span class="hljs-comment">// Mongoose will set `isNew` to `false` if `save()` succeeds</span>
  <span class="hljs-keyword">this</span>.$locals.wasNew = <span class="hljs-keyword">this</span>.isNew;
});

schema.post(<span class="hljs-string">'save'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>() </span>{
  <span class="hljs-comment">// Prints true if `isNew` was set before `save()`</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.$locals.wasNew);
});</pre> </div>
<h3 id="document_Document-$markValid">Document.prototype.$markValid()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> the field to mark as valid </li></ul>
<div>
<p>Marks a path as valid, removing existing validation errors.</p> </div>
<h3 id="document_Document-$session">Document.prototype.$session()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[session] <span class="method-type">«ClientSession»</span> overwrite the current session </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ClientSession»</span> </li></ul>
<div>
<p>Getter/setter around the session associated with this document. Used to automatically set <code>session</code> if you <code>save()</code> a doc that you got from a query with an associated session.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> session = MyModel.startSession();
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> MyModel.findOne().session(session);
doc.$session() === session; <span class="hljs-comment">// true</span>
doc.$session(<span class="hljs-literal">null</span>);
doc.$session() === <span class="hljs-literal">null</span>; <span class="hljs-comment">// true</span></pre> <p>If this is a top-level document, setting the session propagates to all child docs.</p> </div>
<h3 id="document_Document-$set">Document.prototype.$set()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">path <span class="method-type">«String|Object»</span> path or object of key/vals to set </li>
<li class="param">val <span class="method-type">«Any»</span> the value to set </li>
<li class="param">[type] <span class="method-type">«Schema|String|Number|Buffer|*»</span> optionally specify a type for "on-the-fly" attributes </li>
<li class="param">[options] <span class="method-type">«Object»</span> optionally specify options that modify the behavior of the set </li>
</ul>
<div>
<p>Alias for <code>set()</code>, used internally to avoid conflicts</p> </div>
<h3 id="document_Document-depopulate">Document.prototype.depopulate()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this </li></ul>
<div>
<p>Takes a populated field and returns it to its unpopulated state.</p> <h4>Example:</h4> <pre data-language="javascript">Model.findOne().populate(<span class="hljs-string">'author'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
  <span class="hljs-built_in">console</span>.log(doc.author.name); <span class="hljs-comment">// Dr.Seuss</span>
  <span class="hljs-built_in">console</span>.log(doc.depopulate(<span class="hljs-string">'author'</span>));
  <span class="hljs-built_in">console</span>.log(doc.author); <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
})</pre> <p>If the path was not populated, this is a no-op.</p> </div>
<h3 id="document_Document-directModifiedPaths">Document.prototype.directModifiedPaths()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> </li></ul>
<div>
<p>Returns the list of paths that have been directly modified. A direct modified path is a path that you explicitly set, whether via <code>doc.foo = 'bar'</code>, <code>Object.assign(doc, { foo: 'bar' })</code>, or <code>doc.set('foo', 'bar')</code>.</p> <p>A path <code>a</code> may be in <code>modifiedPaths()</code> but not in <code>directModifiedPaths()</code> because a child of <code>a</code> was directly modified.</p> <h4>Example</h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ foo: <span class="hljs-built_in">String</span>, nested: { bar: <span class="hljs-built_in">String</span> } });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">await</span> Model.create({ foo: <span class="hljs-string">'original'</span>, nested: { bar: <span class="hljs-string">'original'</span> } });

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> Model.findOne();
doc.nested.bar = <span class="hljs-string">'modified'</span>;
doc.directModifiedPaths(); <span class="hljs-comment">// ['nested.bar']</span>
doc.modifiedPaths(); <span class="hljs-comment">// ['nested', 'nested.bar']</span></pre> </div>
<h3 id="document_Document-equals">Document.prototype.equals()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">doc <span class="method-type">«Document»</span> a document to compare </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if the Document stores the same data as doc.</p> <p>Documents are considered equal when they have matching <code>_id</code>s, unless neither document has an <code>_id</code>, in which case this function falls back to using <code>deepEqual()</code>.</p> </div>
<h3 id="document_Document-errors">Document.prototype.errors</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Hash containing current validation errors.</p> </div>
<h3 id="document_Document-execPopulate">Document.prototype.execPopulate()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[callback] <span class="method-type">«Function»</span> optional callback. If specified, a promise will <strong>not</strong> be returned </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise»</span> promise that resolves to the document when population is done </li></ul>
<div>
<p>Explicitly executes population and returns a promise. Useful for ES2015 integration.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">var</span> promise = doc.
  populate(<span class="hljs-string">'company'</span>).
  populate({
    path: <span class="hljs-string">'notes'</span>,
    match: <span class="hljs-regexp">/airline/</span>,
    select: <span class="hljs-string">'text'</span>,
    model: <span class="hljs-string">'modelName'</span>
    options: opts
  }).
  execPopulate();

<span class="hljs-comment">// summary</span>
doc.execPopulate().then(resolve, reject);</pre> </div>
<h3 id="document_Document-get">Document.prototype.get()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">path <span class="method-type">«String»</span> </li>
<li class="param">[type] <span class="method-type">«Schema|String|Number|Buffer|*»</span> optionally specify a type for on-the-fly attributes </li>
<li class="param">[options] <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>[options.virtuals=false] <span class="method-type">«Boolean»</span> Apply virtuals before getting this path </li></ul>
<ul style="margin-top: 0.5em"><li>[options.getters=true] <span class="method-type">«Boolean»</span> If false, skip applying getters and just get the raw value </li></ul>
</ul>
<div>
<p>Returns the value of a path.</p> <h4>Example</h4> <pre data-language="javascript"><span class="hljs-comment">// path</span>
doc.get(<span class="hljs-string">'age'</span>) <span class="hljs-comment">// 47</span>

<span class="hljs-comment">// dynamic casting to a string</span>
doc.get(<span class="hljs-string">'age'</span>, <span class="hljs-built_in">String</span>) <span class="hljs-comment">// "47"</span></pre> </div>
<h3 id="document_Document-id">Document.prototype.id</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The string version of this documents _id.</p> <h4>Note:</h4> <p>This getter exists on all documents by default. The getter can be disabled by setting the <code>id</code> <a href="../guide#id">option</a> of its <code>Schema</code> to false at construction time.</p> <pre data-language="javascript"><span class="hljs-keyword">new</span> Schema({ name: <span class="hljs-built_in">String</span> }, { id: <span class="hljs-literal">false</span> });</pre> </div>
<h3 id="document_Document-init">Document.prototype.init()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">doc <span class="method-type">«Object»</span> document returned by mongo </li></ul>
<div>
<p>Initializes the document without setters or marking anything modified.</p> <p>Called internally after a document is returned from mongodb. Normally, you do <strong>not</strong> need to call this function on your own.</p> <p>This function triggers <code>init</code> <a href="../middleware">middleware</a>. Note that <code>init</code> hooks are <a href="../middleware#synchronous">synchronous</a>.</p> </div>
<h3 id="document_Document-inspect">Document.prototype.inspect()</h3>
<div>
<p>Helper for console.log</p> </div>
<h3 id="document_Document-invalidate">Document.prototype.invalidate()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">path <span class="method-type">«String»</span> the field to invalidate </li>
<li class="param">errorMsg <span class="method-type">«String|Error»</span> the error which states the reason <code>path</code> was invalid </li>
<li class="param">value <span class="method-type">«Object|String|Number|any»</span> optional invalid value </li>
<li class="param">[kind] <span class="method-type">«String»</span> optional <code>kind</code> property for the error </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ValidationError»</span> the current ValidationError, with all currently invalidated paths </li></ul>
<div>
<p>Marks a path as invalid, causing validation to fail.</p> <p>The <code>errorMsg</code> argument will become the message of the <code>ValidationError</code>.</p> <p>The <code>value</code> argument (if passed) will be available through the <code>ValidationError.value</code> property.</p> <pre data-language="javascript">doc.invalidate(<span class="hljs-string">'size'</span>, <span class="hljs-string">'must be less than 20'</span>, <span class="hljs-number">14</span>);

doc.validate(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-built_in">console</span>.log(err)
  <span class="hljs-comment">// prints</span>
  { message: <span class="hljs-string">'Validation failed'</span>,
    name: <span class="hljs-string">'ValidationError'</span>,
    errors:
     { size:
        { message: <span class="hljs-string">'must be less than 20'</span>,
          name: <span class="hljs-string">'ValidatorError'</span>,
          path: <span class="hljs-string">'size'</span>,
          type: <span class="hljs-string">'user defined'</span>,
          value: <span class="hljs-number">14</span> } } }
})</pre> </div>
<h3 id="document_Document-isDirectModified">Document.prototype.isDirectModified()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if <code>path</code> was directly set and modified, else false.</p> <h4>Example</h4> <pre data-language="javascript">doc.set(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.isDirectModified(<span class="hljs-string">'documents.0.title'</span>) <span class="hljs-comment">// true</span>
doc.isDirectModified(<span class="hljs-string">'documents'</span>) <span class="hljs-comment">// false</span></pre> </div>
<h3 id="document_Document-isDirectSelected">Document.prototype.isDirectSelected()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> was explicitly selected. If no projection, always returns true.</p> <h4>Example</h4> <pre data-language="javascript">Thing.findOne().select(<span class="hljs-string">'nested.name'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
   doc.isDirectSelected(<span class="hljs-string">'nested.name'</span>) <span class="hljs-comment">// true</span>
   doc.isDirectSelected(<span class="hljs-string">'nested.otherName'</span>) <span class="hljs-comment">// false</span>
   doc.isDirectSelected(<span class="hljs-string">'nested'</span>)  <span class="hljs-comment">// false</span>
})</pre> </div>
<h3 id="document_Document-isInit">Document.prototype.isInit()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> was initialized.</p> </div>
<h3 id="document_Document-isModified">Document.prototype.isModified()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">[path] <span class="method-type">«String»</span> optional </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if this document was modified, else false.</p> <p>If <code>path</code> is given, checks if a path or any full path containing <code>path</code> as part of its path chain has been modified.</p> <h4>Example</h4> <pre data-language="javascript">doc.set(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.isModified()                      <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents'</span>)           <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents.0.title'</span>)   <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents otherProp'</span>) <span class="hljs-comment">// true</span>
doc.isDirectModified(<span class="hljs-string">'documents'</span>)     <span class="hljs-comment">// false</span></pre> </div>
<h3 id="document_Document-isNew">Document.prototype.isNew</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Boolean flag specifying if the document is new.</p> </div>
<h3 id="document_Document-isSelected">Document.prototype.isSelected()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> was selected in the source query which initialized this document.</p> <h4>Example</h4> <pre data-language="javascript">Thing.findOne().select(<span class="hljs-string">'name'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
   doc.isSelected(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// true</span>
   doc.isSelected(<span class="hljs-string">'age'</span>)  <span class="hljs-comment">// false</span>
})</pre> </div>
<h3 id="document_Document-markModified">Document.prototype.markModified()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">path <span class="method-type">«String»</span> the path to mark modified </li>
<li class="param">[scope] <span class="method-type">«Document»</span> the scope to run validators with </li>
</ul>
<div>
<p>Marks the path as having pending changes to write to the db.</p> <p><em>Very helpful when using <a href="schematypes#mixed">Mixed</a> types.</em></p> <h4>Example:</h4> <pre data-language="javascript">doc.mixed.type = <span class="hljs-string">'changed'</span>;
doc.markModified(<span class="hljs-string">'mixed.type'</span>);
doc.save() <span class="hljs-comment">// changes to mixed.type are now persisted</span></pre> </div>
<h3 id="document_Document-modifiedPaths">Document.prototype.modifiedPaths()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[options] <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>[options.includeChildren=false] <span class="method-type">«Boolean»</span> if true, returns children of modified paths as well. For example, if false, the list of modified paths for <code>doc.colors = { primary: 'blue' };</code> will <strong>not</strong> contain <code>colors.primary</code>. If true, <code>modifiedPaths()</code> will return an array that contains <code>colors.primary</code>. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> </li></ul>
<div>
<p>Returns the list of paths that have been modified.</p> </div>
<h3 id="document_Document-overwrite">Document.prototype.overwrite()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">obj <span class="method-type">«Object»</span> the object to overwrite this document with </li></ul>
<div>
<p>Overwrite all values in this document with the values of <code>obj</code>, except for immutable properties. Behaves similarly to <code>set()</code>, except for it unsets all properties that aren't in <code>obj</code>.</p> </div>
<h3 id="document_Document-populate">Document.prototype.populate()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[path] <span class="method-type">«String|Object»</span> The path to populate or an options object </li>
<li class="param">[callback] <span class="method-type">«Function»</span> When passed, population is invoked </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this </li></ul>
<div>
<p>Populates document references, executing the <code>callback</code> when complete. If you want to use promises instead, use this function with <a href="#document_Document-execPopulate"><code>execPopulate()</code></a></p> <h4>Example:</h4> <pre data-language="javascript">doc
.populate(<span class="hljs-string">'company'</span>)
.populate({
  path: <span class="hljs-string">'notes'</span>,
  match: <span class="hljs-regexp">/airline/</span>,
  select: <span class="hljs-string">'text'</span>,
  model: <span class="hljs-string">'modelName'</span>
  options: opts
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, user</span>) </span>{
  assert(doc._id === user._id) <span class="hljs-comment">// the document itself is passed</span>
})

<span class="hljs-comment">// summary</span>
doc.populate(path)                   <span class="hljs-comment">// not executed</span>
doc.populate(options);               <span class="hljs-comment">// not executed</span>
doc.populate(path, callback)         <span class="hljs-comment">// executed</span>
doc.populate(options, callback);     <span class="hljs-comment">// executed</span>
doc.populate(callback);              <span class="hljs-comment">// executed</span>
doc.populate(options).execPopulate() <span class="hljs-comment">// executed, returns promise</span></pre> <h4>NOTE:</h4> <p>Population does not occur unless a <code>callback</code> is passed <em>or</em> you explicitly call <code>execPopulate()</code>. Passing the same path a second time will overwrite the previous path options. See <a href="#model_Model.populate">Model.populate()</a> for explaination of options.</p> </div>
<h3 id="document_Document-populated">Document.prototype.populated()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array,ObjectId,Number,Buffer,String,undefined»</span> </li></ul>
<div>
<p>Gets _id(s) used during population of the given <code>path</code>.</p> <h4>Example:</h4> <pre data-language="javascript">Model.findOne().populate(<span class="hljs-string">'author'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
  <span class="hljs-built_in">console</span>.log(doc.author.name)         <span class="hljs-comment">// Dr.Seuss</span>
  <span class="hljs-built_in">console</span>.log(doc.populated(<span class="hljs-string">'author'</span>)) <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
})</pre> <p>If the path was not populated, undefined is returned.</p> </div>
<h3 id="document_Document-replaceOne">Document.prototype.replaceOne()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">doc <span class="method-type">«Object»</span> </li>
<li class="param">options <span class="method-type">«Object»</span> </li>
<li class="param">callback <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Query»</span> </li></ul>
<div>
<p>Sends a replaceOne command with this document <code>_id</code> as the query selector.</p> <h4>Valid options:</h4> <ul> <li>same as in <a href="#model_Model.replaceOne">Model.replaceOne</a>
</li> </ul> </div>
<h3 id="document_Document-save">Document.prototype.save()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[options] <span class="method-type">«Object»</span> options optional options </li>
<ul style="margin-top: 0.5em"><li>[options.safe] <span class="method-type">«Object»</span> (DEPRECATED) overrides <a href="http://mongoosejs.com//docs/guide.html#safe">schema's safe option</a> </li></ul>
<ul style="margin-top: 0.5em"><li>[options.validateBeforeSave] <span class="method-type">«Boolean»</span> set to false to save without validating. </li></ul>
<li class="param">[fn] <span class="method-type">«Function»</span> optional callback </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise,undefined»</span> Returns undefined if used with callback or a Promise otherwise. </li></ul>
<div>
<p>Saves this document.</p> <h4>Example:</h4> <pre data-language="javascript">product.sold = <span class="hljs-built_in">Date</span>.now();
product.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, product</span>) </span>{
  <span class="hljs-keyword">if</span> (err) ..
})</pre> <p>The callback will receive two parameters</p> <ol> <li>
<code>err</code> if an error occurred</li> <li>
<code>product</code> which is the saved <code>product</code>
</li> </ol> <p>As an extra measure of flow control, save will return a Promise.</p> <h4>Example:</h4> <pre data-language="javascript">product.save().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">product</span>) </span>{
   ...
});</pre> </div>
<h3 id="document_Document-schema">Document.prototype.schema</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The documents schema.</p> </div>
<h3 id="document_Document-set">Document.prototype.set()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">path <span class="method-type">«String|Object»</span> path or object of key/vals to set </li>
<li class="param">val <span class="method-type">«Any»</span> the value to set </li>
<li class="param">[type] <span class="method-type">«Schema|String|Number|Buffer|*»</span> optionally specify a type for "on-the-fly" attributes </li>
<li class="param">[options] <span class="method-type">«Object»</span> optionally specify options that modify the behavior of the set </li>
</ul>
<div>
<p>Sets the value of a path, or many paths.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-comment">// path, value</span>
doc.set(path, value)

<span class="hljs-comment">// object</span>
doc.set({
    path  : value
  , path2 : {
       path  : value
    }
})

<span class="hljs-comment">// on-the-fly cast to number</span>
doc.set(path, value, <span class="hljs-built_in">Number</span>)

<span class="hljs-comment">// on-the-fly cast to string</span>
doc.set(path, value, <span class="hljs-built_in">String</span>)

<span class="hljs-comment">// changing strict mode behavior</span>
doc.set(path, value, { strict: <span class="hljs-literal">false</span> });</pre> </div>
<h3 id="document_Document-toJSON">Document.prototype.toJSON()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">options <span class="method-type">«Object»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Object»</span> </li></ul>
<div>
<p>The return value of this method is used in calls to JSON.stringify(doc).</p> <p>This method accepts the same options as <a href="#document_Document-toObject">Document#toObject</a>. To apply the options to every document of your schema by default, set your <a href="#schema_Schema">schemas</a> <code>toJSON</code> option to the same argument.</p> <pre data-language="javascript">schema.set(<span class="hljs-string">'toJSON'</span>, { virtuals: <span class="hljs-literal">true</span> })</pre> <p>See <a href="../guide#toJSON">schema options</a> for details.</p> </div>
<h3 id="document_Document-toObject">Document.prototype.toObject()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[options] <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>[options.getters=false] <span class="method-type">«Boolean»</span> if true, apply all getters, including virtuals </li></ul>
<ul style="margin-top: 0.5em"><li>[options.virtuals=false] <span class="method-type">«Boolean»</span> if true, apply virtuals, including aliases. Use <code>{ getters: true, virtuals: false }</code> to just apply getters, not virtuals </li></ul>
<ul style="margin-top: 0.5em"><li>[options.aliases=true] <span class="method-type">«Boolean»</span> if <code>options.virtuals = true</code>, you can set <code>options.aliases = false</code> to skip applying aliases. This option is a no-op if <code>options.virtuals = false</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.minimize=true] <span class="method-type">«Boolean»</span> if true, omit any empty objects from the output </li></ul>
<ul style="margin-top: 0.5em"><li>[options.transform=null] <span class="method-type">«Function|null»</span> if set, mongoose will call this function to allow you to transform the returned object </li></ul>
<ul style="margin-top: 0.5em"><li>[options.depopulate=false] <span class="method-type">«Boolean»</span> if true, replace any conventionally populated paths with the original id in the output. Has no affect on virtual populated paths. </li></ul>
<ul style="margin-top: 0.5em"><li>[options.versionKey=true] <span class="method-type">«Boolean»</span> if false, exclude the version key (<code>__v</code> by default) from the output </li></ul>
<ul style="margin-top: 0.5em"><li>[options.flattenMaps=false] <span class="method-type">«Boolean»</span> if true, convert Maps to POJOs. Useful if you want to <code>JSON.stringify()</code> the result of <code>toObject()</code>. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Object»</span> js object </li></ul>
<div>
<p>Converts this document into a plain javascript object, ready for storage in MongoDB.</p> <p>Buffers are converted to instances of <a href="http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html">mongodb.Binary</a> for proper storage.</p> <h4>Options:</h4> <ul> <li>
<code>getters</code> apply all getters (path and virtual getters), defaults to false</li> <li>
<code>virtuals</code> apply virtual getters (can override <code>getters</code> option), defaults to false</li> <li>
<code>minimize</code> remove empty objects (defaults to true)</li> <li>
<code>transform</code> a transform function to apply to the resulting document before returning</li> <li>
<code>depopulate</code> depopulate any populated paths, replacing them with their original refs (defaults to false)</li> <li>
<code>versionKey</code> whether to include the version key (defaults to true)</li> </ul> <h4>Getters/Virtuals</h4> <p>Example of only applying path getters</p> <pre data-language="javascript">doc.toObject({ getters: <span class="hljs-literal">true</span>, virtuals: <span class="hljs-literal">false</span> })</pre> <p>Example of only applying virtual getters</p> <pre data-language="javascript">doc.toObject({ virtuals: <span class="hljs-literal">true</span> })</pre> <p>Example of applying both path and virtual getters</p> <pre data-language="javascript">doc.toObject({ getters: <span class="hljs-literal">true</span> })</pre> <p>To apply these options to every document of your schema by default, set your <a href="#schema_Schema">schemas</a> <code>toObject</code> option to the same argument.</p> <pre data-language="javascript">schema.set(<span class="hljs-string">'toObject'</span>, { virtuals: <span class="hljs-literal">true</span> })</pre> <h4>Transform</h4> <p>We may need to perform a transformation of the resulting object based on some criteria, say to remove some sensitive information or return a custom object. In this case we set the optional <code>transform</code> function.</p> <p>Transform functions receive three arguments</p> <pre data-language="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{}</pre> <ul> <li>
<code>doc</code> The mongoose document which is being converted</li> <li>
<code>ret</code> The plain object representation which has been converted</li> <li>
<code>options</code> The options in use (either schema options or the options passed inline)</li> </ul> <h4>Example</h4> <pre data-language="javascript"><span class="hljs-comment">// specify the transform schema option</span>
<span class="hljs-keyword">if</span> (!schema.options.toObject) schema.options.toObject = {};
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-comment">// remove the _id of every document before returning the result</span>
  <span class="hljs-keyword">delete</span> ret._id;
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.toObject(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.toObject(); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span></pre> <p>With transformations we can do a lot more than remove properties. We can even return completely new customized objects:</p> <pre data-language="javascript"><span class="hljs-keyword">if</span> (!schema.options.toObject) schema.options.toObject = {};
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">return</span> { movie: ret.name }
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.toObject(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.toObject(); <span class="hljs-comment">// { movie: 'Wreck-it Ralph' }</span></pre> <p><em>Note: if a transform function returns <code>undefined</code>, the return value will be ignored.</em></p> <p>Transformations may also be applied inline, overridding any transform set in the options:</p> <pre data-language="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xform</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">return</span> { inline: ret.name, custom: <span class="hljs-literal">true</span> }
}

<span class="hljs-comment">// pass the transform as an inline option</span>
doc.toObject({ transform: xform }); <span class="hljs-comment">// { inline: 'Wreck-it Ralph', custom: true }</span></pre> <p>If you want to skip transformations, use <code>transform: false</code>:</p> <pre data-language="javascript">schema.options.toObject.hide = <span class="hljs-string">'_id'</span>;
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">if</span> (options.hide) {
    options.hide.split(<span class="hljs-string">' '</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prop</span>) </span>{
      <span class="hljs-keyword">delete</span> ret[prop];
    });
  }
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> Doc({ _id: <span class="hljs-string">'anId'</span>, secret: <span class="hljs-number">47</span>, name: <span class="hljs-string">'Wreck-it Ralph'</span> });
doc.toObject();                                        <span class="hljs-comment">// { secret: 47, name: 'Wreck-it Ralph' }</span>
doc.toObject({ hide: <span class="hljs-string">'secret _id'</span>, transform: <span class="hljs-literal">false</span> });<span class="hljs-comment">// { _id: 'anId', secret: 47, name: 'Wreck-it Ralph' }</span>
doc.toObject({ hide: <span class="hljs-string">'secret _id'</span>, transform: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span></pre> <p>If you pass a transform in <code>toObject()</code> options, Mongoose will apply the transform to <a href="../subdocs">subdocuments</a> in addition to the top-level document. Similarly, <code>transform: false</code> skips transforms for all subdocuments.</p> <h2>Note that this is behavior is different for transforms defined in the schema</h2> <p>if you define a transform in <code>schema.options.toObject.transform</code>, that transform will <strong>not</strong> apply to subdocuments.</p> <pre data-language="javascript">const memberSchema = new Schema({ name: String, email: String });
const groupSchema = new Schema({ members: [memberSchema], name: String, email });
const Group = mongoose.model('Group', groupSchema);

const doc = new Group({
  name: 'Engineering',
  email: '<a href="mailto:dev@mongoosejs.io">dev@mongoosejs.io</a>',
  members: [{ name: 'Val', email: '<a href="mailto:val@mongoosejs.io">val@mongoosejs.io</a>' }]
});

// Removes `email` from both top-level document **and** array elements
// { name: 'Engineering', members: [{ name: 'Val' }] }
doc.toObject({ transform: (doc, ret) =&gt; { delete ret.email; return ret; } });
</pre> <p>Transforms, like all of these options, are also available for <code>toJSON</code>. See <a href="https://thecodebarbarian.com/the-80-20-guide-to-json-stringify-in-javascript.html">this guide to <code>JSON.stringify()</code></a> to learn why <code>toJSON()</code> and <code>toObject()</code> are separate functions.</p> <p>See <a href="../guide#toObject">schema options</a> for some more details.</p> <p><em>During save, no custom options are applied to the document before being sent to the database.</em></p> </div>
<h3 id="document_Document-toString">Document.prototype.toString()</h3>
<div>
<p>Helper for console.log</p> </div>
<h3 id="document_Document-unmarkModified">Document.prototype.unmarkModified()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">path <span class="method-type">«String»</span> the path to unmark modified </li></ul>
<div>
<p>Clears the modified state on the specified path.</p> <h4>Example:</h4> <pre data-language="javascript">doc.foo = <span class="hljs-string">'bar'</span>;
doc.unmarkModified(<span class="hljs-string">'foo'</span>);
doc.save(); <span class="hljs-comment">// changes to foo will not be persisted</span></pre> </div>
<h3 id="document_Document-update">Document.prototype.update()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">doc <span class="method-type">«Object»</span> </li>
<li class="param">options <span class="method-type">«Object»</span> </li>
<li class="param">callback <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Query»</span> </li></ul>
<div>
<p>Sends an update command with this document <code>_id</code> as the query selector.</p> <h4>Example:</h4> <pre data-language="javascript">weirdCar.update({$inc: {wheels:<span class="hljs-number">1</span>}}, { w: <span class="hljs-number">1</span> }, callback);</pre> <h4>Valid options:</h4> <ul> <li>same as in <a href="#model_Model.update">Model.update</a>
</li> </ul> </div>
<h3 id="document_Document-updateOne">Document.prototype.updateOne()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">doc <span class="method-type">«Object»</span> </li>
<li class="param">options <span class="method-type">«Object»</span> </li>
<li class="param">callback <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Query»</span> </li></ul>
<div>
<p>Sends an updateOne command with this document <code>_id</code> as the query selector.</p> <h4>Example:</h4> <pre data-language="javascript">weirdCar.updateOne({$inc: {wheels:<span class="hljs-number">1</span>}}, { w: <span class="hljs-number">1</span> }, callback);</pre> <h4>Valid options:</h4> <ul> <li>same as in <a href="#model_Model.updateOne">Model.updateOne</a>
</li> </ul> </div>
<h3 id="document_Document-validate">Document.prototype.validate()</h3>
<h5>Parameters</h5>
<ul class="params">
<li class="param">[pathsToValidate] <span class="method-type">«Array|String»</span> list of paths to validate. If set, Mongoose will validate only the modified paths that are in the given list. </li>
<li class="param">[options] <span class="method-type">«Object»</span> internal options </li>
<li class="param">[callback] <span class="method-type">«Function»</span> optional callback called after validation completes, passing an error if one occurred </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise»</span> Promise </li></ul>
<div>
<p>Executes registered validation rules for this document.</p> <h4>Note:</h4> <p>This method is called <code>pre</code> save and if a validation rule is violated, <a href="#model_Model-save">save</a> is aborted and the error is returned to your <code>callback</code>.</p> <h4>Example:</h4> <pre data-language="javascript">doc.validate(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-keyword">if</span> (err) handleError(err);
  <span class="hljs-keyword">else</span> <span class="hljs-comment">// validation passed</span>
});</pre> </div>
<h3 id="document_Document-validateSync">Document.prototype.validateSync()</h3>
<h5>Parameters</h5>
<ul class="params"><li class="param">pathsToValidate <span class="method-type">«Array|string»</span> only validate the given paths </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ValidationError,undefined»</span> ValidationError if there are errors during validation, or undefined if there is no error. </li></ul>
<div>
<p>Executes registered validation rules (skipping asynchronous validators) for this document.</p> <h4>Note:</h4> <p>This method is useful if you need synchronous validation.</p> <h4>Example:</h4> <pre data-language="javascript"><span class="hljs-keyword">var</span> err = doc.validateSync();
<span class="hljs-keyword">if</span> (err) {
  handleError(err);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// validation passed</span>
}</pre> </div>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010 LearnBoost<br>Licensed under the MIT License.<br>
    <a href="https://mongoosejs.com/docs/api/document.html" class="_attribution-link">https://mongoosejs.com/docs/api/document.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

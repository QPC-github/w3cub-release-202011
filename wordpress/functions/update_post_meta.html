
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Update_post_meta() - WordPress - W3cubDocs</title>
  
  <meta name="description" content=" Updates a post meta field based on the given post ID. ">
  <meta name="keywords" content="update, post, meta, int, &#36;post, id, string, &#36;meta, key, mixed, value, &#36;prev, &#39;&#39;, wordpress">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/wordpress/functions/update_post_meta.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/wordpress.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/wordpress/" class="_nav-link" title="" style="margin-left:0;">WordPress</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _wordpress">
				
				
<h1>update_post_meta( int $post_id, string $meta_key, mixed $meta_value, mixed $prev_value = '' )</h1>  <section class="summary"> <p>Updates a post meta field based on the given post ID.</p> </section> <div class="content-toc">  <section class="description"> <h2 class="toc-heading" id="description" tabindex="-1">Description </h2> <p>Use the <code>$prev_value</code> parameter to differentiate between meta fields with the same key and post ID.</p> <p>If the meta field for the post does not exist, it will be added and its ID returned.</p> <p>Can be used in place of <a href="add_post_meta">add_post_meta()</a>.</p> </section>  <section class="parameters"> <h2 class="toc-heading" id="parameters" tabindex="-1">Parameters </h2> <dl> <dt>$post_id</dt> <dd> <p class="desc"> <span class="type">(<span class="int">int</span>)</span> <span class="required">(Required)</span> <span class="description">Post ID.</span> </p> </dd> <dt>$meta_key</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">Metadata key.</span> </p> </dd> <dt>$meta_value</dt> <dd> <p class="desc"> <span class="type">(<span class="mixed">mixed</span>)</span> <span class="required">(Required)</span> <span class="description">Metadata value. Must be serializable if non-scalar.</span> </p> </dd> <dt>$prev_value</dt> <dd> <p class="desc"> <span class="type">(<span class="mixed">mixed</span>)</span> <span class="required">(Optional)</span> <span class="description"> Previous value to check before updating. If specified, only update existing metadata entries with this value. Otherwise, update all entries. </span> </p> <p class="default">Default value: ''</p> </dd> </dl> </section>  <section class="return"> <h2 class="toc-heading" id="return" tabindex="-1">Return </h2> <p><span class="return-type">(int|bool)</span> Meta ID if the key didn't exist, true on successful update, false on failure or if the value passed to the function is the same as the one that is already in the database.</p> </section>  <section class="explanation"> <h2 class="toc-heading" id="more-information" tabindex="-1">More Information </h2> <h3 class="toc-heading" id="character-escaping" tabindex="-1">Character Escaping </h3> <p>Post meta values are passed through the stripslashes() function upon being stored, so you will need to be careful when passing in values (such as JSON) that might include \ escaped characters.</p> <h4 class="toc-heading" id="do-not-store-escaped-values" tabindex="-1">Do not store escaped values </h4> <p>Consider the JSON value <code>{"key":"value with \"escaped quotes\""}</code></p> <pre class="brush: php; title: ; notranslate" title="" data-language="php">
&lt;?php
$escaped_json = '{"key":"value with \\"escaped quotes\\""}';
update_post_meta( $id, 'escaped_json', $escaped_json );
$broken = get_post_meta( $id, 'escaped_json', true );
/*
$broken, after passing through stripslashes() ends up unparsable:
{"key":"value with "escaped quotes""}
*/
?&gt;
</pre> <h4 class="toc-heading" id="workaround" tabindex="-1">Workaround </h4> <p>By adding one more level of \ escaping using function <code>wp_slash</code> (introduced in WP 3.6), you can compensate for the call to stripslashes()</p> <pre class="brush: php; title: ; notranslate" title="" data-language="php">
&lt;?php
$escaped_json = '{"key":"value with \\"escaped quotes\\""}';
update_post_meta( $id, 'double_escaped_json', wp_slash( $escaped_json ) );
$fixed = get_post_meta( $id, 'double_escaped_json', true );
/*
$fixed, after stripslashes(), ends up being stored as desired:
{"key":"value with \"escaped quotes\""}
*/
?&gt;
</pre> </section>  <section class="source-content"> <h2 class="toc-heading" id="source" tabindex="-1">Source </h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/post.php/">wp-includes/post.php</a> </p> <pre class="source-code-container" data-language="php">function update_post_meta( $post_id, $meta_key, $meta_value, $prev_value = '' ) {
	// Make sure meta is added to the post, not a revision.
	$the_post = wp_is_post_revision( $post_id );
	if ( $the_post ) {
		$post_id = $the_post;
	}

	return update_metadata( 'post', $post_id, $meta_key, $meta_value, $prev_value );
}</pre>  </section>  <section class="related"> <h2 class="toc-heading" id="related" tabindex="-1">Related </h2> <article class="uses"> <h3 class="toc-heading" id="uses" tabindex="-1">Uses </h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/revision.php:</span> <a href="wp_is_post_revision">wp_is_post_revision()</a> </td> <td class="related-desc"> <p>Determines if the specified post is a revision.</p> </td> </tr> <tr> <td> <span>wp-includes/meta.php:</span> <a href="update_metadata">update_metadata()</a> </td> <td class="related-desc"> <p>Updates metadata for the specified object. If no value already exists for the specified object ID and metadata key, the metadata will be added.</p> </td> </tr> </tbody>

</table> </article> <article class="used-by"> <h3 class="toc-heading" id="used-by" tabindex="-1">Used By </h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-attachments-controller.php:</span> <a href="../classes/wp_rest_attachments_controller/edit_media_item">WP_REST_Attachments_Controller::edit_media_item()</a> </td> <td class="related-desc"> <p>Applies edits to a media item and creates a new attachment record.</p> </td> </tr> <tr> <td> <span>wp-includes/user.php:</span> <a href="_wp_privacy_account_request_confirmed">_wp_privacy_account_request_confirmed()</a> </td> <td class="related-desc"> <p>Update log when privacy request is confirmed.</p> </td> </tr> <tr> <td> <span>wp-includes/user.php:</span> <a href="_wp_privacy_send_request_confirmation_notification">_wp_privacy_send_request_confirmation_notification()</a> </td> <td class="related-desc"> <p>Notify the site administrator via email when a request is confirmed.</p> </td> </tr> <tr> <td> <span>wp-includes/user.php:</span> <a href="_wp_privacy_send_erasure_fulfillment_notification">_wp_privacy_send_erasure_fulfillment_notification()</a> </td> <td class="related-desc"> <p>Notify the user when their erasure request is fulfilled.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/privacy-tools.php:</span> <a href="wp_privacy_process_personal_data_export_page">wp_privacy_process_personal_data_export_page()</a> </td> <td class="related-desc"> <p>Intercept personal data exporter page Ajax responses in order to assemble the personal data export file.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/privacy-tools.php:</span> <a href="wp_privacy_generate_personal_data_export_file">wp_privacy_generate_personal_data_export_file()</a> </td> <td class="related-desc"> <p>Generate the personal data export file.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/privacy-tools.php:</span> <a href="_wp_privacy_completed_request">_wp_privacy_completed_request()</a> </td> <td class="related-desc"> <p>Marks a request as completed by the admin and logs the current timestamp.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="../classes/wp_customize_manager/set_changeset_lock">WP_Customize_Manager::set_changeset_lock()</a> </td> <td class="related-desc"> <p>Marks the changeset post as being currently edited by the current user.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="../classes/wp_customize_manager/refresh_changeset_lock">WP_Customize_Manager::refresh_changeset_lock()</a> </td> <td class="related-desc"> <p>Refreshes changeset lock with the current time if current user edited the changeset before.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="../classes/wp_customize_manager/dismiss_user_auto_draft_changesets">WP_Customize_Manager::dismiss_user_auto_draft_changesets()</a> </td> <td class="related-desc"> <p>Dismiss all of the current user’s auto-drafts (other than the present one).</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-customize-manager.php:</span> <a href="../classes/wp_customize_manager/import_theme_starter_content">WP_Customize_Manager::import_theme_starter_content()</a> </td> <td class="related-desc"> <p>Import theme starter content into the customized state.</p> </td> </tr> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-attachments-controller.php:</span> <a href="../classes/wp_rest_attachments_controller/create_item">WP_REST_Attachments_Controller::create_item()</a> </td> <td class="related-desc"> <p>Creates a single attachment.</p> </td> </tr> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-attachments-controller.php:</span> <a href="../classes/wp_rest_attachments_controller/update_item">WP_REST_Attachments_Controller::update_item()</a> </td> <td class="related-desc"> <p>Updates a single attachment.</p> </td> </tr> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php:</span> <a href="../classes/wp_rest_posts_controller/handle_template">WP_REST_Posts_Controller::handle_template()</a> </td> <td class="related-desc"> <p>Sets the template for a post.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-background.php:</span> <a href="../classes/custom_background/ajax_background_add">Custom_Background::ajax_background_add()</a> </td> <td class="related-desc"> <p>Ajax handler for adding custom background context to an attachment.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/image-edit.php:</span> <a href="wp_restore_image">wp_restore_image()</a> </td> <td class="related-desc"> <p>Restores the metadata for a given attachment.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/image-edit.php:</span> <a href="wp_save_image">wp_save_image()</a> </td> <td class="related-desc"> <p>Saves image to post, along with enqueued changes in <code>$_REQUEST['history']</code>.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/image.php:</span> <a href="wp_generate_attachment_metadata">wp_generate_attachment_metadata()</a> </td> <td class="related-desc"> <p>Generate attachment meta data and create image sub-sizes for images.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/media.php:</span> <a href="media_upload_form_handler">media_upload_form_handler()</a> </td> <td class="related-desc"> <p>Handles form submissions for the legacy media uploader.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/post.php:</span> <a href="wp_set_post_lock">wp_set_post_lock()</a> </td> <td class="related-desc"> <p>Mark the post as currently being edited by the current user</p> </td> </tr> <tr> <td> <span>wp-admin/includes/post.php:</span> <a href="edit_post">edit_post()</a> </td> <td class="related-desc"> <p>Update an existing post with values provided in $_POST.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/ajax-actions.php:</span> <a href="wp_ajax_upload_attachment">wp_ajax_upload_attachment()</a> </td> <td class="related-desc"> <p>Ajax handler for uploading attachments</p> </td> </tr> <tr> <td> <span>wp-admin/includes/ajax-actions.php:</span> <a href="wp_ajax_wp_remove_post_lock">wp_ajax_wp_remove_post_lock()</a> </td> <td class="related-desc"> <p>Ajax handler for removing a post lock.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/ajax-actions.php:</span> <a href="wp_ajax_save_attachment">wp_ajax_save_attachment()</a> </td> <td class="related-desc"> <p>Ajax handler for updating attachment attributes.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-image-header.php:</span> <a href="../classes/custom_image_header/ajax_header_add">Custom_Image_Header::ajax_header_add()</a> </td> <td class="related-desc"> <p>Given an attachment ID for a header image, updates its “last used” timestamp to now.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-image-header.php:</span> <a href="../classes/custom_image_header/customize_set_last_used">Custom_Image_Header::customize_set_last_used()</a> </td> <td class="related-desc"> <p>Updates the last-used postmeta on a header image attachment after saving a new header image via the Customizer.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-image-header.php:</span> <a href="../classes/custom_image_header/set_header_image">Custom_Image_Header::set_header_image()</a> </td> <td class="related-desc"> <p>Choose a header image, selected from existing uploaded and default headers, or provide an array of uploaded header data (either new, or from media library).</p> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-background.php:</span> <a href="../classes/custom_background/wp_set_background_image">Custom_Background::wp_set_background_image()</a> </td> <td class="related-desc"> </td> </tr> <tr> <td> <span>wp-admin/includes/class-custom-background.php:</span> <a href="../classes/custom_background/handle_upload">Custom_Background::handle_upload()</a> </td> <td class="related-desc"> <p>Handle an Image upload for the background image.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-embed.php:</span> <a href="../classes/wp_embed/shortcode">WP_Embed::shortcode()</a> </td> <td class="related-desc"> <p>The <a href="do_shortcode">do_shortcode()</a> callback function.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="set_post_thumbnail">set_post_thumbnail()</a> </td> <td class="related-desc"> <p>Sets the post thumbnail (featured image) for the given post.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="wp_update_attachment_metadata">wp_update_attachment_metadata()</a> </td> <td class="related-desc"> <p>Updates metadata for an attachment.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="wp_insert_post">wp_insert_post()</a> </td> <td class="related-desc"> <p>Insert or update a post.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="update_attached_file">update_attached_file()</a> </td> <td class="related-desc"> <p>Update attachment file path based on attachment ID.</p> </td> </tr> <tr> <td> <span>wp-includes/revision.php:</span> <a href="wp_restore_post_revision">wp_restore_post_revision()</a> </td> <td class="related-desc"> <p>Restores a post to the specified revision.</p> </td> </tr> <tr> <td> <span>wp-includes/nav-menu.php:</span> <a href="wp_update_nav_menu_item">wp_update_nav_menu_item()</a> </td> <td class="related-desc"> <p>Save the properties of a menu item or create a new one.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section class="changelog"> <h2 class="toc-heading" id="changelog" tabindex="-1">Changelog </h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/1.5.0/" alt="WordPress 1.5.0">1.5.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>   </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2003–2019 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/update_post_meta" class="_attribution-link">https://developer.wordpress.org/reference/functions/update_post_meta</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

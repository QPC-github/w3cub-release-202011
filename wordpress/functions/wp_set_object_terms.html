
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Wp_set_object_terms() - WordPress - W3cubDocs</title>
  
  <meta name="description" content=" Create Term and Taxonomy Relationships. ">
  <meta name="keywords" content="wp, set, object, terms, int, &#36;object, id, string|int|array, &#36;terms, string, &#36;taxonomy, bool, &#36;append, false, wordpress">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/wordpress/functions/wp_set_object_terms.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/wordpress.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/wordpress/" class="_nav-link" title="" style="margin-left:0;">WordPress</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _wordpress">
				
				
<h1>wp_set_object_terms( int $object_id, string|int|array $terms, string $taxonomy, bool $append = false )</h1>  <section class="summary"> <p>Create Term and Taxonomy Relationships.</p> </section> <div class="content-toc">  <section class="description"> <h2 class="toc-heading" id="description" tabindex="-1">Description </h2> <p>Relates an object (post, link etc) to a term and taxonomy type. Creates the term and taxonomy relationship if it doesn’t already exist. Creates a term if it doesn’t exist (using the slug).</p> <p>A relationship means that the term is grouped in or belongs to the taxonomy. A term has no meaning until it is given context by defining which taxonomy it exists under.</p> </section>  <section class="parameters"> <h2 class="toc-heading" id="parameters" tabindex="-1">Parameters </h2> <dl> <dt>$object_id</dt> <dd> <p class="desc"> <span class="type">(<span class="int">int</span>)</span> <span class="required">(Required)</span> <span class="description">The object to relate to.</span> </p> </dd> <dt>$terms</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>|<span class="int">int</span>|<span class="array">array</span>)</span> <span class="required">(Required)</span> <span class="description">A single term slug, single term ID, or array of either term slugs or IDs. Will replace all existing related terms in this taxonomy. Passing an empty value will remove all related terms.</span> </p> </dd> <dt>$taxonomy</dt> <dd> <p class="desc"> <span class="type">(<span class="string">string</span>)</span> <span class="required">(Required)</span> <span class="description">The context in which to relate the term to the object.</span> </p> </dd> <dt>$append</dt> <dd> <p class="desc"> <span class="type">(<span class="bool">bool</span>)</span> <span class="required">(Optional)</span> <span class="description"> If false will delete difference of terms. </span> </p> <p class="default">Default value: false</p> </dd> </dl> </section>  <section class="return"> <h2 class="toc-heading" id="return" tabindex="-1">Return </h2> <p><span class="return-type">(array|<a href="../classes/wp_error">WP_Error</a>)</span> Term taxonomy IDs of the affected terms or <a href="../classes/wp_error">WP_Error</a> on failure.</p> </section>  <section class="explanation"> <h2 class="toc-heading" id="more-information" tabindex="-1">More Information </h2> <p>For parameter <code>$terms</code>, integers are interpreted as tag IDs. Some functions may return term_ids as strings which will be interpreted as slugs consisting of numeric characters.</p> <p>For Return:</p> <ul> <li>(array) An array of the terms ( as term_taxonomy_ids ! ) affected if successful</li> <li>(array) An empty array if the $terms argument was NULL or empty – successmessage for the removing of the term</li> <li>(<a href="../classes/wp_error">WP_Error</a>) The WordPress Error object on invalid taxonomy (‘invalid_taxonomy’).</li> <li>(string) The first offending term if a term given in the $terms parameter is named incorrectly. (Invalid term ids are accepted and inserted).</li> </ul> <p>This function <b>does not check</b> if there is a relationship between the object (=post type) and the taxonomy (like post_tag, category or custom taxonomy). Because of that, any existing term will be paired with the object, whether or not there is a connection between the object and the taxonomy (of this particular term)!! ( <a class="external text" href="http://www.wp-entwickler.at/vorsicht-beim-setzen-von-terms-mit-wp-set-object-terms/" rel="nofollow">Further information in <b>german</b></a>)</p> <p>Perhaps the <a title="Function Reference/wp set post terms" href="wp_set_post_terms">wp_set_post_terms()</a> is a more useful function, since it checks the values​​, converting taxonomies separated by commas and validating hierarchical terms in integers.</p> <p>It may be confusing but the returned array consists of <b>term_taxonomy_ids</b> instead of term_ids.</p> </section>  <section class="source-content"> <h2 class="toc-heading" id="source" tabindex="-1">Source </h2> <p> File: <a href="https://developer.wordpress.org/reference/files/wp-includes/taxonomy.php/">wp-includes/taxonomy.php</a> </p> <pre class="source-code-container" data-language="php">function wp_set_object_terms( $object_id, $terms, $taxonomy, $append = false ) {
	global $wpdb;

	$object_id = (int) $object_id;

	if ( ! taxonomy_exists( $taxonomy ) ) {
		return new WP_Error( 'invalid_taxonomy', __( 'Invalid taxonomy.' ) );
	}

	if ( ! is_array( $terms ) ) {
		$terms = array( $terms );
	}

	if ( ! $append ) {
		$old_tt_ids = wp_get_object_terms(
			$object_id,
			$taxonomy,
			array(
				'fields'                 =&gt; 'tt_ids',
				'orderby'                =&gt; 'none',
				'update_term_meta_cache' =&gt; false,
			)
		);
	} else {
		$old_tt_ids = array();
	}

	$tt_ids     = array();
	$term_ids   = array();
	$new_tt_ids = array();

	foreach ( (array) $terms as $term ) {
		if ( '' === trim( $term ) ) {
			continue;
		}

		$term_info = term_exists( $term, $taxonomy );

		if ( ! $term_info ) {
			// Skip if a non-existent term ID is passed.
			if ( is_int( $term ) ) {
				continue;
			}

			$term_info = wp_insert_term( $term, $taxonomy );
		}

		if ( is_wp_error( $term_info ) ) {
			return $term_info;
		}

		$term_ids[] = $term_info['term_id'];
		$tt_id      = $term_info['term_taxonomy_id'];
		$tt_ids[]   = $tt_id;

		if ( $wpdb-&gt;get_var( $wpdb-&gt;prepare( "SELECT term_taxonomy_id FROM $wpdb-&gt;term_relationships WHERE object_id = %d AND term_taxonomy_id = %d", $object_id, $tt_id ) ) ) {
			continue;
		}

		/**
		 * Fires immediately before an object-term relationship is added.
		 *
		 * @since 2.9.0
		 * @since 4.7.0 Added the `$taxonomy` parameter.
		 *
		 * @param int    $object_id Object ID.
		 * @param int    $tt_id     Term taxonomy ID.
		 * @param string $taxonomy  Taxonomy slug.
		 */
		do_action( 'add_term_relationship', $object_id, $tt_id, $taxonomy );

		$wpdb-&gt;insert(
			$wpdb-&gt;term_relationships,
			array(
				'object_id'        =&gt; $object_id,
				'term_taxonomy_id' =&gt; $tt_id,
			)
		);

		/**
		 * Fires immediately after an object-term relationship is added.
		 *
		 * @since 2.9.0
		 * @since 4.7.0 Added the `$taxonomy` parameter.
		 *
		 * @param int    $object_id Object ID.
		 * @param int    $tt_id     Term taxonomy ID.
		 * @param string $taxonomy  Taxonomy slug.
		 */
		do_action( 'added_term_relationship', $object_id, $tt_id, $taxonomy );

		$new_tt_ids[] = $tt_id;
	}

	if ( $new_tt_ids ) {
		wp_update_term_count( $new_tt_ids, $taxonomy );
	}

	if ( ! $append ) {
		$delete_tt_ids = array_diff( $old_tt_ids, $tt_ids );

		if ( $delete_tt_ids ) {
			$in_delete_tt_ids = "'" . implode( "', '", $delete_tt_ids ) . "'";
			$delete_term_ids  = $wpdb-&gt;get_col( $wpdb-&gt;prepare( "SELECT tt.term_id FROM $wpdb-&gt;term_taxonomy AS tt WHERE tt.taxonomy = %s AND tt.term_taxonomy_id IN ($in_delete_tt_ids)", $taxonomy ) );
			$delete_term_ids  = array_map( 'intval', $delete_term_ids );

			$remove = wp_remove_object_terms( $object_id, $delete_term_ids, $taxonomy );
			if ( is_wp_error( $remove ) ) {
				return $remove;
			}
		}
	}

	$t = get_taxonomy( $taxonomy );

	if ( ! $append &amp;&amp; isset( $t-&gt;sort ) &amp;&amp; $t-&gt;sort ) {
		$values     = array();
		$term_order = 0;

		$final_tt_ids = wp_get_object_terms(
			$object_id,
			$taxonomy,
			array(
				'fields'                 =&gt; 'tt_ids',
				'update_term_meta_cache' =&gt; false,
			)
		);

		foreach ( $tt_ids as $tt_id ) {
			if ( in_array( (int) $tt_id, $final_tt_ids, true ) ) {
				$values[] = $wpdb-&gt;prepare( '(%d, %d, %d)', $object_id, $tt_id, ++$term_order );
			}
		}

		if ( $values ) {
			if ( false === $wpdb-&gt;query( "INSERT INTO $wpdb-&gt;term_relationships (object_id, term_taxonomy_id, term_order) VALUES " . join( ',', $values ) . ' ON DUPLICATE KEY UPDATE term_order = VALUES(term_order)' ) ) {
				return new WP_Error( 'db_insert_error', __( 'Could not insert term relationship into the database.' ), $wpdb-&gt;last_error );
			}
		}
	}

	wp_cache_delete( $object_id, $taxonomy . '_relationships' );
	wp_cache_delete( 'last_changed', 'terms' );

	/**
	 * Fires after an object's terms have been set.
	 *
	 * @since 2.8.0
	 *
	 * @param int    $object_id  Object ID.
	 * @param array  $terms      An array of object terms.
	 * @param array  $tt_ids     An array of term taxonomy IDs.
	 * @param string $taxonomy   Taxonomy slug.
	 * @param bool   $append     Whether to append new terms to the old terms.
	 * @param array  $old_tt_ids Old array of term taxonomy IDs.
	 */
	do_action( 'set_object_terms', $object_id, $terms, $tt_ids, $taxonomy, $append, $old_tt_ids );

	return $tt_ids;
}</pre>  </section>  <section class="related"> <h2 class="toc-heading" id="related" tabindex="-1">Related </h2> <article class="uses"> <h3 class="toc-heading" id="uses" tabindex="-1">Uses </h3> <table id="uses-table">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/cache.php:</span> <a href="wp_cache_delete">wp_cache_delete()</a> </td> <td class="related-desc"> <p>Removes the cache contents matching key and group.</p> </td> </tr> <tr> <td> <span>wp-includes/l10n.php:</span> <a href="__">__()</a> </td> <td class="related-desc"> <p>Retrieve the translation of $text.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_update_term_count">wp_update_term_count()</a> </td> <td class="related-desc"> <p>Updates the amount of terms in taxonomy.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_get_object_terms">wp_get_object_terms()</a> </td> <td class="related-desc"> <p>Retrieves the terms associated with the given object(s), in the supplied taxonomies.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_insert_term">wp_insert_term()</a> </td> <td class="related-desc"> <p>Add a new term to the database.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_remove_object_terms">wp_remove_object_terms()</a> </td> <td class="related-desc"> <p>Remove term(s) associated with a given object.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="../hooks/add_term_relationship">add_term_relationship</a> </td> <td class="related-desc"> <p>Fires immediately before an object-term relationship is added.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="../hooks/added_term_relationship">added_term_relationship</a> </td> <td class="related-desc"> <p>Fires immediately after an object-term relationship is added.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="../hooks/set_object_terms">set_object_terms</a> </td> <td class="related-desc"> <p>Fires after an object’s terms have been set.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="term_exists">term_exists()</a> </td> <td class="related-desc"> <p>Determines whether a taxonomy term exists.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="taxonomy_exists">taxonomy_exists()</a> </td> <td class="related-desc"> <p>Determines whether the taxonomy name exists.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="get_taxonomy">get_taxonomy()</a> </td> <td class="related-desc"> <p>Retrieves the taxonomy object of $taxonomy.</p> </td> </tr> <tr> <td> <span>wp-includes/plugin.php:</span> <a href="do_action">do_action()</a> </td> <td class="related-desc"> <p>Execute functions hooked on a specific action hook.</p> </td> </tr> <tr> <td> <span>wp-includes/wp-db.php:</span> <a href="../classes/wpdb/get_var">wpdb::get_var()</a> </td> <td class="related-desc"> <p>Retrieves one variable from the database.</p> </td> </tr> <tr> <td> <span>wp-includes/wp-db.php:</span> <a href="../classes/wpdb/insert">wpdb::insert()</a> </td> <td class="related-desc"> <p>Inserts a row into the table.</p> </td> </tr> <tr> <td> <span>wp-includes/wp-db.php:</span> <a href="../classes/wpdb/get_col">wpdb::get_col()</a> </td> <td class="related-desc"> <p>Retrieves one column from the database.</p> </td> </tr> <tr> <td> <span>wp-includes/wp-db.php:</span> <a href="../classes/wpdb/query">wpdb::query()</a> </td> <td class="related-desc"> <p>Performs a MySQL database query, using current database connection.</p> </td> </tr> <tr> <td> <span>wp-includes/wp-db.php:</span> <a href="../classes/wpdb/prepare">wpdb::prepare()</a> </td> <td class="related-desc"> <p>Prepares a SQL query for safe execution.</p> </td> </tr> <tr> <td> <span>wp-includes/load.php:</span> <a href="is_wp_error">is_wp_error()</a> </td> <td class="related-desc"> <p>Check whether variable is a WordPress Error.</p> </td> </tr> <tr> <td> <span>wp-includes/class-wp-error.php:</span> <a href="../classes/wp_error/__construct">WP_Error::__construct()</a> </td> <td class="related-desc"> <p>Initialize the error.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <h3 class="toc-heading" id="used-by" tabindex="-1">Used By </h3> <table id="used-by-table">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td> <span>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php:</span> <a href="../classes/wp_rest_posts_controller/handle_terms">WP_REST_Posts_Controller::handle_terms()</a> </td> <td class="related-desc"> <p>Updates the post’s terms from a REST request.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/media.php:</span> <a href="media_upload_form_handler">media_upload_form_handler()</a> </td> <td class="related-desc"> <p>Handles form submissions for the legacy media uploader.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/ajax-actions.php:</span> <a href="wp_ajax_save_attachment_compat">wp_ajax_save_attachment_compat()</a> </td> <td class="related-desc"> <p>Ajax handler for saving backward compatible attachment attributes.</p> </td> </tr> <tr> <td> <span>wp-admin/includes/bookmark.php:</span> <a href="wp_set_link_cats">wp_set_link_cats()</a> </td> <td class="related-desc"> <p>Update link with the specified link categories.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_add_object_terms">wp_add_object_terms()</a> </td> <td class="related-desc"> <p>Add term(s) associated with a given object.</p> </td> </tr> <tr> <td> <span>wp-includes/taxonomy.php:</span> <a href="wp_delete_term">wp_delete_term()</a> </td> <td class="related-desc"> <p>Removes a term from the database.</p> </td> </tr> <tr> <td> <span>wp-includes/post.php:</span> <a href="wp_set_post_terms">wp_set_post_terms()</a> </td> <td class="related-desc"> <p>Set the terms for a post.</p> </td> </tr> <tr> <td> <span>wp-includes/nav-menu.php:</span> <a href="wp_update_nav_menu_item">wp_update_nav_menu_item()</a> </td> <td class="related-desc"> <p>Save the properties of a menu item or create a new one.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section class="changelog"> <h2 class="toc-heading" id="changelog" tabindex="-1">Changelog </h2> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.3.0/" alt="WordPress 2.3.0">2.3.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section>   </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2003–2019 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/wp_set_object_terms" class="_attribution-link">https://developer.wordpress.org/reference/functions/wp_set_object_terms</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

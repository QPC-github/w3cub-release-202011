
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Minitest&#58;&#58;Assertions - Ruby &#47; Minitest - W3cubDocs</title>
  
  <meta name="description" content=" Minitest Assertions. All assertion methods accept a msg which is printed if the assertion fails. ">
  <meta name="keywords" content="module, minitest, assertions, ruby">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/minitest/minitest/assertions.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/minitest.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/minitest/" class="_nav-link" title="" style="margin-left:0;">Ruby / Minitest</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="module-Minitest::Assertions" class="module"> module Minitest::Assertions </h1> <section class="description"> <p>Minitest <a href="assertions">Assertions</a>. All assertion methods accept a <code>msg</code> which is printed if the assertion fails.</p> <p>Protocol: Nearly everything here boils up to <code>assert</code>, which expects to be able to increment an instance accessor named <code>assertions</code>. This is not provided by <a href="assertions">Assertions</a> and must be provided by the thing including <a href="assertions">Assertions</a>. See Minitest::Runnable for an example.</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-diff"> <span class="method-name">diff</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="diff-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 29
def self.diff
  @diff = if (RbConfig::CONFIG["host_os"] =~ /mswin|mingw/ &amp;&amp;
              system("diff.exe", __FILE__, __FILE__)) then
            "diff.exe -u"
          elsif Minitest::Test.maglev? then
            "diff -u"
          elsif system("gdiff", __FILE__, __FILE__)
            "gdiff -u" # solaris and kin suck
          elsif system("diff", __FILE__, __FILE__)
            "diff -u"
          else
            nil
          end unless defined? @diff

  @diff
end</pre> </div> <p>Returns the diff command to use in <a href="assertions#method-i-diff">diff</a>. Tries to intelligently figure out what diff to use.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-diff-3D"> <span class="method-name">diff=</span><span class="method-args">(o)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="diff-3D-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 49
def self.diff= o
  @diff = o
end</pre> </div> <p>Set the diff command to use in <a href="assertions#method-i-diff">diff</a>.</p>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-assert"> <span class="method-name">assert</span><span class="method-args">(test, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 134
def assert test, msg = nil
  self.assertions += 1
  unless test then
    msg ||= "Expected #{mu_pp test} to be truthy."
    msg = msg.call if Proc === msg
    raise Minitest::Assertion, msg
  end
  true
end</pre> </div> <p>Fails unless <code>test</code> is truthy.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_empty"> <span class="method-name">assert_empty</span><span class="method-args">(obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_empty-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 151
def assert_empty obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to be empty" }
  assert_respond_to obj, :empty?
  assert obj.empty?, msg
end</pre> </div> <p>Fails unless <code>obj</code> is empty.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_equal"> <span class="method-name">assert_equal</span><span class="method-args">(exp, act, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_equal-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 172
def assert_equal exp, act, msg = nil
  msg = message(msg, E) { diff exp, act }
  result = assert exp == act, msg

  if nil == exp then
    if Minitest::VERSION =~ /^6/ then
      refute_nil exp, "Use assert_nil if expecting nil."
    else
      where = Minitest.filter_backtrace(caller).first
      where = where.split(/:in /, 2).first # clean up noise

      warn "DEPRECATED: Use assert_nil if expecting nil from #{where}. This will fail in Minitest 6."
    end
  end

  result
end</pre> </div> <p>Fails unless <code>exp == act</code> printing the difference between the two, if possible.</p> <p>If there is no visible difference but the assertion fails, you should suspect that your #== is buggy, or your inspect output is missing crucial details. For nicer structural diffing, set <a href="test#method-c-make_my_diffs_pretty-21">Minitest::Test.make_my_diffs_pretty!</a></p> <p>For floats use assert_in_delta.</p> <p>See also: <a href="assertions#method-c-diff">::diff</a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_in_delta"> <span class="method-name">assert_in_delta</span><span class="method-args">(exp, act, delta = 0.001, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_in_delta-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 196
def assert_in_delta exp, act, delta = 0.001, msg = nil
  n = (exp - act).abs
  msg = message(msg) {
    "Expected |#{exp} - #{act}| (#{n}) to be &lt;= #{delta}"
  }
  assert delta &gt;= n, msg
end</pre> </div> <p>For comparing Floats. Fails unless <code>exp</code> and <code>act</code> are within <code>delta</code> of each other.</p> <pre class="ruby" data-language="ruby">assert_in_delta Math::PI, (22.0 / 7.0), 0.01
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_in_epsilon"> <span class="method-name">assert_in_epsilon</span><span class="method-args">(exp, act, epsilon = 0.001, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_in_epsilon-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 208
def assert_in_epsilon exp, act, epsilon = 0.001, msg = nil
  assert_in_delta exp, act, [exp.abs, act.abs].min * epsilon, msg
end</pre> </div> <p>For comparing Floats. Fails unless <code>exp</code> and <code>act</code> have a relative error less than <code>epsilon</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_includes"> <span class="method-name">assert_includes</span><span class="method-args">(collection, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_includes-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 215
def assert_includes collection, obj, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(collection)} to include #{mu_pp(obj)}"
  }
  assert_respond_to collection, :include?
  assert collection.include?(obj), msg
end</pre> </div> <p>Fails unless <code>collection</code> includes <code>obj</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_instance_of"> <span class="method-name">assert_instance_of</span><span class="method-args">(cls, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_instance_of-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 226
def assert_instance_of cls, obj, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(obj)} to be an instance of #{cls}, not #{obj.class}"
  }

  assert obj.instance_of?(cls), msg
end</pre> </div> <p>Fails unless <code>obj</code> is an instance of <code>cls</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_kind_of"> <span class="method-name">assert_kind_of</span><span class="method-args">(cls, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_kind_of-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 237
def assert_kind_of cls, obj, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(obj)} to be a kind of #{cls}, not #{obj.class}" }

  assert obj.kind_of?(cls), msg
end</pre> </div> <p>Fails unless <code>obj</code> is a kind of <code>cls</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_match"> <span class="method-name">assert_match</span><span class="method-args">(matcher, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_match-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 247
def assert_match matcher, obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp matcher} to match #{mu_pp obj}" }
  assert_respond_to matcher, :"=~"
  matcher = Regexp.new Regexp.escape matcher if String === matcher
  assert matcher =~ obj, msg
end</pre> </div> <p>Fails unless <code>matcher</code> <code>=~</code> <code>obj</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_mock"> <span class="method-name">assert_mock</span><span class="method-args">(mock)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_mock-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/mock.rb, line 184
def assert_mock mock
  assert mock.verify
end</pre> </div> <p>Assert that the mock verifies correctly.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_nil"> <span class="method-name">assert_nil</span><span class="method-args">(obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_nil-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 257
def assert_nil obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to be nil" }
  assert obj.nil?, msg
end</pre> </div> <p>Fails unless <code>obj</code> is nil</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_operator"> <span class="method-name">assert_operator</span><span class="method-args">(o1, op, o2 = UNDEFINED, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_operator-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 267
def assert_operator o1, op, o2 = UNDEFINED, msg = nil
  return assert_predicate o1, op, msg if UNDEFINED == o2
  msg = message(msg) { "Expected #{mu_pp(o1)} to be #{op} #{mu_pp(o2)}" }
  assert o1.__send__(op, o2), msg
end</pre> </div> <p>For testing with binary operators. Eg:</p> <pre class="ruby" data-language="ruby">assert_operator 5, :&lt;=, 4
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_output"> <span class="method-name">assert_output</span><span class="method-args">(stdout = nil, stderr = nil) { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_output-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 285
def assert_output stdout = nil, stderr = nil
  out, err = capture_io do
    yield
  end

  err_msg = Regexp === stderr ? :assert_match : :assert_equal if stderr
  out_msg = Regexp === stdout ? :assert_match : :assert_equal if stdout

  y = send err_msg, stderr, err, "In stderr" if err_msg
  x = send out_msg, stdout, out, "In stdout" if out_msg

  (!stdout || x) &amp;&amp; (!stderr || y)
end</pre> </div> <p>Fails if stdout or stderr do not output the expected results. Pass in nil if you don't care about that streams output. Pass in “” if you require it to be silent. Pass in a regexp if you want to pattern match.</p> <pre class="ruby" data-language="ruby">assert_output(/hey/) { method_with_output }
</pre> <p>NOTE: this uses <a href="assertions#method-i-capture_io">capture_io</a>, not <a href="assertions#method-i-capture_subprocess_io">capture_subprocess_io</a>.</p> <p>See also: <a href="assertions#method-i-assert_silent">assert_silent</a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_predicate"> <span class="method-name">assert_predicate</span><span class="method-args">(o1, op, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_predicate-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 308
def assert_predicate o1, op, msg = nil
  msg = message(msg) { "Expected #{mu_pp(o1)} to be #{op}" }
  assert o1.__send__(op), msg
end</pre> </div> <p>For testing with predicates. Eg:</p> <pre class="ruby" data-language="ruby">assert_predicate str, :empty?
</pre> <p>This is really meant for specs and is front-ended by <a href="assertions#method-i-assert_operator">#assert_operator</a>:</p> <pre class="ruby" data-language="ruby">str.must_be :empty?
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_raises"> <span class="method-name">assert_raises</span><span class="method-args">(*exp) { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_raises-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 321
def assert_raises *exp
  msg = "#{exp.pop}.\n" if String === exp.last
  exp &lt;&lt; StandardError if exp.empty?

  begin
    yield
  rescue *exp =&gt; e
    pass # count assertion
    return e
  rescue Minitest::Skip, Minitest::Assertion
    # don't count assertion
    raise
  rescue SignalException, SystemExit
    raise
  rescue Exception =&gt; e
    flunk proc {
      exception_details(e, "#{msg}#{mu_pp(exp)} exception expected, not")
    }
  end

  exp = exp.first if exp.size == 1

  flunk "#{msg}#{mu_pp(exp)} expected but nothing was raised."
end</pre> </div> <p>Fails unless the block raises one of <code>exp</code>. Returns the exception matched so you can check the message, attributes, etc.</p> <p><code>exp</code> takes an optional message on the end to help explain failures and defaults to StandardError if no exception class is passed.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_respond_to"> <span class="method-name">assert_respond_to</span><span class="method-args">(obj, meth, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_respond_to-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 349
def assert_respond_to obj, meth, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(obj)} (#{obj.class}) to respond to ##{meth}"
  }
  assert obj.respond_to?(meth), msg
end</pre> </div> <p>Fails unless <code>obj</code> responds to <code>meth</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_same"> <span class="method-name">assert_same</span><span class="method-args">(exp, act, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_same-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 359
def assert_same exp, act, msg = nil
  msg = message(msg) {
    data = [mu_pp(act), act.object_id, mu_pp(exp), exp.object_id]
    "Expected %s (oid=%d) to be the same as %s (oid=%d)" % data
  }
  assert exp.equal?(act), msg
end</pre> </div> <p>Fails unless <code>exp</code> and <code>act</code> are equal?</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_send"> <span class="method-name">assert_send</span><span class="method-args">(send_ary, m = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_send-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 372
def assert_send send_ary, m = nil
  where = Minitest.filter_backtrace(caller).first
  where = where.split(/:in /, 2).first # clean up noise
  warn "DEPRECATED: assert_send. From #{where}"

  recv, msg, *args = send_ary
  m = message(m) {
    "Expected #{mu_pp(recv)}.#{msg}(*#{mu_pp(args)}) to return true" }
  assert recv.__send__(msg, *args), m
end</pre> </div> <p><code>send_ary</code> is a receiver, message and arguments.</p> <p>Fails unless the call returns a true value</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_silent"> <span class="method-name">assert_silent</span><span class="method-args">() { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_silent-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 388
def assert_silent
  assert_output "", "" do
    yield
  end
end</pre> </div> <p>Fails if the block outputs anything to stderr or stdout.</p> <p>See also: <a href="assertions#method-i-assert_output">assert_output</a></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-assert_throws"> <span class="method-name">assert_throws</span><span class="method-args">(sym, msg = nil) { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="assert_throws-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 397
def assert_throws sym, msg = nil
  default = "Expected #{mu_pp(sym)} to have been thrown"
  caught = true
  catch(sym) do
    begin
      yield
    rescue ThreadError =&gt; e       # wtf?!? 1.8 + threads == suck
      default += ", not \:#{e.message[/uncaught throw \`(\w+?)\'/, 1]}"
    rescue ArgumentError =&gt; e     # 1.9 exception
      raise e unless e.message.include?("uncaught throw")
      default += ", not #{e.message.split(/ /).last}"
    rescue NameError =&gt; e         # 1.8 exception
      raise e unless e.name == sym
      default += ", not #{e.name.inspect}"
    end
    caught = false
  end

  assert caught, message(msg) { default }
end</pre> </div> <p>Fails unless the block throws <code>sym</code></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-capture_io"> <span class="method-name">capture_io</span><span class="method-args">() { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="capture_io-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 433
def capture_io
  _synchronize do
    begin
      captured_stdout, captured_stderr = StringIO.new, StringIO.new

      orig_stdout, orig_stderr = $stdout, $stderr
      $stdout, $stderr         = captured_stdout, captured_stderr

      yield

      return captured_stdout.string, captured_stderr.string
    ensure
      $stdout = orig_stdout
      $stderr = orig_stderr
    end
  end
end</pre> </div> <p>Captures $stdout and $stderr into strings:</p> <pre class="ruby" data-language="ruby">out, err = capture_io do
  puts "Some info"
  warn "You did a bad thing"
end

assert_match %r%info%, out
assert_match %r%bad%, err
</pre> <p>NOTE: For efficiency, this method uses StringIO and does not capture IO for subprocesses. Use <a href="assertions#method-i-capture_subprocess_io">capture_subprocess_io</a> for that.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-capture_subprocess_io"> <span class="method-name">capture_subprocess_io</span><span class="method-args">() { || ... }</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="capture_subprocess_io-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 466
def capture_subprocess_io
  _synchronize do
    begin
      require "tempfile"

      captured_stdout, captured_stderr = Tempfile.new("out"), Tempfile.new("err")

      orig_stdout, orig_stderr = $stdout.dup, $stderr.dup
      $stdout.reopen captured_stdout
      $stderr.reopen captured_stderr

      yield

      $stdout.rewind
      $stderr.rewind

      return captured_stdout.read, captured_stderr.read
    ensure
      captured_stdout.unlink
      captured_stderr.unlink
      $stdout.reopen orig_stdout
      $stderr.reopen orig_stderr
    end
  end
end</pre> </div> <p>Captures $stdout and $stderr into strings, using Tempfile to ensure that subprocess IO is captured as well.</p> <pre class="ruby" data-language="ruby">out, err = capture_subprocess_io do
  system "echo Some info"
  system "echo You did a bad thing 1&gt;&amp;2"
end

assert_match %r%info%, out
assert_match %r%bad%, err
</pre> <p>NOTE: This method is approximately 10x slower than <a href="assertions#method-i-capture_io">capture_io</a> so only use it when you need to test the output of a subprocess.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-diff"> <span class="method-name">diff</span><span class="method-args">(exp, act)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="diff-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 59
def diff exp, act
  expect = mu_pp_for_diff exp
  butwas = mu_pp_for_diff act
  result = nil

  need_to_diff =
    (expect.include?("\n")    ||
     butwas.include?("\n")    ||
     expect.size &gt; 30         ||
     butwas.size &gt; 30         ||
     expect == butwas)        &amp;&amp;
    Minitest::Assertions.diff

  return "Expected: #{mu_pp exp}\n  Actual: #{mu_pp act}" unless
    need_to_diff

  Tempfile.open("expect") do |a|
    a.puts expect
    a.flush

    Tempfile.open("butwas") do |b|
      b.puts butwas
      b.flush

      result = `#{Minitest::Assertions.diff} #{a.path} #{b.path}`
      result.sub!(/^\-\-\- .+/, "--- expected")
      result.sub!(/^\+\+\+ .+/, "+++ actual")

      if result.empty? then
        klass = exp.class
        result = [
                  "No visible difference in the #{klass}#inspect output.\n",
                  "You should look at the implementation of #== on ",
                  "#{klass} or its members.\n",
                  expect,
                 ].join
      end
    end
  end

  result
end</pre> </div> <p>Returns a diff between <code>exp</code> and <code>act</code>. If there is no known diff command or if it doesn't make sense to diff the output (single line, short output), then it simply returns a basic comparison between the two.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-exception_details"> <span class="method-name">exception_details</span><span class="method-args">(e, msg)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="exception_details-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 495
def exception_details e, msg
  [
   "#{msg}",
   "Class: &lt;#{e.class}&gt;",
   "Message: &lt;#{e.message.inspect}&gt;",
   "---Backtrace---",
   "#{Minitest.filter_backtrace(e.backtrace).join("\n")}",
   "---------------",
  ].join "\n"
end</pre> </div> <p>Returns details for exception <code>e</code></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-flunk"> <span class="method-name">flunk</span><span class="method-args">(msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="flunk-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 509
def flunk msg = nil
  msg ||= "Epic Fail!"
  assert false, msg
end</pre> </div> <p>Fails with <code>msg</code></p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-message"> <span class="method-name">message</span><span class="method-args">(msg = nil, ending = nil, &amp;default)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="message-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 517
def message msg = nil, ending = nil, &amp;default
  proc {
    msg = msg.call.chomp(".") if Proc === msg
    custom_message = "#{msg}.\n" unless msg.nil? or msg.to_s.empty?
    "#{custom_message}#{default.call}#{ending || "."}"
  }
end</pre> </div> <p>Returns a proc that will output <code>msg</code> along with the default message.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mu_pp"> <span class="method-name">mu_pp</span><span class="method-args">(obj)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="mu_pp-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 107
def mu_pp obj
  s = obj.inspect

  if defined? Encoding then
    s = s.encode Encoding.default_external

    if String === obj &amp;&amp; obj.encoding != Encoding.default_external then
      s = "# encoding: #{obj.encoding}\n#{s}"
    end
  end

  s
end</pre> </div> <p>This returns a human-readable version of <code>obj</code>. By default inspect is called. You can override this to use pretty_print if you want.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mu_pp_for_diff"> <span class="method-name">mu_pp_for_diff</span><span class="method-args">(obj)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="mu_pp_for_diff-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 127
def mu_pp_for_diff obj
  mu_pp(obj).gsub(/\\n/, "\n").gsub(/:0x[a-fA-F0-9]{4,}/m, ":0xXXXXXX")
end</pre> </div> <p>This returns a diff-able human-readable version of <code>obj</code>. This differs from the regular <a href="assertions#method-i-mu_pp">#mu_pp</a> because it expands escaped newlines and makes hex-values generic (like object_ids). This uses <a href="assertions#method-i-mu_pp">#mu_pp</a> to do the first pass and then cleans it up.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pass"> <span class="method-name">pass</span><span class="method-args">(_msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="pass-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 528
def pass _msg = nil
  assert true
end</pre> </div> <p>used for counting assertions</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute"> <span class="method-name">refute</span><span class="method-args">(test, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 535
def refute test, msg = nil
  msg ||= message { "Expected #{mu_pp(test)} to not be truthy" }
  not assert !test, msg
end</pre> </div> <p>Fails if <code>test</code> is truthy.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_empty"> <span class="method-name">refute_empty</span><span class="method-args">(obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_empty-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 543
def refute_empty obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to not be empty" }
  assert_respond_to obj, :empty?
  refute obj.empty?, msg
end</pre> </div> <p>Fails if <code>obj</code> is empty.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_equal"> <span class="method-name">refute_equal</span><span class="method-args">(exp, act, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_equal-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 554
def refute_equal exp, act, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(act)} to not be equal to #{mu_pp(exp)}"
  }
  refute exp == act, msg
end</pre> </div> <p>Fails if <code>exp == act</code>.</p> <p>For floats use refute_in_delta.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_in_delta"> <span class="method-name">refute_in_delta</span><span class="method-args">(exp, act, delta = 0.001, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_in_delta-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 566
def refute_in_delta exp, act, delta = 0.001, msg = nil
  n = (exp - act).abs
  msg = message(msg) {
    "Expected |#{exp} - #{act}| (#{n}) to not be &lt;= #{delta}"
  }
  refute delta &gt;= n, msg
end</pre> </div> <p>For comparing Floats. Fails if <code>exp</code> is within <code>delta</code> of <code>act</code>.</p> <pre class="ruby" data-language="ruby">refute_in_delta Math::PI, (22.0 / 7.0)
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_in_epsilon"> <span class="method-name">refute_in_epsilon</span><span class="method-args">(a, b, epsilon = 0.001, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_in_epsilon-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 578
def refute_in_epsilon a, b, epsilon = 0.001, msg = nil
  refute_in_delta a, b, a * epsilon, msg
end</pre> </div> <p>For comparing Floats. Fails if <code>exp</code> and <code>act</code> have a relative error less than <code>epsilon</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_includes"> <span class="method-name">refute_includes</span><span class="method-args">(collection, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_includes-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 585
def refute_includes collection, obj, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(collection)} to not include #{mu_pp(obj)}"
  }
  assert_respond_to collection, :include?
  refute collection.include?(obj), msg
end</pre> </div> <p>Fails if <code>collection</code> includes <code>obj</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_instance_of"> <span class="method-name">refute_instance_of</span><span class="method-args">(cls, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_instance_of-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 596
def refute_instance_of cls, obj, msg = nil
  msg = message(msg) {
    "Expected #{mu_pp(obj)} to not be an instance of #{cls}"
  }
  refute obj.instance_of?(cls), msg
end</pre> </div> <p>Fails if <code>obj</code> is an instance of <code>cls</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_kind_of"> <span class="method-name">refute_kind_of</span><span class="method-args">(cls, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_kind_of-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 606
def refute_kind_of cls, obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to not be a kind of #{cls}" }
  refute obj.kind_of?(cls), msg
end</pre> </div> <p>Fails if <code>obj</code> is a kind of <code>cls</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_match"> <span class="method-name">refute_match</span><span class="method-args">(matcher, obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_match-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 614
def refute_match matcher, obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp matcher} to not match #{mu_pp obj}" }
  assert_respond_to matcher, :"=~"
  matcher = Regexp.new Regexp.escape matcher if String === matcher
  refute matcher =~ obj, msg
end</pre> </div> <p>Fails if <code>matcher</code> <code>=~</code> <code>obj</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_nil"> <span class="method-name">refute_nil</span><span class="method-args">(obj, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_nil-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 624
def refute_nil obj, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to not be nil" }
  refute obj.nil?, msg
end</pre> </div> <p>Fails if <code>obj</code> is nil.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_operator"> <span class="method-name">refute_operator</span><span class="method-args">(o1, op, o2 = UNDEFINED, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_operator-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 635
def refute_operator o1, op, o2 = UNDEFINED, msg = nil
  return refute_predicate o1, op, msg if UNDEFINED == o2
  msg = message(msg) { "Expected #{mu_pp(o1)} to not be #{op} #{mu_pp(o2)}" }
  refute o1.__send__(op, o2), msg
end</pre> </div> <p>Fails if <code>o1</code> is not <code>op</code> <code>o2</code>. Eg:</p> <pre class="ruby" data-language="ruby">refute_operator 1, :&gt;, 2 #=&gt; pass
refute_operator 1, :&lt;, 2 #=&gt; fail
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_predicate"> <span class="method-name">refute_predicate</span><span class="method-args">(o1, op, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_predicate-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 650
def refute_predicate o1, op, msg = nil
  msg = message(msg) { "Expected #{mu_pp(o1)} to not be #{op}" }
  refute o1.__send__(op), msg
end</pre> </div> <p>For testing with predicates.</p> <pre class="ruby" data-language="ruby">refute_predicate str, :empty?
</pre> <p>This is really meant for specs and is front-ended by <a href="assertions#method-i-refute_operator">#refute_operator</a>:</p> <pre class="ruby" data-language="ruby">str.wont_be :empty?
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_respond_to"> <span class="method-name">refute_respond_to</span><span class="method-args">(obj, meth, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_respond_to-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 658
def refute_respond_to obj, meth, msg = nil
  msg = message(msg) { "Expected #{mu_pp(obj)} to not respond to #{meth}" }

  refute obj.respond_to?(meth), msg
end</pre> </div> <p>Fails if <code>obj</code> responds to the message <code>meth</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-refute_same"> <span class="method-name">refute_same</span><span class="method-args">(exp, act, msg = nil)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="refute_same-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 667
def refute_same exp, act, msg = nil
  msg = message(msg) {
    data = [mu_pp(act), act.object_id, mu_pp(exp), exp.object_id]
    "Expected %s (oid=%d) to not be the same as %s (oid=%d)" % data
  }
  refute exp.equal?(act), msg
end</pre> </div> <p>Fails if <code>exp</code> is the same (by object identity) as <code>act</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-skip"> <span class="method-name">skip</span><span class="method-args">(msg = nil, bt = caller)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="skip-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 680
def skip msg = nil, bt = caller
  msg ||= "Skipped, no message given"
  @skip = true
  raise Minitest::Skip, msg, bt
end</pre> </div> <p>Skips the current run. If run in verbose-mode, the skipped run gets listed at the end of the run but doesn't cause a failure exit code.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-skipped-3F"> <span class="method-name">skipped?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="skipped-3F-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/assertions.rb, line 689
def skipped?
  defined?(@skip) and @skip
end</pre> </div> <p>Was this testcase skipped? Meant for teardown.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    © Ryan Davis, seattle.rb<br>Licensed under the MIT License.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

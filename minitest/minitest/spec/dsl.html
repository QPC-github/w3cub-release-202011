
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Minitest&#58;&#58;Spec&#58;&#58;DSL - Ruby &#47; Minitest - W3cubDocs</title>
  
  <meta name="description" content=" Oh look! A Minitest&#58;&#58;Spec&#58;&#58;DSL module! Eat your heart out DHH. ">
  <meta name="keywords" content="module, minitest, spec, dsl, ruby">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/minitest/minitest/spec/dsl.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/minitest.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/minitest/" class="_nav-link" title="" style="margin-left:0;">Ruby / Minitest</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _rdoc">
				
				
<h1 id="module-Minitest::Spec::DSL" class="module"> module Minitest::Spec::DSL </h1> <section class="description"> <p>Oh look! A <a href="dsl">Minitest::Spec::DSL</a> module! Eat your heart out DHH.</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="TYPES">TYPES </dt>
<dd>
<p>Contains pairs of matchers and <a href="../spec">Spec</a> classes to be used to calculate the superclass of a top-level describe. This allows for automatically customizable spec types.</p> <p>See: <a href="dsl#method-i-register_spec_type">#register_spec_type</a> and <a href="dsl#method-i-spec_type">#spec_type</a></p> </dd>
</dl> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-after"> <span class="method-name">after</span><span class="method-args">(_type = nil, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="after-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 198
def after _type = nil, &amp;block
  define_method :teardown do
    self.instance_eval(&amp;block)
    super()
  end
end</pre> </div> <p>Define an 'after' action. Inherits the way normal methods should.</p> <p>NOTE: <code>type</code> is ignored and is only there to make porting easier.</p> <p>Equivalent to <a href="../test/lifecyclehooks#method-i-teardown">Minitest::Test::LifecycleHooks#teardown</a>.</p> <div class="method-calls-super"> Calls superclass method </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-before"> <span class="method-name">before</span><span class="method-args">(_type = nil, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="before-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 184
def before _type = nil, &amp;block
  define_method :setup do
    super()
    self.instance_eval(&amp;block)
  end
end</pre> </div> <p>Define a 'before' action. Inherits the way normal methods should.</p> <p>NOTE: <code>type</code> is ignored and is only there to make porting easier.</p> <p>Equivalent to <a href="../test/lifecyclehooks#method-i-setup">Minitest::Test::LifecycleHooks#setup</a>.</p> <div class="method-calls-super"> Calls superclass method </div>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-it"> <span class="method-name">it</span><span class="method-args">(desc = "anonymous", &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="it-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 216
def it desc = "anonymous", &amp;block
  block ||= proc { skip "(no tests defined)" }

  @specs ||= 0
  @specs += 1

  name = "test_%04d_%s" % [ @specs, desc ]

  undef_klasses = self.children.reject { |c| c.public_method_defined? name }

  define_method name, &amp;block

  undef_klasses.each do |undef_klass|
    undef_klass.send :undef_method, name
  end

  name
end</pre> </div> <p>Define an expectation with name <code>desc</code>. Name gets morphed to a proper test method name. For some freakish reason, people who write specs don't like class inheritance, so this goes way out of its way to make sure that expectations aren't inherited.</p> <p>This is also aliased to <a href="dsl#method-i-specify">specify</a> and doesn't require a <code>desc</code> arg.</p> <p>Hint: If you <em>do</em> want inheritance, use minitest/test. You can mix and match between assertions and expectations as much as you want.</p>  </div> <div class="aliases"> Also aliased as: <a href="dsl#method-i-specify">specify</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-let"> <span class="method-name">let</span><span class="method-args">(name, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="let-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 240
def let name, &amp;block
  name = name.to_s
  pre, post = "let '#{name}' cannot ", ". Please use another name."
  methods = Minitest::Spec.instance_methods.map(&amp;:to_s) - %w[subject]
  raise ArgumentError, "#{pre}begin with 'test'#{post}" if
    name =~ /\Atest/
  raise ArgumentError, "#{pre}override a method in Minitest::Spec#{post}" if
    methods.include? name

  define_method name do
    @_memoized ||= {}
    @_memoized.fetch(name) { |k| @_memoized[k] = instance_eval(&amp;block) }
  end
end</pre> </div> <p>Essentially, define an accessor for <code>name</code> with <code>block</code>.</p> <p>Why use let instead of def? I honestly don't know.</p>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-register_spec_type"> <span class="method-name">register_spec_type</span><span class="method-args">(*args, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="register_spec_type-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 139
def register_spec_type *args, &amp;block
  if block then
    matcher, klass = block, args.first
  else
    matcher, klass = *args
  end
  TYPES.unshift [matcher, klass]
end</pre> </div> <p>Register a new type of spec that matches the spec's description. This method can take either a Regexp and a spec class or a spec class and a block that takes the description and returns true if it matches.</p> <p>Eg:</p> <pre class="ruby" data-language="ruby">register_spec_type(/Controller$/, Minitest::Spec::Rails)
</pre> <p>or:</p> <pre class="ruby" data-language="ruby">register_spec_type(Minitest::Spec::RailsModel) do |desc|
  desc.superclass == ActiveRecord::Base
end
</pre>  </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-spec_type"> <span class="method-name">spec_type</span><span class="method-args">(desc, *additional)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="spec_type-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 153
def spec_type desc, *additional
  TYPES.find { |matcher, _klass|
    if matcher.respond_to? :call then
      matcher.call desc, *additional
    else
      matcher === desc.to_s
    end
  }.last
end</pre> </div> <p>Figure out the spec class to use based on a spec's description. Eg:</p> <pre class="ruby" data-language="ruby">spec_type("BlahController") # =&gt; Minitest::Spec::Rails
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-specify"> <span class="method-name">specify</span><span class="method-args">(desc = "anonymous", &amp;block)</span> </div>  <div class="aliases"> Alias for: <a href="dsl#method-i-it">it</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-subject"> <span class="method-name">subject</span><span class="method-args">(&amp;block)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description">
<div class="method-source-code" id="subject-source"> <pre class="ruby" data-language="ruby"># File lib/minitest/spec.rb, line 259
def subject &amp;block
  let :subject, &amp;block
end</pre> </div> <p>Another lazy man's accessor generator. Made even more lazy by setting the name for you to <code>subject</code>.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    © Ryan Davis, seattle.rb<br>Licensed under the MIT License.<br>
    
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

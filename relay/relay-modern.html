
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Introduction to Relay Modern - Relay - W3cubDocs</title>
  
  <meta name="description" content="Relay Modern is a new version of Relay designed from the ground up to be easier to use, more extensible and, most of all, able to improve &hellip;">
  <meta name="keywords" content="introduction, relay, modern">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/relay/relay-modern.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/relay.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/relay/" class="_nav-link" title="" style="margin-left:0;">Relay</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _simple">
				
				
<h1>Introduction to Relay Modern</h1>
<p>Relay Modern is a new version of Relay designed from the ground up to be easier to use, more extensible and, most of all, able to improve performance on mobile devices. Relay Modern accomplishes this with static queries and ahead-of-time code generation.</p>
<h2 id="getting-started">
Getting Started </h2>
<h3 id="upgrade-to-react-relay-v1-0-0">
Upgrade to react-relay v1.0.0 </h3>
<p>Relay v1.0 introduces the Relay Modern API:</p>
<pre class="prism language-javascript" data-language="javascript">
yarn add react-relay</pre>
<p>When upgrading an existing Relay app, replace all <code>require('react-relay')</code> with <code>require('react-relay/classic')</code> to continue to import the Relay Classic API.</p>
<h3 id="set-up-babel-plugin-relay">
Set up babel-plugin-relay </h3>
<p>Relay Modern requires a Babel plugin to convert GraphQL to runtime artifacts:</p>
<pre class="prism language-javascript" data-language="javascript">
yarn add --dev babel-plugin-relay</pre>
<p>Add <code>"relay"</code> to the list of plugins your .babelrc file. See <a href="babel-plugin-relay">the docs</a> if upgrading an existing Relay app.</p>
<h3 id="set-up-relay-compiler">
Set up relay-compiler </h3>
<p>Relay Modern's ahead-of-time compilation requires the new Relay Compiler:</p>
<pre class="prism language-javascript" data-language="javascript">
yarn add --dev relay-compiler</pre>
<p>Run the Relay Compiler after making changes to any GraphQL in your Relay application. It may be helpful to add it as a <code>yarn script</code>. Add an entry to <code>"scripts"</code> in your package.json file.</p>
<pre class="prism language-javascript" data-language="javascript">
"relay": "relay-compiler --src ./src --schema path/schema.graphql"</pre>
<p>Then after making edits to your application files, just run <code>yarn run relay</code> to generate new files, or <code>yarn run relay -- --watch</code> to run the compiler as a long-lived process which automatically generates new files whenever you save.</p>
<h2 id="javascript-environment-requirements">
JavaScript environment requirements </h2>
<p>The Relay Modern packages distributed on NPM use the widely-supported ES5 version of JavaScript to support as many browser environments as possible.</p>
<p>However, Relay Modern expects modern JavaScript global types (<code>Map</code>, <code>Set</code>, <code>Promise</code>, <code>Object.assign</code>) to be defined. If you support older browsers and devices which may not yet provide these natively, consider including a global polyfill in your bundled application, such as <a href="https://github.com/zloirock/core-js">core-js</a> or <a href="https://babeljs.io/docs/usage/polyfill/">babel-polyfill</a>.</p>
<p>A polyfilled environment for Relay using <a href="https://github.com/zloirock/core-js">core-js</a> to support older browsers might look like:</p>
<pre class="prism language-javascript" data-language="javascript">
require('core-js/es6/map');
require('core-js/es6/set');
require('core-js/es6/promise');
require('core-js/es6/object');

require('./myRelayApplication');</pre>
<h2 id="migrating-to-relay-modern">
Migrating to Relay Modern </h2>
<p>Migrating a Relay Classic app to Relay Modern doesn't require rewriting from scratch. Instead, you can convert one component at a time to the Relay Modern API while continuing to have a working app. Once all components have been converted, the smaller and faster Relay Modern runtime can be used.</p>
<p>During this migration, use the <a href="relay-compat">Relay Compat</a> tools and APIs to work with both Relay Classic and Relay Modern.</p>
<h2 id="idea">
Idea </h2>
<p><a href="https://facebook.github.io/react/">React</a> allows views to be defined as components where every component is responsible for rendering a part of the UI. Composing other components is how to build complex UIs. Each React component doesn't need to know the inner workings of the composed components.</p>
<p>Relay couples React with GraphQL and develops the idea of encapsulation further. It allows components to specify what data they need and the Relay framework provides the data. This makes the data needs of inner components opaque and allows composition of those needs. Thinking about what data an app needs becomes localized to the component making it easier to reason about what fields are needed or no longer needed.</p>
<h2 id="terminology">
Terminology </h2>
<h3 id="container">
Container </h3>
<p>Relay Modern containers combine standard React components with a description of their data requirements, expressed as one or more GraphQL fragments. Each container is itself a standard React component that can be rendered using the standard React API (e.g. <code>&lt;YourComponent prop={...} /&gt;</code>). When rendered, a container will read the data for its fragment from the Relay cache. As the fragment data changes - for example due to a mutation, subscription, or updated query response - the container will automatically re-render the component.</p>
<p><a href="fragment-container"><code>createFragmentContainer</code></a> returns a basic container that cannot fetch additional data beyond what is declared in its fragment(s). Relay Modern also provides more advanced containers for dynamic use cases (which were previously handled in Relay Classic via <code>setVariables</code>):</p>
<h4 id="container-refetching-data-aka-see-more">
Refetching Data (aka "See More") </h4>
<p><a href="refetch-container"><code>createRefetchContainer</code></a> is a variation of <code>createFragmentContainer</code> that addresses the "see more" use case, where a subset of data is rendered initially and then additional data is fetched on demand. Refetch containers initially fetch data for their fragments just like fragment containers, but also offer a <code>refetch()</code> method by which additional data can be fetched, or the container can be re-rendered to read data using different variables.</p>
<h3 id="pagination-container">
Pagination Container </h3>
<p>This is a specialization of the general-purpose refetch container that is tailored for the common scenario of paginating through a collection of items by fetching successively more pages of data. See <a href="pagination-container"><code>createPaginationContainer</code></a> for details.</p>
<h3 id="query-renderer">
Query Renderer </h3>
<p><a href="query-renderer"><code>QueryRenderer</code></a> manages the execution of the GraphQL query. It sends the query with given variables, parses the response, saves the data to the internal cache, and finally renders the view.</p>
<h3 id="relay-environment">
Relay Environment </h3>
<p>An instance of a <a href="relay-environment">Relay Environment</a> encapsulates an in-memory cache of GraphQL data and a network layer that provides access to your GraphQL server. The Environment object is typically not used by developers directly, instead it is passed to each <a href="query-renderer"><code>QueryRenderer</code></a>, which uses the environment to access, modify, and fetch data. Within a container, the current environment can be accessed via <code>this.props.relay.environment</code>. This is most commonly used to <a href="mutations">execute a mutation</a>.</p>
<h3 id="network-layer">
Network layer </h3>
<p>Applications must supply a <a href="network-layer">Network Layer</a> when creating an instance of a Relay Environment. The network layer is an object conforming to a simple interface through which Relay can execute queries, mutations, and subscriptions. Essentially, this object teaches Relay how to talk to your GraphQL server.</p>
<h2 id="workflow">
Workflow </h2>
<p>One of the big ideas behind the new API is that execution can be made a lot more efficient by moving work ahead-of-time: from the runtime of the app to the build-time. As such, changes to GraphQL fragments require a build step to regenerate a set of artifacts. More on <a href="relay-compiler">the Relay Compiler</a>.</p>
<h2 id="comparing-relay-classic-and-relay-modern">
Comparing Relay Classic and Relay Modern </h2>
<p>Relay Modern enables a variety of new features. Some are available via the Compat API, while others require upgrading fully to the Modern runtime. See <a href="new-in-relay-modern">what's new in Relay Modern</a> for more details.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2013–present Facebook Inc.<br>Licensed under the BSD License.<br>
    <a href="https://facebook.github.io/relay/docs/relay-modern.html" class="_attribution-link">https://facebook.github.io/relay/docs/relay-modern.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

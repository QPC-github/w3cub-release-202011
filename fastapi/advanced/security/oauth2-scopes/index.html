
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>OAuth2 Scopes - FastAPI - W3cubDocs</title>
  
  <meta name="description" content=" You can use OAuth2 scopes directly with FastAPI, they are integrated to work seamlessly. ">
  <meta name="keywords" content="oauth, scopes, fastapi">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/fastapi/advanced/security/oauth2-scopes/">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-f16eecbe420d8b2925d31ffbb21d05646497ecbd9515f08ffe69e9bba7332f5657accc7003c7f6c72cb4a132171acf171b359ae3bae4ae5660ddfb1718f88c67.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/fastapi.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/fastapi/" class="_nav-link" title="" style="margin-left:0;">FastAPI</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _fastapi">
				
				
<h1 id="oauth2-scopes">OAuth2 scopes</h1> <p>You can use OAuth2 scopes directly with <strong>FastAPI</strong>, they are integrated to work seamlessly.</p> <p>This would allow you to have a more fine-grained permission system, following the OAuth2 standard, integrated into your OpenAPI application (and the API docs).</p> <p>OAuth2 with scopes is the mechanism used by many big authentication providers, like Facebook, Google, GitHub, Microsoft, Twitter, etc. They use it to provide specific permissions to users and applications.</p> <p>Every time you "log in with" Facebook, Google, GitHub, Microsoft, Twitter, that application is using OAuth2 with scopes.</p> <p>In this section you will see how to manage authentication and authorization with the same OAuth2 with scopes in your <strong>FastAPI</strong> application.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>This is a more or less advanced section. If you are just starting, you can skip it.</p> <p>You don't necessarily need OAuth2 scopes, and you can handle authentication and authorization however you want.</p> <p>But OAuth2 with scopes can be nicely integrated into your API (with OpenAPI) and your API docs.</p> <p>Nevertheless, you still enforce those scopes, or any other security/authorization requirement, however you need, in your code.</p> <p>In many cases, OAuth2 with scopes can be an overkill.</p> <p>But if you know you need it, or you are curious, keep reading.</p> </div> <h2 id="oauth2-scopes-and-openapi">OAuth2 scopes and OpenAPI</h2> <p>The OAuth2 specification defines "scopes" as a list of strings separated by spaces.</p> <p>The content of each of these strings can have any format, but should not contain spaces.</p> <p>These scopes represent "permissions".</p> <p>In OpenAPI (e.g. the API docs), you can define "security schemes".</p> <p>When one of these security schemes uses OAuth2, you can also declare and use scopes.</p> <p>Each "scope" is just a string (without spaces).</p> <p>They are normally used to declare specific security permissions, for example:</p> <ul> <li>
<code>users:read</code> or <code>users:write</code> are common examples.</li> <li>
<code>instagram_basic</code> is used by Facebook / Instagram.</li> <li>
<code>https://www.googleapis.com/auth/drive</code> is used by Google.</li> </ul> <div class="admonition info"> <p class="admonition-title">Info</p> <p>In OAuth2 a "scope" is just a string that declares a specific permission required.</p> <p>It doesn't matter if it has other characters like <code>:</code> or if it is a URL.</p> <p>Those details are implementation specific.</p> <p>For OAuth2 they are just strings.</p> </div> <h2 id="global-view">Global view</h2> <p>First, let's quickly see the parts that change from the examples in the main <strong>Tutorial - User Guide</strong> for <a class="internal-link" href="../../../tutorial/security/oauth2-jwt/index" target="_blank">OAuth2 with Password (and hashing), Bearer with JWT tokens</a>. Now using OAuth2 scopes:</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <p>Now let's review those changes step by step.</p> <h2 id="oauth2-security-scheme">OAuth2 Security scheme</h2> <p>The first change is that now we are declaring the OAuth2 security scheme with two available scopes, <code>me</code> and <code>items</code>.</p> <p>The <code>scopes</code> parameter receives a <code>dict</code> with each scope as a key and the description as the value:</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <p>Because we are now declaring those scopes, they will show up in the API docs when you log-in/authorize.</p> <p>And you will be able to select which scopes you want to give access to: <code>me</code> and <code>items</code>.</p> <p>This is the same mechanism used when you give permissions while logging in with Facebook, Google, GitHub, etc:</p> <p><img src="data:image/png;base64,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"></p> <h2 id="jwt-token-with-scopes">JWT token with scopes</h2> <p>Now, modify the token <em>path operation</em> to return the scopes requested.</p> <p>We are still using the same <code>OAuth2PasswordRequestForm</code>. It includes a property <code>scopes</code> with a <code>list</code> of <code>str</code>, with each scope it received in the request.</p> <p>And we return the scopes as part of the JWT token.</p> <div class="admonition danger"> <p class="admonition-title">Danger</p> <p>For simplicity, here we are just adding the scopes received directly to the token.</p> <p>But in your application, for security, you should make sure you only add the scopes that the user is actually able to have, or the ones you have predefined.</p> </div> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <h2 id="declare-scopes-in-path-operations-and-dependencies">Declare scopes in <em>path operations</em> and dependencies</h2> <p>Now we declare that the <em>path operation</em> for <code>/users/me/items/</code> requires the scope <code>items</code>.</p> <p>For this, we import and use <code>Security</code> from <code>fastapi</code>.</p> <p>You can use <code>Security</code> to declare dependencies (just like <code>Depends</code>), but <code>Security</code> also receives a parameter <code>scopes</code> with a list of scopes (strings).</p> <p>In this case, we pass a dependency function <code>get_current_active_user</code> to <code>Security</code> (the same way we would do with <code>Depends</code>).</p> <p>But we also pass a <code>list</code> of scopes, in this case with just one scope: <code>items</code> (it could have more).</p> <p>And the dependency function <code>get_current_active_user</code> can also declare sub-dependencies, not only with <code>Depends</code> but also with <code>Security</code>. Declaring its own sub-dependency function (<code>get_current_user</code>), and more scope requirements.</p> <p>In this case, it requires the scope <code>me</code> (it could require more than one scope).</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You don't necessarily need to add different scopes in different places.</p> <p>We are doing it here to demonstrate how <strong>FastAPI</strong> handles scopes declared at different levels.</p> </div> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <div class="admonition info"> <p class="admonition-title">Technical Details</p> <p><code>Security</code> is actually a subclass of <code>Depends</code>, and it has just one extra parameter that we'll see later.</p> <p>But by using <code>Security</code> instead of <code>Depends</code>, <strong>FastAPI</strong> will know that it can declare security scopes, use them internally, and document the API with OpenAPI.</p> <p>But when you import <code>Query</code>, <code>Path</code>, <code>Depends</code>, <code>Security</code> and others from <code>fastapi</code>, those are actually functions that return special classes.</p> </div> <h2 id="use-securityscopes">Use <code>SecurityScopes</code>
</h2> <p>Now update the dependency <code>get_current_user</code>.</p> <p>This is the one used by the dependencies above.</p> <p>Here's were we are using the same OAuth2 scheme we created before, declaring it as a dependency: <code>oauth2_scheme</code>.</p> <p>Because this dependency function doesn't have any scope requirements itself, we can use <code>Depends</code> with <code>oauth2_scheme</code>, we don't have to use <code>Security</code> when we don't need to specify security scopes.</p> <p>We also declare a special parameter of type <code>SecurityScopes</code>, imported from <code>fastapi.security</code>.</p> <p>This <code>SecurityScopes</code> class is similar to <code>Request</code> (<code>Request</code> was used to get the request object directly).</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <h2 id="use-the-scopes">Use the <code>scopes</code>
</h2> <p>The parameter <code>security_scopes</code> will be of type <code>SecurityScopes</code>.</p> <p>It will have a property <code>scopes</code> with a list containing all the scopes required by itself and all the dependencies that use this as a sub-dependency. That means, all the "dependants"... this might sound confusing, it is explained again later below.</p> <p>The <code>security_scopes</code> object (of class <code>SecurityScopes</code>) also provides a <code>scope_str</code> attribute with a single string, containing those scopes separated by spaces (we are going to use it).</p> <p>We create an <code>HTTPException</code> that we can re-use (<code>raise</code>) later at several points.</p> <p>In this exception, we include the scopes required (if any) as a string separated by spaces (using <code>scope_str</code>). We put that string containing the scopes in the <code>WWW-Authenticate</code> header (this is part of the spec).</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <h2 id="verify-the-username-and-data-shape">Verify the <code>username</code> and data shape</h2> <p>We verify that we get a <code>username</code>, and extract the scopes.</p> <p>And then we validate that data with the Pydantic model (catching the <code>ValidationError</code> exception), and if we get an error reading the JWT token or validating the data with Pydantic, we raise the <code>HTTPException</code> we created before.</p> <p>For that, we update the Pydantic model <code>TokenData</code> with a new property <code>scopes</code>.</p> <p>By validating the data with Pydantic we can make sure that we have, for example, exactly a <code>list</code> of <code>str</code> with the scopes and a <code>str</code> with the <code>username</code>.</p> <p>Instead of, for example, a <code>dict</code>, or something else, as it could break the application at some point later, making it a security risk.</p> <p>We also verify that we have a user with that username, and if not, we raise that same exception we created before.</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <h2 id="verify-the-scopes">Verify the <code>scopes</code>
</h2> <p>We now verify that all the scopes required, by this dependency and all the dependants (including <em>path operations</em>), are included in the scopes provided in the token received, otherwise raise an <code>HTTPException</code>.</p> <p>For this, we use <code>security_scopes.scopes</code>, that contains a <code>list</code> with all these scopes as <code>str</code>.</p> <div class="highlight"><pre class="language-python" data-language="python">from datetime import datetime, timedelta
from typing import List, Union

from fastapi import Depends, FastAPI, HTTPException, Security, status
from fastapi.security import (
    OAuth2PasswordBearer,
    OAuth2PasswordRequestForm,
    SecurityScopes,
)
from jose import JWTError, jwt
from passlib.context import CryptContext
from pydantic import BaseModel, ValidationError

# to get a string like this run:
# openssl rand -hex 32
SECRET_KEY = "09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30


fake_users_db = {
    "johndoe": {
        "username": "johndoe",
        "full_name": "John Doe",
        "email": "johndoe@example.com",
        "hashed_password": "$2b$12$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36WQoeG6Lruj3vjPGga31lW",
        "disabled": False,
    },
    "alice": {
        "username": "alice",
        "full_name": "Alice Chains",
        "email": "alicechains@example.com",
        "hashed_password": "$2b$12$gSvqqUPvlXP2tfVFaWK1Be7DlH.PKZbv5H8KnzzVgXXbVxpva.pFm",
        "disabled": True,
    },
}


class Token(BaseModel):
    access_token: str
    token_type: str


class TokenData(BaseModel):
    username: Union[str, None] = None
    scopes: List[str] = []


class User(BaseModel):
    username: str
    email: Union[str, None] = None
    full_name: Union[str, None] = None
    disabled: Union[bool, None] = None


class UserInDB(User):
    hashed_password: str


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

oauth2_scheme = OAuth2PasswordBearer(
    tokenUrl="token",
    scopes={"me": "Read information about the current user.", "items": "Read items."},
)

app = FastAPI()


def verify_password(plain_password, hashed_password):
    return pwd_context.verify(plain_password, hashed_password)


def get_password_hash(password):
    return pwd_context.hash(password)


def get_user(db, username: str):
    if username in db:
        user_dict = db[username]
        return UserInDB(**user_dict)


def authenticate_user(fake_db, username: str, password: str):
    user = get_user(fake_db, username)
    if not user:
        return False
    if not verify_password(password, user.hashed_password):
        return False
    return user


def create_access_token(data: dict, expires_delta: Union[timedelta, None] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt


async def get_current_user(
    security_scopes: SecurityScopes, token: str = Depends(oauth2_scheme)
):
    if security_scopes.scopes:
        authenticate_value = f'Bearer scope="{security_scopes.scope_str}"'
    else:
        authenticate_value = f"Bearer"
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": authenticate_value},
    )
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: str = payload.get("sub")
        if username is None:
            raise credentials_exception
        token_scopes = payload.get("scopes", [])
        token_data = TokenData(scopes=token_scopes, username=username)
    except (JWTError, ValidationError):
        raise credentials_exception
    user = get_user(fake_users_db, username=token_data.username)
    if user is None:
        raise credentials_exception
    for scope in security_scopes.scopes:
        if scope not in token_data.scopes:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Not enough permissions",
                headers={"WWW-Authenticate": authenticate_value},
            )
    return user


async def get_current_active_user(
    current_user: User = Security(get_current_user, scopes=["me"])
):
    if current_user.disabled:
        raise HTTPException(status_code=400, detail="Inactive user")
    return current_user


@app.post("/token", response_model=Token)
async def login_for_access_token(form_data: OAuth2PasswordRequestForm = Depends()):
    user = authenticate_user(fake_users_db, form_data.username, form_data.password)
    if not user:
        raise HTTPException(status_code=400, detail="Incorrect username or password")
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.username, "scopes": form_data.scopes},
        expires_delta=access_token_expires,
    )
    return {"access_token": access_token, "token_type": "bearer"}


@app.get("/users/me/", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_active_user)):
    return current_user


@app.get("/users/me/items/")
async def read_own_items(
    current_user: User = Security(get_current_active_user, scopes=["items"])
):
    return [{"item_id": "Foo", "owner": current_user.username}]


@app.get("/status/")
async def read_system_status(current_user: User = Depends(get_current_user)):
    return {"status": "ok"}
</pre></div> <h2 id="dependency-tree-and-scopes">Dependency tree and scopes</h2> <p>Let's review again this dependency tree and the scopes.</p> <p>As the <code>get_current_active_user</code> dependency has as a sub-dependency on <code>get_current_user</code>, the scope <code>"me"</code> declared at <code>get_current_active_user</code> will be included in the list of required scopes in the <code>security_scopes.scopes</code> passed to <code>get_current_user</code>.</p> <p>The <em>path operation</em> itself also declares a scope, <code>"items"</code>, so this will also be in the list of <code>security_scopes.scopes</code> passed to <code>get_current_user</code>.</p> <p>Here's how the hierarchy of dependencies and scopes looks like:</p> <ul> <li>The <em>path operation</em> <code>read_own_items</code> has:<ul> <li>Required scopes <code>["items"]</code> with the dependency:</li> <li>
<code>get_current_active_user</code>:<ul> <li>The dependency function <code>get_current_active_user</code> has:<ul> <li>Required scopes <code>["me"]</code> with the dependency:</li> <li>
<code>get_current_user</code>:<ul> <li>The dependency function <code>get_current_user</code> has:<ul> <li>No scopes required by itself.</li> <li>A dependency using <code>oauth2_scheme</code>.</li> <li>A <code>security_scopes</code> parameter of type <code>SecurityScopes</code>:<ul> <li>This <code>security_scopes</code> parameter has a property <code>scopes</code> with a <code>list</code> containing all these scopes declared above, so:<ul> <li>
<code>security_scopes.scopes</code> will contain <code>["me", "items"]</code> for the <em>path operation</em> <code>read_own_items</code>.</li> <li>
<code>security_scopes.scopes</code> will contain <code>["me"]</code> for the <em>path operation</em> <code>read_users_me</code>, because it is declared in the dependency <code>get_current_active_user</code>.</li> <li>
<code>security_scopes.scopes</code> will contain <code>[]</code> (nothing) for the <em>path operation</em> <code>read_system_status</code>, because it didn't declare any <code>Security</code> with <code>scopes</code>, and its dependency, <code>get_current_user</code>, doesn't declare any <code>scope</code> either.</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>The important and "magic" thing here is that <code>get_current_user</code> will have a different list of <code>scopes</code> to check for each <em>path operation</em>.</p> <p>All depending on the <code>scopes</code> declared in each <em>path operation</em> and each dependency in the dependency tree for that specific <em>path operation</em>.</p> </div> <h2 id="more-details-about-securityscopes">More details about <code>SecurityScopes</code>
</h2> <p>You can use <code>SecurityScopes</code> at any point, and in multiple places, it doesn't have to be at the "root" dependency.</p> <p>It will always have the security scopes declared in the current <code>Security</code> dependencies and all the dependants for <strong>that specific</strong> <em>path operation</em> and <strong>that specific</strong> dependency tree.</p> <p>Because the <code>SecurityScopes</code> will have all the scopes declared by dependants, you can use it to verify that a token has the required scopes in a central dependency function, and then declare different scope requirements in different <em>path operations</em>.</p> <p>They will be checked independently for each <em>path operation</em>.</p> <h2 id="check-it">Check it</h2> <p>If you open the API docs, you can authenticate and specify which scopes you want to authorize.</p> <p><img src="data:image/png;base64,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"></p> <p>If you don't select any scope, you will be "authenticated", but when you try to access <code>/users/me/</code> or <code>/users/me/items/</code> you will get an error saying that you don't have enough permissions. You will still be able to access <code>/status/</code>.</p> <p>And if you select the scope <code>me</code> but not the scope <code>items</code>, you will be able to access <code>/users/me/</code> but not <code>/users/me/items/</code>.</p> <p>That's what would happen to a third party application that tried to access one of these <em>path operations</em> with a token provided by a user, depending on how many permissions the user gave the application.</p> <h2 id="about-third-party-integrations">About third party integrations</h2> <p>In this example we are using the OAuth2 "password" flow.</p> <p>This is appropriate when we are logging in to our own application, probably with our own frontend.</p> <p>Because we can trust it to receive the <code>username</code> and <code>password</code>, as we control it.</p> <p>But if you are building an OAuth2 application that others would connect to (i.e., if you are building an authentication provider equivalent to Facebook, Google, GitHub, etc.) you should use one of the other flows.</p> <p>The most common is the implicit flow.</p> <p>The most secure is the code flow, but is more complex to implement as it requires more steps. As it is more complex, many providers end up suggesting the implicit flow.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>It's common that each authentication provider names their flows in a different way, to make it part of their brand.</p> <p>But in the end, they are implementing the same OAuth2 standard.</p> </div> <p><strong>FastAPI</strong> includes utilities for all these OAuth2 authentication flows in <code>fastapi.security.oauth2</code>.</p> <h2 id="security-in-decorator-dependencies">
<code>Security</code> in decorator <code>dependencies</code>
</h2> <p>The same way you can define a <code>list</code> of <code>Depends</code> in the decorator's <code>dependencies</code> parameter (as explained in <a class="internal-link" href="../../../tutorial/dependencies/dependencies-in-path-operation-decorators/index" target="_blank">Dependencies in path operation decorators</a>), you could also use <code>Security</code> with <code>scopes</code> there.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2018 Sebastián Ramírez<br>Licensed under the MIT License.<br>
    <a href="https://fastapi.tiangolo.com/advanced/security/oauth2-scopes/" class="_attribution-link">https://fastapi.tiangolo.com/advanced/security/oauth2-scopes/</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

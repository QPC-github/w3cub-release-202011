
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Imputil - Python 2.7 - W3cubDocs</title>
  
  <meta name="description" content=" Deprecated since version 2.6&#58; The imputil module has been removed in Python 3. ">
  <meta name="keywords" content="imputil, —, import, utilities, python, python~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/python~2.7/library/imputil.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/python~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/python~2.7/" class="_nav-link" title="" style="margin-left:0;">Python 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _python">
				
				
<h1 id="imputil-import-utilities"> imputil — Import utilities</h1> <div class="deprecated" id="module-imputil"> <p><span class="versionmodified deprecated">Deprecated since version 2.6: </span>The <a class="reference internal" href="#module-imputil" title="imputil: Manage and augment the import process. (deprecated)"><code>imputil</code></a> module has been removed in Python 3.</p> </div> <p id="index-0">This module provides a very handy and useful mechanism for custom <a class="reference internal" href="https://docs.python.org/2.7/reference/simple_stmts.html#import"><code>import</code></a> hooks. Compared to the older <code>ihooks</code> module, <a class="reference internal" href="#module-imputil" title="imputil: Manage and augment the import process. (deprecated)"><code>imputil</code></a> takes a dramatically simpler and more straight-forward approach to custom <a class="reference internal" href="https://docs.python.org/2.7/reference/simple_stmts.html#import"><code>import</code></a> functions.</p> <dl class="class"> <dt id="imputil.ImportManager">
<code>class imputil.ImportManager([fs_imp])</code> </dt> <dd>
<p>Manage the import process.</p> <dl class="method"> <dt id="imputil.ImportManager.install">
<code>install([namespace])</code> </dt> <dd>
<p>Install this ImportManager into the specified namespace.</p> </dd>
</dl> <dl class="method"> <dt id="imputil.ImportManager.uninstall">
<code>uninstall()</code> </dt> <dd>
<p>Restore the previous import mechanism.</p> </dd>
</dl> <dl class="method"> <dt id="imputil.ImportManager.add_suffix">
<code>add_suffix(suffix, importFunc)</code> </dt> <dd>
<p>Undocumented.</p> </dd>
</dl> </dd>
</dl> <dl class="class"> <dt id="imputil.Importer">
<code>class imputil.Importer</code> </dt> <dd>
<p>Base class for replacing standard import functions.</p> <dl class="method"> <dt id="imputil.Importer.import_top">
<code>import_top(name)</code> </dt> <dd>
<p>Import a top-level module.</p> </dd>
</dl> <dl class="method"> <dt id="imputil.Importer.get_code">
<code>get_code(parent, modname, fqname)</code> </dt> <dd>
<p>Find and retrieve the code for the given module.</p> <p><em>parent</em> specifies a parent module to define a context for importing. It may be <code>None</code>, indicating no particular context for the search.</p> <p><em>modname</em> specifies a single module (not dotted) within the parent.</p> <p><em>fqname</em> specifies the fully-qualified module name. This is a (potentially) dotted name from the “root” of the module namespace down to the modname.</p> <p>If there is no parent, then modname==fqname.</p> <p>This method should return <code>None</code>, or a 3-tuple.</p>  <ul class="simple"> <li>If the module was not found, then <code>None</code> should be returned.</li> <li>The first item of the 2- or 3-tuple should be the integer 0 or 1, specifying whether the module that was found is a package or not.</li> <li>The second item is the code object for the module (it will be executed within the new module’s namespace). This item can also be a fully-loaded module object (e.g. loaded from a shared lib).</li> <li>The third item is a dictionary of name/value pairs that will be inserted into new module before the code object is executed. This is provided in case the module’s code expects certain values (such as where the module was found). When the second item is a module object, then these names/values will be inserted <em>after</em> the module has been loaded/initialized.</li> </ul>  </dd>
</dl> </dd>
</dl> <dl class="class"> <dt id="imputil.BuiltinImporter">
<code>class imputil.BuiltinImporter</code> </dt> <dd>
<p>Emulate the import mechanism for built-in and frozen modules. This is a sub-class of the <a class="reference internal" href="#imputil.Importer" title="imputil.Importer"><code>Importer</code></a> class.</p> <dl class="method"> <dt id="imputil.BuiltinImporter.get_code">
<code>get_code(parent, modname, fqname)</code> </dt> <dd>
<p>Undocumented.</p> </dd>
</dl> </dd>
</dl> <dl class="function"> <dt id="imputil.py_suffix_importer">
<code>imputil.py_suffix_importer(filename, finfo, fqname)</code> </dt> <dd>
<p>Undocumented.</p> </dd>
</dl> <dl class="class"> <dt id="imputil.DynLoadSuffixImporter">
<code>class imputil.DynLoadSuffixImporter([desc])</code> </dt> <dd>
<p>Undocumented.</p> <dl class="method"> <dt id="imputil.DynLoadSuffixImporter.import_file">
<code>import_file(filename, finfo, fqname)</code> </dt> <dd>
<p>Undocumented.</p> </dd>
</dl> </dd>
</dl>  <h2 id="examples-imputil">1. Examples</h2> <p id="examples">This is a re-implementation of hierarchical module import.</p> <p>This code is intended to be read, not executed. However, it does work – all you need to do to enable it is “import knee”.</p> <p>(The name is a pun on the clunkier predecessor of this module, “ni”.)</p> <pre data-language="python">import sys, imp, __builtin__

# Replacement for __import__()
def import_hook(name, globals=None, locals=None, fromlist=None):
    parent = determine_parent(globals)
    q, tail = find_head_package(parent, name)
    m = load_tail(q, tail)
    if not fromlist:
        return q
    if hasattr(m, "__path__"):
        ensure_fromlist(m, fromlist)
    return m

def determine_parent(globals):
    if not globals or  not globals.has_key("__name__"):
        return None
    pname = globals['__name__']
    if globals.has_key("__path__"):
        parent = sys.modules[pname]
        assert globals is parent.__dict__
        return parent
    if '.' in pname:
        i = pname.rfind('.')
        pname = pname[:i]
        parent = sys.modules[pname]
        assert parent.__name__ == pname
        return parent
    return None

def find_head_package(parent, name):
    if '.' in name:
        i = name.find('.')
        head = name[:i]
        tail = name[i+1:]
    else:
        head = name
        tail = ""
    if parent:
        qname = "%s.%s" % (parent.__name__, head)
    else:
        qname = head
    q = import_module(head, qname, parent)
    if q: return q, tail
    if parent:
        qname = head
        parent = None
        q = import_module(head, qname, parent)
        if q: return q, tail
    raise ImportError("No module named " + qname)

def load_tail(q, tail):
    m = q
    while tail:
        i = tail.find('.')
        if i &lt; 0: i = len(tail)
        head, tail = tail[:i], tail[i+1:]
        mname = "%s.%s" % (m.__name__, head)
        m = import_module(head, mname, m)
        if not m:
            raise ImportError("No module named " + mname)
    return m

def ensure_fromlist(m, fromlist, recursive=0):
    for sub in fromlist:
        if sub == "*":
            if not recursive:
                try:
                    all = m.__all__
                except AttributeError:
                    pass
                else:
                    ensure_fromlist(m, all, 1)
            continue
        if sub != "*" and not hasattr(m, sub):
            subname = "%s.%s" % (m.__name__, sub)
            submod = import_module(sub, subname, m)
            if not submod:
                raise ImportError("No module named " + subname)

def import_module(partname, fqname, parent):
    try:
        return sys.modules[fqname]
    except KeyError:
        pass
    try:
        fp, pathname, stuff = imp.find_module(partname,
                                              parent and parent.__path__)
    except ImportError:
        return None
    try:
        m = imp.load_module(fqname, fp, pathname, stuff)
    finally:
        if fp: fp.close()
    if parent:
        setattr(parent, partname, m)
    return m


# Replacement for reload()
def reload_hook(module):
    name = module.__name__
    if '.' not in name:
        return import_module(name, name, None)
    i = name.rfind('.')
    pname = name[:i]
    parent = sys.modules[pname]
    return import_module(name[i+1:], name, parent)


# Save the original hooks
original_import = __builtin__.__import__
original_reload = __builtin__.reload

# Now install our hooks
__builtin__.__import__ = import_hook
__builtin__.reload = reload_hook
</pre> <p id="index-1">Also see the <code>importers</code> module (which can be found in <code>Demo/imputil/</code> in the Python source distribution) for additional examples.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2020 Python Software Foundation<br>Licensed under the PSF License.<br>
    <a href="https://docs.python.org/2.7/library/imputil.html" class="_attribution-link">https://docs.python.org/2.7/library/imputil.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

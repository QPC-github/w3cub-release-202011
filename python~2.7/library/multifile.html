
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Multifile - Python 2.7 - W3cubDocs</title>
  
  <meta name="description" content="Deprecated since version 2.5&#58; The email package should be used in preference to the multifile module. This module is present only to maintain &hellip;">
  <meta name="keywords" content="multifile, —, support, for, files, containing, distinct, parts, python, python~2.7">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/python~2.7/library/multifile.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/python~2.7.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/python~2.7/" class="_nav-link" title="" style="margin-left:0;">Python 2.7</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _python">
				
				
<h1 id="multifile-support-for-files-containing-distinct-parts"> multifile — Support for files containing distinct parts</h1> <div class="deprecated" id="module-multifile"> <p><span class="versionmodified deprecated">Deprecated since version 2.5: </span>The <a class="reference internal" href="email#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><code>email</code></a> package should be used in preference to the <a class="reference internal" href="#module-multifile" title="multifile: Support for reading files which contain distinct parts, such as some MIME data. (deprecated)"><code>multifile</code></a> module. This module is present only to maintain backward compatibility.</p> </div> <p>The <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> object enables you to treat sections of a text file as file-like input objects, with <code>''</code> being returned by <a class="reference internal" href="readline#module-readline" title="readline: GNU readline support for Python. (Unix)"><code>readline()</code></a> when a given delimiter pattern is encountered. The defaults of this class are designed to make it useful for parsing MIME multipart messages, but by subclassing it and overriding methods it can be easily adapted for more general use.</p> <dl class="class"> <dt id="multifile.MultiFile">
<code>class multifile.MultiFile(fp[, seekable])</code> </dt> <dd>
<p>Create a multi-file. You must instantiate this class with an input object argument for the <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> instance to get lines from, such as a file object returned by <a class="reference internal" href="functions#open" title="open"><code>open()</code></a>.</p> <p><a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> only ever looks at the input object’s <a class="reference internal" href="readline#module-readline" title="readline: GNU readline support for Python. (Unix)"><code>readline()</code></a>, <a class="reference internal" href="#multifile.MultiFile.seek" title="multifile.MultiFile.seek"><code>seek()</code></a> and <a class="reference internal" href="#multifile.MultiFile.tell" title="multifile.MultiFile.tell"><code>tell()</code></a> methods, and the latter two are only needed if you want random access to the individual MIME parts. To use <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> on a non-seekable stream object, set the optional <em>seekable</em> argument to false; this will prevent using the input object’s <a class="reference internal" href="#multifile.MultiFile.seek" title="multifile.MultiFile.seek"><code>seek()</code></a> and <a class="reference internal" href="#multifile.MultiFile.tell" title="multifile.MultiFile.tell"><code>tell()</code></a> methods.</p> </dd>
</dl> <p>It will be useful to know that in <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a>’s view of the world, text is composed of three kinds of lines: data, section-dividers, and end-markers. MultiFile is designed to support parsing of messages that may have multiple nested message parts, each with its own pattern for section-divider and end-marker lines.</p> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt>
<code>Module</code> <a class="reference internal" href="email#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><code>email</code></a>
</dt>
<dd>
<p>Comprehensive email handling package; supersedes the <a class="reference internal" href="#module-multifile" title="multifile: Support for reading files which contain distinct parts, such as some MIME data. (deprecated)"><code>multifile</code></a> module.</p> </dd> </dl> </div>  <h2 id="id1">1. MultiFile Objects</h2> <p id="multifile-objects">A <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> instance has the following methods:</p> <dl class="method"> <dt id="multifile.MultiFile.readline">
<code>MultiFile.readline(str)</code> </dt> <dd>
<p>Read a line. If the line is data (not a section-divider or end-marker or real EOF) return it. If the line matches the most-recently-stacked boundary, return <code>''</code> and set <code>self.last</code> to 1 or 0 according as the match is or is not an end-marker. If the line matches any other stacked boundary, raise an error. On encountering end-of-file on the underlying stream object, the method raises <code>Error</code> unless all boundaries have been popped.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.readlines">
<code>MultiFile.readlines(str)</code> </dt> <dd>
<p>Return all lines remaining in this part as a list of strings.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.read">
<code>MultiFile.read()</code> </dt> <dd>
<p>Read all lines, up to the next section. Return them as a single (multiline) string. Note that this doesn’t take a size argument!</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.seek">
<code>MultiFile.seek(pos[, whence])</code> </dt> <dd>
<p>Seek. Seek indices are relative to the start of the current section. The <em>pos</em> and <em>whence</em> arguments are interpreted as for a file seek.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.tell">
<code>MultiFile.tell()</code> </dt> <dd>
<p>Return the file position relative to the start of the current section.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.next">
<code>MultiFile.next()</code> </dt> <dd>
<p>Skip lines to the next section (that is, read lines until a section-divider or end-marker has been consumed). Return true if there is such a section, false if an end-marker is seen. Re-enable the most-recently-pushed boundary.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.is_data">
<code>MultiFile.is_data(str)</code> </dt> <dd>
<p>Return true if <em>str</em> is data and false if it might be a section boundary. As written, it tests for a prefix other than <code>'-</code><code>-'</code> at start of line (which all MIME boundaries have) but it is declared so it can be overridden in derived classes.</p> <p>Note that this test is used intended as a fast guard for the real boundary tests; if it always returns false it will merely slow processing, not cause it to fail.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.push">
<code>MultiFile.push(str)</code> </dt> <dd>
<p>Push a boundary string. When a decorated version of this boundary is found as an input line, it will be interpreted as a section-divider or end-marker (depending on the decoration, see <a class="rfc reference external" href="https://tools.ietf.org/html/rfc2045.html" id="index-0"><strong>RFC 2045</strong></a>). All subsequent reads will return the empty string to indicate end-of-file, until a call to <a class="reference internal" href="#multifile.MultiFile.pop" title="multifile.MultiFile.pop"><code>pop()</code></a> removes the boundary a or <a class="reference internal" href="#multifile.MultiFile.next" title="multifile.MultiFile.next"><code>next()</code></a> call reenables it.</p> <p>It is possible to push more than one boundary. Encountering the most-recently-pushed boundary will return EOF; encountering any other boundary will raise an error.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.pop">
<code>MultiFile.pop()</code> </dt> <dd>
<p>Pop a section boundary. This boundary will no longer be interpreted as EOF.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.section_divider">
<code>MultiFile.section_divider(str)</code> </dt> <dd>
<p>Turn a boundary into a section-divider line. By default, this method prepends <code>'--'</code> (which MIME section boundaries have) but it is declared so it can be overridden in derived classes. This method need not append LF or CR-LF, as comparison with the result ignores trailing whitespace.</p> </dd>
</dl> <dl class="method"> <dt id="multifile.MultiFile.end_marker">
<code>MultiFile.end_marker(str)</code> </dt> <dd>
<p>Turn a boundary string into an end-marker line. By default, this method prepends <code>'--'</code> and appends <code>'--'</code> (like a MIME-multipart end-of-message marker) but it is declared so it can be overridden in derived classes. This method need not append LF or CR-LF, as comparison with the result ignores trailing whitespace.</p> </dd>
</dl> <p>Finally, <a class="reference internal" href="#multifile.MultiFile" title="multifile.MultiFile"><code>MultiFile</code></a> instances have two public instance variables:</p> <dl class="attribute"> <dt id="multifile.MultiFile.level">
<code>MultiFile.level</code> </dt> <dd>
<p>Nesting depth of the current part.</p> </dd>
</dl> <dl class="attribute"> <dt id="multifile.MultiFile.last">
<code>MultiFile.last</code> </dt> <dd>
<p>True if the last end-of-file was for an end-of-message marker.</p> </dd>
</dl>   <h2 id="id2">2. MultiFile Example</h2> <pre data-language="python" id="multifile-example">import mimetools
import multifile
import StringIO

def extract_mime_part_matching(stream, mimetype):
    """Return the first element in a multipart MIME message on stream
    matching mimetype."""

    msg = mimetools.Message(stream)
    msgtype = msg.gettype()
    params = msg.getplist()

    data = StringIO.StringIO()
    if msgtype[:10] == "multipart/":

        file = multifile.MultiFile(stream)
        file.push(msg.getparam("boundary"))
        while file.next():
            submsg = mimetools.Message(file)
            try:
                data = StringIO.StringIO()
                mimetools.decode(file, data, submsg.getencoding())
            except ValueError:
                continue
            if submsg.gettype() == mimetype:
                break
        file.pop()
    return data.getvalue()
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    © 2001–2020 Python Software Foundation<br>Licensed under the PSF License.<br>
    <a href="https://docs.python.org/2.7/library/multifile.html" class="_attribution-link">https://docs.python.org/2.7/library/multifile.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

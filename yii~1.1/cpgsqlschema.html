
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CPgsqlSchema - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content=" the abstract column types mapped to physical column types. ">
  <meta name="keywords" content="cpgsqlschema, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cpgsqlschema.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/yii~1.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CPgsqlSchema</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.db.schema.pgsql">system.db.schema.pgsql</a></td> </tr> <tr> <th>Inheritance</th> <td>class CPgsqlSchema » <a href="cdbschema">CDbSchema</a> » <a href="ccomponent">CComponent</a>
</td> </tr> <tr> <th>Since</th> <td>1.0</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php">framework/db/schema/pgsql/CPgsqlSchema.php</a></td> </tr> </table> <div id="classDescription"> CPgsqlSchema is the class for retrieving metadata information from a PostgreSQL database.</div>  <div class="summary docProperty"> <h2>Public Properties</h2>  <table class="summaryTable"> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="columnTypes"> <td><a href="cpgsqlschema#columnTypes-detail">columnTypes</a></td> <td>array</td> <td>the abstract column types mapped to physical column types.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="commandBuilder"> <td><a href="cdbschema#commandBuilder-detail">commandBuilder</a></td> <td><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td>the SQL command builder for this connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dbConnection"> <td><a href="cdbschema#dbConnection-detail">dbConnection</a></td> <td><a href="cdbconnection">CDbConnection</a></td> <td>database connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="tableNames"> <td><a href="cdbschema#tableNames-detail">tableNames</a></td> <td>array</td> <td>Returns all table names in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="tables"> <td><a href="cdbschema#tables-detail">tables</a></td> <td>array</td> <td>Returns the metadata for all tables in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> </table> </div>  <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr class="inherited" id="__call"> <td><a href="ccomponent#__call-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__construct"> <td><a href="cdbschema#__construct-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="__get"> <td><a href="ccomponent#__get-detail">__get()</a></td> <td>Returns a property value, an event handler list or a behavior based on its name.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__isset"> <td><a href="ccomponent#__isset-detail">__isset()</a></td> <td>Checks if a property value is null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__set"> <td><a href="ccomponent#__set-detail">__set()</a></td> <td>Sets value of a component property.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__unset"> <td><a href="ccomponent#__unset-detail">__unset()</a></td> <td>Sets a component property to be null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="addColumn"> <td><a href="cpgsqlschema#addColumn-detail">addColumn()</a></td> <td>Builds a SQL statement for adding a new DB column.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="addForeignKey"> <td><a href="cdbschema#addForeignKey-detail">addForeignKey()</a></td> <td>Builds a SQL statement for adding a foreign key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="addPrimaryKey"> <td><a href="cdbschema#addPrimaryKey-detail">addPrimaryKey()</a></td> <td>Builds a SQL statement for adding a primary key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="alterColumn"> <td><a href="cpgsqlschema#alterColumn-detail">alterColumn()</a></td> <td>Builds a SQL statement for changing the definition of a column.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="asa"> <td><a href="ccomponent#asa-detail">asa()</a></td> <td>Returns the named behavior object.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehavior"> <td><a href="ccomponent#attachBehavior-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehaviors"> <td><a href="ccomponent#attachBehaviors-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachEventHandler"> <td><a href="ccomponent#attachEventHandler-detail">attachEventHandler()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canGetProperty"> <td><a href="ccomponent#canGetProperty-detail">canGetProperty()</a></td> <td>Determines whether a property can be read.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canSetProperty"> <td><a href="ccomponent#canSetProperty-detail">canSetProperty()</a></td> <td>Determines whether a property can be set.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="checkIntegrity"> <td><a href="cpgsqlschema#checkIntegrity-detail">checkIntegrity()</a></td> <td>Enables or disables integrity check.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="compareTableNames"> <td><a href="cdbschema#compareTableNames-detail">compareTableNames()</a></td> <td>Compares two table names.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="createIndex"> <td><a href="cdbschema#createIndex-detail">createIndex()</a></td> <td>Builds a SQL statement for creating a new index.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="createTable"> <td><a href="cdbschema#createTable-detail">createTable()</a></td> <td>Builds a SQL statement for creating a new DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="detachBehavior"> <td><a href="ccomponent#detachBehavior-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachBehaviors"> <td><a href="ccomponent#detachBehaviors-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachEventHandler"> <td><a href="ccomponent#detachEventHandler-detail">detachEventHandler()</a></td> <td>Detaches an existing event handler.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehavior"> <td><a href="ccomponent#disableBehavior-detail">disableBehavior()</a></td> <td>Disables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehaviors"> <td><a href="ccomponent#disableBehaviors-detail">disableBehaviors()</a></td> <td>Disables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="dropColumn"> <td><a href="cdbschema#dropColumn-detail">dropColumn()</a></td> <td>Builds a SQL statement for dropping a DB column.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropForeignKey"> <td><a href="cdbschema#dropForeignKey-detail">dropForeignKey()</a></td> <td>Builds a SQL statement for dropping a foreign key constraint.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="dropIndex"> <td><a href="cpgsqlschema#dropIndex-detail">dropIndex()</a></td> <td>Builds a SQL statement for dropping an index.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="dropPrimaryKey"> <td><a href="cdbschema#dropPrimaryKey-detail">dropPrimaryKey()</a></td> <td>Builds a SQL statement for removing a primary key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropTable"> <td><a href="cdbschema#dropTable-detail">dropTable()</a></td> <td>Builds a SQL statement for dropping a DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="enableBehavior"> <td><a href="ccomponent#enableBehavior-detail">enableBehavior()</a></td> <td>Enables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="enableBehaviors"> <td><a href="ccomponent#enableBehaviors-detail">enableBehaviors()</a></td> <td>Enables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="evaluateExpression"> <td><a href="ccomponent#evaluateExpression-detail">evaluateExpression()</a></td> <td>Evaluates a PHP expression or callback under the context of this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="getColumnType"> <td><a href="cdbschema#getColumnType-detail">getColumnType()</a></td> <td>Converts an abstract column type into a physical column type.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getCommandBuilder"> <td><a href="cdbschema#getCommandBuilder-detail">getCommandBuilder()</a></td> <td>Returns the SQL command builder for this connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getDbConnection"> <td><a href="cdbschema#getDbConnection-detail">getDbConnection()</a></td> <td>Returns database connection. The connection is active.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getEventHandlers"> <td><a href="ccomponent#getEventHandlers-detail">getEventHandlers()</a></td> <td>Returns the list of attached event handlers for an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="getTable"> <td><a href="cdbschema#getTable-detail">getTable()</a></td> <td>Obtains the metadata for the named table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getTableNames"> <td><a href="cdbschema#getTableNames-detail">getTableNames()</a></td> <td>Returns all table names in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getTables"> <td><a href="cdbschema#getTables-detail">getTables()</a></td> <td>Returns the metadata for all tables in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="hasEvent"> <td><a href="ccomponent#hasEvent-detail">hasEvent()</a></td> <td>Determines whether an event is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasEventHandler"> <td><a href="ccomponent#hasEventHandler-detail">hasEventHandler()</a></td> <td>Checks whether the named event has attached handlers.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasProperty"> <td><a href="ccomponent#hasProperty-detail">hasProperty()</a></td> <td>Determines whether a property is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="quoteColumnName"> <td><a href="cdbschema#quoteColumnName-detail">quoteColumnName()</a></td> <td>Quotes a column name for use in a query.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="quoteSimpleColumnName"> <td><a href="cdbschema#quoteSimpleColumnName-detail">quoteSimpleColumnName()</a></td> <td>Quotes a simple column name for use in a query.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="quoteSimpleTableName"> <td><a href="cpgsqlschema#quoteSimpleTableName-detail">quoteSimpleTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="quoteTableName"> <td><a href="cdbschema#quoteTableName-detail">quoteTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="raiseEvent"> <td><a href="ccomponent#raiseEvent-detail">raiseEvent()</a></td> <td>Raises an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="refresh"> <td><a href="cdbschema#refresh-detail">refresh()</a></td> <td>Refreshes the schema.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="renameColumn"> <td><a href="cdbschema#renameColumn-detail">renameColumn()</a></td> <td>Builds a SQL statement for renaming a column.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="renameTable"> <td><a href="cpgsqlschema#renameTable-detail">renameTable()</a></td> <td>Builds a SQL statement for renaming a DB table.</td> <td>CPgsqlSchema</td> </tr> <tr id="resetSequence"> <td><a href="cpgsqlschema#resetSequence-detail">resetSequence()</a></td> <td>Resets the sequence value of a table's primary key.</td> <td>CPgsqlSchema</td> </tr> <tr class="inherited" id="truncateTable"> <td><a href="cdbschema#truncateTable-detail">truncateTable()</a></td> <td>Builds a SQL statement for truncating a DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> </table> </div> <div class="summary docMethod"> <h2>Protected Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="createColumn"> <td><a href="cpgsqlschema#createColumn-detail">createColumn()</a></td> <td>Creates a table column.</td> <td>CPgsqlSchema</td> </tr> <tr id="createCommandBuilder"> <td><a href="cpgsqlschema#createCommandBuilder-detail">createCommandBuilder()</a></td> <td>Creates a command builder for the database.</td> <td>CPgsqlSchema</td> </tr> <tr id="findColumns"> <td><a href="cpgsqlschema#findColumns-detail">findColumns()</a></td> <td>Collects the table column metadata.</td> <td>CPgsqlSchema</td> </tr> <tr id="findConstraints"> <td><a href="cpgsqlschema#findConstraints-detail">findConstraints()</a></td> <td>Collects the primary and foreign key column details for the given table.</td> <td>CPgsqlSchema</td> </tr> <tr id="findForeignKey"> <td><a href="cpgsqlschema#findForeignKey-detail">findForeignKey()</a></td> <td>Collects foreign key information.</td> <td>CPgsqlSchema</td> </tr> <tr id="findPrimaryKey"> <td><a href="cpgsqlschema#findPrimaryKey-detail">findPrimaryKey()</a></td> <td>Collects primary key information.</td> <td>CPgsqlSchema</td> </tr> <tr id="findTableNames"> <td><a href="cpgsqlschema#findTableNames-detail">findTableNames()</a></td> <td>Returns all table names in the database.</td> <td>CPgsqlSchema</td> </tr> <tr id="loadTable"> <td><a href="cpgsqlschema#loadTable-detail">loadTable()</a></td> <td>Loads the metadata for the specified table.</td> <td>CPgsqlSchema</td> </tr> <tr id="resolveTableNames"> <td><a href="cpgsqlschema#resolveTableNames-detail">resolveTableNames()</a></td> <td>Generates various kinds of table names.</td> <td>CPgsqlSchema</td> </tr> </table> </div>  <h2>Property Details</h2> <h3 class="detailHeader" id="columnTypes-detail"> columnTypes<span class="detailHeaderTag"> property (available since v1.1.6) </span> </h3> <pre class="signature">public array <b>$columnTypes</b>;</pre> <p>the abstract column types mapped to physical column types.</p> <h2>Method Details</h2> <h3 class="detailHeader" id="addColumn-detail"> addColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>addColumn</b>(string $table, string $column, string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table that the new column will be added to. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the new column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the column type. The <a href="cpgsqlschema#getColumnType">getColumnType</a> method will be invoked to convert abstract column type (if any) into the physical one. Anything that is not recognized as abstract type will be kept in the generated SQL. For example, 'string' will be turned into 'varchar(255)', while 'string not null' will become 'varchar(255) not null'.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for adding a new column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L391">framework/db/schema/pgsql/CPgsqlSchema.php#391</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">addColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$column</span><span style="color: #007700">, </span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$type</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>        . </span><span style="color: #DD0000">' ADD COLUMN ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$type</span><span style="color: #007700">;<br>    return </span><span style="color: #0000BB">$sql</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for adding a new DB column.</p> <h3 class="detailHeader" id="alterColumn-detail"> alterColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>alterColumn</b>(string $table, string $column, string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be changed. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the column to be changed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new column type. The <a href="cpgsqlschema#getColumnType">getColumnType</a> method will be invoked to convert abstract column type (if any) into the physical one. Anything that is not recognized as abstract type will be kept in the generated SQL. For example, 'string' will be turned into 'varchar(255)', while 'string not null' will become 'varchar(255) not null'.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for changing the definition of a column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L410">framework/db/schema/pgsql/CPgsqlSchema.php#410</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">alterColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$column</span><span style="color: #007700">, </span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$type</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' ALTER COLUMN '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' TYPE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">$sql</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for changing the definition of a column.</p> <h3 class="detailHeader" id="checkIntegrity-detail"> checkIntegrity() <span class="detailHeaderTag"> method (available since v1.1) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>checkIntegrity</b>(boolean $check=true, string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$check</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to turn on or off the integrity check.</td> </tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L90">framework/db/schema/pgsql/CPgsqlSchema.php#90</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">checkIntegrity</span><span style="color: #007700">(</span><span style="color: #0000BB">$check</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">,</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$enable</span><span style="color: #007700">=</span><span style="color: #0000BB">$check </span><span style="color: #007700">? </span><span style="color: #DD0000">'ENABLE' </span><span style="color: #007700">: </span><span style="color: #DD0000">'DISABLE'</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$tableNames</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$db</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">();<br>    foreach(</span><span style="color: #0000BB">$tableNames </span><span style="color: #007700">as </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #DD0000">'"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">.</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br>        if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #DD0000">'"."'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">);<br>        </span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">"ALTER TABLE </span><span style="color: #0000BB">$tableName</span><span style="color: #0000BB">$enable</span><span style="color: #DD0000"> TRIGGER ALL"</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br>    }<br>}</span></pre> </div> <p>Enables or disables integrity check.</p> <h3 class="detailHeader" id="createColumn-detail"> createColumn() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cdbcolumnschema">CDbColumnSchema</a> <b>createColumn</b>(array $column)</pre> </td></tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">column metadata</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbcolumnschema">CDbColumnSchema</a></td> <td class="paramDescCol">normalized column metadata</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L206">framework/db/schema/pgsql/CPgsqlSchema.php#206</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">createColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">=new </span><span style="color: #0000BB">CPgsqlColumnSchema</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'attname'</span><span style="color: #007700">];<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allowNull</span><span style="color: #007700">=!</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'attnotnull'</span><span style="color: #007700">];<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isPrimaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isForeignKey</span><span style="color: #007700">=</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">comment</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'comment'</span><span style="color: #007700">]===</span><span style="color: #0000BB">null </span><span style="color: #007700">? </span><span style="color: #DD0000">'' </span><span style="color: #007700">: </span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'comment'</span><span style="color: #007700">];<br><br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">init</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'type'</span><span style="color: #007700">],</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'atthasdef'</span><span style="color: #007700">] ? </span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'adsrc'</span><span style="color: #007700">] : </span><span style="color: #0000BB">null</span><span style="color: #007700">);<br><br>    return </span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Creates a table column.</p> <h3 class="detailHeader" id="createCommandBuilder-detail"> createCommandBuilder() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cpgsqlcommandbuilder">CPgsqlCommandBuilder</a> <b>createCommandBuilder</b>()</pre> </td></tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cpgsqlcommandbuilder">CPgsqlCommandBuilder</a></td> <td class="paramDescCol">command builder instance.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L435">framework/db/schema/pgsql/CPgsqlSchema.php#435</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">createCommandBuilder</span><span style="color: #007700">()<br>{<br>    return new </span><span style="color: #0000BB">CPgsqlCommandBuilder</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Creates a command builder for the database. This method may be overridden by child classes to create a DBMS-specific command builder.</p> <h3 class="detailHeader" id="dropIndex-detail"> dropIndex() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>dropIndex</b>(string $name, string $table)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the index to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose index is to be dropped. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for dropping an index.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L425">framework/db/schema/pgsql/CPgsqlSchema.php#425</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">dropIndex</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">, </span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'DROP INDEX '</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for dropping an index.</p> <h3 class="detailHeader" id="findColumns-detail"> findColumns() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected boolean <b>findColumns</b>(<a href="cpgsqltableschema">CPgsqlTableSchema</a> $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cpgsqltableschema">CPgsqlTableSchema</a></td> <td class="paramDescCol">the table metadata</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether the table exists in the database</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L166">framework/db/schema/pgsql/CPgsqlSchema.php#166</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findColumns</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=&lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">SELECT a.attname, LOWER(format_type(a.atttypid, a.atttypmod)) AS type, d.adsrc, a.attnotnull, a.atthasdef,<br>pg_catalog.col_description(a.attrelid, a.attnum) AS comment<br>FROM pg_attribute a LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum<br>WHERE a.attnum &gt; 0 AND NOT a.attisdropped<br>AND a.attrelid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table<br>    AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = :schema))<br>ORDER BY a.attnum<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':table'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':schema'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">);<br><br>    if((</span><span style="color: #0000BB">$columns</span><span style="color: #007700">=</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">())===array())<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$column</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">);<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br><br>        if(</span><span style="color: #0000BB">stripos</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'adsrc'</span><span style="color: #007700">],</span><span style="color: #DD0000">'nextval'</span><span style="color: #007700">)===</span><span style="color: #0000BB">0 </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/nextval\([^\']*\'([^\']+)\'[^\)]*\)/i'</span><span style="color: #007700">,</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'adsrc'</span><span style="color: #007700">],</span><span style="color: #0000BB">$matches</span><span style="color: #007700">))<br>        {<br>            if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">],</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false </span><span style="color: #007700">|| </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">===</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">)<br>                </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>            else<br>                </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>            </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">autoIncrement</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>        }<br>    }<br>    return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Collects the table column metadata.</p> <h3 class="detailHeader" id="findConstraints-detail"> findConstraints() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected void <b>findConstraints</b>(<a href="cpgsqltableschema">CPgsqlTableSchema</a> $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cpgsqltableschema">CPgsqlTableSchema</a></td> <td class="paramDescCol">the table metadata</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L225">framework/db/schema/pgsql/CPgsqlSchema.php#225</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findConstraints</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=&lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">SELECT conname, consrc, contype, indkey FROM (<br>SELECT<br>    conname,<br>    CASE WHEN contype='f' THEN<br>        pg_catalog.pg_get_constraintdef(oid)<br>    ELSE<br>        'CHECK (' || consrc || ')'<br>    END AS consrc,<br>    contype,<br>    conrelid AS relid,<br>    NULL AS indkey<br>FROM<br>    pg_catalog.pg_constraint<br>WHERE<br>    contype IN ('f', 'c')<br>UNION ALL<br>SELECT<br>    pc.relname,<br>    NULL,<br>    CASE WHEN indisprimary THEN<br>            'p'<br>    ELSE<br>            'u'<br>    END,<br>    pi.indrelid,<br>    indkey<br>FROM<br>    pg_catalog.pg_class pc,<br>    pg_catalog.pg_index pi<br>WHERE<br>    pc.oid=pi.indexrelid<br>    AND EXISTS (<br>        SELECT 1 FROM pg_catalog.pg_depend d JOIN pg_catalog.pg_constraint c<br>        ON (d.refclassid = c.tableoid AND d.refobjid = c.oid)<br>        WHERE d.classid = pc.tableoid AND d.objid = pc.oid AND d.deptype = 'i' AND c.contype IN ('u', 'p')<br>)<br>) AS sub<br>WHERE relid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table<br>AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace<br>WHERE nspname=:schema))<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':table'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':schema'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">() as </span><span style="color: #0000BB">$row</span><span style="color: #007700">)<br>    {<br>        if(</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'contype'</span><span style="color: #007700">]===</span><span style="color: #DD0000">'p'</span><span style="color: #007700">) </span><span style="color: #FF8000">// primary key<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'indkey'</span><span style="color: #007700">]);<br>        elseif(</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'contype'</span><span style="color: #007700">]===</span><span style="color: #DD0000">'f'</span><span style="color: #007700">) </span><span style="color: #FF8000">// foreign key<br>            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findForeignKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'consrc'</span><span style="color: #007700">]);<br>    }<br>}</span></pre> </div> <p>Collects the primary and foreign key column details for the given table.</p> <h3 class="detailHeader" id="findForeignKey-detail"> findForeignKey() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected void <b>findForeignKey</b>(<a href="cpgsqltableschema">CPgsqlTableSchema</a> $table, string $src)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cpgsqltableschema">CPgsqlTableSchema</a></td> <td class="paramDescCol">the table metadata</td> </tr> <tr> <td class="paramNameCol">$src</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">pgsql foreign key definition</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L322">framework/db/schema/pgsql/CPgsqlSchema.php#322</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findForeignKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$src</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$matches</span><span style="color: #007700">=array();<br>    </span><span style="color: #0000BB">$brackets</span><span style="color: #007700">=</span><span style="color: #DD0000">'\(([^\)]+)\)'</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$pattern</span><span style="color: #007700">=</span><span style="color: #DD0000">"/FOREIGN\s+KEY\s+</span><span style="color: #007700">{</span><span style="color: #0000BB">$brackets</span><span style="color: #007700">}</span><span style="color: #DD0000">\s+REFERENCES\s+([^\(]+)</span><span style="color: #007700">{</span><span style="color: #0000BB">$brackets</span><span style="color: #007700">}</span><span style="color: #DD0000">/i"</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">,</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'"'</span><span style="color: #007700">,</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$src</span><span style="color: #007700">),</span><span style="color: #0000BB">$matches</span><span style="color: #007700">))<br>    {<br>        </span><span style="color: #0000BB">$keys</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/,\s+/'</span><span style="color: #007700">, </span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);<br>        </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$fkeys</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/,\s+/'</span><span style="color: #007700">, </span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">3</span><span style="color: #007700">]);<br>        foreach(</span><span style="color: #0000BB">$keys </span><span style="color: #007700">as </span><span style="color: #0000BB">$i</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$key</span><span style="color: #007700">)<br>        {<br>            </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foreignKeys</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]=array(</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">,</span><span style="color: #0000BB">$fkeys</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]);<br>            if(isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]))<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">isForeignKey</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>        }<br>    }<br>}</span></pre> </div> <p>Collects foreign key information.</p> <h3 class="detailHeader" id="findPrimaryKey-detail"> findPrimaryKey() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected void <b>findPrimaryKey</b>(<a href="cpgsqltableschema">CPgsqlTableSchema</a> $table, string $indices)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cpgsqltableschema">CPgsqlTableSchema</a></td> <td class="paramDescCol">the table metadata</td> </tr> <tr> <td class="paramNameCol">$indices</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">pgsql primary key index list</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L286">framework/db/schema/pgsql/CPgsqlSchema.php#286</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$indices</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$indices</span><span style="color: #007700">=</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">', '</span><span style="color: #007700">,</span><span style="color: #0000BB">preg_split</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s+/'</span><span style="color: #007700">,</span><span style="color: #0000BB">$indices</span><span style="color: #007700">));<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=&lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">SELECT attnum, attname FROM pg_catalog.pg_attribute WHERE<br>attrelid=(<br>    SELECT oid FROM pg_catalog.pg_class WHERE relname=:table AND relnamespace=(<br>        SELECT oid FROM pg_catalog.pg_namespace WHERE nspname=:schema<br>    )<br>)<br>AND attnum IN (</span><span style="color: #007700">{</span><span style="color: #0000BB">$indices</span><span style="color: #007700">}</span><span style="color: #DD0000">)<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':table'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':schema'</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">() as </span><span style="color: #0000BB">$row</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$name</span><span style="color: #007700">=</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'attname'</span><span style="color: #007700">];<br>        if(isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]))<br>        {<br>            </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$name</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">isPrimaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>            if(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">===</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br>            elseif(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">))<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">=array(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>            else<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br>        }<br>    }<br>}</span></pre> </div> <p>Collects primary key information.</p> <h3 class="detailHeader" id="findTableNames-detail"> findTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected array <b>findTableNames</b>(string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema. If not empty, the returned table names will be prefixed with the schema name.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">all table names in the database.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L347">framework/db/schema/pgsql/CPgsqlSchema.php#347</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">===</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=&lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">SELECT table_name, table_schema FROM information_schema.tables<br>WHERE table_schema=:schema AND table_type='BASE TABLE'<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #DD0000">':schema'</span><span style="color: #007700">,</span><span style="color: #0000BB">$schema</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$rows</span><span style="color: #007700">=</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">();<br>    </span><span style="color: #0000BB">$names</span><span style="color: #007700">=array();<br>    foreach(</span><span style="color: #0000BB">$rows </span><span style="color: #007700">as </span><span style="color: #0000BB">$row</span><span style="color: #007700">)<br>    {<br>        if(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">===</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$names</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'table_name'</span><span style="color: #007700">];<br>        else<br>            </span><span style="color: #0000BB">$names</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'table_schema'</span><span style="color: #007700">].</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'table_name'</span><span style="color: #007700">];<br>    }<br>    return </span><span style="color: #0000BB">$names</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Returns all table names in the database.</p> <h3 class="detailHeader" id="loadTable-detail"> loadTable() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cdbtableschema">CDbTableSchema</a> <b>loadTable</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">driver dependent table metadata.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L109">framework/db/schema/pgsql/CPgsqlSchema.php#109</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">loadTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">=new </span><span style="color: #0000BB">CPgsqlTableSchema</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">resolveTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>    if(!</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findColumns</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">))<br>        return </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findConstraints</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br><br>    if(</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">) &amp;&amp; isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">]))<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">];<br>    elseif(</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">))<br>    {<br>        foreach(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey </span><span style="color: #007700">as </span><span style="color: #0000BB">$pk</span><span style="color: #007700">)<br>        {<br>            if(isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$pk</span><span style="color: #007700">]))<br>            {<br>                </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_sequences</span><span style="color: #007700">[</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$pk</span><span style="color: #007700">];<br>                break;<br>            }<br>        }<br>    }<br><br>    return </span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Loads the metadata for the specified table.</p> <h3 class="detailHeader" id="quoteSimpleTableName-detail"> quoteSimpleTableName() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteSimpleTableName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L53">framework/db/schema/pgsql/CPgsqlSchema.php#53</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteSimpleTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Quotes a table name for use in a query. A simple table name does not schema prefix.</p> <h3 class="detailHeader" id="renameTable-detail"> renameTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>renameTable</b>(string $table, string $newName)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table to be renamed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$newName</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new table name. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for renaming a DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L376">framework/db/schema/pgsql/CPgsqlSchema.php#376</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">renameTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$newName</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' RENAME TO ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$newName</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Builds a SQL statement for renaming a DB table.</p> <h3 class="detailHeader" id="resetSequence-detail"> resetSequence() <span class="detailHeaderTag"> method (available since v1.1) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>resetSequence</b>(<a href="cdbtableschema">CDbTableSchema</a> $table, integer|null $value=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">the table schema whose primary key sequence will be reset</td> </tr> <tr> <td class="paramNameCol">$value</td> <td class="paramTypeCol">integer|null</td> <td class="paramDescCol">the value for the primary key of the next new row inserted. If this is not set, the next new row's primary key will have the max value of a primary key plus one (i.e. sequence trimming).</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L68">framework/db/schema/pgsql/CPgsqlSchema.php#68</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">resetSequence</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$value</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">===</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        return;<br>    </span><span style="color: #0000BB">$sequence</span><span style="color: #007700">=</span><span style="color: #DD0000">'"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">.</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)!==</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$sequence</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #DD0000">'"."'</span><span style="color: #007700">,</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">);<br>    if(</span><span style="color: #0000BB">$value</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$value</span><span style="color: #007700">=(int)</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br>    else<br>        </span><span style="color: #0000BB">$value</span><span style="color: #007700">=</span><span style="color: #DD0000">"(SELECT COALESCE(MAX(\"</span><span style="color: #007700">{</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">}</span><span style="color: #DD0000">\"),0) FROM </span><span style="color: #007700">{</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">}</span><span style="color: #DD0000">)+1"</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()<br>        -&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT SETVAL('</span><span style="color: #0000BB">$sequence</span><span style="color: #DD0000">',</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">,false)"</span><span style="color: #007700">)<br>        -&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br>}</span></pre> </div> <p>Resets the sequence value of a table's primary key. The sequence will be reset such that the primary key of the next new row inserted will have the specified value or max value of a primary key plus one (i.e. sequence trimming).</p> <h3 class="detailHeader" id="resolveTableNames-detail"> resolveTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected void <b>resolveTableNames</b>(<a href="cpgsqltableschema">CPgsqlTableSchema</a> $table, string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cpgsqltableschema">CPgsqlTableSchema</a></td> <td class="paramDescCol">the table instance</td> </tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the unquoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/pgsql/CPgsqlSchema.php#L139">framework/db/schema/pgsql/CPgsqlSchema.php#139</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">resolveTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$parts</span><span style="color: #007700">=</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'"'</span><span style="color: #007700">,</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">));<br>    if(isset(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]))<br>    {<br>        </span><span style="color: #0000BB">$schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>    }<br>    else<br>    {<br>        </span><span style="color: #0000BB">$schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>    }<br><br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">$schemaName</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">$schemaName</span><span style="color: #007700">===</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">);<br>    else<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$schemaName</span><span style="color: #007700">).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Generates various kinds of table names.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CPgsqlSchema" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CPgsqlSchema</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

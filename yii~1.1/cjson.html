
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CJSON - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content=" decodes a JSON string into appropriate variable ">
  <meta name="keywords" content="cjson, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cjson.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/yii~1.1.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CJSON</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.web.helpers">system.web.helpers</a></td> </tr> <tr> <th>Inheritance</th> <td>class CJSON</td> </tr> <tr> <th>Since</th> <td>1.0</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php">framework/web/helpers/CJSON.php</a></td> </tr> </table> <div id="classDescription"> CJSON converts PHP data to and from JSON format.</div>   <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="decode"> <td><a href="cjson#decode-detail">decode()</a></td> <td>decodes a JSON string into appropriate variable</td> <td>CJSON</td> </tr> <tr id="encode"> <td><a href="cjson#encode-detail">encode()</a></td> <td>Encodes an arbitrary variable into JSON format</td> <td>CJSON</td> </tr> </table> </div> <div class="summary docMethod"> <h2>Protected Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="nameValue"> <td><a href="cjson#nameValue-detail">nameValue()</a></td> <td>array-walking function for use in generating JSON-formatted name-value pairs</td> <td>CJSON</td> </tr> <tr id="reduceString"> <td><a href="cjson#reduceString-detail">reduceString()</a></td> <td>reduce a string by removing leading and trailing comments and whitespace</td> <td>CJSON</td> </tr> <tr id="unicodeToUTF8"> <td><a href="cjson#unicodeToUTF8-detail">unicodeToUTF8()</a></td> <td>This function converts a Unicode array back to its UTF-8 representation</td> <td>CJSON</td> </tr> <tr id="utf16beToUTF8"> <td><a href="cjson#utf16beToUTF8-detail">utf16beToUTF8()</a></td> <td>UTF-8 to UTF-16BE conversion.</td> <td>CJSON</td> </tr> <tr id="utf8ToUTF16BE"> <td><a href="cjson#utf8ToUTF16BE-detail">utf8ToUTF16BE()</a></td> <td>UTF-8 to UTF-16BE conversion.</td> <td>CJSON</td> </tr> <tr id="utf8ToUnicode"> <td><a href="cjson#utf8ToUnicode-detail">utf8ToUnicode()</a></td> <td>This function returns any UTF-8 encoded text as a list of</td> <td>CJSON</td> </tr> </table> </div>  <h2>Method Details</h2> <h3 class="detailHeader" id="decode-detail"> decode() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static mixed <b>decode</b>(string $str, boolean $useArray=true)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">JSON-formatted string</td> </tr> <tr> <td class="paramNameCol">$useArray</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to use associative array to represent object data</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">mixed</td> <td class="paramDescCol">number, boolean, string, array, or object corresponding to given JSON input string. Note that decode() always returns strings in ASCII or UTF-8 format!</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L331">framework/web/helpers/CJSON.php#331</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">$useArray</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'json_decode'</span><span style="color: #007700">))<br>    {<br>        </span><span style="color: #0000BB">$json </span><span style="color: #007700">= </span><span style="color: #0000BB">json_decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">);<br><br>        </span><span style="color: #FF8000">// based on investigation, native fails sometimes returning null.<br>        // see: http://gggeek.altervista.org/sw/article_20070425.html<br>        // As of PHP 5.3.6 it still fails on some valid JSON strings<br>        </span><span style="color: #007700">if(</span><span style="color: #0000BB">$json </span><span style="color: #007700">!== </span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>            return </span><span style="color: #0000BB">$json</span><span style="color: #007700">;<br>    }<br><br>    </span><span style="color: #0000BB">$str </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">reduceString</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br><br>    switch (</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">)) {<br>        case </span><span style="color: #DD0000">'true'</span><span style="color: #007700">:<br>            return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'false'</span><span style="color: #007700">:<br>            return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'null'</span><span style="color: #007700">:<br>            return </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br><br>        default:<br>            if (</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">)) {<br>                </span><span style="color: #FF8000">// Lookie-loo, it's a number<br><br>                // This would work on its own, but I'm trying to be<br>                // good about returning integers where appropriate:<br>                // return (float)$str;<br><br>                // Return float or int, as appropriate<br>                </span><span style="color: #007700">return ((float)</span><span style="color: #0000BB">$str </span><span style="color: #007700">== (integer)</span><span style="color: #0000BB">$str</span><span style="color: #007700">)<br>                    ? (integer)</span><span style="color: #0000BB">$str<br>                    </span><span style="color: #007700">: (float)</span><span style="color: #0000BB">$str</span><span style="color: #007700">;<br><br>            } elseif (</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^("|\').+(\1)$/s'</span><span style="color: #007700">, </span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">$m</span><span style="color: #007700">) &amp;&amp; </span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">] == </span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">]) {<br>                </span><span style="color: #FF8000">// STRINGS RETURNED IN UTF-8 FORMAT<br>                </span><span style="color: #0000BB">$delim </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>                </span><span style="color: #0000BB">$chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>                </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">= </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>                </span><span style="color: #0000BB">$strlen_chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">);<br><br>                for (</span><span style="color: #0000BB">$c </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">; </span><span style="color: #0000BB">$c </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">$strlen_chrs</span><span style="color: #007700">; ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">) {<br><br>                    </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">2</span><span style="color: #007700">);<br>                    </span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">= </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">});<br><br>                    switch (</span><span style="color: #0000BB">true</span><span style="color: #007700">) {<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\b'</span><span style="color: #007700">:<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">0x08</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\t'</span><span style="color: #007700">:<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">0x09</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\n'</span><span style="color: #007700">:<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">0x0A</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\f'</span><span style="color: #007700">:<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">0x0C</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\r'</span><span style="color: #007700">:<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">0x0D</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br><br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\\"'</span><span style="color: #007700">:<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\\\''</span><span style="color: #007700">:<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\\\\'</span><span style="color: #007700">:<br>                        case </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'\\/'</span><span style="color: #007700">:<br>                            if ((</span><span style="color: #0000BB">$delim </span><span style="color: #007700">== </span><span style="color: #DD0000">'"' </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">!= </span><span style="color: #DD0000">'\\\''</span><span style="color: #007700">) ||<br>                               (</span><span style="color: #0000BB">$delim </span><span style="color: #007700">== </span><span style="color: #DD0000">"'" </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">!= </span><span style="color: #DD0000">'\\"'</span><span style="color: #007700">)) {<br>                                </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{++</span><span style="color: #0000BB">$c</span><span style="color: #007700">};<br>                            }<br>                            break;<br><br>                        case </span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\\\u[0-9A-F]{4}/i'</span><span style="color: #007700">, </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">6</span><span style="color: #007700">)):<br>                            </span><span style="color: #FF8000">// single, escaped unicode character<br>                            </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">= </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">hexdec</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, (</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">), </span><span style="color: #0000BB">2</span><span style="color: #007700">)))<br>                                   . </span><span style="color: #0000BB">chr</span><span style="color: #007700">(</span><span style="color: #0000BB">hexdec</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, (</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">4</span><span style="color: #007700">), </span><span style="color: #0000BB">2</span><span style="color: #007700">)));<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf16beToUTF8</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">);<br>                            </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">5</span><span style="color: #007700">;<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&gt;= </span><span style="color: #0000BB">0x20</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&lt;= </span><span style="color: #0000BB">0x7F</span><span style="color: #007700">):<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">};<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xE0</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xC0</span><span style="color: #007700">:<br>                            </span><span style="color: #FF8000">// characters U-00000080 - U-000007FF, mask 110XXXXX<br>                            //see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">2</span><span style="color: #007700">);<br>                            ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xF0</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xE0</span><span style="color: #007700">:<br>                            </span><span style="color: #FF8000">// characters U-00000800 - U-0000FFFF, mask 1110XXXX<br>                            // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">3</span><span style="color: #007700">);<br>                            </span><span style="color: #0000BB">$c </span><span style="color: #007700">+= </span><span style="color: #0000BB">2</span><span style="color: #007700">;<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xF8</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xF0</span><span style="color: #007700">:<br>                            </span><span style="color: #FF8000">// characters U-00010000 - U-001FFFFF, mask 11110XXX<br>                            // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">4</span><span style="color: #007700">);<br>                            </span><span style="color: #0000BB">$c </span><span style="color: #007700">+= </span><span style="color: #0000BB">3</span><span style="color: #007700">;<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xFC</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xF8</span><span style="color: #007700">:<br>                            </span><span style="color: #FF8000">// characters U-00200000 - U-03FFFFFF, mask 111110XX<br>                            // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">);<br>                            </span><span style="color: #0000BB">$c </span><span style="color: #007700">+= </span><span style="color: #0000BB">4</span><span style="color: #007700">;<br>                            break;<br><br>                        case (</span><span style="color: #0000BB">$ord_chrs_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xFE</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xFC</span><span style="color: #007700">:<br>                            </span><span style="color: #FF8000">// characters U-04000000 - U-7FFFFFFF, mask 1111110X<br>                            // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                            </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">.= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">6</span><span style="color: #007700">);<br>                            </span><span style="color: #0000BB">$c </span><span style="color: #007700">+= </span><span style="color: #0000BB">5</span><span style="color: #007700">;<br>                            break;<br><br>                    }<br><br>                }<br><br>                return </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">;<br><br>            } elseif (</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^\[.*\]$/s'</span><span style="color: #007700">, </span><span style="color: #0000BB">$str</span><span style="color: #007700">) || </span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^\{.*\}$/s'</span><span style="color: #007700">, </span><span style="color: #0000BB">$str</span><span style="color: #007700">)) {<br>                </span><span style="color: #FF8000">// array, or object notation<br><br>                </span><span style="color: #007700">if (</span><span style="color: #0000BB">$str</span><span style="color: #007700">{</span><span style="color: #0000BB">0</span><span style="color: #007700">} == </span><span style="color: #DD0000">'['</span><span style="color: #007700">) {<br>                    </span><span style="color: #0000BB">$stk </span><span style="color: #007700">= array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">);<br>                    </span><span style="color: #0000BB">$arr </span><span style="color: #007700">= array();<br>                } else {<br>                    if (</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">) {<br>                        </span><span style="color: #0000BB">$stk </span><span style="color: #007700">= array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$obj </span><span style="color: #007700">= array();<br>                    } else {<br>                        </span><span style="color: #0000BB">$stk </span><span style="color: #007700">= array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$obj </span><span style="color: #007700">= new </span><span style="color: #0000BB">stdClass</span><span style="color: #007700">();<br>                    }<br>                }<br><br>                </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">false</span><span style="color: #007700">);<br><br>                </span><span style="color: #0000BB">$chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">, -</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>                </span><span style="color: #0000BB">$chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">reduceString</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">);<br><br>                if (</span><span style="color: #0000BB">$chrs </span><span style="color: #007700">== </span><span style="color: #DD0000">''</span><span style="color: #007700">) {<br>                    if (</span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">) == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">) {<br>                        return </span><span style="color: #0000BB">$arr</span><span style="color: #007700">;<br><br>                    } else {<br>                        return </span><span style="color: #0000BB">$obj</span><span style="color: #007700">;<br><br>                    }<br>                }<br><br>                </span><span style="color: #FF8000">//print("\nparsing {$chrs}\n");<br><br>                </span><span style="color: #0000BB">$strlen_chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">);<br><br>                for (</span><span style="color: #0000BB">$c </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">; </span><span style="color: #0000BB">$c </span><span style="color: #007700">&lt;= </span><span style="color: #0000BB">$strlen_chrs</span><span style="color: #007700">; ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">) {<br><br>                    </span><span style="color: #0000BB">$top </span><span style="color: #007700">= </span><span style="color: #0000BB">end</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">);<br>                    </span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #0000BB">2</span><span style="color: #007700">);<br><br>                    if ((</span><span style="color: #0000BB">$c </span><span style="color: #007700">== </span><span style="color: #0000BB">$strlen_chrs</span><span style="color: #007700">) || ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">','</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">))) {<br>                        </span><span style="color: #FF8000">// found a comma that is not inside a string, array, etc.,<br>                        // OR we've reached the end of the character list<br>                        </span><span style="color: #0000BB">$slice </span><span style="color: #007700">= </span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'where'</span><span style="color: #007700">], (</span><span style="color: #0000BB">$c </span><span style="color: #007700">- </span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'where'</span><span style="color: #007700">]));<br>                        </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; (</span><span style="color: #0000BB">$c </span><span style="color: #007700">+ </span><span style="color: #0000BB">1</span><span style="color: #007700">), </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">false</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found split at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");<br><br>                        </span><span style="color: #007700">if (</span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">) == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">) {<br>                            </span><span style="color: #FF8000">// we are in an array, so just push an element onto the stack<br>                            </span><span style="color: #0000BB">$arr</span><span style="color: #007700">[] = </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$slice</span><span style="color: #007700">,</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">);<br><br>                        } elseif (</span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">) == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">) {<br>                            </span><span style="color: #FF8000">// we are in an object, so figure<br>                            // out the property name and set an<br>                            // element in an associative array,<br>                            // for now<br>                            </span><span style="color: #007700">if (</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^\s*(["\'].*[^\\\]["\'])\s*:\s*(\S.*),?$/Uis'</span><span style="color: #007700">, </span><span style="color: #0000BB">$slice</span><span style="color: #007700">, </span><span style="color: #0000BB">$parts</span><span style="color: #007700">)) {<br>                                </span><span style="color: #FF8000">// "name":value pair<br>                                </span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">],</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">);<br>                                </span><span style="color: #0000BB">$val </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">],</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">);<br><br>                                if (</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">) {<br>                                    </span><span style="color: #0000BB">$obj</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">] = </span><span style="color: #0000BB">$val</span><span style="color: #007700">;<br>                                } else {<br>                                    </span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">$val</span><span style="color: #007700">;<br>                                }<br>                            } elseif (</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^\s*(\w+)\s*:\s*(\S.*),?$/Uis'</span><span style="color: #007700">, </span><span style="color: #0000BB">$slice</span><span style="color: #007700">, </span><span style="color: #0000BB">$parts</span><span style="color: #007700">)) {<br>                                </span><span style="color: #FF8000">// name:value pair, where name is unquoted<br>                                </span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>                                </span><span style="color: #0000BB">$val </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">],</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">);<br><br>                                if (</span><span style="color: #0000BB">$useArray</span><span style="color: #007700">) {<br>                                    </span><span style="color: #0000BB">$obj</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">] = </span><span style="color: #0000BB">$val</span><span style="color: #007700">;<br>                                } else {<br>                                    </span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">$val</span><span style="color: #007700">;<br>                                }<br>                            }<br><br>                        }<br><br>                    } elseif (((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">'"'</span><span style="color: #007700">) || (</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">"'"</span><span style="color: #007700">)) &amp;&amp; (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] != </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_STR</span><span style="color: #007700">)) {<br>                        </span><span style="color: #FF8000">// found a quote, and we are not inside a string<br>                        </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_STR</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">});<br>                        </span><span style="color: #FF8000">//print("Found start of string at {$c}\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'delim'</span><span style="color: #007700">]) &amp;&amp;<br>                             (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_STR</span><span style="color: #007700">) &amp;&amp;<br>                             ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c </span><span style="color: #007700">- </span><span style="color: #0000BB">1</span><span style="color: #007700">} != </span><span style="color: #DD0000">"\\"</span><span style="color: #007700">) ||<br>                             (</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c </span><span style="color: #007700">- </span><span style="color: #0000BB">1</span><span style="color: #007700">} == </span><span style="color: #DD0000">"\\" </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c </span><span style="color: #007700">- </span><span style="color: #0000BB">2</span><span style="color: #007700">} == </span><span style="color: #DD0000">"\\"</span><span style="color: #007700">))) {<br>                        </span><span style="color: #FF8000">// found a quote, we're in a string, and it's not escaped<br>                        </span><span style="color: #0000BB">array_pop</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found end of string at {$c}: ".substr($chrs, $top['where'], (1 + 1 + $c - $top['where']))."\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">'['</span><span style="color: #007700">) &amp;&amp;<br>                             </span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">], array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">))) {<br>                        </span><span style="color: #FF8000">// found a left-bracket, and we are in an array, object, or slice<br>                        </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">false</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found start of array at {$c}\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">']'</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">)) {<br>                        </span><span style="color: #FF8000">// found a right-bracket, and we're in an array<br>                        </span><span style="color: #0000BB">array_pop</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found end of array at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">'{'</span><span style="color: #007700">) &amp;&amp;<br>                             </span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">], array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">))) {<br>                        </span><span style="color: #FF8000">// found a left-brace, and we are in an array, object, or slice<br>                        </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">false</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found start of object at {$c}\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">} == </span><span style="color: #DD0000">'}'</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">)) {<br>                        </span><span style="color: #FF8000">// found a right-brace, and we're in an object<br>                        </span><span style="color: #0000BB">array_pop</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">);<br>                        </span><span style="color: #FF8000">//print("Found end of object at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'/*'</span><span style="color: #007700">) &amp;&amp;<br>                             </span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">], array(</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_SLICE</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">, </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">))) {<br>                        </span><span style="color: #FF8000">// found a comment start, and we are in an array, object, or slice<br>                        </span><span style="color: #0000BB">$stk</span><span style="color: #007700">[] = array(</span><span style="color: #DD0000">'what' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_CMT</span><span style="color: #007700">, </span><span style="color: #DD0000">'where' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$c</span><span style="color: #007700">, </span><span style="color: #DD0000">'delim' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">false</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">++;<br>                        </span><span style="color: #FF8000">//print("Found start of comment at {$c}\n");<br><br>                    </span><span style="color: #007700">} elseif ((</span><span style="color: #0000BB">$substr_chrs_c_2 </span><span style="color: #007700">== </span><span style="color: #DD0000">'*/'</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'what'</span><span style="color: #007700">] == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_CMT</span><span style="color: #007700">)) {<br>                        </span><span style="color: #FF8000">// found a comment end, and we're in one now<br>                        </span><span style="color: #0000BB">array_pop</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">++;<br><br>                        for (</span><span style="color: #0000BB">$i </span><span style="color: #007700">= </span><span style="color: #0000BB">$top</span><span style="color: #007700">[</span><span style="color: #DD0000">'where'</span><span style="color: #007700">]; </span><span style="color: #0000BB">$i </span><span style="color: #007700">&lt;= </span><span style="color: #0000BB">$c</span><span style="color: #007700">; ++</span><span style="color: #0000BB">$i</span><span style="color: #007700">)<br>                            </span><span style="color: #0000BB">$chrs </span><span style="color: #007700">= </span><span style="color: #0000BB">substr_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$chrs</span><span style="color: #007700">, </span><span style="color: #DD0000">' '</span><span style="color: #007700">, </span><span style="color: #0000BB">$i</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br><br>                        </span><span style="color: #FF8000">//print("Found end of comment at {$c}: ".substr($chrs, $top['where'], (1 + $c - $top['where']))."\n");<br><br>                    </span><span style="color: #007700">}<br><br>                }<br><br>                if (</span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">) == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_ARR</span><span style="color: #007700">) {<br>                    return </span><span style="color: #0000BB">$arr</span><span style="color: #007700">;<br><br>                } elseif (</span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$stk</span><span style="color: #007700">) == </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">JSON_IN_OBJ</span><span style="color: #007700">) {<br>                    return </span><span style="color: #0000BB">$obj</span><span style="color: #007700">;<br><br>                }<br><br>            }<br>    }<br>}</span></pre> </div> <p>decodes a JSON string into appropriate variable</p> <h3 class="detailHeader" id="encode-detail"> encode() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static string <b>encode</b>(mixed $var)</pre> </td></tr> <tr> <td class="paramNameCol">$var</td> <td class="paramTypeCol">mixed</td> <td class="paramDescCol">any number, boolean, string, array, or object to be encoded. If var is a string, it will be converted to UTF-8 format first before being encoded.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">JSON string representation of input var</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L95">framework/web/helpers/CJSON.php#95</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">)<br>{<br>    switch (</span><span style="color: #0000BB">gettype</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">)) {<br>        case </span><span style="color: #DD0000">'boolean'</span><span style="color: #007700">:<br>            return </span><span style="color: #0000BB">$var </span><span style="color: #007700">? </span><span style="color: #DD0000">'true' </span><span style="color: #007700">: </span><span style="color: #DD0000">'false'</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'NULL'</span><span style="color: #007700">:<br>            return </span><span style="color: #DD0000">'null'</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'integer'</span><span style="color: #007700">:<br>            return (int) </span><span style="color: #0000BB">$var</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'double'</span><span style="color: #007700">:<br>        case </span><span style="color: #DD0000">'float'</span><span style="color: #007700">:<br>            return </span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,(float)</span><span style="color: #0000BB">$var</span><span style="color: #007700">); </span><span style="color: #FF8000">// locale-independent representation<br><br>        </span><span style="color: #007700">case </span><span style="color: #DD0000">'string'</span><span style="color: #007700">:<br>            if ((</span><span style="color: #0000BB">$enc</span><span style="color: #007700">=</span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">app</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">charset</span><span style="color: #007700">))!==</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">)<br>                </span><span style="color: #0000BB">$var</span><span style="color: #007700">=</span><span style="color: #0000BB">iconv</span><span style="color: #007700">(</span><span style="color: #0000BB">$enc</span><span style="color: #007700">, </span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">, </span><span style="color: #0000BB">$var</span><span style="color: #007700">);<br><br>            if(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'json_encode'</span><span style="color: #007700">))<br>                return </span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">);<br><br>            </span><span style="color: #FF8000">// STRINGS ARE EXPECTED TO BE IN ASCII OR UTF-8 FORMAT<br>            </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">= </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>            </span><span style="color: #0000BB">$strlen_var </span><span style="color: #007700">= </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">);<br><br>           </span><span style="color: #FF8000">/*<br>            * Iterate over every character in the string,<br>            * escaping with a slash or encoding to UTF-8 where necessary<br>            */<br>            </span><span style="color: #007700">for (</span><span style="color: #0000BB">$c </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">; </span><span style="color: #0000BB">$c </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">$strlen_var</span><span style="color: #007700">; ++</span><span style="color: #0000BB">$c</span><span style="color: #007700">) {<br><br>                </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">= </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">});<br><br>                switch (</span><span style="color: #0000BB">true</span><span style="color: #007700">) {<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x08</span><span style="color: #007700">:<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\b'</span><span style="color: #007700">;<br>                        break;<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x09</span><span style="color: #007700">:<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\t'</span><span style="color: #007700">;<br>                        break;<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x0A</span><span style="color: #007700">:<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\n'</span><span style="color: #007700">;<br>                        break;<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x0C</span><span style="color: #007700">:<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\f'</span><span style="color: #007700">;<br>                        break;<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x0D</span><span style="color: #007700">:<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\r'</span><span style="color: #007700">;<br>                        break;<br><br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x22</span><span style="color: #007700">:<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x2F</span><span style="color: #007700">:<br>                    case </span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">== </span><span style="color: #0000BB">0x5C</span><span style="color: #007700">:<br>                        </span><span style="color: #FF8000">// double quote, slash, slosh<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #DD0000">'\\'</span><span style="color: #007700">.</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">};<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&gt;= </span><span style="color: #0000BB">0x20</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&lt;= </span><span style="color: #0000BB">0x7F</span><span style="color: #007700">)):<br>                        </span><span style="color: #FF8000">// characters U-00000000 - U-0000007F (same as ASCII)<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">};<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xE0</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xC0</span><span style="color: #007700">):<br>                        </span><span style="color: #FF8000">// characters U-00000080 - U-000007FF, mask 110XXXXX<br>                        // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                        </span><span style="color: #0000BB">$char </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'C*'</span><span style="color: #007700">, </span><span style="color: #0000BB">$ord_var_c</span><span style="color: #007700">, </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">}));<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>                        </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">=  </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(</span><span style="color: #0000BB">$char</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'\u%04s'</span><span style="color: #007700">, </span><span style="color: #0000BB">bin2hex</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">));<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xF0</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xE0</span><span style="color: #007700">):<br>                        </span><span style="color: #FF8000">// characters U-00000800 - U-0000FFFF, mask 1110XXXX<br>                        // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                        </span><span style="color: #0000BB">$char </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'C*'</span><span style="color: #007700">, </span><span style="color: #0000BB">$ord_var_c</span><span style="color: #007700">,<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">}));<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br>                        </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(</span><span style="color: #0000BB">$char</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'\u%04s'</span><span style="color: #007700">, </span><span style="color: #0000BB">bin2hex</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">));<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xF8</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xF0</span><span style="color: #007700">):<br>                        </span><span style="color: #FF8000">// characters U-00010000 - U-001FFFFF, mask 11110XXX<br>                        // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                        </span><span style="color: #0000BB">$char </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'C*'</span><span style="color: #007700">, </span><span style="color: #0000BB">$ord_var_c</span><span style="color: #007700">,<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">3</span><span style="color: #007700">}));<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br>                        </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(</span><span style="color: #0000BB">$char</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'\u%04s'</span><span style="color: #007700">, </span><span style="color: #0000BB">bin2hex</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">));<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xFC</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xF8</span><span style="color: #007700">):<br>                        </span><span style="color: #FF8000">// characters U-00200000 - U-03FFFFFF, mask 111110XX<br>                        // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                        </span><span style="color: #0000BB">$char </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'C*'</span><span style="color: #007700">, </span><span style="color: #0000BB">$ord_var_c</span><span style="color: #007700">,<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">3</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">4</span><span style="color: #007700">}));<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br>                        </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(</span><span style="color: #0000BB">$char</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'\u%04s'</span><span style="color: #007700">, </span><span style="color: #0000BB">bin2hex</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">));<br>                        break;<br><br>                    case ((</span><span style="color: #0000BB">$ord_var_c </span><span style="color: #007700">&amp; </span><span style="color: #0000BB">0xFE</span><span style="color: #007700">) == </span><span style="color: #0000BB">0xFC</span><span style="color: #007700">):<br>                        </span><span style="color: #FF8000">// characters U-04000000 - U-7FFFFFFF, mask 1111110X<br>                        // see http://www.cl.cam.ac.uk/~mgk25/unicode.html#utf-8<br>                        </span><span style="color: #0000BB">$char </span><span style="color: #007700">= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'C*'</span><span style="color: #007700">, </span><span style="color: #0000BB">$ord_var_c</span><span style="color: #007700">,<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">2</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">3</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">4</span><span style="color: #007700">}),<br>                                     </span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">{</span><span style="color: #0000BB">$c</span><span style="color: #007700">+</span><span style="color: #0000BB">5</span><span style="color: #007700">}));<br>                        </span><span style="color: #0000BB">$c</span><span style="color: #007700">+=</span><span style="color: #0000BB">5</span><span style="color: #007700">;<br>                        </span><span style="color: #0000BB">$utf16 </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(</span><span style="color: #0000BB">$char</span><span style="color: #007700">);<br>                        </span><span style="color: #0000BB">$ascii </span><span style="color: #007700">.= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'\u%04s'</span><span style="color: #007700">, </span><span style="color: #0000BB">bin2hex</span><span style="color: #007700">(</span><span style="color: #0000BB">$utf16</span><span style="color: #007700">));<br>                        break;<br>                }<br>            }<br><br>            return </span><span style="color: #DD0000">'"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$ascii</span><span style="color: #007700">.</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'array'</span><span style="color: #007700">:<br>           </span><span style="color: #FF8000">/*<br>            * As per JSON spec if any array key is not an integer<br>            * we must treat the the whole array as an object. We<br>            * also try to catch a sparsely populated associative<br>            * array with numeric keys here because some JS engines<br>            * will create an array with empty indexes up to<br>            * max_index which can cause memory issues and because<br>            * the keys, which may be relevant, will be remapped<br>            * otherwise.<br>            *<br>            * As per the ECMA and JSON specification an object may<br>            * have any string as a property. Unfortunately due to<br>            * a hole in the ECMA specification if the key is a<br>            * ECMA reserved word or starts with a digit the<br>            * parameter is only accessible using ECMAScript's<br>            * bracket notation.<br>            */<br><br>            // treat as a JSON object<br>            </span><span style="color: #007700">if (</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">) &amp;&amp; </span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">) &amp;&amp; (</span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">) !== </span><span style="color: #0000BB">range</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">) - </span><span style="color: #0000BB">1</span><span style="color: #007700">))) {<br>                return </span><span style="color: #DD0000">'{' </span><span style="color: #007700">.<br>                       </span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">, </span><span style="color: #0000BB">array_map</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'CJSON'</span><span style="color: #007700">, </span><span style="color: #DD0000">'nameValue'</span><span style="color: #007700">),<br>                                           </span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">),<br>                                           </span><span style="color: #0000BB">array_values</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">)))<br>                       . </span><span style="color: #DD0000">'}'</span><span style="color: #007700">;<br>            }<br><br>            </span><span style="color: #FF8000">// treat it like a regular array<br>            </span><span style="color: #007700">return </span><span style="color: #DD0000">'[' </span><span style="color: #007700">. </span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">, </span><span style="color: #0000BB">array_map</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'CJSON'</span><span style="color: #007700">, </span><span style="color: #DD0000">'encode'</span><span style="color: #007700">), </span><span style="color: #0000BB">$var</span><span style="color: #007700">)) . </span><span style="color: #DD0000">']'</span><span style="color: #007700">;<br><br>        case </span><span style="color: #DD0000">'object'</span><span style="color: #007700">:<br>            </span><span style="color: #FF8000">// Check for the JsonSerializable interface available in PHP5.4<br>            // Note that instanceof returns false in case it doesnt know the interface.<br>            </span><span style="color: #007700">if (</span><span style="color: #0000BB">interface_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'JsonSerializable'</span><span style="color: #007700">, </span><span style="color: #0000BB">false</span><span style="color: #007700">) &amp;&amp; </span><span style="color: #0000BB">$var </span><span style="color: #007700">instanceof </span><span style="color: #0000BB">JsonSerializable</span><span style="color: #007700">)<br>            {<br>                </span><span style="color: #FF8000">// We use the function defined in the interface instead of json_encode.<br>                // This way even for PHP &lt; 5.4 one could define the interface and use it.<br>                </span><span style="color: #007700">return </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">jsonSerialize</span><span style="color: #007700">());<br>            }<br>            elseif (</span><span style="color: #0000BB">$var </span><span style="color: #007700">instanceof </span><span style="color: #0000BB">Traversable</span><span style="color: #007700">)<br>            {<br>                </span><span style="color: #0000BB">$vars </span><span style="color: #007700">= array();<br>                foreach (</span><span style="color: #0000BB">$var </span><span style="color: #007700">as </span><span style="color: #0000BB">$k</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)<br>                    </span><span style="color: #0000BB">$vars</span><span style="color: #007700">[</span><span style="color: #0000BB">$k</span><span style="color: #007700">] = </span><span style="color: #0000BB">$v</span><span style="color: #007700">;<br>            }<br>            else<br>                </span><span style="color: #0000BB">$vars </span><span style="color: #007700">= </span><span style="color: #0000BB">get_object_vars</span><span style="color: #007700">(</span><span style="color: #0000BB">$var</span><span style="color: #007700">);<br>            return </span><span style="color: #DD0000">'{' </span><span style="color: #007700">.<br>                   </span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">, </span><span style="color: #0000BB">array_map</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'CJSON'</span><span style="color: #007700">, </span><span style="color: #DD0000">'nameValue'</span><span style="color: #007700">),<br>                                       </span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$vars</span><span style="color: #007700">),<br>                                       </span><span style="color: #0000BB">array_values</span><span style="color: #007700">(</span><span style="color: #0000BB">$vars</span><span style="color: #007700">)))<br>                   . </span><span style="color: #DD0000">'}'</span><span style="color: #007700">;<br><br>        default:<br>            return </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>    }<br>}</span></pre> </div> <p>Encodes an arbitrary variable into JSON format</p> <h3 class="detailHeader" id="nameValue-detail"> nameValue() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>nameValue</b>(string $name, mixed $value)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">name of key to use</td> </tr> <tr> <td class="paramNameCol">$value</td> <td class="paramTypeCol">mixed</td> <td class="paramDescCol">reference to an array element to be encoded</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">JSON-formatted name-value pair, like '"name":value'</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L290">framework/web/helpers/CJSON.php#290</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">nameValue</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">strval</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)) . </span><span style="color: #DD0000">':' </span><span style="color: #007700">. </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br>}</span></pre> </div> <p>array-walking function for use in generating JSON-formatted name-value pairs</p> <h3 class="detailHeader" id="reduceString-detail"> reduceString() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>reduceString</b>(string $str)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string value to strip of comments and whitespace</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string value stripped of comments and whitespace</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L303">framework/web/helpers/CJSON.php#303</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">reduceString</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$str </span><span style="color: #007700">= </span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(array(<br><br>            </span><span style="color: #FF8000">// eliminate single line comments in '// ...' form<br>            </span><span style="color: #DD0000">'#^\s*//(.+)$#m'</span><span style="color: #007700">,<br><br>            </span><span style="color: #FF8000">// eliminate multi-line comments in '/* ... */' form, at start of string<br>            </span><span style="color: #DD0000">'#^\s*/\*(.+)\*/#Us'</span><span style="color: #007700">,<br><br>            </span><span style="color: #FF8000">// eliminate multi-line comments in '/* ... */' form, at end of string<br>            </span><span style="color: #DD0000">'#/\*(.+)\*/\s*$#Us'<br><br>        </span><span style="color: #007700">), </span><span style="color: #DD0000">''</span><span style="color: #007700">, </span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br><br>    </span><span style="color: #FF8000">// eliminate extraneous space<br>    </span><span style="color: #007700">return </span><span style="color: #0000BB">trim</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br>}</span></pre> </div> <p>reduce a string by removing leading and trailing comments and whitespace</p> <h3 class="detailHeader" id="unicodeToUTF8-detail"> unicodeToUTF8() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>unicodeToUTF8</b>(string &amp;$str)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string to convert</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol"></td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L661">framework/web/helpers/CJSON.php#661</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">unicodeToUTF8</span><span style="color: #007700">( &amp;</span><span style="color: #0000BB">$str </span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$utf8 </span><span style="color: #007700">= </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>    foreach( </span><span style="color: #0000BB">$str </span><span style="color: #007700">as </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">)<br>    {<br>        if ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">128 </span><span style="color: #007700">)<br>        {<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">);<br>        }<br>        elseif ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">2048 </span><span style="color: #007700">)<br>        {<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">192 </span><span style="color: #007700">+  ( ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">- ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">64 </span><span style="color: #007700">) ) / </span><span style="color: #0000BB">64 </span><span style="color: #007700">) );<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">128 </span><span style="color: #007700">+ ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">64 </span><span style="color: #007700">) );<br>        }<br>        else<br>        {<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">224 </span><span style="color: #007700">+ ( ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">- ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">4096 </span><span style="color: #007700">) ) / </span><span style="color: #0000BB">4096 </span><span style="color: #007700">) );<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">128 </span><span style="color: #007700">+ ( ( ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">4096 </span><span style="color: #007700">) - ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">64 </span><span style="color: #007700">) ) / </span><span style="color: #0000BB">64 </span><span style="color: #007700">) );<br>            </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">.= </span><span style="color: #0000BB">chr</span><span style="color: #007700">( </span><span style="color: #0000BB">128 </span><span style="color: #007700">+ ( </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">% </span><span style="color: #0000BB">64 </span><span style="color: #007700">) );<br>        }<br>    }<br>    return </span><span style="color: #0000BB">$utf8</span><span style="color: #007700">;<br>}</span></pre> </div> <p>This function converts a Unicode array back to its UTF-8 representation</p> <div class="SeeAlso"> <h4>See Also</h4> <ul> <li><a href="cjson#utf8ToUnicode">utf8ToUnicode()</a></li> </ul> </div> <h3 class="detailHeader" id="utf16beToUTF8-detail"> utf16beToUTF8() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>utf16beToUTF8</b>(string &amp;$str)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string to convert</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol"></td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L712">framework/web/helpers/CJSON.php#712</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">utf16beToUTF8</span><span style="color: #007700">(&amp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$uni </span><span style="color: #007700">= </span><span style="color: #0000BB">unpack</span><span style="color: #007700">(</span><span style="color: #DD0000">'n*'</span><span style="color: #007700">,</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">unicodeToUTF8</span><span style="color: #007700">(</span><span style="color: #0000BB">$uni</span><span style="color: #007700">);<br>}</span></pre> </div> <p>UTF-8 to UTF-16BE conversion. <br><br> Maybe really UCS-2 without mb_string due to utf8ToUnicode limits</p> <h3 class="detailHeader" id="utf8ToUTF16BE-detail"> utf8ToUTF16BE() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>utf8ToUTF16BE</b>(string &amp;$str, boolean $bom=false)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string to convert</td> </tr> <tr> <td class="paramNameCol">$bom</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to output BOM header</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol"></td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L693">framework/web/helpers/CJSON.php#693</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">utf8ToUTF16BE</span><span style="color: #007700">(&amp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">, </span><span style="color: #0000BB">$bom </span><span style="color: #007700">= </span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$out </span><span style="color: #007700">= </span><span style="color: #0000BB">$bom </span><span style="color: #007700">? </span><span style="color: #DD0000">"\xFE\xFF" </span><span style="color: #007700">: </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'mb_convert_encoding'</span><span style="color: #007700">))<br>        return </span><span style="color: #0000BB">$out</span><span style="color: #007700">.</span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,</span><span style="color: #DD0000">'UTF-16BE'</span><span style="color: #007700">,</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">);<br><br>    </span><span style="color: #0000BB">$uni </span><span style="color: #007700">= </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">utf8ToUnicode</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br>    foreach(</span><span style="color: #0000BB">$uni </span><span style="color: #007700">as </span><span style="color: #0000BB">$cp</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$out </span><span style="color: #007700">.= </span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">'n'</span><span style="color: #007700">,</span><span style="color: #0000BB">$cp</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">$out</span><span style="color: #007700">;<br>}</span></pre> </div> <p>UTF-8 to UTF-16BE conversion. <br><br> Maybe really UCS-2 without mb_string due to utf8ToUnicode limits</p> <h3 class="detailHeader" id="utf8ToUnicode-detail"> utf8ToUnicode() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static string <b>utf8ToUnicode</b>(string &amp;$str)</pre> </td></tr> <tr> <td class="paramNameCol">$str</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">string to convert</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol"></td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/web/helpers/CJSON.php#L623">framework/web/helpers/CJSON.php#623</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">utf8ToUnicode</span><span style="color: #007700">( &amp;</span><span style="color: #0000BB">$str </span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$unicode </span><span style="color: #007700">= array();<br>    </span><span style="color: #0000BB">$values </span><span style="color: #007700">= array();<br>    </span><span style="color: #0000BB">$lookingFor </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br><br>    for (</span><span style="color: #0000BB">$i </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">; </span><span style="color: #0000BB">$i </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">strlen</span><span style="color: #007700">( </span><span style="color: #0000BB">$str </span><span style="color: #007700">); </span><span style="color: #0000BB">$i</span><span style="color: #007700">++ )<br>    {<br>        </span><span style="color: #0000BB">$thisValue </span><span style="color: #007700">= </span><span style="color: #0000BB">ord</span><span style="color: #007700">( </span><span style="color: #0000BB">$str</span><span style="color: #007700">[ </span><span style="color: #0000BB">$i </span><span style="color: #007700">] );<br>        if ( </span><span style="color: #0000BB">$thisValue </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">128 </span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$unicode</span><span style="color: #007700">[] = </span><span style="color: #0000BB">$thisValue</span><span style="color: #007700">;<br>        else<br>        {<br>            if ( </span><span style="color: #0000BB">count</span><span style="color: #007700">( </span><span style="color: #0000BB">$values </span><span style="color: #007700">) == </span><span style="color: #0000BB">0 </span><span style="color: #007700">)<br>                </span><span style="color: #0000BB">$lookingFor </span><span style="color: #007700">= ( </span><span style="color: #0000BB">$thisValue </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">224 </span><span style="color: #007700">) ? </span><span style="color: #0000BB">2 </span><span style="color: #007700">: </span><span style="color: #0000BB">3</span><span style="color: #007700">;<br>            </span><span style="color: #0000BB">$values</span><span style="color: #007700">[] = </span><span style="color: #0000BB">$thisValue</span><span style="color: #007700">;<br>            if ( </span><span style="color: #0000BB">count</span><span style="color: #007700">( </span><span style="color: #0000BB">$values </span><span style="color: #007700">) == </span><span style="color: #0000BB">$lookingFor </span><span style="color: #007700">)<br>            {<br>                </span><span style="color: #0000BB">$number </span><span style="color: #007700">= ( </span><span style="color: #0000BB">$lookingFor </span><span style="color: #007700">== </span><span style="color: #0000BB">3 </span><span style="color: #007700">) ?<br>                    ( ( </span><span style="color: #0000BB">$values</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">] % </span><span style="color: #0000BB">16 </span><span style="color: #007700">) * </span><span style="color: #0000BB">4096 </span><span style="color: #007700">) + ( ( </span><span style="color: #0000BB">$values</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">] % </span><span style="color: #0000BB">64 </span><span style="color: #007700">) * </span><span style="color: #0000BB">64 </span><span style="color: #007700">) + ( </span><span style="color: #0000BB">$values</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">] % </span><span style="color: #0000BB">64 </span><span style="color: #007700">):<br>                    ( ( </span><span style="color: #0000BB">$values</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">] % </span><span style="color: #0000BB">32 </span><span style="color: #007700">) * </span><span style="color: #0000BB">64 </span><span style="color: #007700">) + ( </span><span style="color: #0000BB">$values</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">] % </span><span style="color: #0000BB">64 </span><span style="color: #007700">);<br>                </span><span style="color: #0000BB">$unicode</span><span style="color: #007700">[] = </span><span style="color: #0000BB">$number</span><span style="color: #007700">;<br>                </span><span style="color: #0000BB">$values </span><span style="color: #007700">= array();<br>                </span><span style="color: #0000BB">$lookingFor </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>            }<br>        }<br>    }<br>    return </span><span style="color: #0000BB">$unicode</span><span style="color: #007700">;<br>}</span></pre> </div> <p>This function returns any UTF-8 encoded text as a list of Unicode values:</p> <div class="SeeAlso"> <h4>See Also</h4> <ul> <li><a href="cjson#unicodeToUTF8">unicodeToUTF8()</a></li> </ul> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CJSON" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CJSON</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

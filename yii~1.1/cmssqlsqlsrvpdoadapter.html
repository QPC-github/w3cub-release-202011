
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CMssqlSqlsrvPdoAdapter - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content="Returns last inserted ID value. SQLSRV driver supports PDO&#58;&#58;lastInsertId() with one peculiarity&#58; when &#36;sequence&#39;s value is null &hellip;">
  <meta name="keywords" content="cmssqlsqlsrvpdoadapter, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cmssqlsqlsrvpdoadapter.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/yii~1.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CMssqlSqlsrvPdoAdapter</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.db.schema.mssql">system.db.schema.mssql</a></td> </tr> <tr> <th>Inheritance</th> <td>class CMssqlSqlsrvPdoAdapter » PDO</td> </tr> <tr> <th>Since</th> <td>1.1.13</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSqlsrvPdoAdapter.php">framework/db/schema/mssql/CMssqlSqlsrvPdoAdapter.php</a></td> </tr> </table> <div id="classDescription"> This is an extension of default PDO class for MSSQL SQLSRV driver only. It provides workaround of the improperly implemented functionalities of PDO SQLSRV driver.</div>   <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr class="inherited" id="__construct"> <td>__construct()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="__sleep"> <td>__sleep()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="__wakeup"> <td>__wakeup()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="beginTransaction"> <td>beginTransaction()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="commit"> <td>commit()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="errorCode"> <td>errorCode()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="errorInfo"> <td>errorInfo()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="exec"> <td>exec()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="getAttribute"> <td>getAttribute()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="getAvailableDrivers"> <td>getAvailableDrivers()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="inTransaction"> <td>inTransaction()</td> <td></td> <td>PDO</td> </tr> <tr id="lastInsertId"> <td><a href="cmssqlsqlsrvpdoadapter#lastInsertId-detail">lastInsertId()</a></td> <td>Returns last inserted ID value.</td> <td>CMssqlSqlsrvPdoAdapter</td> </tr> <tr class="inherited" id="prepare"> <td>prepare()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="query"> <td>query()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="quote"> <td>quote()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="rollBack"> <td>rollBack()</td> <td></td> <td>PDO</td> </tr> <tr class="inherited" id="setAttribute"> <td>setAttribute()</td> <td></td> <td>PDO</td> </tr> </table> </div>  <h2>Method Details</h2> <h3 class="detailHeader" id="lastInsertId-detail"> lastInsertId() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public integer <b>lastInsertId</b>(string|null $sequence=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$sequence</td> <td class="paramTypeCol">string|null</td> <td class="paramDescCol">the sequence name. Defaults to null.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">integer</td> <td class="paramDescCol">last inserted ID value.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSqlsrvPdoAdapter.php#L30">framework/db/schema/mssql/CMssqlSqlsrvPdoAdapter.php#30</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>    if(!</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">();<br>    return </span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Returns last inserted ID value. SQLSRV driver supports PDO::lastInsertId() with one peculiarity: when $sequence's value is null or empty string it returns empty string. But when parameter is not specified at all it's working as expected and returns actual last inserted ID (like other PDO drivers).</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CMssqlSqlsrvPdoAdapter" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CMssqlSqlsrvPdoAdapter</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

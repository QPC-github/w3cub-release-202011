
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CPasswordHelper - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content=" Check for availability of PHP crypt() with the Blowfish hash option. ">
  <meta name="keywords" content="cpasswordhelper, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cpasswordhelper.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/yii~1.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CPasswordHelper</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.utils">system.utils</a></td> </tr> <tr> <th>Inheritance</th> <td>class CPasswordHelper</td> </tr> <tr> <th>Since</th> <td>1.1.14</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php">framework/utils/CPasswordHelper.php</a></td> </tr> </table> <div id="classDescription"> CPasswordHelper provides a simple API for secure password hashing and verification. <br><br> CPasswordHelper uses the Blowfish hash algorithm available in many PHP runtime environments through the PHP <a href="http://php.net/manual/en/function.crypt.php">crypt()</a> built-in function. As of Dec 2012 it is the strongest algorithm available in PHP and the only algorithm without some security concerns surrounding it. For this reason, CPasswordHelper fails when run in an environment that does not have crypt() with its Blowfish option and $2y hash fix. Compatible system is: <br><br> (1) Most *nix systems since PHP 4 (the algorithm is part of the library function crypt(3)); (2) Any PHP since 5.3.7 or PHP with the <a href="http://www.hardened-php.net/suhosin/">Suhosin patch</a> including $2y fix backported. Note that Debian's 5.3.3 is not supported. <br><br> For more information about password hashing, crypt() and Blowfish, please read the Yii Wiki article <a href="http://www.yiiframework.com/wiki/425/use-crypt-for-password-storage/">Use crypt() for password storage</a>. and the PHP RFC <a href="http://wiki.php.net/rfc/password_hash">Adding simple password hashing API</a>. <br><br> CPasswordHelper throws an exception if the Blowfish hash algorithm is not available in the runtime PHP's crypt() function. It can be used as follows <br><br> Generate a hash from a password: <pre>
$hash = CPasswordHelper::hashPassword($password);
</pre> This hash can be stored in a database (e.g. CHAR(60) CHARACTER SET latin1). The hash is usually generated and saved to the database when the user enters a new password. But it can also be useful to generate and save a hash after validating a user's password in order to change the cost or refresh the salt. <br><br> To verify a password, fetch the user's saved hash from the database (into $hash) and: <pre>
if (CPasswordHelper::verifyPassword($password, $hash))
    // password is good
else
    // password is bad
</pre>
</div>   <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="generateSalt"> <td><a href="cpasswordhelper#generateSalt-detail">generateSalt()</a></td> <td>Generates a salt that can be used to generate a password hash.</td> <td>CPasswordHelper</td> </tr> <tr id="hashPassword"> <td><a href="cpasswordhelper#hashPassword-detail">hashPassword()</a></td> <td>Generate a secure hash from a password and a random salt.</td> <td>CPasswordHelper</td> </tr> <tr id="same"> <td><a href="cpasswordhelper#same-detail">same()</a></td> <td>Check for sameness of two strings using an algorithm with timing</td> <td>CPasswordHelper</td> </tr> <tr id="verifyPassword"> <td><a href="cpasswordhelper#verifyPassword-detail">verifyPassword()</a></td> <td>Verify a password against a hash.</td> <td>CPasswordHelper</td> </tr> </table> </div> <div class="summary docMethod"> <h2>Protected Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="checkBlowfish"> <td><a href="cpasswordhelper#checkBlowfish-detail">checkBlowfish()</a></td> <td>Check for availability of PHP crypt() with the Blowfish hash option.</td> <td>CPasswordHelper</td> </tr> </table> </div>  <h2>Method Details</h2> <h3 class="detailHeader" id="checkBlowfish-detail"> checkBlowfish() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected static void <b>checkBlowfish</b>()</pre> </td></tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php#L61">framework/utils/CPasswordHelper.php#61</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected static function </span><span style="color: #0000BB">checkBlowfish</span><span style="color: #007700">()<br>{<br>    if(!</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'crypt'</span><span style="color: #007700">))<br>        throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'{class} requires the PHP crypt() function. This system does not have it.'</span><span style="color: #007700">,<br>            array(</span><span style="color: #DD0000">'{class}'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">)));<br><br>    if(!</span><span style="color: #0000BB">defined</span><span style="color: #007700">(</span><span style="color: #DD0000">'CRYPT_BLOWFISH'</span><span style="color: #007700">) || !</span><span style="color: #0000BB">CRYPT_BLOWFISH</span><span style="color: #007700">)<br>        throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,<br>            </span><span style="color: #DD0000">'{class} requires the Blowfish option of the PHP crypt() function. This system does not have it.'</span><span style="color: #007700">,<br>            array(</span><span style="color: #DD0000">'{class}'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">)));<br>}</span></pre> </div> <p>Check for availability of PHP crypt() with the Blowfish hash option.</p> <h3 class="detailHeader" id="generateSalt-detail"> generateSalt() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static string <b>generateSalt</b>(int $cost=13)</pre> </td></tr> <tr> <td class="paramNameCol">$cost</td> <td class="paramTypeCol">int</td> <td class="paramDescCol">Cost parameter used by the Blowfish hash algorithm.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the random salt value.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php#L181">framework/utils/CPasswordHelper.php#181</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">generateSalt</span><span style="color: #007700">(</span><span style="color: #0000BB">$cost</span><span style="color: #007700">=</span><span style="color: #0000BB">13</span><span style="color: #007700">)<br>{<br>    if(!</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$cost</span><span style="color: #007700">))<br>        throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'{class}::$cost must be a number.'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'{class}'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">)));<br><br>    </span><span style="color: #0000BB">$cost</span><span style="color: #007700">=(int)</span><span style="color: #0000BB">$cost</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">$cost</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">4 </span><span style="color: #007700">|| </span><span style="color: #0000BB">$cost</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">31</span><span style="color: #007700">)<br>        throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'{class}::$cost must be between 4 and 31.'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'{class}'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">)));<br><br>    if((</span><span style="color: #0000BB">$random</span><span style="color: #007700">=</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">app</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getSecurityManager</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">generateRandomString</span><span style="color: #007700">(</span><span style="color: #0000BB">22</span><span style="color: #007700">,</span><span style="color: #0000BB">true</span><span style="color: #007700">))===</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>        if((</span><span style="color: #0000BB">$random</span><span style="color: #007700">=</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">app</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getSecurityManager</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">generateRandomString</span><span style="color: #007700">(</span><span style="color: #0000BB">22</span><span style="color: #007700">,</span><span style="color: #0000BB">false</span><span style="color: #007700">))===</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>            throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Unable to generate random string.'</span><span style="color: #007700">));<br>    return </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">'$2y$%02d$'</span><span style="color: #007700">,</span><span style="color: #0000BB">$cost</span><span style="color: #007700">).</span><span style="color: #0000BB">strtr</span><span style="color: #007700">(</span><span style="color: #0000BB">$random</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'_'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #DD0000">'~'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'/'</span><span style="color: #007700">));<br>}</span></pre> </div> <p>Generates a salt that can be used to generate a password hash. <br><br> The PHP <a href="http://php.net/manual/en/function.crypt.php">crypt()</a> built-in function requires, for the Blowfish hash algorithm, a salt string in a specific format: "$2y$" (in which the "y" may be replaced by "a" or "y" see PHP manual for details), a two digit cost parameter, "$", 22 characters from the alphabet "./0-9A-Za-z".</p> <h3 class="detailHeader" id="hashPassword-detail"> hashPassword() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static string <b>hashPassword</b>(string $password, int $cost=13)</pre> </td></tr> <tr> <td class="paramNameCol">$password</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">The password to be hashed.</td> </tr> <tr> <td class="paramNameCol">$cost</td> <td class="paramTypeCol">int</td> <td class="paramDescCol">Cost parameter used by the Blowfish hash algorithm. The higher the value of cost, the longer it takes to generate the hash and to verify a password against it. Higher cost therefore slows down a brute-force attack. For best protection against brute for attacks, set it to the highest value that is tolerable on production servers. The time taken to compute the hash doubles for every increment by one of $cost. So, for example, if the hash takes 1 second to compute when $cost is 14 then then the compute time varies as 2^($cost - 14) seconds.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">The password hash string, always 60 ASCII characters.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php#L92">framework/utils/CPasswordHelper.php#92</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">,</span><span style="color: #0000BB">$cost</span><span style="color: #007700">=</span><span style="color: #0000BB">13</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">checkBlowfish</span><span style="color: #007700">();<br>    </span><span style="color: #0000BB">$salt</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">generateSalt</span><span style="color: #007700">(</span><span style="color: #0000BB">$cost</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$hash</span><span style="color: #007700">=</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">,</span><span style="color: #0000BB">$salt</span><span style="color: #007700">);<br><br>    if(!</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$hash</span><span style="color: #007700">) || (</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'mb_strlen'</span><span style="color: #007700">) ? </span><span style="color: #0000BB">mb_strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$hash</span><span style="color: #007700">, </span><span style="color: #DD0000">'8bit'</span><span style="color: #007700">) : </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$hash</span><span style="color: #007700">))&lt;</span><span style="color: #0000BB">32</span><span style="color: #007700">)<br>        throw new </span><span style="color: #0000BB">CException</span><span style="color: #007700">(</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'yii'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Internal error while generating hash.'</span><span style="color: #007700">));<br><br>    return </span><span style="color: #0000BB">$hash</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Generate a secure hash from a password and a random salt. <br><br> Uses the PHP <a href="http://php.net/manual/en/function.crypt.php">crypt()</a> built-in function with the Blowfish hash option.</p> <h3 class="detailHeader" id="same-detail"> same() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static bool <b>same</b>(string $a, string $b)</pre> </td></tr> <tr> <td class="paramNameCol">$a</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">First subject string to compare.</td> </tr> <tr> <td class="paramNameCol">$b</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">Second subject string to compare.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">bool</td> <td class="paramDescCol">true if the strings are the same, false if they are different or if either is not a string.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php#L150">framework/utils/CPasswordHelper.php#150</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">same</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,</span><span style="color: #0000BB">$b</span><span style="color: #007700">)<br>{<br>    if(!</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">) || !</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">))<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    </span><span style="color: #0000BB">$mb</span><span style="color: #007700">=</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'mb_strlen'</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$length</span><span style="color: #007700">=</span><span style="color: #0000BB">$mb </span><span style="color: #007700">? </span><span style="color: #0000BB">mb_strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,</span><span style="color: #DD0000">'8bit'</span><span style="color: #007700">) : </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">);<br>    if(</span><span style="color: #0000BB">$length</span><span style="color: #007700">!==(</span><span style="color: #0000BB">$mb </span><span style="color: #007700">? </span><span style="color: #0000BB">mb_strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">,</span><span style="color: #DD0000">'8bit'</span><span style="color: #007700">) : </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">)))<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    </span><span style="color: #0000BB">$check</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br>    for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">$length</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">+=</span><span style="color: #0000BB">1</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$check</span><span style="color: #007700">|=(</span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">])^</span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]));<br><br>    return </span><span style="color: #0000BB">$check</span><span style="color: #007700">===</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Check for sameness of two strings using an algorithm with timing independent of the string values if the subject strings are of equal length. <br><br> The function can be useful to prevent timing attacks. For example, if $a and $b are both hash values from the same algorithm, then the timing of this function does not reveal whether or not there is a match. <br><br> NOTE: timing is affected if $a and $b are different lengths or either is not a string. For the purpose of checking password hash this does not reveal information useful to an attacker.</p> <div class="SeeAlso"> <h4>See Also</h4> <ul> <li><a href="http://blog.astrumfutura.com/2010/10/nanosecond-scale-remote-timing-attacks-on-php-applications-time-to-take-them-seriously/">http://blog.astrumfutura.com/2010/10/nanosecond-scale-remote-timing-attacks-on-php-applications-time-to-take-them-seriously/</a></li> <li><a href="http://codereview.stackexchange.com/questions/13512">http://codereview.stackexchange.com/questions/13512</a></li> <li><a href="https://github.com/ircmaxell/password_compat/blob/master/lib/password.php">https://github.com/ircmaxell/password_compat/blob/master/lib/password.php</a></li> </ul> </div> <h3 class="detailHeader" id="verifyPassword-detail"> verifyPassword() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public static bool <b>verifyPassword</b>(string $password, string $hash)</pre> </td></tr> <tr> <td class="paramNameCol">$password</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">The password to verify. If password is empty or not a string, method will return false.</td> </tr> <tr> <td class="paramNameCol">$hash</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">The hash to verify the password against.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">bool</td> <td class="paramDescCol">True if the password matches the hash.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/utils/CPasswordHelper.php#L112">framework/utils/CPasswordHelper.php#112</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public static function </span><span style="color: #0000BB">verifyPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">, </span><span style="color: #0000BB">$hash</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">checkBlowfish</span><span style="color: #007700">();<br>    if(!</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">) || </span><span style="color: #0000BB">$password</span><span style="color: #007700">===</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    if (!</span><span style="color: #0000BB">$password </span><span style="color: #007700">|| !</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'{^\$2[axy]\$(\d\d)\$[\./0-9A-Za-z]{22}}'</span><span style="color: #007700">,</span><span style="color: #0000BB">$hash</span><span style="color: #007700">,</span><span style="color: #0000BB">$matches</span><span style="color: #007700">) ||<br>        </span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&lt;</span><span style="color: #0000BB">4 </span><span style="color: #007700">|| </span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&gt;</span><span style="color: #0000BB">31</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    </span><span style="color: #0000BB">$test</span><span style="color: #007700">=</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">,</span><span style="color: #0000BB">$hash</span><span style="color: #007700">);<br>    if(!</span><span style="color: #0000BB">is_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$test</span><span style="color: #007700">) || </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$test</span><span style="color: #007700">)&lt;</span><span style="color: #0000BB">32</span><span style="color: #007700">)<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br><br>    return </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">same</span><span style="color: #007700">(</span><span style="color: #0000BB">$test</span><span style="color: #007700">, </span><span style="color: #0000BB">$hash</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Verify a password against a hash.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CPasswordHelper" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CPasswordHelper</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>CMssqlSchema - Yii 1.1 - W3cubDocs</title>
  
  <meta name="description" content=" the abstract column types mapped to physical column types. ">
  <meta name="keywords" content="cmssqlschema, yii, yii~1.1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/yii~1.1/cmssqlschema.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/yii~1.1.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/yii~1.1/" class="_nav-link" title="" style="margin-left:0;">Yii 1.1</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _yii">
				
				
<h1>CMssqlSchema</h1>  <table class="summaryTable docClass"> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr> <th>Package</th> <td><a href="index#system.db.schema.mssql">system.db.schema.mssql</a></td> </tr> <tr> <th>Inheritance</th> <td>class CMssqlSchema » <a href="cdbschema">CDbSchema</a> » <a href="ccomponent">CComponent</a>
</td> </tr> <tr> <th>Source Code</th> <td><a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php">framework/db/schema/mssql/CMssqlSchema.php</a></td> </tr> </table> <div id="classDescription"> CMssqlSchema is the class for retrieving metadata information from a MS SQL Server database.</div>  <div class="summary docProperty"> <h2>Public Properties</h2>  <table class="summaryTable"> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="columnTypes"> <td><a href="cmssqlschema#columnTypes-detail">columnTypes</a></td> <td>array</td> <td>the abstract column types mapped to physical column types.</td> <td>CMssqlSchema</td> </tr> <tr class="inherited" id="commandBuilder"> <td><a href="cdbschema#commandBuilder-detail">commandBuilder</a></td> <td><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td>the SQL command builder for this connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dbConnection"> <td><a href="cdbschema#dbConnection-detail">dbConnection</a></td> <td><a href="cdbconnection">CDbConnection</a></td> <td>database connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="tableNames"> <td><a href="cdbschema#tableNames-detail">tableNames</a></td> <td>array</td> <td>Returns all table names in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="tables"> <td><a href="cdbschema#tables-detail">tables</a></td> <td>array</td> <td>Returns the metadata for all tables in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> </table> </div>  <div class="summary docMethod"> <h2>Public Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr class="inherited" id="__call"> <td><a href="ccomponent#__call-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__construct"> <td><a href="cdbschema#__construct-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="__get"> <td><a href="ccomponent#__get-detail">__get()</a></td> <td>Returns a property value, an event handler list or a behavior based on its name.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__isset"> <td><a href="ccomponent#__isset-detail">__isset()</a></td> <td>Checks if a property value is null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__set"> <td><a href="ccomponent#__set-detail">__set()</a></td> <td>Sets value of a component property.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="__unset"> <td><a href="ccomponent#__unset-detail">__unset()</a></td> <td>Sets a component property to be null.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="addColumn"> <td><a href="cdbschema#addColumn-detail">addColumn()</a></td> <td>Builds a SQL statement for adding a new DB column.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="addForeignKey"> <td><a href="cdbschema#addForeignKey-detail">addForeignKey()</a></td> <td>Builds a SQL statement for adding a foreign key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="addPrimaryKey"> <td><a href="cdbschema#addPrimaryKey-detail">addPrimaryKey()</a></td> <td>Builds a SQL statement for adding a primary key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="alterColumn"> <td><a href="cmssqlschema#alterColumn-detail">alterColumn()</a></td> <td>Builds a SQL statement for changing the definition of a column.</td> <td>CMssqlSchema</td> </tr> <tr class="inherited" id="asa"> <td><a href="ccomponent#asa-detail">asa()</a></td> <td>Returns the named behavior object.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehavior"> <td><a href="ccomponent#attachBehavior-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachBehaviors"> <td><a href="ccomponent#attachBehaviors-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="attachEventHandler"> <td><a href="ccomponent#attachEventHandler-detail">attachEventHandler()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canGetProperty"> <td><a href="ccomponent#canGetProperty-detail">canGetProperty()</a></td> <td>Determines whether a property can be read.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="canSetProperty"> <td><a href="ccomponent#canSetProperty-detail">canSetProperty()</a></td> <td>Determines whether a property can be set.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr id="checkIntegrity"> <td><a href="cmssqlschema#checkIntegrity-detail">checkIntegrity()</a></td> <td>Enables or disables integrity check.</td> <td>CMssqlSchema</td> </tr> <tr id="compareTableNames"> <td><a href="cmssqlschema#compareTableNames-detail">compareTableNames()</a></td> <td>Compares two table names.</td> <td>CMssqlSchema</td> </tr> <tr class="inherited" id="createIndex"> <td><a href="cdbschema#createIndex-detail">createIndex()</a></td> <td>Builds a SQL statement for creating a new index.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="createTable"> <td><a href="cdbschema#createTable-detail">createTable()</a></td> <td>Builds a SQL statement for creating a new DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="detachBehavior"> <td><a href="ccomponent#detachBehavior-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachBehaviors"> <td><a href="ccomponent#detachBehaviors-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="detachEventHandler"> <td><a href="ccomponent#detachEventHandler-detail">detachEventHandler()</a></td> <td>Detaches an existing event handler.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehavior"> <td><a href="ccomponent#disableBehavior-detail">disableBehavior()</a></td> <td>Disables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="disableBehaviors"> <td><a href="ccomponent#disableBehaviors-detail">disableBehaviors()</a></td> <td>Disables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="dropColumn"> <td><a href="cdbschema#dropColumn-detail">dropColumn()</a></td> <td>Builds a SQL statement for dropping a DB column.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropForeignKey"> <td><a href="cdbschema#dropForeignKey-detail">dropForeignKey()</a></td> <td>Builds a SQL statement for dropping a foreign key constraint.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropIndex"> <td><a href="cdbschema#dropIndex-detail">dropIndex()</a></td> <td>Builds a SQL statement for dropping an index.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropPrimaryKey"> <td><a href="cdbschema#dropPrimaryKey-detail">dropPrimaryKey()</a></td> <td>Builds a SQL statement for removing a primary key constraint to an existing table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="dropTable"> <td><a href="cdbschema#dropTable-detail">dropTable()</a></td> <td>Builds a SQL statement for dropping a DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="enableBehavior"> <td><a href="ccomponent#enableBehavior-detail">enableBehavior()</a></td> <td>Enables an attached behavior.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="enableBehaviors"> <td><a href="ccomponent#enableBehaviors-detail">enableBehaviors()</a></td> <td>Enables all behaviors attached to this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="evaluateExpression"> <td><a href="ccomponent#evaluateExpression-detail">evaluateExpression()</a></td> <td>Evaluates a PHP expression or callback under the context of this component.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="getColumnType"> <td><a href="cdbschema#getColumnType-detail">getColumnType()</a></td> <td>Converts an abstract column type into a physical column type.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getCommandBuilder"> <td><a href="cdbschema#getCommandBuilder-detail">getCommandBuilder()</a></td> <td>Returns the SQL command builder for this connection.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getDbConnection"> <td><a href="cdbschema#getDbConnection-detail">getDbConnection()</a></td> <td>Returns database connection. The connection is active.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getEventHandlers"> <td><a href="ccomponent#getEventHandlers-detail">getEventHandlers()</a></td> <td>Returns the list of attached event handlers for an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="getTable"> <td><a href="cdbschema#getTable-detail">getTable()</a></td> <td>Obtains the metadata for the named table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getTableNames"> <td><a href="cdbschema#getTableNames-detail">getTableNames()</a></td> <td>Returns all table names in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="getTables"> <td><a href="cdbschema#getTables-detail">getTables()</a></td> <td>Returns the metadata for all tables in the database.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="hasEvent"> <td><a href="ccomponent#hasEvent-detail">hasEvent()</a></td> <td>Determines whether an event is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasEventHandler"> <td><a href="ccomponent#hasEventHandler-detail">hasEventHandler()</a></td> <td>Checks whether the named event has attached handlers.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="hasProperty"> <td><a href="ccomponent#hasProperty-detail">hasProperty()</a></td> <td>Determines whether a property is defined.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="quoteColumnName"> <td><a href="cdbschema#quoteColumnName-detail">quoteColumnName()</a></td> <td>Quotes a column name for use in a query.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="quoteSimpleColumnName"> <td><a href="cmssqlschema#quoteSimpleColumnName-detail">quoteSimpleColumnName()</a></td> <td>Quotes a column name for use in a query.</td> <td>CMssqlSchema</td> </tr> <tr id="quoteSimpleTableName"> <td><a href="cmssqlschema#quoteSimpleTableName-detail">quoteSimpleTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td>CMssqlSchema</td> </tr> <tr class="inherited" id="quoteTableName"> <td><a href="cdbschema#quoteTableName-detail">quoteTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr class="inherited" id="raiseEvent"> <td><a href="ccomponent#raiseEvent-detail">raiseEvent()</a></td> <td>Raises an event.</td> <td><a href="ccomponent">CComponent</a></td> </tr> <tr class="inherited" id="refresh"> <td><a href="cdbschema#refresh-detail">refresh()</a></td> <td>Refreshes the schema.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> <tr id="renameColumn"> <td><a href="cmssqlschema#renameColumn-detail">renameColumn()</a></td> <td>Builds a SQL statement for renaming a column.</td> <td>CMssqlSchema</td> </tr> <tr id="renameTable"> <td><a href="cmssqlschema#renameTable-detail">renameTable()</a></td> <td>Builds a SQL statement for renaming a DB table.</td> <td>CMssqlSchema</td> </tr> <tr id="resetSequence"> <td><a href="cmssqlschema#resetSequence-detail">resetSequence()</a></td> <td>Resets the sequence value of a table's primary key.</td> <td>CMssqlSchema</td> </tr> <tr class="inherited" id="truncateTable"> <td><a href="cdbschema#truncateTable-detail">truncateTable()</a></td> <td>Builds a SQL statement for truncating a DB table.</td> <td><a href="cdbschema">CDbSchema</a></td> </tr> </table> </div> <div class="summary docMethod"> <h2>Protected Methods</h2>  <table class="summaryTable"> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="createColumn"> <td><a href="cmssqlschema#createColumn-detail">createColumn()</a></td> <td>Creates a table column.</td> <td>CMssqlSchema</td> </tr> <tr id="createCommandBuilder"> <td><a href="cmssqlschema#createCommandBuilder-detail">createCommandBuilder()</a></td> <td>Creates a command builder for the database.</td> <td>CMssqlSchema</td> </tr> <tr id="findColumns"> <td><a href="cmssqlschema#findColumns-detail">findColumns()</a></td> <td>Collects the table column metadata.</td> <td>CMssqlSchema</td> </tr> <tr id="findForeignKeys"> <td><a href="cmssqlschema#findForeignKeys-detail">findForeignKeys()</a></td> <td>Gets foreign relationship constraint keys and table name</td> <td>CMssqlSchema</td> </tr> <tr id="findPrimaryKey"> <td><a href="cmssqlschema#findPrimaryKey-detail">findPrimaryKey()</a></td> <td>Gets the primary key column(s) details for the given table.</td> <td>CMssqlSchema</td> </tr> <tr id="findTableNames"> <td><a href="cmssqlschema#findTableNames-detail">findTableNames()</a></td> <td>Returns all table names in the database.</td> <td>CMssqlSchema</td> </tr> <tr id="loadTable"> <td><a href="cmssqlschema#loadTable-detail">loadTable()</a></td> <td>Loads the metadata for the specified table.</td> <td>CMssqlSchema</td> </tr> <tr id="resolveTableNames"> <td><a href="cmssqlschema#resolveTableNames-detail">resolveTableNames()</a></td> <td>Generates various kinds of table names.</td> <td>CMssqlSchema</td> </tr> </table> </div>  <h2>Property Details</h2> <h3 class="detailHeader" id="columnTypes-detail"> columnTypes<span class="detailHeaderTag"> property (available since v1.1.6) </span> </h3> <pre class="signature">public array <b>$columnTypes</b>;</pre> <p>the abstract column types mapped to physical column types.</p> <h2>Method Details</h2> <h3 class="detailHeader" id="alterColumn-detail"> alterColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>alterColumn</b>(string $table, string $column, string $type)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be changed. The table name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the name of the column to be changed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$type</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new column type. The <a href="cmssqlschema#getColumnType">getColumnType</a> method will be invoked to convert abstract column type (if any) into the physical one. Anything that is not recognized as abstract type will be kept in the generated SQL. For example, 'string' will be turned into 'varchar(255)', while 'string not null' will become 'varchar(255) not null'.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for changing the definition of a column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L433">framework/db/schema/mssql/CMssqlSchema.php#433</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">alterColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$column</span><span style="color: #007700">, </span><span style="color: #0000BB">$type</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$type</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">'ALTER TABLE ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">) . </span><span style="color: #DD0000">' ALTER COLUMN '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">) . </span><span style="color: #DD0000">' '<br>        </span><span style="color: #007700">. </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getColumnType</span><span style="color: #007700">(</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">$sql</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for changing the definition of a column.</p> <h3 class="detailHeader" id="checkIntegrity-detail"> checkIntegrity() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>checkIntegrity</b>(boolean $check=true, string $schema='')</pre> </td></tr> <tr> <td class="paramNameCol">$check</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to turn on or off the integrity check.</td> </tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L116">framework/db/schema/mssql/CMssqlSchema.php#116</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">checkIntegrity</span><span style="color: #007700">(</span><span style="color: #0000BB">$check</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">,</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$enable</span><span style="color: #007700">=</span><span style="color: #0000BB">$check </span><span style="color: #007700">? </span><span style="color: #DD0000">'CHECK' </span><span style="color: #007700">: </span><span style="color: #DD0000">'NOCHECK'</span><span style="color: #007700">;<br>    if(!isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_normalTables</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">]))<br>        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_normalTables</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">]=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">,</span><span style="color: #0000BB">false</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$db</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">();<br>    foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_normalTables</span><span style="color: #007700">[</span><span style="color: #0000BB">$schema</span><span style="color: #007700">] as </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$tableName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$tableName</span><span style="color: #007700">);<br>        </span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">"ALTER TABLE </span><span style="color: #0000BB">$tableName</span><span style="color: #0000BB">$enable</span><span style="color: #DD0000"> CONSTRAINT ALL"</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br>    }<br>}</span></pre> </div> <p>Enables or disables integrity check.</p> <h3 class="detailHeader" id="compareTableNames-detail"> compareTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public boolean <b>compareTableNames</b>(string $name1, string $name2)</pre> </td></tr> <tr> <td class="paramNameCol">$name1</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name 1</td> </tr> <tr> <td class="paramNameCol">$name2</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name 2</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether the two table names refer to the same table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L76">framework/db/schema/mssql/CMssqlSchema.php#76</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">compareTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">,</span><span style="color: #0000BB">$name2</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$name1</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'['</span><span style="color: #007700">,</span><span style="color: #DD0000">']'</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name1</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$name2</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'['</span><span style="color: #007700">,</span><span style="color: #DD0000">']'</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name2</span><span style="color: #007700">);<br>    return </span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">compareTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$name1</span><span style="color: #007700">),</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$name2</span><span style="color: #007700">));<br>}</span></pre> </div> <p>Compares two table names. The table names can be either quoted or unquoted. This method will consider both cases.</p> <h3 class="detailHeader" id="createColumn-detail"> createColumn() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cdbcolumnschema">CDbColumnSchema</a> <b>createColumn</b>(array $column)</pre> </td></tr> <tr> <td class="paramNameCol">$column</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">column metadata</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbcolumnschema">CDbColumnSchema</a></td> <td class="paramDescCol">normalized column metadata</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L331">framework/db/schema/mssql/CMssqlSchema.php#331</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">createColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">=new </span><span style="color: #0000BB">CMssqlColumnSchema</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'COLUMN_NAME'</span><span style="color: #007700">];<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allowNull</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'IS_NULLABLE'</span><span style="color: #007700">]==</span><span style="color: #DD0000">'YES'</span><span style="color: #007700">;<br>    if (</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'NUMERIC_PRECISION_RADIX'</span><span style="color: #007700">]!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #FF8000">// We have a numeric datatype<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">size</span><span style="color: #007700">=</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">precision</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'NUMERIC_PRECISION'</span><span style="color: #007700">]!==</span><span style="color: #0000BB">null</span><span style="color: #007700">?(int)</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'NUMERIC_PRECISION'</span><span style="color: #007700">]:</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">scale</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'NUMERIC_SCALE'</span><span style="color: #007700">]!==</span><span style="color: #0000BB">null</span><span style="color: #007700">?(int)</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'NUMERIC_SCALE'</span><span style="color: #007700">]:</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>    }<br>    elseif (</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'DATA_TYPE'</span><span style="color: #007700">]==</span><span style="color: #DD0000">'image' </span><span style="color: #007700">|| </span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'DATA_TYPE'</span><span style="color: #007700">]==</span><span style="color: #DD0000">'text'</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">size</span><span style="color: #007700">=</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">precision</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>    else<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">size</span><span style="color: #007700">=</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">precision</span><span style="color: #007700">=(</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'CHARACTER_MAXIMUM_LENGTH'</span><span style="color: #007700">]!== </span><span style="color: #0000BB">null</span><span style="color: #007700">)?(int)</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'CHARACTER_MAXIMUM_LENGTH'</span><span style="color: #007700">]:</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">autoIncrement</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'IsIdentity'</span><span style="color: #007700">]==</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">comment</span><span style="color: #007700">=</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'Comment'</span><span style="color: #007700">]===</span><span style="color: #0000BB">null </span><span style="color: #007700">? </span><span style="color: #DD0000">'' </span><span style="color: #007700">: </span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'Comment'</span><span style="color: #007700">];<br><br>    </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">init</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'DATA_TYPE'</span><span style="color: #007700">],</span><span style="color: #0000BB">$column</span><span style="color: #007700">[</span><span style="color: #DD0000">'COLUMN_DEFAULT'</span><span style="color: #007700">]);<br>    return </span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Creates a table column.</p> <h3 class="detailHeader" id="createCommandBuilder-detail"> createCommandBuilder() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cdbcommandbuilder">CDbCommandBuilder</a> <b>createCommandBuilder</b>()</pre> </td></tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cdbcommandbuilder">CDbCommandBuilder</a></td> <td class="paramDescCol">command builder instance</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L393">framework/db/schema/mssql/CMssqlSchema.php#393</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">createCommandBuilder</span><span style="color: #007700">()<br>{<br>    return new </span><span style="color: #0000BB">CMssqlCommandBuilder</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">);<br>}</span></pre> </div> <p>Creates a command builder for the database. This method overrides parent implementation in order to create a MSSQL specific command builder</p> <h3 class="detailHeader" id="findColumns-detail"> findColumns() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected boolean <b>findColumns</b>(<a href="cmssqltableschema">CMssqlTableSchema</a> $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cmssqltableschema">CMssqlTableSchema</a></td> <td class="paramDescCol">the table metadata</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether the table exists in the database</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L281">framework/db/schema/mssql/CMssqlSchema.php#281</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findColumns</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$columnsTable</span><span style="color: #007700">=</span><span style="color: #DD0000">"INFORMATION_SCHEMA.COLUMNS"</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$where</span><span style="color: #007700">=array();<br>    </span><span style="color: #0000BB">$where</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"t1.TABLE_NAME='"</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">.</span><span style="color: #DD0000">"'"</span><span style="color: #007700">;<br>    if (isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">))<br>    {<br>        </span><span style="color: #0000BB">$where</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"t1.TABLE_CATALOG='"</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">"'"</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$columnsTable </span><span style="color: #007700">= </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$columnsTable</span><span style="color: #007700">;<br>    }<br>    if (isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">))<br>        </span><span style="color: #0000BB">$where</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"t1.TABLE_SCHEMA='"</span><span style="color: #007700">.</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">.</span><span style="color: #DD0000">"'"</span><span style="color: #007700">;<br><br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=</span><span style="color: #DD0000">"SELECT t1.*, columnproperty(object_id(t1.table_schema+'.'+t1.table_name), t1.column_name, 'IsIdentity') AS IsIdentity, "</span><span style="color: #007700">.<br>         </span><span style="color: #DD0000">"CONVERT(VARCHAR, t2.value) AS Comment FROM "</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$columnsTable</span><span style="color: #007700">).</span><span style="color: #DD0000">" AS t1 "</span><span style="color: #007700">.<br>         </span><span style="color: #DD0000">"LEFT OUTER JOIN sys.extended_properties AS t2 ON t1.ORDINAL_POSITION = t2.minor_id AND "</span><span style="color: #007700">.<br>         </span><span style="color: #DD0000">"object_name(t2.major_id) = t1.TABLE_NAME AND t2.class=1 AND t2.class_desc='OBJECT_OR_COLUMN' AND t2.name='MS_Description' "</span><span style="color: #007700">.<br>         </span><span style="color: #DD0000">"WHERE "</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #DD0000">' AND '</span><span style="color: #007700">,</span><span style="color: #0000BB">$where</span><span style="color: #007700">);<br>    try<br>    {<br>        </span><span style="color: #0000BB">$columns</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">();<br>        if(empty(</span><span style="color: #0000BB">$columns</span><span style="color: #007700">))<br>            return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br>    }<br>    catch(</span><span style="color: #0000BB">Exception $e</span><span style="color: #007700">)<br>    {<br>        return </span><span style="color: #0000BB">false</span><span style="color: #007700">;<br>    }<br><br>    foreach(</span><span style="color: #0000BB">$columns </span><span style="color: #007700">as </span><span style="color: #0000BB">$column</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$column</span><span style="color: #007700">);<br>        if (</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">))<br>            </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isPrimaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">, </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">);<br>        else<br>            </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isPrimaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">strcasecmp</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">,</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">)===</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br><br>        </span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isForeignKey</span><span style="color: #007700">=isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foreignKeys</span><span style="color: #007700">[</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">]);<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">columns</span><span style="color: #007700">[</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">]=</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br>        if (</span><span style="color: #0000BB">$c</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">autoIncrement </span><span style="color: #007700">&amp;&amp; </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">===</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;<br>    }<br>    return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Collects the table column metadata.</p> <h3 class="detailHeader" id="findForeignKeys-detail"> findForeignKeys() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected array <b>findForeignKeys</b>(<a href="cmssqltableschema">CMssqlTableSchema</a> $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cmssqltableschema">CMssqlTableSchema</a></td> <td class="paramDescCol">table</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">foreign relationship table name and keys.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L228">framework/db/schema/mssql/CMssqlSchema.php#228</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findForeignKeys</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$rc</span><span style="color: #007700">=</span><span style="color: #DD0000">'INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS'</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$kcu</span><span style="color: #007700">=</span><span style="color: #DD0000">'INFORMATION_SCHEMA.KEY_COLUMN_USAGE'</span><span style="color: #007700">;<br>    if (isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">))<br>    {<br>        </span><span style="color: #0000BB">$kcu</span><span style="color: #007700">=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$kcu</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$rc</span><span style="color: #007700">=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$rc</span><span style="color: #007700">;<br>    }<br><br>    </span><span style="color: #FF8000">//From http://msdn2.microsoft.com/en-us/library/aa175805(SQL.80).aspx<br>    </span><span style="color: #0000BB">$sql </span><span style="color: #007700">= &lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">    SELECT<br>         KCU1.CONSTRAINT_NAME AS 'FK_CONSTRAINT_NAME'<br>       , KCU1.TABLE_NAME AS 'FK_TABLE_NAME'<br>       , KCU1.COLUMN_NAME AS 'FK_COLUMN_NAME'<br>       , KCU1.ORDINAL_POSITION AS 'FK_ORDINAL_POSITION'<br>       , KCU2.CONSTRAINT_NAME AS 'UQ_CONSTRAINT_NAME'<br>       , KCU2.TABLE_NAME AS 'UQ_TABLE_NAME'<br>       , KCU2.COLUMN_NAME AS 'UQ_COLUMN_NAME'<br>       , KCU2.ORDINAL_POSITION AS 'UQ_ORDINAL_POSITION'<br>    FROM </span><span style="color: #007700">{</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$rc</span><span style="color: #007700">)}</span><span style="color: #DD0000"> RC<br>    JOIN </span><span style="color: #007700">{</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$kcu</span><span style="color: #007700">)}</span><span style="color: #DD0000"> KCU1<br>    ON KCU1.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG<br>       AND KCU1.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA<br>       AND KCU1.CONSTRAINT_NAME = RC.CONSTRAINT_NAME<br>    JOIN </span><span style="color: #007700">{</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$kcu</span><span style="color: #007700">)}</span><span style="color: #DD0000"> KCU2<br>    ON KCU2.CONSTRAINT_CATALOG =<br>    RC.UNIQUE_CONSTRAINT_CATALOG<br>       AND KCU2.CONSTRAINT_SCHEMA =<br>    RC.UNIQUE_CONSTRAINT_SCHEMA<br>       AND KCU2.CONSTRAINT_NAME =<br>    RC.UNIQUE_CONSTRAINT_NAME<br>       AND KCU2.ORDINAL_POSITION = KCU1.ORDINAL_POSITION<br>    WHERE KCU1.TABLE_NAME = :table<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command </span><span style="color: #007700">= </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':table'</span><span style="color: #007700">, </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$fkeys</span><span style="color: #007700">=array();<br>    foreach(</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">() as </span><span style="color: #0000BB">$info</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #0000BB">$fkeys</span><span style="color: #007700">[</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">'FK_COLUMN_NAME'</span><span style="color: #007700">]]=array(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">'UQ_TABLE_NAME'</span><span style="color: #007700">],</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">'UQ_COLUMN_NAME'</span><span style="color: #007700">],);<br><br>    }<br>    return </span><span style="color: #0000BB">$fkeys</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Gets foreign relationship constraint keys and table name</p> <h3 class="detailHeader" id="findPrimaryKey-detail"> findPrimaryKey() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected mixed <b>findPrimaryKey</b>(<a href="cmssqltableschema">CMssqlTableSchema</a> $table)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cmssqltableschema">CMssqlTableSchema</a></td> <td class="paramDescCol">table</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">mixed</td> <td class="paramDescCol">primary keys (null if no pk, string if only 1 column pk, or array if composite pk)</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L187">framework/db/schema/mssql/CMssqlSchema.php#187</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$kcu</span><span style="color: #007700">=</span><span style="color: #DD0000">'INFORMATION_SCHEMA.KEY_COLUMN_USAGE'</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$tc</span><span style="color: #007700">=</span><span style="color: #DD0000">'INFORMATION_SCHEMA.TABLE_CONSTRAINTS'</span><span style="color: #007700">;<br>    if (isset(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">))<br>    {<br>        </span><span style="color: #0000BB">$kcu</span><span style="color: #007700">=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$kcu</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$tc</span><span style="color: #007700">=</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$tc</span><span style="color: #007700">;<br>    }<br><br>    </span><span style="color: #0000BB">$sql </span><span style="color: #007700">= &lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">    SELECT k.column_name field_name<br>    FROM </span><span style="color: #007700">{</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$kcu</span><span style="color: #007700">)}</span><span style="color: #DD0000"> k<br>    LEFT JOIN </span><span style="color: #007700">{</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$tc</span><span style="color: #007700">)}</span><span style="color: #DD0000"> c<br>    ON k.table_name = c.table_name<br>        AND k.constraint_name = c.constraint_name<br>    WHERE c.constraint_type ='PRIMARY KEY'<br>        AND k.table_name = :table<br>        AND k.table_schema = :schema<br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command </span><span style="color: #007700">= </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':table'</span><span style="color: #007700">, </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindValue</span><span style="color: #007700">(</span><span style="color: #DD0000">':schema'</span><span style="color: #007700">, </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$primary</span><span style="color: #007700">=</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryColumn</span><span style="color: #007700">();<br>    switch (</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$primary</span><span style="color: #007700">))<br>    {<br>        case </span><span style="color: #0000BB">0</span><span style="color: #007700">: </span><span style="color: #FF8000">// No primary key on table<br>            </span><span style="color: #0000BB">$primary</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>            break;<br>        case </span><span style="color: #0000BB">1</span><span style="color: #007700">: </span><span style="color: #FF8000">// Only 1 primary key<br>            </span><span style="color: #0000BB">$primary</span><span style="color: #007700">=</span><span style="color: #0000BB">$primary</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>            break;<br>    }<br>    return </span><span style="color: #0000BB">$primary</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Gets the primary key column(s) details for the given table.</p> <h3 class="detailHeader" id="findTableNames-detail"> findTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected array <b>findTableNames</b>(string $schema='', boolean $includeViews=true)</pre> </td></tr> <tr> <td class="paramNameCol">$schema</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the schema of the tables. Defaults to empty string, meaning the current or default schema. If not empty, the returned table names will be prefixed with the schema name.</td> </tr> <tr> <td class="paramNameCol">$includeViews</td> <td class="paramTypeCol">boolean</td> <td class="paramDescCol">whether to include views in the result. Defaults to true.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">array</td> <td class="paramDescCol">all table names in the database.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L361">framework/db/schema/mssql/CMssqlSchema.php#361</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">findTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$includeViews</span><span style="color: #007700">=</span><span style="color: #0000BB">true</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">$schema</span><span style="color: #007700">===</span><span style="color: #DD0000">''</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$schema</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">;<br>    if(</span><span style="color: #0000BB">$includeViews</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$condition</span><span style="color: #007700">=</span><span style="color: #DD0000">"TABLE_TYPE in ('BASE TABLE','VIEW')"</span><span style="color: #007700">;<br>    else<br>        </span><span style="color: #0000BB">$condition</span><span style="color: #007700">=</span><span style="color: #DD0000">"TABLE_TYPE='BASE TABLE'"</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$sql</span><span style="color: #007700">=&lt;&lt;&lt;EOD<br></span><span style="color: #DD0000">SELECT TABLE_NAME FROM [INFORMATION_SCHEMA].[TABLES]<br>WHERE TABLE_SCHEMA=:schema AND </span><span style="color: #0000BB">$condition</span><span style="color: #DD0000"><br></span><span style="color: #007700">EOD;<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #DD0000">":schema"</span><span style="color: #007700">, </span><span style="color: #0000BB">$schema</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$rows</span><span style="color: #007700">=</span><span style="color: #0000BB">$command</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">queryAll</span><span style="color: #007700">();<br>    </span><span style="color: #0000BB">$names</span><span style="color: #007700">=array();<br>    foreach (</span><span style="color: #0000BB">$rows </span><span style="color: #007700">as </span><span style="color: #0000BB">$row</span><span style="color: #007700">)<br>    {<br>        if (</span><span style="color: #0000BB">$schema </span><span style="color: #007700">== </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">)<br>            </span><span style="color: #0000BB">$names</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'TABLE_NAME'</span><span style="color: #007700">];<br>        else<br>            </span><span style="color: #0000BB">$names</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$schema</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'TABLE_NAME'</span><span style="color: #007700">];<br>    }<br><br>    return </span><span style="color: #0000BB">$names</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Returns all table names in the database.</p> <h3 class="detailHeader" id="loadTable-detail"> loadTable() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected <a href="cmssqltableschema">CMssqlTableSchema</a> <b>loadTable</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol"><a href="cmssqltableschema">CMssqlTableSchema</a></td> <td class="paramDescCol">driver dependent table metadata. Null if the table does not exist.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L134">framework/db/schema/mssql/CMssqlSchema.php#134</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">loadTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">=new </span><span style="color: #0000BB">CMssqlTableSchema</span><span style="color: #007700">;<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">resolveTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br>    </span><span style="color: #FF8000">//if (!in_array($table-&gt;name, $this-&gt;tableNames)) return null;<br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findPrimaryKey</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br>    </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foreignKeys</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findForeignKeys</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">);<br>    if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findColumns</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">))<br>    {<br>        return </span><span style="color: #0000BB">$table</span><span style="color: #007700">;<br>    }<br>    else<br>        return </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Loads the metadata for the specified table.</p> <h3 class="detailHeader" id="quoteSimpleColumnName-detail"> quoteSimpleColumnName() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteSimpleColumnName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">column name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted column name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L63">framework/db/schema/mssql/CMssqlSchema.php#63</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteSimpleColumnName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'['</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">']'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Quotes a column name for use in a query. A simple column name does not contain prefix.</p> <h3 class="detailHeader" id="quoteSimpleTableName-detail"> quoteSimpleTableName() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>quoteSimpleTableName</b>(string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">table name</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the properly quoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L51">framework/db/schema/mssql/CMssqlSchema.php#51</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">quoteSimpleTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">'['</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">']'</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Quotes a table name for use in a query. A simple table name does not schema prefix.</p> <h3 class="detailHeader" id="renameColumn-detail"> renameColumn() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>renameColumn</b>(string $table, string $name, string $newName)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table whose column is to be renamed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the old name of the column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$newName</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new name of the column. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for renaming a DB column.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L418">framework/db/schema/mssql/CMssqlSchema.php#418</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">renameColumn</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">, </span><span style="color: #0000BB">$newName</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"sp_rename '</span><span style="color: #0000BB">$table</span><span style="color: #DD0000">.</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">', '</span><span style="color: #0000BB">$newName</span><span style="color: #DD0000">', 'COLUMN'"</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for renaming a column.</p> <h3 class="detailHeader" id="renameTable-detail"> renameTable() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public string <b>renameTable</b>(string $table, string $newName)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the table to be renamed. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">$newName</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the new table name. The name will be properly quoted by the method.</td> </tr> <tr> <td class="paramNameCol">{return}</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the SQL statement for renaming a DB table.</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L405">framework/db/schema/mssql/CMssqlSchema.php#405</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">renameTable</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">, </span><span style="color: #0000BB">$newName</span><span style="color: #007700">)<br>{<br>    return </span><span style="color: #DD0000">"sp_rename '</span><span style="color: #0000BB">$table</span><span style="color: #DD0000">', '</span><span style="color: #0000BB">$newName</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br>}</span></pre> </div> <p>Builds a SQL statement for renaming a DB table.</p> <h3 class="detailHeader" id="resetSequence-detail"> resetSequence() <span class="detailHeaderTag"> method (available since v1.1.6) </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">public void <b>resetSequence</b>(<a href="cdbtableschema">CDbTableSchema</a> $table, integer|null $value=NULL)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cdbtableschema">CDbTableSchema</a></td> <td class="paramDescCol">the table schema whose primary key sequence will be reset</td> </tr> <tr> <td class="paramNameCol">$value</td> <td class="paramTypeCol">integer|null</td> <td class="paramDescCol">the value for the primary key of the next new row inserted. If this is not set, the next new row's primary key will have the max value of a primary key plus one (i.e. sequence trimming).</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L93">framework/db/schema/mssql/CMssqlSchema.php#93</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">public function </span><span style="color: #0000BB">resetSequence</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$value</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>{<br>    if(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sequenceName</span><span style="color: #007700">===</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        return;<br>    if(</span><span style="color: #0000BB">$value</span><span style="color: #007700">!==</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br>        </span><span style="color: #0000BB">$value</span><span style="color: #007700">=(int)(</span><span style="color: #0000BB">$value</span><span style="color: #007700">)-</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>    else<br>        </span><span style="color: #0000BB">$value</span><span style="color: #007700">=(int)</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()<br>            -&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT MAX([</span><span style="color: #007700">{</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">primaryKey</span><span style="color: #007700">}</span><span style="color: #DD0000">]) FROM </span><span style="color: #007700">{</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">)<br>            -&gt;</span><span style="color: #0000BB">queryScalar</span><span style="color: #007700">();<br>    </span><span style="color: #0000BB">$name</span><span style="color: #007700">=</span><span style="color: #0000BB">strtr</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'['</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #DD0000">']'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">''</span><span style="color: #007700">));<br>    </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getDbConnection</span><span style="color: #007700">()<br>        -&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">"DBCC CHECKIDENT ('</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">',RESEED,</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">)"</span><span style="color: #007700">)<br>        -&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br>}</span></pre> </div> <p>Resets the sequence value of a table's primary key. The sequence will be reset such that the primary key of the next new row inserted will have the specified value or max value of a primary key plus one (i.e. sequence trimming).</p> <h3 class="detailHeader" id="resolveTableNames-detail"> resolveTableNames() <span class="detailHeaderTag"> method </span> </h3> <table class="summaryTable"> <tr><td colspan="3"> <pre class="signature2">protected void <b>resolveTableNames</b>(<a href="cmssqltableschema">CMssqlTableSchema</a> $table, string $name)</pre> </td></tr> <tr> <td class="paramNameCol">$table</td> <td class="paramTypeCol"><a href="cmssqltableschema">CMssqlTableSchema</a></td> <td class="paramDescCol">the table instance</td> </tr> <tr> <td class="paramNameCol">$name</td> <td class="paramTypeCol">string</td> <td class="paramDescCol">the unquoted table name</td> </tr> </table> <div class="sourceCode"> <b>Source Code:</b> <a class="sourceLink" href="https://github.com/yiisoft/yii/blob/1.1.19/framework/db/schema/mssql/CMssqlSchema.php#L154">framework/db/schema/mssql/CMssqlSchema.php#154</a> (<b><a href="#" class="show">show</a></b>) <pre class="code"><span style="color: #007700">protected function </span><span style="color: #0000BB">resolveTableNames</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">)<br>{<br>    </span><span style="color: #0000BB">$parts</span><span style="color: #007700">=</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">,</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'['</span><span style="color: #007700">,</span><span style="color: #DD0000">']'</span><span style="color: #007700">),</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$name</span><span style="color: #007700">));<br>    if((</span><span style="color: #0000BB">$c</span><span style="color: #007700">=</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">))==</span><span style="color: #0000BB">3</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #FF8000">// Catalog name, schema name and table name provided<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">catalogName</span><span style="color: #007700">).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    }<br>    elseif (</span><span style="color: #0000BB">$c</span><span style="color: #007700">==</span><span style="color: #0000BB">2</span><span style="color: #007700">)<br>    {<br>        </span><span style="color: #FF8000">// Only schema name and table name provided<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    }<br>    else<br>    {<br>        </span><span style="color: #FF8000">// Only the name given, we need to get at least the schema name<br>        //if (empty($this-&gt;_schemaNames)) $this-&gt;findTableNames();<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #0000BB">$parts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">DEFAULT_SCHEMA</span><span style="color: #007700">;<br>        </span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">rawName</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">schemaName</span><span style="color: #007700">).</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quoteTableName</span><span style="color: #007700">(</span><span style="color: #0000BB">$table</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br>    }<br>}</span></pre> </div> <p>Generates various kinds of table names.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2008–2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc/api/1.1/CMssqlSchema" class="_attribution-link">http://www.yiiframework.com/doc/api/1.1/CMssqlSchema</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>numpy.linalg.qr() - NumPy 1.17 - W3cubDocs</title>
  
  <meta name="description" content=" Compute the qr factorization of a matrix. ">
  <meta name="keywords" content="numpy, linalg, qr, numpy~1.17">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/numpy~1.17/generated/numpy.linalg.qr.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/numpy~1.17.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/numpy~1.17/" class="_nav-link" title="" style="margin-left:0;">NumPy 1.17</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="numpy-linalg-qr">numpy.linalg.qr</h1> <dl class="function"> <dt id="numpy.linalg.qr">
<code>numpy.linalg.qr(a, mode='reduced')</code> <a class="reference external" href="https://github.com/numpy/numpy/blob/v1.17.0/numpy/linalg/linalg.py#L769-L979"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Compute the qr factorization of a matrix.</p> <p>Factor the matrix <code>a</code> as <em>qr</em>, where <code>q</code> is orthonormal and <code>r</code> is upper-triangular.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<dl class="first docutils"> <dt>
<code>a : array_like, shape (M, N)</code> </dt> <dd>
<p class="first last">Matrix to be factored.</p> </dd> <dt>
<code>mode : {‘reduced’, ‘complete’, ‘r’, ‘raw’, ‘full’, ‘economic’}, optional</code> </dt> <dd>
<p class="first">If K = min(M, N), then</p> <ul class="simple"> <li>‘reduced’ : returns q, r with dimensions (M, K), (K, N) (default)</li> <li>‘complete’ : returns q, r with dimensions (M, M), (M, N)</li> <li>‘r’ : returns r only with dimensions (K, N)</li> <li>‘raw’ : returns h, tau with dimensions (N, M), (K,)</li> <li>‘full’ : alias of ‘reduced’, deprecated</li> <li>‘economic’ : returns h from ‘raw’, deprecated.</li> </ul> <p class="last">The options ‘reduced’, ‘complete, and ‘raw’ are new in numpy 1.8, see the notes for more information. The default is ‘reduced’, and to maintain backward compatibility with earlier versions of numpy both it and the old default ‘full’ can be omitted. Note that array h returned in ‘raw’ mode is transposed for calling Fortran. The ‘economic’ mode is deprecated. The modes ‘full’ and ‘economic’ may be passed using only the first letter for backwards compatibility, but all others must be spelled out. See the Notes for more explanation.</p> </dd> </dl> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<dl class="first docutils"> <dt>
<code>q : ndarray of float or complex, optional</code> </dt> <dd>
<p class="first last">A matrix with orthonormal columns. When mode = ‘complete’ the result is an orthogonal/unitary matrix depending on whether or not a is real/complex. The determinant may be either +/- 1 in that case.</p> </dd> <dt>
<code>r : ndarray of float or complex, optional</code> </dt> <dd>
<p class="first last">The upper-triangular matrix.</p> </dd> <dt>
<code>(h, tau) : ndarrays of np.double or np.cdouble, optional</code> </dt> <dd>
<p class="first last">The array h contains the Householder reflectors that generate q along with r. The tau array contains scaling factors for the reflectors. In the deprecated ‘economic’ mode only h is returned.</p> </dd> </dl> </td> </tr> <tr>
<th class="field-name">Raises:</th>
<td class="field-body">
<dl class="first last docutils"> <dt><strong>LinAlgError</strong></dt> <dd>
<p class="first last">If factoring fails.</p> </dd> </dl> </td> </tr>  </table> <h4 class="rubric">Notes</h4> <p>This is an interface to the LAPACK routines <code>dgeqrf</code>, <code>zgeqrf</code>, <code>dorgqr</code>, and <code>zungqr</code>.</p> <p>For more information on the qr factorization, see for example: <a class="reference external" href="https://en.wikipedia.org/wiki/QR_factorization">https://en.wikipedia.org/wiki/QR_factorization</a></p> <p>Subclasses of <code>ndarray</code> are preserved except for the ‘raw’ mode. So if <code>a</code> is of type <code>matrix</code>, all the return values will be matrices too.</p> <p>New ‘reduced’, ‘complete’, and ‘raw’ options for mode were added in NumPy 1.8.0 and the old option ‘full’ was made an alias of ‘reduced’. In addition the options ‘full’ and ‘economic’ were deprecated. Because ‘full’ was the previous default and ‘reduced’ is the new default, backward compatibility can be maintained by letting <code>mode</code> default. The ‘raw’ option was added so that LAPACK routines that can multiply arrays by q using the Householder reflectors can be used. Note that in this case the returned arrays are of type np.double or np.cdouble and the h array is transposed to be FORTRAN compatible. No routines using the ‘raw’ return are currently exposed by numpy, but some are available in lapack_lite and just await the necessary work.</p> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; a = np.random.randn(9, 6)
&gt;&gt;&gt; q, r = np.linalg.qr(a)
&gt;&gt;&gt; np.allclose(a, np.dot(q, r))  # a does equal qr
True
&gt;&gt;&gt; r2 = np.linalg.qr(a, mode='r')
&gt;&gt;&gt; r3 = np.linalg.qr(a, mode='economic')
&gt;&gt;&gt; np.allclose(r, r2)  # mode='r' returns the same r as mode='full'
True
&gt;&gt;&gt; # But only triu parts are guaranteed equal when mode='economic'
&gt;&gt;&gt; np.allclose(r, np.triu(r3[:6,:6], k=0))
True
</pre> <p>Example illustrating a common use of <a class="reference internal" href="#numpy.linalg.qr" title="numpy.linalg.qr"><code>qr</code></a>: solving of least squares problems</p> <p>What are the least-squares-best <code>m</code> and <code>y0</code> in <code>y = y0 + mx</code> for the following data: {(0,1), (1,0), (1,2), (2,1)}. (Graph the points and you’ll see that it should be y0 = 0, m = 1.) The answer is provided by solving the over-determined matrix equation <code>Ax = b</code>, where:</p> <pre data-language="python">A = array([[0, 1], [1, 1], [1, 1], [2, 1]])
x = array([[y0], [m]])
b = array([[1], [0], [2], [1]])
</pre> <p>If A = qr such that q is orthonormal (which is always possible via Gram-Schmidt), then <code>x = inv(r) * (q.T) * b</code>. (In numpy practice, however, we simply use <a class="reference internal" href="numpy.linalg.lstsq#numpy.linalg.lstsq" title="numpy.linalg.lstsq"><code>lstsq</code></a>.)</p> <pre data-language="python">&gt;&gt;&gt; A = np.array([[0, 1], [1, 1], [1, 1], [2, 1]])
&gt;&gt;&gt; A
array([[0, 1],
       [1, 1],
       [1, 1],
       [2, 1]])
&gt;&gt;&gt; b = np.array([1, 0, 2, 1])
&gt;&gt;&gt; q, r = np.linalg.qr(A)
&gt;&gt;&gt; p = np.dot(q.T, b)
&gt;&gt;&gt; np.dot(np.linalg.inv(r), p)
array([  1.1e-16,   1.0e+00])
</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2019 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.linalg.qr.html" class="_attribution-link">https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.linalg.qr.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

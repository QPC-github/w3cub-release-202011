
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>numpy.take_along_axis() - NumPy 1.17 - W3cubDocs</title>
  
  <meta name="description" content=" Take values from the input array by matching 1d index and data slices. ">
  <meta name="keywords" content="numpy, take, along, axis, numpy~1.17">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/numpy~1.17/generated/numpy.take_along_axis.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/numpy~1.17.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/numpy~1.17/" class="_nav-link" title="" style="margin-left:0;">NumPy 1.17</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="numpy-take-along-axis">numpy.take_along_axis</h1> <dl class="function"> <dt id="numpy.take_along_axis">
<code>numpy.take_along_axis(arr, indices, axis)</code> <a class="reference external" href="https://github.com/numpy/numpy/blob/v1.17.0/numpy/lib/shape_base.py#L58-L172"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Take values from the input array by matching 1d index and data slices.</p> <p>This iterates over matching 1d slices oriented along the specified axis in the index and data arrays, and uses the former to look up values in the latter. These slices can be different lengths.</p> <p>Functions returning an index along an axis, like <a class="reference internal" href="numpy.argsort#numpy.argsort" title="numpy.argsort"><code>argsort</code></a> and <a class="reference internal" href="numpy.argpartition#numpy.argpartition" title="numpy.argpartition"><code>argpartition</code></a>, produce suitable indices for this function.</p> <div class="versionadded"> <p><span class="versionmodified">New in version 1.15.0.</span></p> </div> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<dl class="first docutils"> <dt><strong>arr: ndarray (Ni…, M, Nk…)</strong></dt> <dd>
<p class="first last">Source array</p> </dd> <dt><strong>indices: ndarray (Ni…, J, Nk…)</strong></dt> <dd>
<p class="first last">Indices to take along each 1d slice of <code>arr</code>. This must match the dimension of arr, but dimensions Ni and Nj only need to broadcast against <code>arr</code>.</p> </dd> <dt><strong>axis: int</strong></dt> <dd>
<p class="first last">The axis to take 1d slices along. If axis is None, the input array is treated as if it had first been flattened to 1d, for consistency with <a class="reference internal" href="numpy.sort#numpy.sort" title="numpy.sort"><code>sort</code></a> and <a class="reference internal" href="numpy.argsort#numpy.argsort" title="numpy.argsort"><code>argsort</code></a>.</p> </dd> </dl> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<dl class="first last docutils"> <dt><strong>out: ndarray (Ni…, J, Nk…)</strong></dt> <dd>
<p class="first last">The indexed result.</p> </dd> </dl> </td> </tr>  </table> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <dl class="last docutils"> <dt>
 <a class="reference internal" href="numpy.take#numpy.take" title="numpy.take"><code>take</code></a>
</dt> <dd>Take along an axis, using the same indices for every 1d slice</dd> <dt>
 <a class="reference internal" href="numpy.put_along_axis#numpy.put_along_axis" title="numpy.put_along_axis"><code>put_along_axis</code></a>
</dt> <dd>Put values into the destination array by matching 1d index and data slices</dd> </dl> </div> <h4 class="rubric">Notes</h4> <p>This is equivalent to (but faster than) the following use of <a class="reference internal" href="numpy.ndindex#numpy.ndindex" title="numpy.ndindex"><code>ndindex</code></a> and <a class="reference internal" href="numpy.s_#numpy.s_" title="numpy.s_"><code>s_</code></a>, which sets each of <code>ii</code> and <code>kk</code> to a tuple of indices:</p> <pre data-language="python">Ni, M, Nk = a.shape[:axis], a.shape[axis], a.shape[axis+1:]
J = indices.shape[axis]  # Need not equal M
out = np.empty(Ni + (J,) + Nk)

for ii in ndindex(Ni):
    for kk in ndindex(Nk):
        a_1d       = a      [ii + s_[:,] + kk]
        indices_1d = indices[ii + s_[:,] + kk]
        out_1d     = out    [ii + s_[:,] + kk]
        for j in range(J):
            out_1d[j] = a_1d[indices_1d[j]]
</pre> <p>Equivalently, eliminating the inner loop, the last two lines would be:</p> <pre data-language="python">out_1d[:] = a_1d[indices_1d]
</pre> <h4 class="rubric">Examples</h4> <p>For this sample array</p> <pre data-language="python">&gt;&gt;&gt; a = np.array([[10, 30, 20], [60, 40, 50]])
</pre> <p>We can sort either by using sort directly, or argsort and this function</p> <pre data-language="python">&gt;&gt;&gt; np.sort(a, axis=1)
array([[10, 20, 30],
       [40, 50, 60]])
&gt;&gt;&gt; ai = np.argsort(a, axis=1); ai
array([[0, 2, 1],
       [1, 2, 0]])
&gt;&gt;&gt; np.take_along_axis(a, ai, axis=1)
array([[10, 20, 30],
       [40, 50, 60]])
</pre> <p>The same works for max and min, if you expand the dimensions:</p> <pre data-language="python">&gt;&gt;&gt; np.expand_dims(np.max(a, axis=1), axis=1)
array([[30],
       [60]])
&gt;&gt;&gt; ai = np.expand_dims(np.argmax(a, axis=1), axis=1)
&gt;&gt;&gt; ai
array([[1],
       [0]])
&gt;&gt;&gt; np.take_along_axis(a, ai, axis=1)
array([[30],
       [60]])
</pre> <p>If we want to get the max and min at the same time, we can stack the indices first</p> <pre data-language="python">&gt;&gt;&gt; ai_min = np.expand_dims(np.argmin(a, axis=1), axis=1)
&gt;&gt;&gt; ai_max = np.expand_dims(np.argmax(a, axis=1), axis=1)
&gt;&gt;&gt; ai = np.concatenate([ai_min, ai_max], axis=1)
&gt;&gt;&gt; ai
array([[0, 1],
       [1, 0]])
&gt;&gt;&gt; np.take_along_axis(a, ai, axis=1)
array([[10, 30],
       [40, 60]])
</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2019 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.take_along_axis.html" class="_attribution-link">https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.take_along_axis.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

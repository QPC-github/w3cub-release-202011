
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>numpy.einsum_path() - NumPy 1.17 - W3cubDocs</title>
  
  <meta name="description" content=" Evaluates the lowest cost contraction order for an einsum expression by considering the creation of intermediate arrays. ">
  <meta name="keywords" content="numpy, einsum, path, numpy~1.17">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/numpy~1.17/generated/numpy.einsum_path.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/numpy~1.17.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/numpy~1.17/" class="_nav-link" title="" style="margin-left:0;">NumPy 1.17</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="numpy-einsum-path">numpy.einsum_path</h1> <dl class="function"> <dt id="numpy.einsum_path">
<code>numpy.einsum_path(subscripts, *operands, optimize='greedy')</code> <a class="reference external" href="https://github.com/numpy/numpy/blob/v1.17.0/numpy/core/einsumfunc.py#L704-L992"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Evaluates the lowest cost contraction order for an einsum expression by considering the creation of intermediate arrays.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<dl class="first docutils"> <dt>
<code>subscripts : str</code> </dt> <dd>
<p class="first last">Specifies the subscripts for summation.</p> </dd> <dt>
<code>*operands : list of array_like</code> </dt> <dd>
<p class="first last">These are the arrays for the operation.</p> </dd> <dt>
<code>optimize : {bool, list, tuple, ‘greedy’, ‘optimal’}</code> </dt> <dd>
<p class="first">Choose the type of path. If a tuple is provided, the second argument is assumed to be the maximum intermediate size created. If only a single argument is provided the largest input or output array size is used as a maximum intermediate size.</p> <ul class="simple"> <li>if a list is given that starts with <code>einsum_path</code>, uses this as the contraction path</li> <li>if False no optimization is taken</li> <li>if True defaults to the ‘greedy’ algorithm</li> <li>‘optimal’ An algorithm that combinatorially explores all possible ways of contracting the listed tensors and choosest the least costly path. Scales exponentially with the number of terms in the contraction.</li> <li>‘greedy’ An algorithm that chooses the best pair contraction at each step. Effectively, this algorithm searches the largest inner, Hadamard, and then outer products at each step. Scales cubically with the number of terms in the contraction. Equivalent to the ‘optimal’ path for most contractions.</li> </ul> <p class="last">Default is ‘greedy’.</p> </dd> </dl> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<dl class="first last docutils"> <dt>
<code>path : list of tuples</code> </dt> <dd>
<p class="first last">A list representation of the einsum path.</p> </dd> <dt>
<code>string_repr : str</code> </dt> <dd>
<p class="first last">A printable representation of the einsum path.</p> </dd> </dl> </td> </tr>  </table> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <p class="last"><a class="reference internal" href="numpy.einsum#numpy.einsum" title="numpy.einsum"><code>einsum</code></a>, <a class="reference internal" href="numpy.linalg.multi_dot#numpy.linalg.multi_dot" title="numpy.linalg.multi_dot"><code>linalg.multi_dot</code></a></p> </div> <h4 class="rubric">Notes</h4> <p>The resulting path indicates which terms of the input contraction should be contracted first, the result of this contraction is then appended to the end of the contraction list. This list can then be iterated over until all intermediate contractions are complete.</p> <h4 class="rubric">Examples</h4> <p>We can begin with a chain dot example. In this case, it is optimal to contract the <code>b</code> and <code>c</code> tensors first as represented by the first element of the path <code>(1, 2)</code>. The resulting tensor is added to the end of the contraction and the remaining contraction <code>(0, 1)</code> is then completed.</p> <pre data-language="python">&gt;&gt;&gt; np.random.seed(123)
&gt;&gt;&gt; a = np.random.rand(2, 2)
&gt;&gt;&gt; b = np.random.rand(2, 5)
&gt;&gt;&gt; c = np.random.rand(5, 2)
&gt;&gt;&gt; path_info = np.einsum_path('ij,jk,kl-&gt;il', a, b, c, optimize='greedy')
&gt;&gt;&gt; print(path_info[0])
['einsum_path', (1, 2), (0, 1)]
&gt;&gt;&gt; print(path_info[1])
  Complete contraction:  ij,jk,kl-&gt;il # may vary
         Naive scaling:  4
     Optimized scaling:  3
      Naive FLOP count:  1.600e+02
  Optimized FLOP count:  5.600e+01
   Theoretical speedup:  2.857
  Largest intermediate:  4.000e+00 elements
-------------------------------------------------------------------------
scaling                  current                                remaining
-------------------------------------------------------------------------
   3                   kl,jk-&gt;jl                                ij,jl-&gt;il
   3                   jl,ij-&gt;il                                   il-&gt;il
</pre> <p>A more complex index transformation example.</p> <pre data-language="python">&gt;&gt;&gt; I = np.random.rand(10, 10, 10, 10)
&gt;&gt;&gt; C = np.random.rand(10, 10)
&gt;&gt;&gt; path_info = np.einsum_path('ea,fb,abcd,gc,hd-&gt;efgh', C, C, I, C, C,
...                            optimize='greedy')
</pre> <pre data-language="python">&gt;&gt;&gt; print(path_info[0])
['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)]
&gt;&gt;&gt; print(path_info[1]) 
  Complete contraction:  ea,fb,abcd,gc,hd-&gt;efgh # may vary
         Naive scaling:  8
     Optimized scaling:  5
      Naive FLOP count:  8.000e+08
  Optimized FLOP count:  8.000e+05
   Theoretical speedup:  1000.000
  Largest intermediate:  1.000e+04 elements
--------------------------------------------------------------------------
scaling                  current                                remaining
--------------------------------------------------------------------------
   5               abcd,ea-&gt;bcde                      fb,gc,hd,bcde-&gt;efgh
   5               bcde,fb-&gt;cdef                         gc,hd,cdef-&gt;efgh
   5               cdef,gc-&gt;defg                            hd,defg-&gt;efgh
   5               defg,hd-&gt;efgh                               efgh-&gt;efgh
</pre> </dd>
</dl>
<div class="_attribution">
  <p class="_attribution-p">
    © 2005–2019 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.einsum_path.html" class="_attribution-link">https://docs.scipy.org/doc/numpy-1.17.0/reference/generated/numpy.einsum_path.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

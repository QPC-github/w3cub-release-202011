
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Ttk_vsapi - Tcl&#47;Tk - W3cubDocs</title>
  
  <meta name="description" content="className and partId are required parameters and specify the Visual Styles class and part as given in the Microsoft documentation. The stateMap may &hellip;">
  <meta name="keywords" content="ttk, vsapi, tcl, tk, tcl_tk">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tcl_tk/tkcmd/ttk_vsapi.htm.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/tcl_tk.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tcl_tk/" class="_nav-link" title="" style="margin-left:0;">Tcl/Tk</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tcl_tk">
				
				
<h1>ttk_vsapi</h1>  <dl> <dd id="L2219">
<a href="ttk_vsapi.htm#M2" name="L2219">NAME</a> <dl><dd>ttk_vsapi — Define a Microsoft Visual Styles element</dd></dl> <dd id="L2220">
<a href="ttk_vsapi.htm#M3" name="L2220">SYNOPSIS</a>  <dd id="L2221">
<a href="ttk_vsapi.htm#M4" name="L2221">DESCRIPTION</a> <dd id="L2222">
<a href="ttk_vsapi.htm#M5" name="L2222">OPTIONS</a> <dl class="options"> <dd id="L2223">
<a href="ttk_vsapi.htm#M6" name="L2223"><b>-padding </b><i>padding</i></a> <dd id="L2224">
<a href="ttk_vsapi.htm#M7" name="L2224"><b>-margins </b><i>padding</i></a> <dd id="L2225">
<a href="ttk_vsapi.htm#M8" name="L2225"><b>-width </b><i>width</i></a> <dd id="L2226">
<a href="ttk_vsapi.htm#M9" name="L2226"><b>-height </b><i>height</i></a> </dd>
</dd>
</dd>
</dd>
</dl> <dd id="L2227">
<a href="ttk_vsapi.htm#M10" name="L2227">STATE MAP</a> <dd id="L2228">
<a href="ttk_vsapi.htm#M11" name="L2228">EXAMPLE</a> <dd id="L2229">
<a href="ttk_vsapi.htm#M12" name="L2229">SEE ALSO</a> <dd id="L2230">
<a href="ttk_vsapi.htm#M13" name="L2230">KEYWORDS</a> </dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dl> <h2 id="M2">Name</h2> ttk_vsapi — Define a Microsoft Visual Styles element <h2 id="M3">Synopsis</h2> <b>ttk::style element create </b><i>name</i> <b>vsapi</b> <i>className</i> <i>partId</i> ?<i>stateMap</i>? ?<i>options</i>?<br> <h2 id="M4">Description</h2> The <b>vsapi</b> element factory creates a new element in the current theme whose visual appearance is drawn using the Microsoft Visual Styles API which is responsible for the themed styles on Windows XP and Vista. This factory permits any of the Visual Styles parts to be declared as Ttk elements that can then be included in a style layout to modify the appearance of Ttk widgets. <p> <i>className</i> and <i>partId</i> are required parameters and specify the Visual Styles class and part as given in the Microsoft documentation. The <i>stateMap</i> may be provided to map Ttk states to Visual Styles API states (see <b><a href="#M10">STATE MAP</a></b>). </p>
<h2 id="M5">Options</h2> Valid <i>options</i> are: 
<dl class="options"> <dt id="M6">
<b>-padding </b><i>padding</i>
</dt>
<dd> Specify the element's interior padding. <i>padding</i> is a list of up to four integers specifying the left, top, right and bottom padding quantities respectively. This option may not be mixed with any other options. 
</dd>
<dt id="M7">
<b>-margins </b><i>padding</i>
</dt>
<dd> Specifies the elements exterior padding. <i>padding</i> is a list of up to four integers specifying the left, top, right and bottom padding quantities respectively. This option may not be mixed with any other options. 
</dd>
<dt id="M8">
<b>-width </b><i>width</i>
</dt>
<dd> Specifies the height for the element. If this option is set then the Visual Styles API will not be queried for the recommended size or the part. If this option is set then <b>-height</b> should also be set. The <b>-width</b> and <b>-height</b> options cannot be mixed with the <b>-padding</b> or <b>-margins</b> options. 
</dd>
<dt id="M9">
<b>-height </b><i>height</i>
</dt>
<dd> Specifies the height of the element. See the comments for <b>-width</b>. 
</dd>
</dl> <h2 id="M10">State map</h2> The <i>stateMap</i> parameter is a list of ttk states and the corresponding Visual Styles API state value. This permits the element appearance to respond to changes in the widget state such as becoming active or being pressed. The list should be as described for the <b><a href="ttk_style.htm">ttk::style map</a></b> command but note that the last pair in the list should be the default state and is typically and empty list and 1. Unfortunately all the Visual Styles parts have different state values and these must be looked up either in the Microsoft documentation or more likely in the header files. The original header to use was <i>tmschema.h</i>, but in more recent versions of the Windows Development Kit this is <i>vssym32.h</i>. <p> If no <i>stateMap</i> parameter is given there is an implicit default map of {{} 1} </p>
<h2 id="M11">Example</h2> Create a correctly themed close button by changing the layout of a <b><a href="ttk_button.htm">ttk::button</a></b>(n). This uses the WINDOW part WP_SMALLCLOSEBUTTON and as documented the states CBS_DISABLED, CBS_HOT, CBS_NORMAL and CBS_PUSHED are mapped from ttk states. <pre>ttk::style element create smallclose <b>vsapi</b> WINDOW 19 \
    {disabled 4 pressed 3 active 2 {} 1}
ttk::style layout CloseButton {CloseButton.smallclose -sticky news}
pack [ttk::button .close -style CloseButton]</pre> <p> Change the appearance of a <b><a href="ttk_checkbutton.htm">ttk::checkbutton</a></b>(n) to use the Explorer pin part EBP_HEADERPIN. </p>
<pre>ttk::style element create pin <b>vsapi</b> EXPLORERBAR 3 {
    {pressed !selected} 3
    {active !selected} 2
    {pressed selected} 6
    {active selected} 5
    {selected} 4
    {} 1
}
ttk::style layout Explorer.Pin {Explorer.Pin.pin -sticky news}
pack [ttk::checkbutton .pin -style Explorer.Pin]</pre> <h2 id="M12">See also</h2> <b><a href="ttk_intro.htm">ttk::intro</a></b>, <b><a href="ttk_widget.htm">ttk::widget</a></b>, <b><a href="ttk_style.htm">ttk::style</a></b>, <b><a href="ttk_image.htm">ttk_image</a></b>   <div class="_attribution"><p class="_attribution-p">Copyright © 2008 Pat Thoyts </p></div>
<div class="_attribution">
  <p class="_attribution-p">
    Licensed under <a href="http://tcl.tk/software/tcltk/license.html">Tcl/Tk terms</a><br>
    <a href="https://www.tcl.tk/man/tcl/TkCmd/ttk_vsapi.htm" class="_attribution-link">https://www.tcl.tk/man/tcl/TkCmd/ttk_vsapi.htm</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

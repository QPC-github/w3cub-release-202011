
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Tdbc_odbc - Tcl&#47;Tk - W3cubDocs</title>
  
  <meta name="description" content="Connection to an ODBC database is established by invoking tdbc&#58;&#58;odbc&#58;&#58;connection create, passing it the name to be used as a &hellip;">
  <meta name="keywords" content="tdbc, odbc, tcl, tk, tcl_tk">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/tcl_tk/tdbcodbccmd/tdbc_odbc.htm.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/tcl_tk.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/tcl_tk/" class="_nav-link" title="" style="margin-left:0;">Tcl/Tk</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _tcl_tk">
				
				
<h1>tdbc_odbc</h1>  <dl> <dd id="L2">
<a href="tdbc_odbc.htm#M2" name="L2">NAME</a> <dl><dd>tdbc::odbc — TDBC-ODBC bridge</dd></dl> <dd id="L3">
<a href="tdbc_odbc.htm#M3" name="L3">SYNOPSIS</a>  <dd id="L4">
<a href="tdbc_odbc.htm#M4" name="L4">DESCRIPTION</a> <dl class="description"> <dd id="L5">
<a href="tdbc_odbc.htm#M5" name="L5"><b>add</b></a> <dd id="L6">
<a href="tdbc_odbc.htm#M6" name="L6"><b>add_system</b></a> <dd id="L7">
<a href="tdbc_odbc.htm#M7" name="L7"><b>configure</b></a> <dd id="L8">
<a href="tdbc_odbc.htm#M8" name="L8"><b>configure_system</b></a> <dd id="L9">
<a href="tdbc_odbc.htm#M9" name="L9"><b>remove</b></a> <dd id="L10">
<a href="tdbc_odbc.htm#M10" name="L10"><b>remove_system</b></a> </dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dl> <dd id="L11">
<a href="tdbc_odbc.htm#M11" name="L11">CONNECTION OPTIONS</a> <dd id="L12">
<a href="tdbc_odbc.htm#M12" name="L12">EXAMPLES</a> <dd id="L13">
<a href="tdbc_odbc.htm#M13" name="L13">SEE ALSO</a> <dd id="L14">
<a href="tdbc_odbc.htm#M14" name="L14">KEYWORDS</a> <dd id="L15">
<a href="tdbc_odbc.htm#M15" name="L15">COPYRIGHT</a> </dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dd>
</dl> <h2 id="M2">Name</h2> tdbc::odbc — TDBC-ODBC bridge <h2 id="M3">Synopsis</h2> package require <b>tdbc::odbc 1.0</b><br> <b>tdbc::odbc::connection create</b> <i>db</i> <i>connectionString</i> ?<i>-option value...</i>?<br> <b>tdbc::odbc::connection new</b> <i>connectionString</i> ?<i>-option value...</i>?<br> <b>tdbc::odbc::datasources</b> ?<b>-system</b>|<b>-user</b>?<br> <b>tdbc::odbc::drivers</b><br> <b>tdbc::odbc::datasource</b> <i>command</i> <i>driverName</i> ?<i>keyword</i>-<i>value</i>?...<br> <h2 id="M4">Description</h2> The <b>tdbc::odbc</b> driver provides a database interface that conforms to Tcl DataBase Connectivity (TDBC) and allows a Tcl script to connect to any SQL database presenting an ODBC interface. It is also provided as a worked example of how to write a database driver in C, so that driver authors have a starting point for further development. <p> Connection to an ODBC database is established by invoking <b>tdbc::odbc::connection create</b>, passing it the name to be used as a connection handle, followed by a standard ODBC connection string. As an alternative, <b>tdbc::odbc::connection new</b> may be used to create a database connection with an automatically assigned name. The return value from <b>tdbc::odbc::connection new</b> is the name that was chosen for the connection handle. </p>
<p> The connection string will include at least a <b>DRIVER</b> or <b>DSN</b> keyword, and may include others that are defined by a particular ODBC driver. (If the local ODBC system supports a graphical user interface, the <b>-parent</b> option (see below) may allow calling <b>tdbc::odbc::connection create</b> with an empty connection string.) </p>
<p> The side effect of <b>tdbc::odbc::connection create</b> is to create a new database connection.. See <b>tdbc::connection(n)</b> for the details of how to use the connection to manipulate a database. </p>
<p> In addition to a standard TDBC interface, <b>tdbc::odbc</b> supports three additional ccommands. The first of these, <b>tdbc::odbc::datasources</b>, which returns a Tcl list enumerating the named data sources available to the program (for connection with the <b>DSN</b> keyword in the connection string). The result of <b>tdbc::odbc::datasources</b> may be constrained to only system data sources or only user data sources by including the <b>-system</b> or <b>-user</b> options, respectively. </p>
<p> The <b>tdbc::odbc::drivers</b> command returns a dictionary whose keys are the names of drivers available for the <b>DRIVER</b> keyword in the connection string, and whose values are descriptions of the drivers. </p>
<p> The <b>tdbc::odbc::datasource</b> command allows configuration of named data sources on those systems that support the ODBC Installer application programming interface. It accepts a <i>command</i>, which specifies the operation to be performed, the name of a <i>driver</i> for the database in question, and a set of keyword-value pairs that are interpreted by the given driver. The <i>command</i> must be one of the following: </p>

<dl class="description"> <dt id="M5"><b>add</b></dt>
<dd> Adds a user data source. The keyword-value pairs must include at least a <b>DSN</b> option naming the data source 
</dd>
<dt id="M6"><b>add_system</b></dt>
<dd> Adds a system data source. The keyword-value pairs must include at least a <b>DSN</b> option naming the data source 
</dd>
<dt id="M7"><b>configure</b></dt>
<dd> Configures a user data source. The keyword-value pairs will usually include a <b>DSN</b> option naming the data source. Some drivers will support other options, such as the <b>CREATE_DB</b> option to the Microsoft Access driver on Windows. 
</dd>
<dt id="M8"><b>configure_system</b></dt>
<dd> Configures a system data source. 
</dd>
<dt id="M9"><b>remove</b></dt>
<dd> Removes a user data source. The keyword-value pairs must include a <b>DSN</b> option specifying the data source to remove. 
</dd>
<dt id="M10"><b>remove_system</b></dt>
<dd> Removes a system data source. The keyword-value pairs must include a <b>DSN</b> option specifying the data source to remove. 
</dd>
</dl> <h2 id="M11">Connection options</h2> The <b>tdbc::odbc::connection create</b> object command supports the <b>-encoding</b>, <b>-isolation</b>, <b>-readonly</b> and <b>-timeout</b> options common to all TDBC drivers. The <b>-encoding</b> option will succeed only if the requested encoding is the same as the system encoding; <b>tdbc::odbc</b> does not attempt to specify alternative encodings to an ODBC driver. (Some drivers accept encoding specifications in the connection string.) <p> In addition, if Tk is present in the requesting interpreter, and the local system's ODBC driver manager supports a graphical user interface, the <b>tdbc::odbc::connection create</b> object command supports a <b>-parent</b> option, whose value is the path name of a Tk window. If this option is specified, and a connection string does not specify all the information needed to connect to an interface, the ODBC driver manager will display a dialog box to request whatever additional information is required. The requesting interpreter will block until the user dismisses the dialog, at which point the connection is made. </p>
<h2 id="M12">Examples</h2> Sincs ODBC connection strings are driver specific, it is often difficult to find the documentation needed to compose them. The following examples are known to work on most Windows systems and provide at least a few useful things that a program can do. 
<pre>tdbc::odbc::connection create db \
    "DSN={PAYROLL};UID={aladdin};PWD={Sesame}"</pre> Connects to a named data source "PAYROLL", providing "aladdin" as a user name and "Sesame" as a password. Uses <b>db</b> as the name of the connection. 
<pre>set connString {DRIVER={Microsoft Access Driver (*.mdb)};}
append connString {FIL={MS Access}\;}
append connString {DBQ=} \
    [file nativename [file normalize $fileName]]
tdbc::odbc::connection create db2 -readonly 1 $connString</pre> Opens a connection to a Microsoft Access database file whose name is in <i>$fileName</i>. The database is opened in read-only mode. The resulting connection is called "db2". 
<pre>tdbc::odbc::connection create db3 \
    "DRIVER=SQLite3;DATABASE=$fileName"</pre> Opens a connection to a SQLite3 database whose name is in "$fileName". 
<pre>tdbc::odbc::datasource add \
    {Microsoft Access Driver (*.mdb)} \
    DSN=MyTestDatabase \
    DBQ=[file native [file normalize $fileName]]</pre> Creates a new user data source with the name, "MyTestDatabase" bound to a Microsoft Access file whose path name is in "$fileName". No connection is made to the data source until the program calls <b>tdbc::odbc::connection create</b>. 
<pre>tdbc::odbc::datasource configure \
    {Microsoft Access Driver (*.mdb)} \
    CREATE_DB=[file native [file normalize $fileName]] \
    General</pre> Creates a new, empty Microsoft Access database in the file identified by "$fileName". No connection is made to the database until the program calls <b>tdbc::odbc::connection create</b>. <h2 id="M13">See also</h2> <b><a href="../tdbccmd/tdbc.htm">tdbc</a></b>, <b><a href="../tdbccmd/tdbc_connection.htm">tdbc::connection</a></b>, <b><a href="../tdbccmd/tdbc_resultset.htm">tdbc::resultset</a></b>, <b><a href="../tdbccmd/tdbc_statement.htm">tdbc::statement</a></b>   <h2 id="M15">Copyright</h2> Copyright (c) 2008 by Kevin B. Kenny. <div class="_attribution">
  <p class="_attribution-p">
    Licensed under <a href="http://tcl.tk/software/tcltk/license.html">Tcl/Tk terms</a><br>
    <a href="https://www.tcl.tk/man/tcl/TdbcodbcCmd/tdbc_odbc.htm" class="_attribution-link">https://www.tcl.tk/man/tcl/TdbcodbcCmd/tdbc_odbc.htm</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

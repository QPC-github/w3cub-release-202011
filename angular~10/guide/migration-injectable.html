
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Migration for Missing &#64;Injectable() Decorators and Incomplete Provider Definitions - Angular 10 - W3cubDocs</title>
  
  <meta name="description" content=" Example for missing &#64;Injectable() ">
  <meta name="keywords" content="migration, for, missing, decorators, and, incomplete, provider, definitions, injectable, angular, angular~10">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/angular~10/guide/migration-injectable.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e4ebd3a2a5652ff55173659804c4390a004917f3bdd17b5bb3ba78ea5c9c46fe181cadaac34517ccd815f5bdc982bbfe67179d6f4ac2f084ef2265e2a3dc8dc5.css" integrity="sha512-5OvToqVlL/VRc2WYBMQ5CgBJF/O90Xtbs7p46lycRv4YHK2qw0UXzNgV9b3Jgrv+Zxedb0rC8ITvImXio9yNxQ==" crossorigin="anonymous">
  <script type="text/javascript" integrity="sha512-EpkDeu98lN/jPKijllzVWdRg/dUSSMCaldYZNFz6bcNoBvpWRNz0HSTRQJ3ENmQc5Cuj1zDW1vHd7b0DzpOgyA==" crossorigin="anonymous" src="/assets/application-1299037aef7c94dfe33ca8a3965cd559d460fdd51248c09a95d619345cfa6dc36806fa5644dcf41d24d1409dc436641ce42ba3d730d6d6f1ddedbd03ce93a0c8.js"></script>
  <script src="/json/angular~10.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body>
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/angular~10/" class="_nav-link" title="" style="margin-left:0;">Angular 10</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _angular">
				
				
<h1 id="migration-for-missing-injectable-decorators-and-incomplete-provider-definitions">Migration for missing <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorators and incomplete provider definitions</h1> <h3 id="what-does-this-schematic-do">What does this schematic do?</h3> <ol> <li>This schematic adds an <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorator to classes which are provided in the application but are not decorated.</li> <li>The schematic updates providers which follow the <code>{provide: SomeToken}</code> pattern to explicitly specify <code>useValue: undefined</code>.</li> </ol> <p><strong>Example for missing <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code></strong></p> <p><em>Before migration:</em></p> <pre data-language="typescript">export class MyService {...}
export class MyOtherService {...}
export class MyThirdClass {...}
export class MyFourthClass {...}
export class MyFifthClass {...}

@NgModule({
  providers: [
    MyService,
    {provide: SOME_TOKEN, useClass: MyOtherService},
    // The following classes do not need to be decorated because they
    // are never instantiated and just serve as DI tokens.
    {provide: MyThirdClass, useValue: ...},
    {provide: MyFourthClass, useFactory: ...},
    {provide: MyFifthClass, useExisting: ...},
  ]
})</pre> <p><em>After migration:</em></p> <pre data-language="typescript">@Injectable()
export class MyService {...}
@Injectable()
export class MyOtherService {...}
export class MyThirdClass {...}
export class MyFourthClass {...}
export class MySixthClass {...}

...</pre> <p>Note that <code>MyThirdClass</code>, <code>MyFourthClass</code> and <code>MyFifthClass</code> do not need to be decorated with <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> because they are never instantiated, but just used as a <a href="glossary#di-token">DI token</a>.</p> <p><strong>Example for provider needing <code>useValue: undefined</code></strong></p> <p>This example shows a provider following the <code>{provide: X}</code> pattern. The provider needs to be migrated to a more explicit definition where <code>useValue: undefined</code> is specified.</p> <p><em>Before migration</em>:</p> <pre data-language="typescript">{provide: MyToken}</pre> <p><em>After migration</em>:</p> <pre data-language="typescript">{provide: MyToken, useValue: undefined}</pre> <h3 id="why-is-adding-injectable-necessary">Why is adding <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> necessary?</h3> <p>In our docs, we've always recommended adding <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorators to any class that is provided or injected in your application. However, older versions of Angular did allow injection of a class without the decorator in certain cases, such as AOT mode. This means if you accidentally omitted the decorator, your application may have continued to work despite missing <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorators in some places. This is problematic for future versions of Angular. Eventually, we plan to strictly require the decorator because doing so enables further optimization of both the compiler and the runtime. This schematic adds any <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorators that may be missing to future-proof your app.</p> <h3 id="why-is-adding-usevalue-undefined-necessary">Why is adding <code>useValue: undefined</code> necessary?</h3> <p>Consider the following pattern:</p> <pre data-language="typescript">@NgModule({
  providers: [{provide: MyService}]
})</pre> <p>Providers using this pattern will behave as if they provide <code>MyService</code> as <a href="glossary#di-token">DI token</a> with the value of <code>undefined</code>. This is not the case in Ivy where such providers will be interpreted as if <code>useClass: MyService</code> is specified. This means that these providers will behave differently when updating to version 9 and above. To ensure that the provider behaves the same as before, the DI value should be explicitly set to <code>undefined</code>.</p> <h3 id="when-should-i-be-adding-injectable-decorators-to-classes">When should I be adding <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorators to classes?</h3> <p>Any class that is provided must have an <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorator. The decorator is necessary for the framework to properly create an instance of that class through DI.</p> <p>However, classes which are already decorated with <code>@<a href="../api/core/pipe" class="code-anchor">Pipe</a></code>, <code>@<a href="../api/core/component" class="code-anchor">Component</a></code> or <code>@<a href="../api/core/directive" class="code-anchor">Directive</a></code> do not need both decorators. The existing class decorator already instructs the compiler to generate the needed information.</p> <h3 id="should-i-update-my-library">Should I update my library?</h3> <p>Yes, if your library has any classes that are meant to be injected, they should be updated with the <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorator. In a future version of Angular, a missing <code>@<a href="../api/core/injectable" class="code-anchor">Injectable</a>()</code> decorator will always throw an error.</p> <p>Additionally, providers in your library that follow the described <code>{provide: X}</code> pattern should be updated to specify an explicit value. Without explicit value, these providers can behave differently based on the Angular version in applications consuming your library.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2010–2020 Google, Inc.<br>Licensed under the Creative Commons Attribution License 4.0.<br>
    <a href="https://v10.angular.io/guide/migration-injectable" class="_attribution-link">https://v10.angular.io/guide/migration-injectable</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>


<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Shell – Execute Shell Commands on Targets - Ansible 2.9 - W3cubDocs</title>
  
  <meta name="description" content=" Note ">
  <meta name="keywords" content="shell, –, execute, commands, on, targets, ansible, ansible~2.9">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.9/modules/shell_module.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-01fda2ddb8339756caccf7add5ad4cf849ab52d069bd799015c7f04f93164f64753bff0d15a49d8060b1e66e41002bb301ccadc2350937df079cea3cd52d3cca.css">
  <script src="/assets/application-d9be6f56a823612443fc15b2e027a630e02c4ad2685bb750d13fa4fae28d46c3e7f7ebb69bd4bafddf116f218f9372e9be44021d4247dc20424e2fd1ff8cef81.js" type="text/javascript"></script>
  <script src="/json/ansible~2.9.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script data-ad-client="ca-pub-2572770204602497" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.9/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.9</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="link"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="shell-module">shell – Execute shell commands on targets</h1>  <ul class="simple" id="shell-execute-shell-commands-on-targets"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> <li><a class="reference internal" href="#status" id="id7">Status</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>The <code>shell</code> module takes the command name followed by a list of space-delimited arguments.</li> <li>Either a free form command or <code>cmd</code> parameter is required, see the examples.</li> <li>It is almost exactly like the <a class="reference internal" href="command_module#command-module"><span class="std std-ref">command</span></a> module but runs the command through a shell (<code>/bin/sh</code>) on the remote node.</li> <li>For Windows targets, use the <a class="reference internal" href="win_shell_module#win-shell-module"><span class="std std-ref">win_shell</span></a> module instead.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>chdir</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>Change into this directory before running the command.</div> </td> </tr> <tr> <td colspan="1">  <b>cmd</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The command to run followed by optional arguments.</div> </td> </tr> <tr> <td colspan="1">  <b>creates</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>A filename, when it already exists, this step will <b>not</b> be run.</div> </td> </tr> <tr> <td colspan="1">  <b>executable</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>Change the shell used to execute the command.</div> <div>This expects an absolute path to the executable.</div> </td> </tr> <tr> <td colspan="1">  <b>free_form</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The shell module takes a free form command to run, as a string.</div> <div>There is no actual parameter named 'free form'.</div> <div>See the examples on how to use this module.</div> </td> </tr> <tr> <td colspan="1">  <b>removes</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>A filename, when it does not exist, this step will <b>not</b> be run.</div> </td> </tr> <tr> <td colspan="1">  <b>stdin</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.4</div> </td> <td> </td> <td> <div>Set the stdin of the command directly to the specified value.</div> </td> </tr> <tr> <td colspan="1">  <b>stdin_add_newline</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.8</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Whether to append a newline to stdin data.</div> </td> </tr> <tr> <td colspan="1">  <b>warn</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Whether to enable task warnings.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>If you want to execute a command securely and predictably, it may be better to use the <a class="reference internal" href="command_module#command-module"><span class="std std-ref">command</span></a> module instead. Best practices when writing playbooks will follow the trend of using <a class="reference internal" href="command_module#command-module"><span class="std std-ref">command</span></a> unless the <code>shell</code> module is explicitly required. When running ad-hoc commands, use your best judgement.</li> <li>Check mode is supported when passing <code>creates</code> or <code>removes</code>. If running in check mode and either of these are specified, the module will check for the existence of the file and report the correct changed status. If these are not supplied, the task will be skipped.</li> <li>To sanitize any variables passed to the shell module, you should use <code>{{ var | quote }}</code> instead of just <code>{{ var }}</code> to make sure they do not include evil things like semicolons.</li> <li>An alternative to using inline shell scripts with this module is to use the <a class="reference internal" href="script_module#script-module"><span class="std std-ref">script</span></a> module possibly together with the <a class="reference internal" href="template_module#template-module"><span class="std std-ref">template</span></a> module.</li> <li>For rebooting systems, use the <a class="reference internal" href="reboot_module#reboot-module"><span class="std std-ref">reboot</span></a> or <a class="reference internal" href="win_reboot_module#win-reboot-module"><span class="std std-ref">win_reboot</span></a> module.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <dl class="last docutils"> <dt><a class="reference internal" href="command_module#command-module"><span class="std std-ref">command – Execute commands on targets</span></a></dt> <dd>The official documentation on the <strong>command</strong> module.</dd> <dt><a class="reference internal" href="raw_module#raw-module"><span class="std std-ref">raw – Executes a low-down and dirty command</span></a></dt> <dd>The official documentation on the <strong>raw</strong> module.</dd> <dt><a class="reference internal" href="script_module#script-module"><span class="std std-ref">script – Runs a local script on a remote node after transferring it</span></a></dt> <dd>The official documentation on the <strong>script</strong> module.</dd> <dt><a class="reference internal" href="win_shell_module#win-shell-module"><span class="std std-ref">win_shell – Execute shell commands on target hosts</span></a></dt> <dd>The official documentation on the <strong>win_shell</strong> module.</dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Execute the command in remote shell; stdout goes to the specified file on the remote.
  shell: somescript.sh &gt;&gt; somelog.txt

- name: Change the working directory to somedir/ before executing the command.
  shell: somescript.sh &gt;&gt; somelog.txt
  args:
    chdir: somedir/

# You can also use the 'args' form to provide the options.
- name: This command will change the working directory to somedir/ and will only run when somedir/somelog.txt doesn't exist.
  shell: somescript.sh &gt;&gt; somelog.txt
  args:
    chdir: somedir/
    creates: somelog.txt

# You can also use the 'cmd' parameter instead of free form format.
- name: This command will change the working directory to somedir/.
  shell:
    cmd: ls -l | grep log
    chdir: somedir/

- name: Run a command that uses non-posix shell-isms (in this example /bin/sh doesn't handle redirection and wildcards together but bash does)
  shell: cat &lt; /tmp/*txt
  args:
    executable: /bin/bash

- name: Run a command using a templated variable (always use quote filter to avoid injection)
  shell: cat {{ myfile|quote }}

# You can use shell to run other executables to perform actions inline
- name: Run expect to wait for a successful PXE boot via out-of-band CIMC
  shell: |
    set timeout 300
    spawn ssh admin@{{ cimc_host }}

    expect "password:"
    send "{{ cimc_password }}\n"

    expect "\n{{ cimc_name }}"
    send "connect host\n"

    expect "pxeboot.n12"
    send "\n"

    exit 0
  args:
    executable: /usr/bin/expect
  delegate_to: localhost

# Disabling warnings
- name: Using curl to connect to a host via SOCKS proxy (unsupported in uri). Ordinarily this would throw a warning.
  shell: curl --socks5 localhost:9000 http://www.ansible.com
  args:
    warn: no
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>cmd</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command executed by the task</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">rabbitmqctl join_cluster rabbit@master</div> </td> </tr> <tr> <td colspan="1">  <b>delta</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command execution delta time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">0:00:00.325771</div> </td> </tr> <tr> <td colspan="1">  <b>end</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command execution end time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">2016-02-25 09:18:26.755339</div> </td> </tr> <tr> <td colspan="1">  <b>msg</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td>always</td> <td> <div>changed</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">True</div> </td> </tr> <tr> <td colspan="1">  <b>rc</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td>always</td> <td> <div>The command return code (0 means success)</div> <br> </td> </tr> <tr> <td colspan="1">  <b>start</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command execution start time</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">2016-02-25 09:18:26.429568</div> </td> </tr> <tr> <td colspan="1">  <b>stderr</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command standard error</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">ls: cannot access foo: No such file or directory</div> </td> </tr> <tr> <td colspan="1">  <b>stdout</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>always</td> <td> <div>The command standard output</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">Clustering node rabbit@slave1 with rabbit@master ...</div> </td> </tr> <tr> <td colspan="1">  <b>stdout_lines</b>  <div style="font-size: small"> <span style="color: purple">list</span> </div> </td> <td>always</td> <td> <div>The command standard output split in lines</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">["u'Clustering node rabbit@slave1 with rabbit@master ...'"]</div> </td> </tr> </table> <br><br>  <h2 id="status">Status</h2> <ul class="simple"> <li>This module is guaranteed to have backward compatible interface changes going forward. <em>[stableinterface]</em>
</li> <li>This module is <a class="reference internal" href="../user_guide/modules_support#modules-support"><span class="std std-ref">maintained by the Ansible Core Team</span></a>. <em>[core]</em>
</li> </ul>  <h3 id="red-hat-support">Red Hat Support</h3> <p>More information about Red Hat’s support of this module is available from this <a class="reference external" href="https://access.redhat.com/articles/3166901">Red Hat Knowledge Base article</a>.</p>   <h3 id="authors">Authors</h3> <ul class="simple"> <li>Ansible Core Team</li> <li>Michael DeHaan</li> </ul> <div class="admonition hint"> <p class="first admonition-title">Hint</p> <p class="last">If you notice any issues in this documentation, you can <a class="reference external" href="https://github.com/ansible/ansible/edit/devel/lib/ansible/modules/commands/shell.py?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr">edit this document</a> to improve it.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.9/modules/shell_module.html" class="_attribution-link">https://docs.ansible.com/ansible/2.9/modules/shell_module.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>

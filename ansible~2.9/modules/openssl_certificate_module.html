
<!DOCTYPE HTML>

<html lang="en" class="_theme-default">

<head>
  <meta charset="utf-8">
  <title>Openssl_certificate – Generate And&#47;or Check OpenSSL Certificates - Ansible 2.9 - W3cubDocs</title>
  
  <meta name="description" content=" New in version 2.4. ">
  <meta name="keywords" content="openssl, certificate, –, generate, and, or, check, certificates, ansible, ansible~2.9">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="https://docs.w3cub.com/ansible~2.9/modules/openssl_certificate_module.html">
  <link href="/favicon.png" rel="icon">
  <link rel="stylesheet" type="text/css" href="/assets/application-e498cd0ebe8746846fec95b1a53ab3bb0fb7f47f794f0a38f44c98a1f0d03b21d777ae2c583732e44a5a890f6eacb79a5333545db9d5f3616091ba21ca17d916.css">
  <script src="/assets/application-79c555f6b25481fffac2cac30a7f3e54e608ca09e9e8e42bb1790095ba6d0fcace47d6bc624ddce952c70370892f2d46864f89e6943d4f7f7ff16c8a3231a91a.js" type="text/javascript"></script>
  <script src="/json/ansible~2.9.js"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R3WC07G3GB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R3WC07G3GB');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2572770204602497"
     crossorigin="anonymous"></script>
<script async custom-element="amp-auto-ads"
  src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>


</head>

<body class="docs">
	<amp-auto-ads type="adsense"
              data-ad-client="ca-pub-2572770204602497">
	</amp-auto-ads>
	<div class="_app">
	<header class="_header">

  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible~2.9/" class="_nav-link" title="" style="margin-left:0;">Ansible 2.9</a></span>
  
  <nav class="_nav">
    <a href="https://tools.w3cub.com/?_sp=docs" target="_blank" class="_nav-link ">W3cubTools</a>
    <a href="/cheatsheets/" class="_nav-link ">Cheatsheets</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		
		<form class="_search">
		  <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
		  <a class="_search-clear"></a>
		  <div class="_search-tag"></div>
		</form>
		
		<div class="_list-wrap">
			<div class="_list">
			
			</div>
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="6861657091"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			<div class="_page _sphinx">
				
				
<h1 id="openssl-certificate-module">openssl_certificate – Generate and/or check OpenSSL certificates</h1> <div class="versionadded" id="openssl-certificate-generate-and-or-check-openssl-certificates"> <p><span class="versionmodified">New in version 2.4.</span></p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id7">Return Values</a></li> <li><a class="reference internal" href="#status" id="id8">Status</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module allows one to (re)generate OpenSSL certificates.</li> <li>It implements a notion of provider (ie. <code>selfsigned</code>, <code>ownca</code>, <code>acme</code>, <code>assertonly</code>, <code>entrust</code>) for your certificate.</li> <li>The <code>assertonly</code> provider is intended for use cases where one is only interested in checking properties of a supplied certificate. Please note that this provider has been deprecated in Ansible 2.9 and will be removed in Ansible 2.13. See the examples on how to emulate <code>assertonly</code> usage with <a class="reference internal" href="openssl_certificate_info_module#openssl-certificate-info-module"><span class="std std-ref">openssl_certificate_info</span></a>, <a class="reference internal" href="openssl_csr_info_module#openssl-csr-info-module"><span class="std std-ref">openssl_csr_info</span></a>, <a class="reference internal" href="openssl_privatekey_info_module#openssl-privatekey-info-module"><span class="std std-ref">openssl_privatekey_info</span></a> and <a class="reference internal" href="assert_module#assert-module"><span class="std std-ref">assert</span></a>. This also allows more flexible checks than the ones offered by the <code>assertonly</code> provider.</li> <li>The <code>ownca</code> provider is intended for generating OpenSSL certificate signed with your own CA (Certificate Authority) certificate (self-signed certificate).</li> <li>Many properties that can be specified in this module are for validation of an existing or newly generated certificate. The proper place to specify them, if you want to receive a certificate with these properties is a CSR (Certificate Signing Request).</li> <li>Please note that the module regenerates existing certificate if it doesn’t match the module’s options, or if it seems to be corrupt. If you are concerned that this could overwrite your existing certificate, consider using the <em>backup</em> option.</li> <li>It uses the pyOpenSSL or cryptography python library to interact with OpenSSL.</li> <li>If both the cryptography and PyOpenSSL libraries are available (and meet the minimum version requirements) cryptography will be preferred as a backend over PyOpenSSL (unless the backend is forced with <code>select_crypto_backend</code>). Please note that the PyOpenSSL backend was deprecated in Ansible 2.9 and will be removed in Ansible 2.13.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>PyOpenSSL &gt;= 0.15 or cryptography &gt;= 1.6 (if using <code>selfsigned</code> or <code>assertonly</code> provider)</li> <li>acme-tiny (if using the <code>acme</code> provider)</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>acme_accountkey_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>The path to the accountkey for the <code>acme</code> provider.</div> <div>This is only used by the <code>acme</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>acme_chain</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.5</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Include the intermediate certificate to the generated certificate</div> <div>This is only used by the <code>acme</code> provider.</div> <div>Note that this is only available for older versions of <code>acme-tiny</code>. New versions include the chain automatically, and setting <em>acme_chain</em> to <code>yes</code> results in an error.</div> </td> </tr> <tr> <td colspan="1">  <b>acme_challenge_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>The path to the ACME challenge directory that is served on <a href="#">http://&lt;HOST&gt;:80/.well-known/acme-challenge/</a>
</div> <div>This is only used by the <code>acme</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>attributes</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The attributes the resulting file or directory should have.</div> <div>To get supported flags look at the man page for <em>chattr</em> on the target system.</div> <div>This string should contain the attributes in the same order as the one displayed by <em>lsattr</em>.</div> <div>The <code>=</code> operator is assumed as default, otherwise <code>+</code> or <code>-</code> operators need to be included in the string.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: attr</div> </td> </tr> <tr> <td colspan="1">  <b>backup</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.8</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Create a backup file including a timestamp so you can get the original certificate back if you overwrote it with a new one by accident.</div> <div>This is not used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>csr_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>Path to the Certificate Signing Request (CSR) used to generate this certificate.</div> <div>This is not required in <code>assertonly</code> mode.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_api_client_cert_key_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The path to the private key of the client certificate used to authenticate to the Entrust Certificate Services (ECS) API.</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_api_client_cert_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The path to the client certificate used to authenticate to the Entrust Certificate Services (ECS) API.</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_api_key</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The key (password) for authentication to the Entrust Certificate Services (ECS) API.</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_api_specification_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <b>Default:</b><br><div style="color: blue">"https://cloud.entrust.net/EntrustCloud/documentation/cms-api-2.1.0.yaml"</div> </td> <td> <div>The path to the specification file defining the Entrust Certificate Services (ECS) API configuration.</div> <div>You can use this to keep a local copy of the specification to avoid downloading it every time the module is used.</div> <div>This is only used by the <code>entrust</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_api_user</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The username for authentication to the Entrust Certificate Services (ECS) API.</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_cert_type</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>STANDARD_SSL</b> ←</div></li> <li>ADVANTAGE_SSL</li> <li>UC_SSL</li> <li>EV_SSL</li> <li>WILDCARD_SSL</li> <li>PRIVATE_SSL</li> <li>PD_SSL</li> <li>CDS_ENT_LITE</li> <li>CDS_ENT_PRO</li> <li>SMIME_ENT</li> </ul> </td> <td> <div>Specify the type of certificate requested.</div> <div>This is only used by the <code>entrust</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_not_after</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <b>Default:</b><br><div style="color: blue">"+365d"</div> </td> <td> <div>The point in time at which the certificate stops being valid.</div> <div>Time can be specified either as relative time or as an absolute timestamp.</div> <div>A valid absolute time format is <code>ASN.1 TIME</code> such as <code>2019-06-18</code>.</div> <div>A valid relative time format is <code>[+-]timespec</code> where timespec can be an integer + <code>[w | d | h | m | s]</code>, such as <code>+365d</code> or <code>+32w1d2h</code>).</div> <div>Time will always be interpreted as UTC.</div> <div>Note that only the date (day, month, year) is supported for specifying the expiry date of the issued certificate.</div> <div>The full date-time is adjusted to EST (GMT -5:00) before issuance, which may result in a certificate with an expiration date one day earlier than expected if a relative time is used.</div> <div>The minimum certificate lifetime is 90 days, and maximum is three years.</div> <div>If this value is not specified, the certificate will stop being valid 365 days the date of issue.</div> <div>This is only used by the <code>entrust</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_requester_email</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The email of the requester of the certificate (for tracking purposes).</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_requester_name</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The name of the requester of the certificate (for tracking purposes).</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>entrust_requester_phone</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> </td> <td> <div>The phone number of the requester of the certificate (for tracking purposes).</div> <div>This is only used by the <code>entrust</code> provider.</div> <div>This is required if the provider is <code>entrust</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>extended_key_usage</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>The <em>extended_key_usage</em> extension field must contain all these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: extendedKeyUsage</div> </td> </tr> <tr> <td colspan="1">  <b>extended_key_usage_strict</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to <code>yes</code>, the <em>extended_key_usage</em> extension field must contain only these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: extendedKeyUsage_strict</div> </td> </tr> <tr> <td colspan="1">  <b>force</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Generate the certificate, even if it already exists.</div> </td> </tr> <tr> <td colspan="1">  <b>group</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Name of the group that should own the file/directory, as would be fed to <em>chown</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>has_expired</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Checks if the certificate is expired/not expired at the time the module is executed.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>invalid_at</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The certificate must be invalid at this point in time.</div> <div>The timestamp is formatted as an ASN.1 TIME.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>issuer</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>The key/value pairs that must be present in the issuer name field of the certificate.</div> <div>If you need to specify more than one value with the same key, use a list as value.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>issuer_strict</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.5</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to <code>yes</code>, the <em>issuer</em> field must contain only these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>key_usage</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>The <em>key_usage</em> extension field must contain all these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: keyUsage</div> </td> </tr> <tr> <td colspan="1">  <b>key_usage_strict</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to <code>yes</code>, the <em>key_usage</em> extension field must contain only these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: keyUsage_strict</div> </td> </tr> <tr> <td colspan="1">  <b>mode</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The permissions the resulting file or directory should have.</div> <div>For those used to <em>/usr/bin/chmod</em> remember that modes are actually octal numbers. You must either add a leading zero so that Ansible's YAML parser knows it is an octal number (like <code>0644</code> or <code>01777</code>) or quote it (like <code>'644'</code> or <code>'1777'</code>) so Ansible receives a string and can do its own conversion from string into number.</div> <div>Giving Ansible a number without following one of these rules will end up with a decimal number which will have unexpected results.</div> <div>As of Ansible 1.8, the mode may be specified as a symbolic mode (for example, <code>u+rwx</code> or <code>u=rw,g=r,o=r</code>).</div> </td> </tr> <tr> <td colspan="1">  <b>not_after</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The certificate must expire at this point in time.</div> <div>The timestamp is formatted as an ASN.1 TIME.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: notAfter</div> </td> </tr> <tr> <td colspan="1">  <b>not_before</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The certificate must start to become valid at this point in time.</div> <div>The timestamp is formatted as an ASN.1 TIME.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: notBefore</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_create_authority_key_identifier</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>no</li> <li><div style="color: blue">
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Create a Authority Key Identifier from the CA's certificate. If the CSR provided a authority key identifier, it is ignored.</div> <div>The Authority Key Identifier is generated from the CA certificate's Subject Key Identifier, if available. If it is not available, the CA certificate's public key will be used.</div> <div>This is only used by the <code>ownca</code> provider.</div> <div>Note that this is only supported if the <code>cryptography</code> backend is used!</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_create_subject_key_identifier</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>create_if_not_provided</b> ←</div></li> <li>always_create</li> <li>never_create</li> </ul> </td> <td> <div>Whether to create the Subject Key Identifier (SKI) from the public key.</div> <div>A value of <code>create_if_not_provided</code> (default) only creates a SKI when the CSR does not provide one.</div> <div>A value of <code>always_create</code> always creates a SKI. If the CSR provides one, that one is ignored.</div> <div>A value of <code>never_create</code> never creates a SKI. If the CSR provides one, that one is used.</div> <div>This is only used by the <code>ownca</code> provider.</div> <div>Note that this is only supported if the <code>cryptography</code> backend is used!</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_digest</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> <b>Default:</b><br><div style="color: blue">"sha256"</div> </td> <td> <div>The digest algorithm to be used for the <code>ownca</code> certificate.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_not_after</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> <b>Default:</b><br><div style="color: blue">"+3650d"</div> </td> <td> <div>The point in time at which the certificate stops being valid.</div> <div>Time can be specified either as relative time or as absolute timestamp.</div> <div>Time will always be interpreted as UTC.</div> <div>Valid format is <code>[+-]timespec | ASN.1 TIME</code> where timespec can be an integer + <code>[w | d | h | m | s]</code> (e.g. <code>+32w1d2h</code>.</div> <div>Note that if using relative time this module is NOT idempotent.</div> <div>If this value is not specified, the certificate will stop being valid 10 years from now.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_not_before</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> <b>Default:</b><br><div style="color: blue">"+0s"</div> </td> <td> <div>The point in time the certificate is valid from.</div> <div>Time can be specified either as relative time or as absolute timestamp.</div> <div>Time will always be interpreted as UTC.</div> <div>Valid format is <code>[+-]timespec | ASN.1 TIME</code> where timespec can be an integer + <code>[w | d | h | m | s]</code> (e.g. <code>+32w1d2h</code>.</div> <div>Note that if using relative time this module is NOT idempotent.</div> <div>If this value is not specified, the certificate will start being valid from now.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> </td> <td> <div>Remote absolute path of the CA (Certificate Authority) certificate.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_privatekey_passphrase</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> </td> <td> <div>The passphrase for the <em>ownca_privatekey_path</em>.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_privatekey_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> </td> <td> <div>Path to the CA (Certificate Authority) private key to use when signing the certificate.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>ownca_version</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.7</div> </td> <td> <b>Default:</b><br><div style="color: blue">3</div> </td> <td> <div>The version of the <code>ownca</code> certificate.</div> <div>Nowadays it should almost always be <code>3</code>.</div> <div>This is only used by the <code>ownca</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>owner</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>Name of the user that should own the file/directory, as would be fed to <em>chown</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>path</b>  <div style="font-size: small"> <span style="color: purple">path</span> / <span style="color: red">required</span> </div> </td> <td> </td> <td> <div>Remote absolute path where the generated certificate file should be created or is already located.</div> </td> </tr> <tr> <td colspan="1">  <b>privatekey_passphrase</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The passphrase for the <em>privatekey_path</em>.</div> <div>This is required if the private key is password protected.</div> </td> </tr> <tr> <td colspan="1">  <b>privatekey_path</b>  <div style="font-size: small"> <span style="color: purple">path</span> </div> </td> <td> </td> <td> <div>Path to the private key to use when signing the certificate.</div> </td> </tr> <tr> <td colspan="1">  <b>provider</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>acme</li> <li>assertonly</li> <li>entrust</li> <li>ownca</li> <li>selfsigned</li> </ul> </td> <td> <div>Name of the provider to use to generate/retrieve the OpenSSL certificate.</div> <div>The <code>assertonly</code> provider will not generate files and fail if the certificate file is missing.</div> <div>The <code>assertonly</code> provider has been deprecated in Ansible 2.9 and will be removed in Ansible 2.13. Please see the examples on how to emulate it with <span class="module">openssl_certificate_info</span>, <span class="module">openssl_csr_info</span>, <span class="module">openssl_privatekey_info</span> and <span class="module">assert</span>.</div> <div>The <code>entrust</code> provider was added for Ansible 2.9 and requires credentials for the <a href="entrust%20certificate%20services">https://www.entrustdatacard.com/products/categories/ssl-certificates</a> (ECS) API.</div> <div>Required if <em>state</em> is <code>present</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>select_crypto_backend</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.8</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>auto</b> ←</div></li> <li>cryptography</li> <li>pyopenssl</li> </ul> </td> <td> <div>Determines which crypto backend to use.</div> <div>The default choice is <code>auto</code>, which tries to use <code>cryptography</code> if available, and falls back to <code>pyopenssl</code>.</div> <div>If set to <code>pyopenssl</code>, will try to use the <a href="https://pypi.org/project/pyOpenSSL/">pyOpenSSL</a> library.</div> <div>If set to <code>cryptography</code>, will try to use the <a href="https://cryptography.io/">cryptography</a> library.</div> <div>Please note that the <code>pyopenssl</code> backend has been deprecated in Ansible 2.9, and will be removed in Ansible 2.13. From that point on, only the <code>cryptography</code> backend will be available.</div> </td> </tr> <tr> <td colspan="1">  <b>selevel</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"s0"</div> </td> <td> <div>The level part of the SELinux file context.</div> <div>This is the MLS/MCS attribute, sometimes known as the <code>range</code>.</div> <div>When set to <code>_default</code>, it will use the <code>level</code> portion of the policy if available.</div> </td> </tr> <tr> <td colspan="1">  <b>selfsigned_create_subject_key_identifier</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.9</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>create_if_not_provided</b> ←</div></li> <li>always_create</li> <li>never_create</li> </ul> </td> <td> <div>Whether to create the Subject Key Identifier (SKI) from the public key.</div> <div>A value of <code>create_if_not_provided</code> (default) only creates a SKI when the CSR does not provide one.</div> <div>A value of <code>always_create</code> always creates a SKI. If the CSR provides one, that one is ignored.</div> <div>A value of <code>never_create</code> never creates a SKI. If the CSR provides one, that one is used.</div> <div>This is only used by the <code>selfsigned</code> provider.</div> <div>Note that this is only supported if the <code>cryptography</code> backend is used!</div> </td> </tr> <tr> <td colspan="1">  <b>selfsigned_digest</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"sha256"</div> </td> <td> <div>Digest algorithm to be used when self-signing the certificate.</div> <div>This is only used by the <code>selfsigned</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>selfsigned_not_after</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"+3650d"</div> </td> <td> <div>The point in time at which the certificate stops being valid.</div> <div>Time can be specified either as relative time or as absolute timestamp.</div> <div>Time will always be interpreted as UTC.</div> <div>Valid format is <code>[+-]timespec | ASN.1 TIME</code> where timespec can be an integer + <code>[w | d | h | m | s]</code> (e.g. <code>+32w1d2h</code>.</div> <div>Note that if using relative time this module is NOT idempotent.</div> <div>If this value is not specified, the certificate will stop being valid 10 years from now.</div> <div>This is only used by the <code>selfsigned</code> provider.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: selfsigned_notAfter</div> </td> </tr> <tr> <td colspan="1">  <b>selfsigned_not_before</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <b>Default:</b><br><div style="color: blue">"+0s"</div> </td> <td> <div>The point in time the certificate is valid from.</div> <div>Time can be specified either as relative time or as absolute timestamp.</div> <div>Time will always be interpreted as UTC.</div> <div>Valid format is <code>[+-]timespec | ASN.1 TIME</code> where timespec can be an integer + <code>[w | d | h | m | s]</code> (e.g. <code>+32w1d2h</code>.</div> <div>Note that if using relative time this module is NOT idempotent.</div> <div>If this value is not specified, the certificate will start being valid from now.</div> <div>This is only used by the <code>selfsigned</code> provider.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: selfsigned_notBefore</div> </td> </tr> <tr> <td colspan="1">  <b>selfsigned_version</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.5</div> </td> <td> <b>Default:</b><br><div style="color: blue">3</div> </td> <td> <div>Version of the <code>selfsigned</code> certificate.</div> <div>Nowadays it should almost always be <code>3</code>.</div> <div>This is only used by the <code>selfsigned</code> provider.</div> </td> </tr> <tr> <td colspan="1">  <b>serole</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The role part of the SELinux file context.</div> <div>When set to <code>_default</code>, it will use the <code>role</code> portion of the policy if available.</div> </td> </tr> <tr> <td colspan="1">  <b>setype</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The type part of the SELinux file context.</div> <div>When set to <code>_default</code>, it will use the <code>type</code> portion of the policy if available.</div> </td> </tr> <tr> <td colspan="1">  <b>seuser</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The user part of the SELinux file context.</div> <div>By default it uses the <code>system</code> policy, where applicable.</div> <div>When set to <code>_default</code>, it will use the <code>user</code> portion of the policy if available.</div> </td> </tr> <tr> <td colspan="1">  <b>signature_algorithms</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>A list of algorithms that you would accept the certificate to be signed with (e.g. ['sha256WithRSAEncryption', 'sha512WithRSAEncryption']).</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li>absent</li> <li><div style="color: blue">
<b>present</b> ←</div></li> </ul> </td> <td> <div>Whether the certificate should exist or not, taking action if the state is different from what is stated.</div> </td> </tr> <tr> <td colspan="1">  <b>subject</b>  <div style="font-size: small"> <span style="color: purple">dictionary</span> </div> </td> <td> </td> <td> <div>The key/value pairs that must be present in the subject name field of the certificate.</div> <div>If you need to specify more than one value with the same key, use a list as value.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>subject_alt_name</b>  <div style="font-size: small"> <span style="color: purple">list</span> / <span style="color: purple">elements=string</span> </div> </td> <td> </td> <td> <div>The <em>subject_alt_name</em> extension field must contain these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: subjectAltName</div> </td> </tr> <tr> <td colspan="1">  <b>subject_alt_name_strict</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to <code>yes</code>, the <em>subject_alt_name</em> extension field must contain only these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> <div style="font-size: small; color: darkgreen">
<br>aliases: subjectAltName_strict</div> </td> </tr> <tr> <td colspan="1">  <b>subject_strict</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> <div style="font-style: italic; font-size: small; color: darkgreen">added in 2.5</div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to <code>yes</code>, the <em>subject</em> field must contain only these values.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>unsafe_writes</b>  <div style="font-size: small"> <span style="color: purple">boolean</span> </div> </td> <td> <ul style="margin: 0; padding: 0">
<b>Choices:</b> <li><div style="color: blue">
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Influence when to use atomic operation to prevent data corruption or inconsistent reads from the target file.</div> <div>By default this module uses atomic operations to prevent data corruption or inconsistent reads from the target files, but sometimes systems are configured or just broken in ways that prevent this. One example is docker mounted files, which cannot be updated atomically from inside the container and can only be written in an unsafe manner.</div> <div>This option allows Ansible to fall back to unsafe methods of updating files when atomic operations fail (however, it doesn't force Ansible to perform unsafe writes).</div> <div>IMPORTANT! Unsafe writes are subject to race conditions and can lead to data corruption.</div> </td> </tr> <tr> <td colspan="1">  <b>valid_at</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The certificate must be valid at this point in time.</div> <div>The timestamp is formatted as an ASN.1 TIME.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>valid_in</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td> </td> <td> <div>The certificate must still be valid at this relative time offset from now.</div> <div>Valid format is <code>[+-]timespec | number_of_seconds</code> where timespec can be an integer + <code>[w | d | h | m | s]</code> (e.g. <code>+32w1d2h</code>.</div> <div>Note that if using this parameter, this module is NOT idempotent.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>version</b>  <div style="font-size: small"> <span style="color: purple">integer</span> </div> </td> <td> </td> <td> <div>The version of the certificate.</div> <div>Nowadays it should almost always be 3.</div> <div>This is only used by the <code>assertonly</code> provider.</div> <div>This option is deprecated since Ansible 2.9 and will be removed with the <code>assertonly</code> provider in Ansible 2.13. For alternatives, see the example on replacing <code>assertonly</code>.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>All ASN.1 TIME values should be specified following the YYYYMMDDHHMMSSZ pattern.</li> <li>Date specified should be UTC. Minutes and seconds are mandatory.</li> <li>For security reason, when you use <code>ownca</code> provider, you should NOT run <a class="reference internal" href="#openssl-certificate-module"><span class="std std-ref">openssl_certificate</span></a> on a target machine, but on a dedicated CA machine. It is recommended not to store the CA private key on the target machine. Once signed, the certificate can be moved to the target machine.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="first admonition-title">See also</p> <dl class="last docutils"> <dt><a class="reference internal" href="openssl_csr_module#openssl-csr-module"><span class="std std-ref">openssl_csr – Generate OpenSSL Certificate Signing Request (CSR)</span></a></dt> <dd>The official documentation on the <strong>openssl_csr</strong> module.</dd> <dt><a class="reference internal" href="openssl_dhparam_module#openssl-dhparam-module"><span class="std std-ref">openssl_dhparam – Generate OpenSSL Diffie-Hellman Parameters</span></a></dt> <dd>The official documentation on the <strong>openssl_dhparam</strong> module.</dd> <dt><a class="reference internal" href="openssl_pkcs12_module#openssl-pkcs12-module"><span class="std std-ref">openssl_pkcs12 – Generate OpenSSL PKCS#12 archive</span></a></dt> <dd>The official documentation on the <strong>openssl_pkcs12</strong> module.</dd> <dt><a class="reference internal" href="openssl_privatekey_module#openssl-privatekey-module"><span class="std std-ref">openssl_privatekey – Generate OpenSSL private keys</span></a></dt> <dd>The official documentation on the <strong>openssl_privatekey</strong> module.</dd> <dt><a class="reference internal" href="openssl_publickey_module#openssl-publickey-module"><span class="std std-ref">openssl_publickey – Generate an OpenSSL public key from its private key</span></a></dt> <dd>The official documentation on the <strong>openssl_publickey</strong> module.</dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml">- name: Generate a Self Signed OpenSSL certificate
  openssl_certificate:
    path: /etc/ssl/crt/ansible.com.crt
    privatekey_path: /etc/ssl/private/ansible.com.pem
    csr_path: /etc/ssl/csr/ansible.com.csr
    provider: selfsigned

- name: Generate an OpenSSL certificate signed with your own CA certificate
  openssl_certificate:
    path: /etc/ssl/crt/ansible.com.crt
    csr_path: /etc/ssl/csr/ansible.com.csr
    ownca_path: /etc/ssl/crt/ansible_CA.crt
    ownca_privatekey_path: /etc/ssl/private/ansible_CA.pem
    provider: ownca

- name: Generate a Let's Encrypt Certificate
  openssl_certificate:
    path: /etc/ssl/crt/ansible.com.crt
    csr_path: /etc/ssl/csr/ansible.com.csr
    provider: acme
    acme_accountkey_path: /etc/ssl/private/ansible.com.pem
    acme_challenge_path: /etc/ssl/challenges/ansible.com/

- name: Force (re-)generate a new Let's Encrypt Certificate
  openssl_certificate:
    path: /etc/ssl/crt/ansible.com.crt
    csr_path: /etc/ssl/csr/ansible.com.csr
    provider: acme
    acme_accountkey_path: /etc/ssl/private/ansible.com.pem
    acme_challenge_path: /etc/ssl/challenges/ansible.com/
    force: yes

- name: Generate an Entrust certificate via the Entrust Certificate Services (ECS) API
  openssl_certificate:
    path: /etc/ssl/crt/ansible.com.crt
    csr_path: /etc/ssl/csr/ansible.com.csr
    provider: entrust
    entrust_requester_name: Jo Doe
    entrust_requester_email: jdoe@ansible.com
    entrust_requester_phone: 555-555-5555
    entrust_cert_type: STANDARD_SSL
    entrust_api_user: apiusername
    entrust_api_key: a^lv*32!cd9LnT
    entrust_api_client_cert_path: /etc/ssl/entrust/ecs-client.crt
    entrust_api_client_cert_key_path: /etc/ssl/entrust/ecs-key.crt
    entrust_api_specification_path: /etc/ssl/entrust/api-docs/cms-api-2.1.0.yaml

# The following example shows one assertonly usage using all existing options for
# assertonly, and shows how to emulate the behavior with the openssl_certificate_info,
# openssl_csr_info, openssl_privatekey_info and assert modules:

- openssl_certificate:
    provider: assertonly
    path: /etc/ssl/crt/ansible.com.crt
    csr_path: /etc/ssl/csr/ansible.com.csr
    privatekey_path: /etc/ssl/csr/ansible.com.key
    signature_algorithms:
      - sha256WithRSAEncryption
      - sha512WithRSAEncryption
    subject:
      commonName: ansible.com
    subject_strict: yes
    issuer:
      commonName: ansible.com
    issuer_strict: yes
    has_expired: no
    version: 3
    key_usage:
      - Data Encipherment
    key_usage_strict: yes
    extended_key_usage:
      - DVCS
    extended_key_usage_strict: yes
    subject_alt_name:
      - dns:ansible.com
    subject_alt_name_strict: yes
    not_before: 20190331202428Z
    not_after: 20190413202428Z
    valid_at: "+1d10h"
    invalid_at: 20200331202428Z
    valid_in: 10  # in ten seconds

- openssl_certificate_info:
    path: /etc/ssl/crt/ansible.com.crt
    # for valid_at, invalid_at and valid_in
    valid_at:
      one_day_ten_hours: "+1d10h"
      fixed_timestamp: 20200331202428Z
      ten_seconds: "+10"
  register: result

- openssl_csr_info:
    # Verifies that the CSR signature is valid; module will fail if not
    path: /etc/ssl/csr/ansible.com.csr
  register: result_csr

- openssl_privatekey_info:
    path: /etc/ssl/csr/ansible.com.key
  register: result_privatekey

- assert:
    that:
      # When private key is specified for assertonly, this will be checked:
      - result.public_key == result_privatekey.public_key
      # When CSR is specified for assertonly, this will be checked:
      - result.public_key == result_csr.public_key
      - result.subject_ordered == result_csr.subject_ordered
      - result.extensions_by_oid == result_csr.extensions_by_oid
      # signature_algorithms check
      - "result.signature_algorithm == 'sha256WithRSAEncryption' or result.signature_algorithm == 'sha512WithRSAEncryption'"
      # subject and subject_strict
      - "result.subject.commonName == 'ansible.com'"
      - "result.subject | length == 1"  # the number must be the number of entries you check for
      # issuer and issuer_strict
      - "result.issuer.commonName == 'ansible.com'"
      - "result.issuer | length == 1"  # the number must be the number of entries you check for
      # has_expired
      - not result.expired
      # version
      - result.version == 3
      # key_usage and key_usage_strict
      - "'Data Encipherment' in result.key_usage"
      - "result.key_usage | length == 1"  # the number must be the number of entries you check for
      # extended_key_usage and extended_key_usage_strict
      - "'DVCS' in result.extended_key_usage"
      - "result.extended_key_usage | length == 1"  # the number must be the number of entries you check for
      # subject_alt_name and subject_alt_name_strict
      - "'dns:ansible.com' in result.subject_alt_name"
      - "result.subject_alt_name | length == 1"  # the number must be the number of entries you check for
      # not_before and not_after
      - "result.not_before == '20190331202428Z'"
      - "result.not_after == '20190413202428Z'"
      # valid_at, invalid_at and valid_in
      - "result.valid_at.one_day_ten_hours"  # for valid_at
      - "not result.valid_at.fixed_timestamp"  # for invalid_at
      - "result.valid_at.ten_seconds"  # for valid_in

# Examples for some checks one could use the assertonly provider for:
# (Please note that assertonly has been deprecated!)

# How to use the assertonly provider to implement and trigger your own custom certificate generation workflow:
- name: Check if a certificate is currently still valid, ignoring failures
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    has_expired: no
  ignore_errors: yes
  register: validity_check

- name: Run custom task(s) to get a new, valid certificate in case the initial check failed
  command: superspecialSSL recreate /etc/ssl/crt/example.com.crt
  when: validity_check.failed

- name: Check the new certificate again for validity with the same parameters, this time failing the play if it is still invalid
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    has_expired: no
  when: validity_check.failed

# Some other checks that assertonly could be used for:
- name: Verify that an existing certificate was issued by the Let's Encrypt CA and is currently still valid
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    issuer:
      O: Let's Encrypt
    has_expired: no

- name: Ensure that a certificate uses a modern signature algorithm (no SHA1, MD5 or DSA)
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    signature_algorithms:
      - sha224WithRSAEncryption
      - sha256WithRSAEncryption
      - sha384WithRSAEncryption
      - sha512WithRSAEncryption
      - sha224WithECDSAEncryption
      - sha256WithECDSAEncryption
      - sha384WithECDSAEncryption
      - sha512WithECDSAEncryption

- name: Ensure that the existing certificate belongs to the specified private key
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    privatekey_path: /etc/ssl/private/example.com.pem
    provider: assertonly

- name: Ensure that the existing certificate is still valid at the winter solstice 2017
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    valid_at: 20171221162800Z

- name: Ensure that the existing certificate is still valid 2 weeks (1209600 seconds) from now
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    valid_in: 1209600

- name: Ensure that the existing certificate is only used for digital signatures and encrypting other keys
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    key_usage:
      - digitalSignature
      - keyEncipherment
    key_usage_strict: true

- name: Ensure that the existing certificate can be used for client authentication
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    extended_key_usage:
      - clientAuth

- name: Ensure that the existing certificate can only be used for client authentication and time stamping
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    extended_key_usage:
      - clientAuth
      - 1.3.6.1.5.5.7.3.8
    extended_key_usage_strict: true

- name: Ensure that the existing certificate has a certain domain in its subjectAltName
  openssl_certificate:
    path: /etc/ssl/crt/example.com.crt
    provider: assertonly
    subject_alt_name:
      - www.example.com
      - test.example.com
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../reference_appendices/common_return_values#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>backup_file</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>changed and if <em>backup</em> is <code>yes</code>
</td> <td> <div>Name of backup file created.</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">/path/to/www.ansible.com.crt.2019-03-09@11:22~</div> </td> </tr> <tr> <td colspan="1">  <b>filename</b>  <div style="font-size: small"> <span style="color: purple">string</span> </div> </td> <td>changed or success</td> <td> <div>Path to the generated Certificate</div> <br> <div style="font-size: smaller"><b>Sample:</b></div> <div style="font-size: smaller; color: blue; word-wrap: break-word; word-break: break-all;">/etc/ssl/crt/www.ansible.com.crt</div> </td> </tr> </table> <br><br>  <h2 id="status">Status</h2> <ul class="simple"> <li>This module is not guaranteed to have a backwards compatible interface. <em>[preview]</em>
</li> <li>This module is <a class="reference internal" href="../user_guide/modules_support#modules-support"><span class="std std-ref">maintained by the Ansible Community</span></a>. <em>[community]</em>
</li> </ul>  <h3 id="authors">Authors</h3> <ul class="simple"> <li>Yanis Guenane (@Spredzy)</li> <li>Markus Teufelberger (@MarkusTeufelberger)</li> </ul> <div class="admonition hint"> <p class="first admonition-title">Hint</p> <p class="last">If you notice any issues in this documentation, you can <a class="reference external" href="https://github.com/ansible/ansible/edit/devel/lib/ansible/modules/crypto/openssl_certificate.py?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr">edit this document</a> to improve it.</p> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2018 Michael DeHaan<br>© 2018–2019 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/2.9/modules/openssl_certificate_module.html" class="_attribution-link">https://docs.ansible.com/ansible/2.9/modules/openssl_certificate_module.html</a>
  </p>
</div>

				
			</div>
			<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2572770204602497"
     data-ad-slot="1992473792"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
